<p id=p0><span class='token pointer' id='tok-74-0'>In</span><span class='token pointer' id='tok-74-1'>this</span><span class='token pointer' id='tok-74-2'>article,</span><span class='token pointer' id='tok-74-3'>we</span><span class='token pointer' id='tok-74-4'>will</span><span class='token pointer' id='tok-74-5'>a</span><span class='token pointer' id='tok-74-6'>have</span><span class='token pointer' id='tok-74-7'>a</span><span class='token pointer' id='tok-74-8'>look</span><span class='token pointer' id='tok-74-9'>at</span><span class='token pointer' id='tok-74-10'>automating</span><span class='token pointer' id='tok-74-11'>certain</span><span class='token pointer' id='tok-74-12'>tasks</span><span class='token pointer' id='tok-74-13'>on</span><span class='token pointer' id='tok-74-14'>windows</span><span class='token pointer' id='tok-74-15'>to</span><span class='token pointer' id='tok-74-16'>escalate</span><span class='token pointer' id='tok-74-17'>our</span><span class='token pointer' id='tok-74-18'>privileges</span><span class='token pointer' id='tok-74-19'>and</span><span class='token pointer' id='tok-74-20'>gain</span><span class='token pointer' id='tok-74-21'>access</span><span class='token pointer' id='tok-74-22'>to</span><span class='token pointer' id='tok-74-23'>the</span><span class='token pointer' id='tok-74-24'>system.</span></p>
<p id=p25><span class='token pointer' id='tok-74-25'>Introduction:</span><span class='token pointer' id='tok-74-26'>Privilege</span><span class='token pointer' id='tok-74-27'>Escalation</span><span class='token pointer' id='tok-74-28'>on</span><span class='token pointer' id='tok-74-29'>any</span><span class='token pointer' id='tok-74-30'>system</span><span class='token pointer' id='tok-74-31'>mainly</span><span class='token pointer' id='tok-74-32'>involves</span><span class='token pointer' id='tok-74-33'>a</span><span class='token pointer' id='tok-74-34'>lot</span><span class='token pointer' id='tok-74-35'>of</span><span class='token pointer' id='tok-74-36'>information</span><span class='token pointer' id='tok-74-37'>gathering</span><span class='token pointer' id='tok-74-38'>about</span><span class='token pointer' id='tok-74-39'>the</span><span class='token pointer' id='tok-74-40'>target</span><span class='token pointer' id='tok-74-41'>host</span><span class='token pointer' id='tok-74-42'>which</span><span class='token pointer' id='tok-74-43'>further</span><span class='token pointer' id='tok-74-44'>includes</span><span class='token pointer' id='tok-74-45'>some</span><span class='token pointer' id='tok-74-46'>of</span><span class='token pointer' id='tok-74-47'>the</span><span class='token pointer' id='tok-74-48'>following</span><span class='token pointer' id='tok-74-49'>set</span><span class='token pointer' id='tok-74-50'>of</span><span class='token pointer' id='tok-74-51'>questions</span><span class='token pointer' id='tok-74-52'>that</span><span class='token pointer' id='tok-74-53'>a</span><span class='token pointer' id='tok-74-54'>penetration</span><span class='token pointer' id='tok-74-55'>tester</span><span class='token pointer' id='tok-74-56'>needs</span><span class='token pointer' id='tok-74-57'>to</span><span class='token pointer' id='tok-74-58'>cover:</span></p>
<p id=p59><span class='token pointer' id='tok-74-59'>What</span><span class='token pointer' id='tok-74-60'>version</span><span class='token pointer' id='tok-74-61'>of</span><span class='token pointer' id='tok-74-62'>operating</span><span class='token pointer' id='tok-74-63'>system</span><span class='token pointer' id='tok-74-64'>is</span><span class='token pointer' id='tok-74-65'>being</span><span class='token pointer' id='tok-74-66'>installed</span><span class='token pointer' id='tok-74-67'>on</span><span class='token pointer' id='tok-74-68'>the</span><span class='token pointer' id='tok-74-69'>host?Is</span><span class='token pointer' id='tok-74-70'>there</span><span class='token pointer' id='tok-74-71'>any</span><span class='token pointer' id='tok-74-72'>vulnerable</span><span class='token pointer' id='tok-74-73'>package</span><span class='token pointer' id='tok-74-74'>installed</span><span class='token pointer' id='tok-74-75'>or</span><span class='token pointer' id='tok-74-76'>running?What</span><span class='token pointer' id='tok-74-77'>type</span><span class='token pointer' id='tok-74-78'>of</span><span class='token pointer' id='tok-74-79'>services</span><span class='token pointer' id='tok-74-80'>are</span><span class='token pointer' id='tok-74-81'>running</span><span class='token pointer' id='tok-74-82'>on</span><span class='token pointer' id='tok-74-83'>the</span><span class='token pointer' id='tok-74-84'>system</span><span class='token pointer' id='tok-74-85'>and</span><span class='token pointer' id='tok-74-86'>whether</span><span class='token pointer' id='tok-74-87'>they</span><span class='token pointer' id='tok-74-88'>are</span><span class='token pointer' id='tok-74-89'>configured</span><span class='token pointer' id='tok-74-90'>properly</span><span class='token pointer' id='tok-74-91'>or</span><span class='token pointer' id='tok-74-92'>not</span><span class='token pointer' id='tok-74-93'>from</span><span class='token pointer' id='tok-74-94'>the</span><span class='token pointer' id='tok-74-95'>security</span><span class='token pointer' id='tok-74-96'>point</span><span class='token pointer' id='tok-74-97'>of</span><span class='token pointer' id='tok-74-98'>view?How</span><span class='token pointer' id='tok-74-99'>the</span><span class='token pointer' id='tok-74-100'>user</span><span class='token pointer' id='tok-74-101'>roles</span><span class='token pointer' id='tok-74-102'>are</span><span class='token pointer' id='tok-74-103'>being</span><span class='token pointer' id='tok-74-104'>segregated?How</span><span class='token pointer' id='tok-74-105'>the</span><span class='token pointer' id='tok-74-106'>file</span><span class='token pointer' id='tok-74-107'>system</span><span class='token pointer' id='tok-74-108'>permissions</span><span class='token pointer' id='tok-74-109'>are</span><span class='token pointer' id='tok-74-110'>being</span><span class='token pointer' id='tok-74-111'>assigned</span><span class='token pointer' id='tok-74-112'>to</span><span class='token pointer' id='tok-74-113'>different</span><span class='token pointer' id='tok-74-114'>user</span><span class='token pointer' id='tok-74-115'>roles?Is</span><span class='token pointer' id='tok-74-116'>there</span><span class='token pointer' id='tok-74-117'>is</span><span class='token pointer' id='tok-74-118'>any</span><span class='token pointer' id='tok-74-119'>configuration/password</span><span class='token pointer' id='tok-74-120'>files</span><span class='token pointer' id='tok-74-121'>stored</span><span class='token pointer' id='tok-74-122'>on</span><span class='token pointer' id='tok-74-123'>the</span><span class='token pointer' id='tok-74-124'>system?Is</span><span class='token pointer' id='tok-74-125'>there</span><span class='token pointer' id='tok-74-126'>any</span><span class='token pointer' id='tok-74-127'>misconfigured</span><span class='token pointer' id='tok-74-128'>CRON</span><span class='token pointer' id='tok-74-129'>jobs/Scheduled</span><span class='token pointer' id='tok-74-130'>Tasks</span><span class='token pointer' id='tok-74-131'>running</span><span class='token pointer' id='tok-74-132'>on</span><span class='token pointer' id='tok-74-133'>the</span><span class='token pointer' id='tok-74-134'>system?By</span><span class='token pointer' id='tok-74-135'>answering</span><span class='token pointer' id='tok-74-136'>above</span><span class='token pointer' id='tok-74-137'>and</span><span class='token pointer' id='tok-74-138'>many</span><span class='token pointer' id='tok-74-139'>other</span><span class='token pointer' id='tok-74-140'>questions</span><span class='token pointer' id='tok-74-141'>depending</span><span class='token pointer' id='tok-74-142'>on</span><span class='token pointer' id='tok-74-143'>the</span><span class='token pointer' id='tok-74-144'>situations</span><span class='token pointer' id='tok-74-145'>and</span><span class='token pointer' id='tok-74-146'>availability</span><span class='token pointer' id='tok-74-147'>one</span><span class='token pointer' id='tok-74-148'>can</span><span class='token pointer' id='tok-74-149'>certainly</span><span class='token pointer' id='tok-74-150'>escalate</span><span class='token pointer' id='tok-74-151'>his/her</span><span class='token pointer' id='tok-74-152'>privileges</span><span class='token pointer' id='tok-74-153'>from</span><span class='token pointer' id='tok-74-154'>a</span><span class='token pointer' id='tok-74-155'>normal</span><span class='token pointer' id='tok-74-156'>user</span><span class='token pointer' id='tok-74-157'>to</span><span class='token pointer' id='tok-74-158'>high</span><span class='token pointer' id='tok-74-159'>privileged</span><span class='token pointer' id='tok-74-160'>user.</span><span class='token pointer' id='tok-74-161'>As</span><span class='token pointer' id='tok-74-162'>we</span><span class='token pointer' id='tok-74-163'>can</span><span class='token pointer' id='tok-74-164'>see,</span><span class='token pointer' id='tok-74-165'>there</span><span class='token pointer' id='tok-74-166'>is</span><span class='token pointer' id='tok-74-167'>a</span><span class='token pointer' id='tok-74-168'>lot</span><span class='token pointer' id='tok-74-169'>of</span><span class='token pointer' id='tok-74-170'>information</span><span class='token pointer' id='tok-74-171'>one</span><span class='token pointer' id='tok-74-172'>needs</span><span class='token pointer' id='tok-74-173'>to</span><span class='token pointer' id='tok-74-174'>gather</span><span class='token pointer' id='tok-74-175'>which</span><span class='token pointer' id='tok-74-176'>directly</span><span class='token pointer' id='tok-74-177'>means</span><span class='token pointer' id='tok-74-178'>there</span><span class='token pointer' id='tok-74-179'>are</span><span class='token pointer' id='tok-74-180'>a</span><span class='token pointer' id='tok-74-181'>lot</span><span class='token pointer' id='tok-74-182'>of</span><span class='token pointer' id='tok-74-183'>manual</span><span class='token pointer' id='tok-74-184'>checks</span><span class='token pointer' id='tok-74-185'>we</span><span class='token pointer' id='tok-74-186'>need</span><span class='token pointer' id='tok-74-187'>to</span><span class='token pointer' id='tok-74-188'>perform</span><span class='token pointer' id='tok-74-189'>to</span><span class='token pointer' id='tok-74-190'>escalate</span><span class='token pointer' id='tok-74-191'>our</span><span class='token pointer' id='tok-74-192'>privileges</span><span class='token pointer' id='tok-74-193'>successfully.</span><span class='token pointer' id='tok-74-194'>So,</span><span class='token pointer' id='tok-74-195'>automating</span><span class='token pointer' id='tok-74-196'>certain</span><span class='token pointer' id='tok-74-197'>tasks</span><span class='token pointer' id='tok-74-198'>will</span><span class='token pointer' id='tok-74-199'>save</span><span class='token pointer' id='tok-74-200'>some</span><span class='token pointer' id='tok-74-201'>time</span><span class='token pointer' id='tok-74-202'>and</span><span class='token pointer' id='tok-74-203'>give</span><span class='token pointer' id='tok-74-204'>an</span><span class='token pointer' id='tok-74-205'>added</span><span class='token pointer' id='tok-74-206'>advantage</span><span class='token pointer' id='tok-74-207'>to</span><span class='token pointer' id='tok-74-208'>any</span><span class='token pointer' id='tok-74-209'>penetration</span><span class='token pointer' id='tok-74-210'>tester.</span></p>
<p id=p211><span class='token pointer' id='tok-74-211'>The</span><span class='token pointer' id='tok-74-212'>test</span><span class='token pointer' id='tok-74-213'>bed/software</span><span class='token pointer' id='tok-74-214'>use</span><span class='token pointer' id='tok-74-215'>to</span><span class='token pointer' id='tok-74-216'>test</span><span class='token pointer' id='tok-74-217'>our</span><span class='token pointer' id='tok-74-218'>tool</span><span class='token pointer' id='tok-74-219'>can</span><span class='token pointer' id='tok-74-220'>be</span><span class='token pointer' id='tok-74-221'>downloaded</span><span class='token pointer' id='tok-74-222'>from</span><span class='token pointer' id='tok-74-223'>here.</span><span class='token pointer' id='tok-74-224'>Also,</span><span class='token pointer' id='tok-74-225'>the</span><span class='token pointer' id='tok-74-226'>required</span><span class='token pointer' id='tok-74-227'>package</span><span class='token pointer' id='tok-74-228'>for</span><span class='token pointer' id='tok-74-229'>python</span><span class='token pointer' id='tok-74-230'>can</span><span class='token pointer' id='tok-74-231'>be</span><span class='token pointer' id='tok-74-232'>installed</span><span class='token pointer' id='tok-74-233'>using</span><span class='token pointer' id='tok-74-234'>the</span><span class='token pointer' id='tok-74-235'>following</span><span class='token pointer' id='tok-74-236'>command:</span></p>
<p id=p237><span class='token pointer' id='tok-74-237'>pip</span><span class='token pointer' id='tok-74-238'>install</span><span class='token pointer' id='tok-74-239'>wmi</span></p>
<p id=p240><span class='token pointer' id='tok-74-240'>We</span><span class='token pointer' id='tok-74-241'>will</span><span class='token pointer' id='tok-74-242'>be</span><span class='token pointer' id='tok-74-243'>automating</span><span class='token pointer' id='tok-74-244'>following</span><span class='token pointer' id='tok-74-245'>tasks</span><span class='token pointer' id='tok-74-246'>using</span><span class='token pointer' id='tok-74-247'>Python</span><span class='token pointer' id='tok-74-248'>programming</span><span class='token pointer' id='tok-74-249'>language.</span></p>
<p id=p250><span class='token pointer' id='tok-74-250'>Unquoted</span><span class='token pointer' id='tok-74-251'>Service</span><span class='token pointer' id='tok-74-252'>Paths.Misconfigured</span><span class='token pointer' id='tok-74-253'>Permission</span><span class='token pointer' id='tok-74-254'>for</span><span class='token pointer' id='tok-74-255'>Service</span><span class='token pointer' id='tok-74-256'>Executables.Misconfigured</span><span class='token pointer' id='tok-74-257'>MSI</span><span class='token pointer' id='tok-74-258'>registry</span><span class='token pointer' id='tok-74-259'>entries.Unquoted</span><span class='token pointer' id='tok-74-260'>Service</span><span class='token pointer' id='tok-74-261'>Paths:Before</span><span class='token pointer' id='tok-74-262'>proceeding</span><span class='token pointer' id='tok-74-263'>with</span><span class='token pointer' id='tok-74-264'>understanding</span><span class='token pointer' id='tok-74-265'>the</span><span class='token pointer' id='tok-74-266'>code</span><span class='token pointer' id='tok-74-267'>use</span><span class='token pointer' id='tok-74-268'>to</span><span class='token pointer' id='tok-74-269'>automate</span><span class='token pointer' id='tok-74-270'>this</span><span class='token pointer' id='tok-74-271'>task,</span><span class='token pointer' id='tok-74-272'>we</span><span class='token pointer' id='tok-74-273'>need</span><span class='token pointer' id='tok-74-274'>to</span><span class='token pointer' id='tok-74-275'>understand</span><span class='token pointer' id='tok-74-276'>how</span><span class='token pointer' id='tok-74-277'>we</span><span class='token pointer' id='tok-74-278'>can</span><span class='token pointer' id='tok-74-279'>exploit</span><span class='token pointer' id='tok-74-280'>unquoted</span><span class='token pointer' id='tok-74-281'>service</span><span class='token pointer' id='tok-74-282'>path</span><span class='token pointer' id='tok-74-283'>vulnerabilities.</span><span class='token pointer' id='tok-74-284'>This</span><span class='token pointer' id='tok-74-285'>mainly</span><span class='token pointer' id='tok-74-286'>involves</span><span class='token pointer' id='tok-74-287'>how</span><span class='token pointer' id='tok-74-288'>Windows</span><span class='token pointer' id='tok-74-289'>interpret</span><span class='token pointer' id='tok-74-290'>the</span><span class='token pointer' id='tok-74-291'>executable</span><span class='token pointer' id='tok-74-292'>path</span><span class='token pointer' id='tok-74-293'>of</span><span class='token pointer' id='tok-74-294'>service</span><span class='token pointer' id='tok-74-295'>before</span><span class='token pointer' id='tok-74-296'>starting</span><span class='token pointer' id='tok-74-297'>it.</span><span class='token pointer' id='tok-74-298'>For</span><span class='token pointer' id='tok-74-299'>example:</span></p>
<p id=p300><span class='token pointer' id='tok-74-300'>Let</span><span class='token pointer' id='tok-74-301'>us</span><span class='token pointer' id='tok-74-302'>execute</span><span class='token pointer' id='tok-74-303'>a</span><span class='token pointer' id='tok-74-304'>test</span><span class='token pointer' id='tok-74-305'>program/script</span><span class='token pointer' id='tok-74-306'>using</span><span class='token pointer' id='tok-74-307'>command</span><span class='token pointer' id='tok-74-308'>prompt</span><span class='token pointer' id='tok-74-309'>by</span><span class='token pointer' id='tok-74-310'>providing</span><span class='token pointer' id='tok-74-311'>a</span><span class='token pointer' id='tok-74-312'>path</span><span class='token pointer' id='tok-74-313'>to</span><span class='token pointer' id='tok-74-314'>the</span><span class='token pointer' id='tok-74-315'>executable.</span></p>
<p id=p316><span class='token pointer' id='tok-74-316'>As</span><span class='token pointer' id='tok-74-317'>we</span><span class='token pointer' id='tok-74-318'>can</span><span class='token pointer' id='tok-74-319'>see</span><span class='token pointer' id='tok-74-320'>that</span><span class='token pointer' id='tok-74-321'>our</span><span class='token pointer' id='tok-74-322'>helloworld</span><span class='token pointer' id='tok-74-323'>program</span><span class='token pointer' id='tok-74-324'>executes</span><span class='token pointer' id='tok-74-325'>successfully</span><span class='token pointer' id='tok-74-326'>when</span><span class='token pointer' id='tok-74-327'>placed</span><span class='token pointer' id='tok-74-328'>in</span><span class='token pointer' id='tok-74-329'>a</span><span class='token pointer' id='tok-74-330'>folder</span><span class='token pointer' id='tok-74-331'>without</span><span class='token pointer' id='tok-74-332'>space.</span><span class='token pointer' id='tok-74-333'>So,</span><span class='token pointer' id='tok-74-334'>what</span><span class='token pointer' id='tok-74-335'>happen</span><span class='token pointer' id='tok-74-336'>with</span><span class='token pointer' id='tok-74-337'>a</span><span class='token pointer' id='tok-74-338'>folder</span><span class='token pointer' id='tok-74-339'>with</span><span class='token pointer' id='tok-74-340'>space?</span></p>
<p id=p341><span class='token pointer' id='tok-74-341'>As</span><span class='token pointer' id='tok-74-342'>can</span><span class='token pointer' id='tok-74-343'>be</span><span class='token pointer' id='tok-74-344'>seen,</span><span class='token pointer' id='tok-74-345'>there</span><span class='token pointer' id='tok-74-346'>is</span><span class='token pointer' id='tok-74-347'>a</span><span class='token pointer' id='tok-74-348'>helloworld.exe</span><span class='token pointer' id='tok-74-349'>file</span><span class='token pointer' id='tok-74-350'>in</span><span class='token pointer' id='tok-74-351'>the</span><span class='token pointer' id='tok-74-352'>folder</span><span class='token pointer' id='tok-74-353'>with</span><span class='token pointer' id='tok-74-354'>space.</span><span class='token pointer' id='tok-74-355'>So,</span><span class='token pointer' id='tok-74-356'>to</span><span class='token pointer' id='tok-74-357'>execute</span><span class='token pointer' id='tok-74-358'>that</span><span class='token pointer' id='tok-74-359'>we</span><span class='token pointer' id='tok-74-360'>simply</span><span class='token pointer' id='tok-74-361'>change</span><span class='token pointer' id='tok-74-362'>our</span><span class='token pointer' id='tok-74-363'>directory</span><span class='token pointer' id='tok-74-364'>by</span><span class='token pointer' id='tok-74-365'>providing</span><span class='token pointer' id='tok-74-366'>quotes</span><span class='token pointer' id='tok-74-367'>around</span><span class='token pointer' id='tok-74-368'>folder</span><span class='token pointer' id='tok-74-369'>name.</span><span class='token pointer' id='tok-74-370'>Now</span><span class='token pointer' id='tok-74-371'>the</span><span class='token pointer' id='tok-74-372'>question</span><span class='token pointer' id='tok-74-373'>arises</span><span class='token pointer' id='tok-74-374'>how</span><span class='token pointer' id='tok-74-375'>we</span><span class='token pointer' id='tok-74-376'>can</span><span class='token pointer' id='tok-74-377'>exploit</span><span class='token pointer' id='tok-74-378'>this</span><span class='token pointer' id='tok-74-379'>behavior</span><span class='token pointer' id='tok-74-380'>of</span><span class='token pointer' id='tok-74-381'>Windows.</span></p>
<p id=p382><span class='token pointer' id='tok-74-382'>As</span><span class='token pointer' id='tok-74-383'>can</span><span class='token pointer' id='tok-74-384'>be</span><span class='token pointer' id='tok-74-385'>seen,</span><span class='token pointer' id='tok-74-386'>in</span><span class='token pointer' id='tok-74-387'>first</span><span class='token pointer' id='tok-74-388'>image</span><span class='token pointer' id='tok-74-389'>window</span><span class='token pointer' id='tok-74-390'>treats</span><span class='token pointer' id='tok-74-391'>the</span><span class='token pointer' id='tok-74-392'>folder</span><span class='token pointer' id='tok-74-393'>name</span><span class='token pointer' id='tok-74-394'>with</span><span class='token pointer' id='tok-74-395'>space</span><span class='token pointer' id='tok-74-396'>as</span><span class='token pointer' id='tok-74-397'>an</span><span class='token pointer' id='tok-74-398'>executable</span><span class='token pointer' id='tok-74-399'>and</span><span class='token pointer' id='tok-74-400'>throws</span><span class='token pointer' id='tok-74-401'>us</span><span class='token pointer' id='tok-74-402'>an</span><span class='token pointer' id='tok-74-403'>error</span><span class='token pointer' id='tok-74-404'>saying</span><span class='token pointer' id='tok-74-405'>"folder</span><span class='token pointer' id='tok-74-406'>is</span><span class='token pointer' id='tok-74-407'>not</span><span class='token pointer' id='tok-74-408'>recognized</span><span class='token pointer' id='tok-74-409'>as</span><span class='token pointer' id='tok-74-410'>internal</span><span class='token pointer' id='tok-74-411'>or</span><span class='token pointer' id='tok-74-412'>external</span><span class='token pointer' id='tok-74-413'>command/executable/batch</span><span class='token pointer' id='tok-74-414'>file."</span><span class='token pointer' id='tok-74-415'>So,</span><span class='token pointer' id='tok-74-416'>this</span><span class='token pointer' id='tok-74-417'>means</span><span class='token pointer' id='tok-74-418'>if</span><span class='token pointer' id='tok-74-419'>we</span><span class='token pointer' id='tok-74-420'>put</span><span class='token pointer' id='tok-74-421'>an</span><span class='token pointer' id='tok-74-422'>executable</span><span class='token pointer' id='tok-74-423'>with</span><span class='token pointer' id='tok-74-424'>the</span><span class='token pointer' id='tok-74-425'>name</span><span class='token pointer' id='tok-74-426'>as</span><span class='token pointer' id='tok-74-427'>folder.exe</span><span class='token pointer' id='tok-74-428'>it</span><span class='token pointer' id='tok-74-429'>should</span><span class='token pointer' id='tok-74-430'>get</span><span class='token pointer' id='tok-74-431'>execute</span><span class='token pointer' id='tok-74-432'>when</span><span class='token pointer' id='tok-74-433'>the</span><span class='token pointer' id='tok-74-434'>user</span><span class='token pointer' id='tok-74-435'>calls</span><span class='token pointer' id='tok-74-436'>the</span><span class='token pointer' id='tok-74-437'>program</span><span class='token pointer' id='tok-74-438'>path</span><span class='token pointer' id='tok-74-439'>without</span><span class='token pointer' id='tok-74-440'>spaces.</span></p>
<p id=p441><span class='token pointer' id='tok-74-441'>We</span><span class='token pointer' id='tok-74-442'>first</span><span class='token pointer' id='tok-74-443'>tried</span><span class='token pointer' id='tok-74-444'>to</span><span class='token pointer' id='tok-74-445'>execute</span><span class='token pointer' id='tok-74-446'>our</span><span class='token pointer' id='tok-74-447'>program</span><span class='token pointer' id='tok-74-448'>without</span><span class='token pointer' id='tok-74-449'>space.</span><span class='token pointer' id='tok-74-450'>Further,</span><span class='token pointer' id='tok-74-451'>we</span><span class='token pointer' id='tok-74-452'>copied</span><span class='token pointer' id='tok-74-453'>the</span><span class='token pointer' id='tok-74-454'>same</span><span class='token pointer' id='tok-74-455'>program</span><span class='token pointer' id='tok-74-456'>to</span><span class='token pointer' id='tok-74-457'>desktop</span><span class='token pointer' id='tok-74-458'>folder</span><span class='token pointer' id='tok-74-459'>with</span><span class='token pointer' id='tok-74-460'>name</span><span class='token pointer' id='tok-74-461'>folder.exe</span><span class='token pointer' id='tok-74-462'>and</span><span class='token pointer' id='tok-74-463'>deleted</span><span class='token pointer' id='tok-74-464'>our</span><span class='token pointer' id='tok-74-465'>program</span><span class='token pointer' id='tok-74-466'>from</span><span class='token pointer' id='tok-74-467'>the</span><span class='token pointer' id='tok-74-468'>older</span><span class='token pointer' id='tok-74-469'>path</span><span class='token pointer' id='tok-74-470'>to</span><span class='token pointer' id='tok-74-471'>be</span><span class='token pointer' id='tok-74-472'>sure</span><span class='token pointer' id='tok-74-473'>only</span><span class='token pointer' id='tok-74-474'>planted</span><span class='token pointer' id='tok-74-475'>binary</span><span class='token pointer' id='tok-74-476'>gets</span><span class='token pointer' id='tok-74-477'>executed.</span></p>
<p id=p478><span class='token pointer' id='tok-74-478'>Windows</span><span class='token pointer' id='tok-74-479'>now</span><span class='token pointer' id='tok-74-480'>execute</span><span class='token pointer' id='tok-74-481'>our</span><span class='token pointer' id='tok-74-482'>binary</span><span class='token pointer' id='tok-74-483'>planted</span><span class='token pointer' id='tok-74-484'>with</span><span class='token pointer' id='tok-74-485'>the</span><span class='token pointer' id='tok-74-486'>name</span><span class='token pointer' id='tok-74-487'>of</span><span class='token pointer' id='tok-74-488'>folder.exe.</span></p>
<p id=p489><span class='token pointer' id='tok-74-489'>So,</span><span class='token pointer' id='tok-74-490'>we</span><span class='token pointer' id='tok-74-491'>will</span><span class='token pointer' id='tok-74-492'>be</span><span class='token pointer' id='tok-74-493'>automating</span><span class='token pointer' id='tok-74-494'>this</span><span class='token pointer' id='tok-74-495'>process</span><span class='token pointer' id='tok-74-496'>by</span><span class='token pointer' id='tok-74-497'>telling</span><span class='token pointer' id='tok-74-498'>our</span><span class='token pointer' id='tok-74-499'>program</span><span class='token pointer' id='tok-74-500'>to</span><span class='token pointer' id='tok-74-501'>iterate</span><span class='token pointer' id='tok-74-502'>over</span><span class='token pointer' id='tok-74-503'>the</span><span class='token pointer' id='tok-74-504'>service</span><span class='token pointer' id='tok-74-505'>paths</span><span class='token pointer' id='tok-74-506'>and</span><span class='token pointer' id='tok-74-507'>show</span><span class='token pointer' id='tok-74-508'>us</span><span class='token pointer' id='tok-74-509'>which</span><span class='token pointer' id='tok-74-510'>service</span><span class='token pointer' id='tok-74-511'>paths</span><span class='token pointer' id='tok-74-512'>are</span><span class='token pointer' id='tok-74-513'>unquoted.</span></p>
<p id=p514><span class='token pointer' id='tok-74-514'>In</span><span class='token pointer' id='tok-74-515'>our</span><span class='token pointer' id='tok-74-516'>code,</span><span class='token pointer' id='tok-74-517'>we</span><span class='token pointer' id='tok-74-518'>first</span><span class='token pointer' id='tok-74-519'>defined</span><span class='token pointer' id='tok-74-520'>a</span><span class='token pointer' id='tok-74-521'>WMI</span><span class='token pointer' id='tok-74-522'>object,</span><span class='token pointer' id='tok-74-523'>select</span><span class='token pointer' id='tok-74-524'>everything</span><span class='token pointer' id='tok-74-525'>from</span><span class='token pointer' id='tok-74-526'>Win32_Service</span><span class='token pointer' id='tok-74-527'>class</span><span class='token pointer' id='tok-74-528'>and</span><span class='token pointer' id='tok-74-529'>iterate</span><span class='token pointer' id='tok-74-530'>over</span><span class='token pointer' id='tok-74-531'>it</span><span class='token pointer' id='tok-74-532'>to</span><span class='token pointer' id='tok-74-533'>get</span><span class='token pointer' id='tok-74-534'>all</span><span class='token pointer' id='tok-74-535'>service</span><span class='token pointer' id='tok-74-536'>paths.</span><span class='token pointer' id='tok-74-537'>We</span><span class='token pointer' id='tok-74-538'>further</span><span class='token pointer' id='tok-74-539'>check</span><span class='token pointer' id='tok-74-540'>if</span><span class='token pointer' id='tok-74-541'>the</span><span class='token pointer' id='tok-74-542'>path</span><span class='token pointer' id='tok-74-543'>does</span><span class='token pointer' id='tok-74-544'>not</span><span class='token pointer' id='tok-74-545'>contain</span><span class='token pointer' id='tok-74-546'>any</span><span class='token pointer' id='tok-74-547'>quotes</span><span class='token pointer' id='tok-74-548'>if</span><span class='token pointer' id='tok-74-549'>our</span><span class='token pointer' id='tok-74-550'>condition</span><span class='token pointer' id='tok-74-551'>satisfies</span><span class='token pointer' id='tok-74-552'>we</span><span class='token pointer' id='tok-74-553'>add</span><span class='token pointer' id='tok-74-554'>that</span><span class='token pointer' id='tok-74-555'>path</span><span class='token pointer' id='tok-74-556'>to</span><span class='token pointer' id='tok-74-557'>our</span><span class='token pointer' id='tok-74-558'>dictionary</span><span class='token pointer' id='tok-74-559'>by</span><span class='token pointer' id='tok-74-560'>keeping</span><span class='token pointer' id='tok-74-561'>service</span><span class='token pointer' id='tok-74-562'>name</span><span class='token pointer' id='tok-74-563'>as</span><span class='token pointer' id='tok-74-564'>a</span><span class='token pointer' id='tok-74-565'>key</span><span class='token pointer' id='tok-74-566'>name.</span></p>
<p id=p567><span class='token pointer' id='tok-74-567'>We</span><span class='token pointer' id='tok-74-568'>further</span><span class='token pointer' id='tok-74-569'>check</span><span class='token pointer' id='tok-74-570'>if</span><span class='token pointer' id='tok-74-571'>there</span><span class='token pointer' id='tok-74-572'>are</span><span class='token pointer' id='tok-74-573'>any</span><span class='token pointer' id='tok-74-574'>service</span><span class='token pointer' id='tok-74-575'>paths</span><span class='token pointer' id='tok-74-576'>identified</span><span class='token pointer' id='tok-74-577'>and</span><span class='token pointer' id='tok-74-578'>iterate</span><span class='token pointer' id='tok-74-579'>over</span><span class='token pointer' id='tok-74-580'>our</span><span class='token pointer' id='tok-74-581'>dictionary</span><span class='token pointer' id='tok-74-582'>to</span><span class='token pointer' id='tok-74-583'>display</span><span class='token pointer' id='tok-74-584'>the</span><span class='token pointer' id='tok-74-585'>values.</span></p>
<p id=p586><span class='token pointer' id='tok-74-586'>We</span><span class='token pointer' id='tok-74-587'>will</span><span class='token pointer' id='tok-74-588'>be</span><span class='token pointer' id='tok-74-589'>adding</span><span class='token pointer' id='tok-74-590'>the</span><span class='token pointer' id='tok-74-591'>above</span><span class='token pointer' id='tok-74-592'>code</span><span class='token pointer' id='tok-74-593'>snippets</span><span class='token pointer' id='tok-74-594'>to</span><span class='token pointer' id='tok-74-595'>our</span><span class='token pointer' id='tok-74-596'>final</span><span class='token pointer' id='tok-74-597'>program.</span></p>
<p id=p598><span class='token pointer' id='tok-74-598'>Misconfigured</span><span class='token pointer' id='tok-74-599'>Permission</span><span class='token pointer' id='tok-74-600'>for</span><span class='token pointer' id='tok-74-601'>Service</span><span class='token pointer' id='tok-74-602'>ExecutablesThe</span><span class='token pointer' id='tok-74-603'>second</span><span class='token pointer' id='tok-74-604'>part</span><span class='token pointer' id='tok-74-605'>of</span><span class='token pointer' id='tok-74-606'>the</span><span class='token pointer' id='tok-74-607'>program</span><span class='token pointer' id='tok-74-608'>includes</span><span class='token pointer' id='tok-74-609'>checking</span><span class='token pointer' id='tok-74-610'>the</span><span class='token pointer' id='tok-74-611'>permission</span><span class='token pointer' id='tok-74-612'>of</span><span class='token pointer' id='tok-74-613'>service</span><span class='token pointer' id='tok-74-614'>executables.</span><span class='token pointer' id='tok-74-615'>Which</span><span class='token pointer' id='tok-74-616'>means</span><span class='token pointer' id='tok-74-617'>if</span><span class='token pointer' id='tok-74-618'>any</span><span class='token pointer' id='tok-74-619'>low</span><span class='token pointer' id='tok-74-620'>privileged</span><span class='token pointer' id='tok-74-621'>user</span><span class='token pointer' id='tok-74-622'>can</span><span class='token pointer' id='tok-74-623'>modify/write/replace</span><span class='token pointer' id='tok-74-624'>the</span><span class='token pointer' id='tok-74-625'>executable</span><span class='token pointer' id='tok-74-626'>with</span><span class='token pointer' id='tok-74-627'>his</span><span class='token pointer' id='tok-74-628'>code/executable.</span><span class='token pointer' id='tok-74-629'>Next</span><span class='token pointer' id='tok-74-630'>time</span><span class='token pointer' id='tok-74-631'>when</span><span class='token pointer' id='tok-74-632'>the</span><span class='token pointer' id='tok-74-633'>service</span><span class='token pointer' id='tok-74-634'>starts</span><span class='token pointer' id='tok-74-635'>malicious</span><span class='token pointer' id='tok-74-636'>code</span><span class='token pointer' id='tok-74-637'>will</span><span class='token pointer' id='tok-74-638'>get</span><span class='token pointer' id='tok-74-639'>executed</span><span class='token pointer' id='tok-74-640'>as</span><span class='token pointer' id='tok-74-641'>a</span><span class='token pointer' id='tok-74-642'>system.</span></p>
<p id=p643><span class='token pointer' id='tok-74-643'>In</span><span class='token pointer' id='tok-74-644'>this</span><span class='token pointer' id='tok-74-645'>case,</span><span class='token pointer' id='tok-74-646'>we</span><span class='token pointer' id='tok-74-647'>will</span><span class='token pointer' id='tok-74-648'>be</span><span class='token pointer' id='tok-74-649'>using</span><span class='token pointer' id='tok-74-650'>"icacls"</span><span class='token pointer' id='tok-74-651'>utility</span><span class='token pointer' id='tok-74-652'>of</span><span class='token pointer' id='tok-74-653'>windows</span><span class='token pointer' id='tok-74-654'>to</span><span class='token pointer' id='tok-74-655'>find</span><span class='token pointer' id='tok-74-656'>out</span><span class='token pointer' id='tok-74-657'>permission</span><span class='token pointer' id='tok-74-658'>of</span><span class='token pointer' id='tok-74-659'>all</span><span class='token pointer' id='tok-74-660'>service</span><span class='token pointer' id='tok-74-661'>executables.</span><span class='token pointer' id='tok-74-662'>Moreover,</span><span class='token pointer' id='tok-74-663'>list</span><span class='token pointer' id='tok-74-664'>down</span><span class='token pointer' id='tok-74-665'>the</span><span class='token pointer' id='tok-74-666'>ones</span><span class='token pointer' id='tok-74-667'>in</span><span class='token pointer' id='tok-74-668'>which</span><span class='token pointer' id='tok-74-669'>any</span><span class='token pointer' id='tok-74-670'>user</span><span class='token pointer' id='tok-74-671'>has</span><span class='token pointer' id='tok-74-672'>full</span><span class='token pointer' id='tok-74-673'>access</span><span class='token pointer' id='tok-74-674'>to</span><span class='token pointer' id='tok-74-675'>the</span><span class='token pointer' id='tok-74-676'>executable.</span></p>
<p id=p677><span class='token pointer' id='tok-74-677'>As</span><span class='token pointer' id='tok-74-678'>can</span><span class='token pointer' id='tok-74-679'>be</span><span class='token pointer' id='tok-74-680'>seen,</span><span class='token pointer' id='tok-74-681'>we</span><span class='token pointer' id='tok-74-682'>have</span><span class='token pointer' id='tok-74-683'>used</span><span class='token pointer' id='tok-74-684'>the</span><span class='token pointer' id='tok-74-685'>output</span><span class='token pointer' id='tok-74-686'>of</span><span class='token pointer' id='tok-74-687'>wmi</span><span class='token pointer' id='tok-74-688'>query</span><span class='token pointer' id='tok-74-689'>from</span><span class='token pointer' id='tok-74-690'>our</span><span class='token pointer' id='tok-74-691'>previous</span><span class='token pointer' id='tok-74-692'>section</span><span class='token pointer' id='tok-74-693'>of</span><span class='token pointer' id='tok-74-694'>code</span><span class='token pointer' id='tok-74-695'>and</span><span class='token pointer' id='tok-74-696'>added</span><span class='token pointer' id='tok-74-697'>found</span><span class='token pointer' id='tok-74-698'>executable</span><span class='token pointer' id='tok-74-699'>files</span><span class='token pointer' id='tok-74-700'>in</span><span class='token pointer' id='tok-74-701'>a</span><span class='token pointer' id='tok-74-702'>Python</span><span class='token pointer' id='tok-74-703'>list.</span></p>
<p id=p704><span class='token pointer' id='tok-74-704'>We</span><span class='token pointer' id='tok-74-705'>will</span><span class='token pointer' id='tok-74-706'>now</span><span class='token pointer' id='tok-74-707'>feed</span><span class='token pointer' id='tok-74-708'>the</span><span class='token pointer' id='tok-74-709'>executable</span><span class='token pointer' id='tok-74-710'>path</span><span class='token pointer' id='tok-74-711'>to</span><span class='token pointer' id='tok-74-712'>icacls</span><span class='token pointer' id='tok-74-713'>utility</span><span class='token pointer' id='tok-74-714'>to</span><span class='token pointer' id='tok-74-715'>get</span><span class='token pointer' id='tok-74-716'>the</span><span class='token pointer' id='tok-74-717'>permission</span><span class='token pointer' id='tok-74-718'>info</span><span class='token pointer' id='tok-74-719'>of</span><span class='token pointer' id='tok-74-720'>executable</span><span class='token pointer' id='tok-74-721'>and</span><span class='token pointer' id='tok-74-722'>parse</span><span class='token pointer' id='tok-74-723'>the</span><span class='token pointer' id='tok-74-724'>output</span><span class='token pointer' id='tok-74-725'>using</span><span class='token pointer' id='tok-74-726'>the</span><span class='token pointer' id='tok-74-727'>find_paths</span><span class='token pointer' id='tok-74-728'>function.</span></p>
<p id=p729><span class='token pointer' id='tok-74-729'>Ethical</span><span class='token pointer' id='tok-74-730'>Hacking</span><span class='token pointer' id='tok-74-731'>Training</span><span class='token pointer' id='tok-74-732'>–</span><span class='token pointer' id='tok-74-733'>Resources</span><span class='token pointer' id='tok-74-734'>(InfoSec)</span></p>
<p id=p735><span class='token pointer' id='tok-74-735'>The</span><span class='token pointer' id='tok-74-736'>find_paths</span><span class='token pointer' id='tok-74-737'>function</span><span class='token pointer' id='tok-74-738'>match</span><span class='token pointer' id='tok-74-739'>the</span><span class='token pointer' id='tok-74-740'>permission</span><span class='token pointer' id='tok-74-741'>info</span><span class='token pointer' id='tok-74-742'>of</span><span class='token pointer' id='tok-74-743'>executable</span><span class='token pointer' id='tok-74-744'>with</span><span class='token pointer' id='tok-74-745'>predefined</span><span class='token pointer' id='tok-74-746'>values</span><span class='token pointer' id='tok-74-747'>and</span><span class='token pointer' id='tok-74-748'>prints</span><span class='token pointer' id='tok-74-749'>out</span><span class='token pointer' id='tok-74-750'>if</span><span class='token pointer' id='tok-74-751'>any</span><span class='token pointer' id='tok-74-752'>match</span><span class='token pointer' id='tok-74-753'>is</span><span class='token pointer' id='tok-74-754'>found.</span></p>
<p id=p755><span class='token pointer' id='tok-74-755'>Misconfigured</span><span class='token pointer' id='tok-74-756'>MSI</span><span class='token pointer' id='tok-74-757'>registry</span><span class='token pointer' id='tok-74-758'>entriesWindows</span><span class='token pointer' id='tok-74-759'>has</span><span class='token pointer' id='tok-74-760'>this</span><span class='token pointer' id='tok-74-761'>configuration</span><span class='token pointer' id='tok-74-762'>which</span><span class='token pointer' id='tok-74-763'>if</span><span class='token pointer' id='tok-74-764'>set</span><span class='token pointer' id='tok-74-765'>allows</span><span class='token pointer' id='tok-74-766'>any</span><span class='token pointer' id='tok-74-767'>user</span><span class='token pointer' id='tok-74-768'>to</span><span class='token pointer' id='tok-74-769'>run</span><span class='token pointer' id='tok-74-770'>MSI</span><span class='token pointer' id='tok-74-771'>(Microsoft</span><span class='token pointer' id='tok-74-772'>Installers)</span><span class='token pointer' id='tok-74-773'>with</span><span class='token pointer' id='tok-74-774'>SYSTEM</span><span class='token pointer' id='tok-74-775'>privileges.</span><span class='token pointer' id='tok-74-776'>This</span><span class='token pointer' id='tok-74-777'>involves</span><span class='token pointer' id='tok-74-778'>checking</span><span class='token pointer' id='tok-74-779'>the</span><span class='token pointer' id='tok-74-780'>true</span><span class='token pointer' id='tok-74-781'>value</span><span class='token pointer' id='tok-74-782'>for</span><span class='token pointer' id='tok-74-783'>a</span><span class='token pointer' id='tok-74-784'>32-bit</span><span class='token pointer' id='tok-74-785'>dword</span><span class='token pointer' id='tok-74-786'>named</span><span class='token pointer' id='tok-74-787'>"AlwaysInstallElevated"</span><span class='token pointer' id='tok-74-788'>in</span><span class='token pointer' id='tok-74-789'>following</span><span class='token pointer' id='tok-74-790'>two</span><span class='token pointer' id='tok-74-791'>registry</span><span class='token pointer' id='tok-74-792'>keys:</span></p>
<p id=p793><span class='token pointer' id='tok-74-793'>HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer</span></p>
<p id=p794><span class='token pointer' id='tok-74-794'>HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer</span></p>
<p id=p795><span class='token pointer' id='tok-74-795'>This</span><span class='token pointer' id='tok-74-796'>will</span><span class='token pointer' id='tok-74-797'>be</span><span class='token pointer' id='tok-74-798'>our</span><span class='token pointer' id='tok-74-799'>last</span><span class='token pointer' id='tok-74-800'>addition</span><span class='token pointer' id='tok-74-801'>to</span><span class='token pointer' id='tok-74-802'>the</span><span class='token pointer' id='tok-74-803'>program,</span><span class='token pointer' id='tok-74-804'>in</span><span class='token pointer' id='tok-74-805'>this</span><span class='token pointer' id='tok-74-806'>case,</span><span class='token pointer' id='tok-74-807'>we</span><span class='token pointer' id='tok-74-808'>will</span><span class='token pointer' id='tok-74-809'>be</span><span class='token pointer' id='tok-74-810'>using</span><span class='token pointer' id='tok-74-811'>inbuilt</span><span class='token pointer' id='tok-74-812'>python's</span><span class='token pointer' id='tok-74-813'>module</span><span class='token pointer' id='tok-74-814'>named</span><span class='token pointer' id='tok-74-815'>"_winreg"</span><span class='token pointer' id='tok-74-816'>to</span><span class='token pointer' id='tok-74-817'>fetch</span><span class='token pointer' id='tok-74-818'>out</span><span class='token pointer' id='tok-74-819'>the</span><span class='token pointer' id='tok-74-820'>registry</span><span class='token pointer' id='tok-74-821'>entries.</span></p>
<p id=p822><span class='token pointer' id='tok-74-822'>We</span><span class='token pointer' id='tok-74-823'>open</span><span class='token pointer' id='tok-74-824'>the</span><span class='token pointer' id='tok-74-825'>registry</span><span class='token pointer' id='tok-74-826'>keys</span><span class='token pointer' id='tok-74-827'>using</span><span class='token pointer' id='tok-74-828'>OpenKey</span><span class='token pointer' id='tok-74-829'>function</span><span class='token pointer' id='tok-74-830'>and</span><span class='token pointer' id='tok-74-831'>enum</span><span class='token pointer' id='tok-74-832'>the</span><span class='token pointer' id='tok-74-833'>first</span><span class='token pointer' id='tok-74-834'>dword</span><span class='token pointer' id='tok-74-835'>value.</span><span class='token pointer' id='tok-74-836'>We</span><span class='token pointer' id='tok-74-837'>further</span><span class='token pointer' id='tok-74-838'>verify</span><span class='token pointer' id='tok-74-839'>whether</span><span class='token pointer' id='tok-74-840'>both</span><span class='token pointer' id='tok-74-841'>registry</span><span class='token pointer' id='tok-74-842'>keys</span><span class='token pointer' id='tok-74-843'>are</span><span class='token pointer' id='tok-74-844'>set</span><span class='token pointer' id='tok-74-845'>to</span><span class='token pointer' id='tok-74-846'>true.</span></p>
<p id=p847><span class='token pointer' id='tok-74-847'>If</span><span class='token pointer' id='tok-74-848'>both</span><span class='token pointer' id='tok-74-849'>registry</span><span class='token pointer' id='tok-74-850'>keys</span><span class='token pointer' id='tok-74-851'>exist</span><span class='token pointer' id='tok-74-852'>and</span><span class='token pointer' id='tok-74-853'>dword</span><span class='token pointer' id='tok-74-854'>values</span><span class='token pointer' id='tok-74-855'>are</span><span class='token pointer' id='tok-74-856'>set,</span><span class='token pointer' id='tok-74-857'>we</span><span class='token pointer' id='tok-74-858'>display</span><span class='token pointer' id='tok-74-859'>the</span><span class='token pointer' id='tok-74-860'>following</span><span class='token pointer' id='tok-74-861'>message</span><span class='token pointer' id='tok-74-862'>to</span><span class='token pointer' id='tok-74-863'>the</span><span class='token pointer' id='tok-74-864'>user.</span></p>
<p id=p865><span class='token pointer' id='tok-74-865'>Let's</span><span class='token pointer' id='tok-74-866'>execute</span><span class='token pointer' id='tok-74-867'>our</span><span class='token pointer' id='tok-74-868'>complete</span><span class='token pointer' id='tok-74-869'>script</span><span class='token pointer' id='tok-74-870'>on</span><span class='token pointer' id='tok-74-871'>a</span><span class='token pointer' id='tok-74-872'>vulnerable</span><span class='token pointer' id='tok-74-873'>machine.</span><span class='token pointer' id='tok-74-874'>As</span><span class='token pointer' id='tok-74-875'>can</span><span class='token pointer' id='tok-74-876'>be</span><span class='token pointer' id='tok-74-877'>seen,</span><span class='token pointer' id='tok-74-878'>our</span><span class='token pointer' id='tok-74-879'>script</span><span class='token pointer' id='tok-74-880'>is</span><span class='token pointer' id='tok-74-881'>successfully</span><span class='token pointer' id='tok-74-882'>able</span><span class='token pointer' id='tok-74-883'>to</span><span class='token pointer' id='tok-74-884'>determine</span><span class='token pointer' id='tok-74-885'>the</span><span class='token pointer' id='tok-74-886'>mentioned</span><span class='token pointer' id='tok-74-887'>issues.</span><span class='token pointer' id='tok-74-888'>As</span><span class='token pointer' id='tok-74-889'>our</span><span class='token pointer' id='tok-74-890'>machine</span><span class='token pointer' id='tok-74-891'>is</span><span class='token pointer' id='tok-74-892'>not</span><span class='token pointer' id='tok-74-893'>vulnerable</span><span class='token pointer' id='tok-74-894'>to</span><span class='token pointer' id='tok-74-895'>the</span><span class='token pointer' id='tok-74-896'>third</span><span class='token pointer' id='tok-74-897'>issue,</span><span class='token pointer' id='tok-74-898'>I</span><span class='token pointer' id='tok-74-899'>encourage</span><span class='token pointer' id='tok-74-900'>a</span><span class='token pointer' id='tok-74-901'>diligent</span><span class='token pointer' id='tok-74-902'>reader</span><span class='token pointer' id='tok-74-903'>to</span><span class='token pointer' id='tok-74-904'>manually</span><span class='token pointer' id='tok-74-905'>create</span><span class='token pointer' id='tok-74-906'>those</span><span class='token pointer' id='tok-74-907'>registry</span><span class='token pointer' id='tok-74-908'>entries</span><span class='token pointer' id='tok-74-909'>and</span><span class='token pointer' id='tok-74-910'>execute</span><span class='token pointer' id='tok-74-911'>their</span><span class='token pointer' id='tok-74-912'>own</span><span class='token pointer' id='tok-74-913'>MSI</span><span class='token pointer' id='tok-74-914'>executable</span><span class='token pointer' id='tok-74-915'>using</span><span class='token pointer' id='tok-74-916'>msiexec</span><span class='token pointer' id='tok-74-917'>utility.</span></p>
<p id=p918><span class='token pointer' id='tok-74-918'>Hint:</span><span class='token pointer' id='tok-74-919'>We</span><span class='token pointer' id='tok-74-920'>can</span><span class='token pointer' id='tok-74-921'>generate</span><span class='token pointer' id='tok-74-922'>msi</span><span class='token pointer' id='tok-74-923'>files</span><span class='token pointer' id='tok-74-924'>using</span><span class='token pointer' id='tok-74-925'>msfvenom.
