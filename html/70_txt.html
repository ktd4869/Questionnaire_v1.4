<p id=p0><span class='token pointer' id='tok-70-0'>Often</span><span class='token pointer' id='tok-70-1'>during</span><span class='token pointer' id='tok-70-2'>our</span><span class='token pointer' id='tok-70-3'>penetration</span><span class='token pointer' id='tok-70-4'>testing</span><span class='token pointer' id='tok-70-5'>engagements,</span><span class='token pointer' id='tok-70-6'>we</span><span class='token pointer' id='tok-70-7'>may</span><span class='token pointer' id='tok-70-8'>have</span><span class='token pointer' id='tok-70-9'>to</span><span class='token pointer' id='tok-70-10'>bypass</span><span class='token pointer' id='tok-70-11'>antivirus</span><span class='token pointer' id='tok-70-12'>applications</span><span class='token pointer' id='tok-70-13'>â€“</span><span class='token pointer' id='tok-70-14'>especially</span><span class='token pointer' id='tok-70-15'>during</span><span class='token pointer' id='tok-70-16'>the</span><span class='token pointer' id='tok-70-17'>post</span><span class='token pointer' id='tok-70-18'>exploitation</span><span class='token pointer' id='tok-70-19'>phase</span><span class='token pointer' id='tok-70-20'>to</span><span class='token pointer' id='tok-70-21'>execute</span><span class='token pointer' id='tok-70-22'>certain</span><span class='token pointer' id='tok-70-23'>files</span><span class='token pointer' id='tok-70-24'>on</span><span class='token pointer' id='tok-70-25'>the</span><span class='token pointer' id='tok-70-26'>target</span><span class='token pointer' id='tok-70-27'>machines.</span><span class='token pointer' id='tok-70-28'>Sometimes</span><span class='token pointer' id='tok-70-29'>it</span><span class='token pointer' id='tok-70-30'>is</span><span class='token pointer' id='tok-70-31'>challenging</span><span class='token pointer' id='tok-70-32'>to</span><span class='token pointer' id='tok-70-33'>bypass</span><span class='token pointer' id='tok-70-34'>certain</span><span class='token pointer' id='tok-70-35'>antivirus</span><span class='token pointer' id='tok-70-36'>applications,</span><span class='token pointer' id='tok-70-37'>as</span><span class='token pointer' id='tok-70-38'>there</span><span class='token pointer' id='tok-70-39'>is</span><span class='token pointer' id='tok-70-40'>no</span><span class='token pointer' id='tok-70-41'>standard</span><span class='token pointer' id='tok-70-42'>method/technique</span><span class='token pointer' id='tok-70-43'>available</span><span class='token pointer' id='tok-70-44'>to</span><span class='token pointer' id='tok-70-45'>bypass</span><span class='token pointer' id='tok-70-46'>all</span><span class='token pointer' id='tok-70-47'>the</span><span class='token pointer' id='tok-70-48'>antivirus</span><span class='token pointer' id='tok-70-49'>software.</span><span class='token pointer' id='tok-70-50'>Thus,</span><span class='token pointer' id='tok-70-51'>we</span><span class='token pointer' id='tok-70-52'>need</span><span class='token pointer' id='tok-70-53'>to</span><span class='token pointer' id='tok-70-54'>try</span><span class='token pointer' id='tok-70-55'>out</span><span class='token pointer' id='tok-70-56'>different</span><span class='token pointer' id='tok-70-57'>methods</span><span class='token pointer' id='tok-70-58'>to</span><span class='token pointer' id='tok-70-59'>bypass</span><span class='token pointer' id='tok-70-60'>them.</span><span class='token pointer' id='tok-70-61'>This</span><span class='token pointer' id='tok-70-62'>article</span><span class='token pointer' id='tok-70-63'>walks</span><span class='token pointer' id='tok-70-64'>the</span><span class='token pointer' id='tok-70-65'>reader</span><span class='token pointer' id='tok-70-66'>through</span><span class='token pointer' id='tok-70-67'>some</span><span class='token pointer' id='tok-70-68'>of</span><span class='token pointer' id='tok-70-69'>the</span><span class='token pointer' id='tok-70-70'>popular</span><span class='token pointer' id='tok-70-71'>tools</span><span class='token pointer' id='tok-70-72'>available</span><span class='token pointer' id='tok-70-73'>to</span><span class='token pointer' id='tok-70-74'>play</span><span class='token pointer' id='tok-70-75'>with</span><span class='token pointer' id='tok-70-76'>Antivirus</span><span class='token pointer' id='tok-70-77'>evasion.</span></p>
<p id=p78><span class='token pointer' id='tok-70-78'>File</span><span class='token pointer' id='tok-70-79'>Splitters</span><span class='token pointer' id='tok-70-80'>and</span><span class='token pointer' id='tok-70-81'>Hex</span><span class='token pointer' id='tok-70-82'>editorsThe</span><span class='token pointer' id='tok-70-83'>first</span><span class='token pointer' id='tok-70-84'>technique</span><span class='token pointer' id='tok-70-85'>that</span><span class='token pointer' id='tok-70-86'>we</span><span class='token pointer' id='tok-70-87'>are</span><span class='token pointer' id='tok-70-88'>going</span><span class='token pointer' id='tok-70-89'>to</span><span class='token pointer' id='tok-70-90'>discuss</span><span class='token pointer' id='tok-70-91'>is</span><span class='token pointer' id='tok-70-92'>using</span><span class='token pointer' id='tok-70-93'>file</span><span class='token pointer' id='tok-70-94'>splitting</span><span class='token pointer' id='tok-70-95'>tools</span><span class='token pointer' id='tok-70-96'>to</span><span class='token pointer' id='tok-70-97'>identify</span><span class='token pointer' id='tok-70-98'>the</span><span class='token pointer' id='tok-70-99'>exact</span><span class='token pointer' id='tok-70-100'>signature</span><span class='token pointer' id='tok-70-101'>that</span><span class='token pointer' id='tok-70-102'>is</span><span class='token pointer' id='tok-70-103'>being</span><span class='token pointer' id='tok-70-104'>detected</span><span class='token pointer' id='tok-70-105'>by</span><span class='token pointer' id='tok-70-106'>the</span><span class='token pointer' id='tok-70-107'>antivirus</span><span class='token pointer' id='tok-70-108'>application</span><span class='token pointer' id='tok-70-109'>and</span><span class='token pointer' id='tok-70-110'>modify</span><span class='token pointer' id='tok-70-111'>it.</span><span class='token pointer' id='tok-70-112'>This</span><span class='token pointer' id='tok-70-113'>is</span><span class='token pointer' id='tok-70-114'>one</span><span class='token pointer' id='tok-70-115'>of</span><span class='token pointer' id='tok-70-116'>the</span><span class='token pointer' id='tok-70-117'>oldest</span><span class='token pointer' id='tok-70-118'>ways</span><span class='token pointer' id='tok-70-119'>to</span><span class='token pointer' id='tok-70-120'>bypass</span><span class='token pointer' id='tok-70-121'>AV</span><span class='token pointer' id='tok-70-122'>tools.</span><span class='token pointer' id='tok-70-123'>This</span><span class='token pointer' id='tok-70-124'>technique</span><span class='token pointer' id='tok-70-125'>is</span><span class='token pointer' id='tok-70-126'>efficient</span><span class='token pointer' id='tok-70-127'>if</span><span class='token pointer' id='tok-70-128'>we</span><span class='token pointer' id='tok-70-129'>can</span><span class='token pointer' id='tok-70-130'>locate</span><span class='token pointer' id='tok-70-131'>the</span><span class='token pointer' id='tok-70-132'>exact</span><span class='token pointer' id='tok-70-133'>signature</span><span class='token pointer' id='tok-70-134'>that</span><span class='token pointer' id='tok-70-135'>is</span><span class='token pointer' id='tok-70-136'>being</span><span class='token pointer' id='tok-70-137'>detected.</span><span class='token pointer' id='tok-70-138'>However,</span><span class='token pointer' id='tok-70-139'>there</span><span class='token pointer' id='tok-70-140'>is</span><span class='token pointer' id='tok-70-141'>a</span><span class='token pointer' id='tok-70-142'>limitation</span><span class='token pointer' id='tok-70-143'>with</span><span class='token pointer' id='tok-70-144'>this</span><span class='token pointer' id='tok-70-145'>technique.</span><span class='token pointer' id='tok-70-146'>If</span><span class='token pointer' id='tok-70-147'>we</span><span class='token pointer' id='tok-70-148'>mess</span><span class='token pointer' id='tok-70-149'>the</span><span class='token pointer' id='tok-70-150'>functionality</span><span class='token pointer' id='tok-70-151'>of</span><span class='token pointer' id='tok-70-152'>the</span><span class='token pointer' id='tok-70-153'>application,</span><span class='token pointer' id='tok-70-154'>it</span><span class='token pointer' id='tok-70-155'>becomes</span><span class='token pointer' id='tok-70-156'>useless</span><span class='token pointer' id='tok-70-157'>even</span><span class='token pointer' id='tok-70-158'>if</span><span class='token pointer' id='tok-70-159'>we</span><span class='token pointer' id='tok-70-160'>bypass</span><span class='token pointer' id='tok-70-161'>antivirus.</span><span class='token pointer' id='tok-70-162'>So,</span><span class='token pointer' id='tok-70-163'>as</span><span class='token pointer' id='tok-70-164'>long</span><span class='token pointer' id='tok-70-165'>as</span><span class='token pointer' id='tok-70-166'>the</span><span class='token pointer' id='tok-70-167'>functionality</span><span class='token pointer' id='tok-70-168'>is</span><span class='token pointer' id='tok-70-169'>not</span><span class='token pointer' id='tok-70-170'>modified</span><span class='token pointer' id='tok-70-171'>while</span><span class='token pointer' id='tok-70-172'>we</span><span class='token pointer' id='tok-70-173'>are</span><span class='token pointer' id='tok-70-174'>changing</span><span class='token pointer' id='tok-70-175'>the</span><span class='token pointer' id='tok-70-176'>signatures,</span><span class='token pointer' id='tok-70-177'>we</span><span class='token pointer' id='tok-70-178'>are</span><span class='token pointer' id='tok-70-179'>good</span><span class='token pointer' id='tok-70-180'>to</span><span class='token pointer' id='tok-70-181'>go.</span></p>
<p id=p182><span class='token pointer' id='tok-70-182'>This</span><span class='token pointer' id='tok-70-183'>can</span><span class='token pointer' id='tok-70-184'>be</span><span class='token pointer' id='tok-70-185'>achieved</span><span class='token pointer' id='tok-70-186'>by</span><span class='token pointer' id='tok-70-187'>using</span><span class='token pointer' id='tok-70-188'>a</span><span class='token pointer' id='tok-70-189'>file-splitting</span><span class='token pointer' id='tok-70-190'>tool</span><span class='token pointer' id='tok-70-191'>to</span><span class='token pointer' id='tok-70-192'>split</span><span class='token pointer' id='tok-70-193'>the</span><span class='token pointer' id='tok-70-194'>binary</span><span class='token pointer' id='tok-70-195'>into</span><span class='token pointer' id='tok-70-196'>many</span><span class='token pointer' id='tok-70-197'>parts.</span><span class='token pointer' id='tok-70-198'>This</span><span class='token pointer' id='tok-70-199'>splitting</span><span class='token pointer' id='tok-70-200'>should</span><span class='token pointer' id='tok-70-201'>be</span><span class='token pointer' id='tok-70-202'>done</span><span class='token pointer' id='tok-70-203'>in</span><span class='token pointer' id='tok-70-204'>such</span><span class='token pointer' id='tok-70-205'>a</span><span class='token pointer' id='tok-70-206'>way</span><span class='token pointer' id='tok-70-207'>that</span><span class='token pointer' id='tok-70-208'>each</span><span class='token pointer' id='tok-70-209'>part</span><span class='token pointer' id='tok-70-210'>is</span><span class='token pointer' id='tok-70-211'>larger</span><span class='token pointer' id='tok-70-212'>than</span><span class='token pointer' id='tok-70-213'>the</span><span class='token pointer' id='tok-70-214'>previous</span><span class='token pointer' id='tok-70-215'>one</span><span class='token pointer' id='tok-70-216'>by</span><span class='token pointer' id='tok-70-217'>a</span><span class='token pointer' id='tok-70-218'>fixed</span><span class='token pointer' id='tok-70-219'>amount.</span><span class='token pointer' id='tok-70-220'>Then</span><span class='token pointer' id='tok-70-221'>we</span><span class='token pointer' id='tok-70-222'>need</span><span class='token pointer' id='tok-70-223'>to</span><span class='token pointer' id='tok-70-224'>run</span><span class='token pointer' id='tok-70-225'>the</span><span class='token pointer' id='tok-70-226'>Antivirus</span><span class='token pointer' id='tok-70-227'>scan</span><span class='token pointer' id='tok-70-228'>on</span><span class='token pointer' id='tok-70-229'>these</span><span class='token pointer' id='tok-70-230'>parts</span><span class='token pointer' id='tok-70-231'>to</span><span class='token pointer' id='tok-70-232'>identify</span><span class='token pointer' id='tok-70-233'>which</span><span class='token pointer' id='tok-70-234'>part</span><span class='token pointer' id='tok-70-235'>is</span><span class='token pointer' id='tok-70-236'>flagged</span><span class='token pointer' id='tok-70-237'>first</span><span class='token pointer' id='tok-70-238'>as</span><span class='token pointer' id='tok-70-239'>malicious.</span><span class='token pointer' id='tok-70-240'>We</span><span class='token pointer' id='tok-70-241'>need</span><span class='token pointer' id='tok-70-242'>to</span><span class='token pointer' id='tok-70-243'>do</span><span class='token pointer' id='tok-70-244'>this</span><span class='token pointer' id='tok-70-245'>process</span><span class='token pointer' id='tok-70-246'>repeatedly</span><span class='token pointer' id='tok-70-247'>until</span><span class='token pointer' id='tok-70-248'>the</span><span class='token pointer' id='tok-70-249'>actual</span><span class='token pointer' id='tok-70-250'>signature</span><span class='token pointer' id='tok-70-251'>is</span><span class='token pointer' id='tok-70-252'>located.</span><span class='token pointer' id='tok-70-253'>Tools</span><span class='token pointer' id='tok-70-254'>such</span><span class='token pointer' id='tok-70-255'>as</span><span class='token pointer' id='tok-70-256'>"Dsplit"</span><span class='token pointer' id='tok-70-257'>and</span><span class='token pointer' id='tok-70-258'>"Evade"</span><span class='token pointer' id='tok-70-259'>can</span><span class='token pointer' id='tok-70-260'>be</span><span class='token pointer' id='tok-70-261'>used</span><span class='token pointer' id='tok-70-262'>for</span><span class='token pointer' id='tok-70-263'>file</span><span class='token pointer' id='tok-70-264'>splitting.</span><span class='token pointer' id='tok-70-265'>Once</span><span class='token pointer' id='tok-70-266'>the</span><span class='token pointer' id='tok-70-267'>signature</span><span class='token pointer' id='tok-70-268'>is</span><span class='token pointer' id='tok-70-269'>located,</span><span class='token pointer' id='tok-70-270'>we</span><span class='token pointer' id='tok-70-271'>need</span><span class='token pointer' id='tok-70-272'>to</span><span class='token pointer' id='tok-70-273'>modify</span><span class='token pointer' id='tok-70-274'>it</span><span class='token pointer' id='tok-70-275'>and</span><span class='token pointer' id='tok-70-276'>save</span><span class='token pointer' id='tok-70-277'>the</span><span class='token pointer' id='tok-70-278'>modified</span><span class='token pointer' id='tok-70-279'>binary.</span></p>
<p id=p280><span class='token pointer' id='tok-70-280'>Let's</span><span class='token pointer' id='tok-70-281'>have</span><span class='token pointer' id='tok-70-282'>a</span><span class='token pointer' id='tok-70-283'>look</span><span class='token pointer' id='tok-70-284'>at</span><span class='token pointer' id='tok-70-285'>an</span><span class='token pointer' id='tok-70-286'>example</span><span class='token pointer' id='tok-70-287'>of</span><span class='token pointer' id='tok-70-288'>how</span><span class='token pointer' id='tok-70-289'>this</span><span class='token pointer' id='tok-70-290'>really</span><span class='token pointer' id='tok-70-291'>works</span><span class='token pointer' id='tok-70-292'>against</span><span class='token pointer' id='tok-70-293'>Antivirus</span><span class='token pointer' id='tok-70-294'>tools.</span></p>
<p id=p295><span class='token pointer' id='tok-70-295'>I</span><span class='token pointer' id='tok-70-296'>have</span><span class='token pointer' id='tok-70-297'>downloaded</span><span class='token pointer' id='tok-70-298'>wce.exe</span><span class='token pointer' id='tok-70-299'>from</span><span class='token pointer' id='tok-70-300'>the</span><span class='token pointer' id='tok-70-301'>link</span><span class='token pointer' id='tok-70-302'>given</span><span class='token pointer' id='tok-70-303'>below.</span><span class='token pointer' id='tok-70-304'>This</span><span class='token pointer' id='tok-70-305'>is</span><span class='token pointer' id='tok-70-306'>one</span><span class='token pointer' id='tok-70-307'>of</span><span class='token pointer' id='tok-70-308'>the</span><span class='token pointer' id='tok-70-309'>commonly</span><span class='token pointer' id='tok-70-310'>used</span><span class='token pointer' id='tok-70-311'>tool</span><span class='token pointer' id='tok-70-312'>during</span><span class='token pointer' id='tok-70-313'>post</span><span class='token pointer' id='tok-70-314'>exploitation</span><span class='token pointer' id='tok-70-315'>for</span><span class='token pointer' id='tok-70-316'>dumping</span><span class='token pointer' id='tok-70-317'>passwords</span><span class='token pointer' id='tok-70-318'>in</span><span class='token pointer' id='tok-70-319'>clear</span><span class='token pointer' id='tok-70-320'>text.</span></p>
<p id=p321><span class='token pointer' id='tok-70-321'>Link</span><span class='token pointer' id='tok-70-322'>to</span><span class='token pointer' id='tok-70-323'>download</span><span class='token pointer' id='tok-70-324'>WCE:</span><span class='token pointer' id='tok-70-325'>http://www.ampliasecurity.com/research/windows-credentials-editor/</span></p>
<p id=p326><span class='token pointer' id='tok-70-326'>When</span><span class='token pointer' id='tok-70-327'>we</span><span class='token pointer' id='tok-70-328'>scan</span><span class='token pointer' id='tok-70-329'>this</span><span class='token pointer' id='tok-70-330'>tool</span><span class='token pointer' id='tok-70-331'>through</span><span class='token pointer' id='tok-70-332'>virustotal.com,</span><span class='token pointer' id='tok-70-333'>it</span><span class='token pointer' id='tok-70-334'>is</span><span class='token pointer' id='tok-70-335'>flagged</span><span class='token pointer' id='tok-70-336'>as</span><span class='token pointer' id='tok-70-337'>malicious</span><span class='token pointer' id='tok-70-338'>by</span><span class='token pointer' id='tok-70-339'>47</span><span class='token pointer' id='tok-70-340'>Antivirus</span><span class='token pointer' id='tok-70-341'>softwares</span><span class='token pointer' id='tok-70-342'>out</span><span class='token pointer' id='tok-70-343'>of</span><span class='token pointer' id='tok-70-344'>56.</span></p>
<p id=p345><span class='token pointer' id='tok-70-345'>By</span><span class='token pointer' id='tok-70-346'>using</span><span class='token pointer' id='tok-70-347'>Dsplit,</span><span class='token pointer' id='tok-70-348'>I</span><span class='token pointer' id='tok-70-349'>have</span><span class='token pointer' id='tok-70-350'>noticed</span><span class='token pointer' id='tok-70-351'>that</span><span class='token pointer' id='tok-70-352'>some</span><span class='token pointer' id='tok-70-353'>antivirus</span><span class='token pointer' id='tok-70-354'>software</span><span class='token pointer' id='tok-70-355'>is</span><span class='token pointer' id='tok-70-356'>detecting</span><span class='token pointer' id='tok-70-357'>it</span><span class='token pointer' id='tok-70-358'>as</span><span class='token pointer' id='tok-70-359'>malicious</span><span class='token pointer' id='tok-70-360'>using</span><span class='token pointer' id='tok-70-361'>its</span><span class='token pointer' id='tok-70-362'>welcome</span><span class='token pointer' id='tok-70-363'>text,</span><span class='token pointer' id='tok-70-364'>which</span><span class='token pointer' id='tok-70-365'>is</span><span class='token pointer' id='tok-70-366'>displayed</span><span class='token pointer' id='tok-70-367'>when</span><span class='token pointer' id='tok-70-368'>we</span><span class='token pointer' id='tok-70-369'>run</span><span class='token pointer' id='tok-70-370'>this</span><span class='token pointer' id='tok-70-371'>tool.</span><span class='token pointer' id='tok-70-372'>Therefore,</span><span class='token pointer' id='tok-70-373'>I</span><span class='token pointer' id='tok-70-374'>opened</span><span class='token pointer' id='tok-70-375'>wce.exe</span><span class='token pointer' id='tok-70-376'>in</span><span class='token pointer' id='tok-70-377'>a</span><span class='token pointer' id='tok-70-378'>hex</span><span class='token pointer' id='tok-70-379'>editor</span><span class='token pointer' id='tok-70-380'>and</span><span class='token pointer' id='tok-70-381'>changed</span><span class='token pointer' id='tok-70-382'>this</span><span class='token pointer' id='tok-70-383'>signature</span><span class='token pointer' id='tok-70-384'>from</span><span class='token pointer' id='tok-70-385'>uppercase</span><span class='token pointer' id='tok-70-386'>to</span><span class='token pointer' id='tok-70-387'>lowercase</span><span class='token pointer' id='tok-70-388'>and</span><span class='token pointer' id='tok-70-389'>vice</span><span class='token pointer' id='tok-70-390'>versa.</span><span class='token pointer' id='tok-70-391'>This</span><span class='token pointer' id='tok-70-392'>is</span><span class='token pointer' id='tok-70-393'>shown</span><span class='token pointer' id='tok-70-394'>below.</span></p>
<p id=p395><span class='token pointer' id='tok-70-395'>After</span><span class='token pointer' id='tok-70-396'>making</span><span class='token pointer' id='tok-70-397'>the</span><span class='token pointer' id='tok-70-398'>above</span><span class='token pointer' id='tok-70-399'>shown</span><span class='token pointer' id='tok-70-400'>modifications</span><span class='token pointer' id='tok-70-401'>to</span><span class='token pointer' id='tok-70-402'>the</span><span class='token pointer' id='tok-70-403'>binary,</span><span class='token pointer' id='tok-70-404'>I</span><span class='token pointer' id='tok-70-405'>have</span><span class='token pointer' id='tok-70-406'>scanned</span><span class='token pointer' id='tok-70-407'>through</span><span class='token pointer' id='tok-70-408'>virustotal.com</span><span class='token pointer' id='tok-70-409'>once</span><span class='token pointer' id='tok-70-410'>again</span><span class='token pointer' id='tok-70-411'>and</span><span class='token pointer' id='tok-70-412'>noticed</span><span class='token pointer' id='tok-70-413'>that</span><span class='token pointer' id='tok-70-414'>42</span><span class='token pointer' id='tok-70-415'>antivirus</span><span class='token pointer' id='tok-70-416'>engines</span><span class='token pointer' id='tok-70-417'>out</span><span class='token pointer' id='tok-70-418'>of</span><span class='token pointer' id='tok-70-419'>56</span><span class='token pointer' id='tok-70-420'>have</span><span class='token pointer' id='tok-70-421'>flagged</span><span class='token pointer' id='tok-70-422'>it</span><span class='token pointer' id='tok-70-423'>as</span><span class='token pointer' id='tok-70-424'>malicious</span><span class='token pointer' id='tok-70-425'>this</span><span class='token pointer' id='tok-70-426'>time.</span></p>
<p id=p427><span class='token pointer' id='tok-70-427'>However,</span><span class='token pointer' id='tok-70-428'>this</span><span class='token pointer' id='tok-70-429'>didn't</span><span class='token pointer' id='tok-70-430'>bypass</span><span class='token pointer' id='tok-70-431'>most</span><span class='token pointer' id='tok-70-432'>of</span><span class='token pointer' id='tok-70-433'>the</span><span class='token pointer' id='tok-70-434'>antivirus</span><span class='token pointer' id='tok-70-435'>applications;</span><span class='token pointer' id='tok-70-436'>it</span><span class='token pointer' id='tok-70-437'>is</span><span class='token pointer' id='tok-70-438'>possible</span><span class='token pointer' id='tok-70-439'>to</span><span class='token pointer' id='tok-70-440'>do</span><span class='token pointer' id='tok-70-441'>that</span><span class='token pointer' id='tok-70-442'>if</span><span class='token pointer' id='tok-70-443'>we</span><span class='token pointer' id='tok-70-444'>can</span><span class='token pointer' id='tok-70-445'>locate</span><span class='token pointer' id='tok-70-446'>the</span><span class='token pointer' id='tok-70-447'>exact</span><span class='token pointer' id='tok-70-448'>signature</span><span class='token pointer' id='tok-70-449'>that</span><span class='token pointer' id='tok-70-450'>is</span><span class='token pointer' id='tok-70-451'>being</span><span class='token pointer' id='tok-70-452'>detected</span><span class='token pointer' id='tok-70-453'>by</span><span class='token pointer' id='tok-70-454'>those</span><span class='token pointer' id='tok-70-455'>AVs.</span></p>
<p id=p456><span class='token pointer' id='tok-70-456'>When</span><span class='token pointer' id='tok-70-457'>we</span><span class='token pointer' id='tok-70-458'>use</span><span class='token pointer' id='tok-70-459'>the</span><span class='token pointer' id='tok-70-460'>above-mentioned</span><span class='token pointer' id='tok-70-461'>technique,</span><span class='token pointer' id='tok-70-462'>we</span><span class='token pointer' id='tok-70-463'>should</span><span class='token pointer' id='tok-70-464'>not</span><span class='token pointer' id='tok-70-465'>forget</span><span class='token pointer' id='tok-70-466'>about</span><span class='token pointer' id='tok-70-467'>the</span><span class='token pointer' id='tok-70-468'>functionality</span><span class='token pointer' id='tok-70-469'>of</span><span class='token pointer' id='tok-70-470'>the</span><span class='token pointer' id='tok-70-471'>binary</span><span class='token pointer' id='tok-70-472'>while</span><span class='token pointer' id='tok-70-473'>making</span><span class='token pointer' id='tok-70-474'>changes.</span></p>
<p id=p475><span class='token pointer' id='tok-70-475'>As</span><span class='token pointer' id='tok-70-476'>an</span><span class='token pointer' id='tok-70-477'>example,</span><span class='token pointer' id='tok-70-478'>here</span><span class='token pointer' id='tok-70-479'>is</span><span class='token pointer' id='tok-70-480'>the</span><span class='token pointer' id='tok-70-481'>output</span><span class='token pointer' id='tok-70-482'>of</span><span class='token pointer' id='tok-70-483'>original</span><span class='token pointer' id='tok-70-484'>wce.exe</span><span class='token pointer' id='tok-70-485'>dumping</span><span class='token pointer' id='tok-70-486'>the</span><span class='token pointer' id='tok-70-487'>password</span><span class='token pointer' id='tok-70-488'>from</span><span class='token pointer' id='tok-70-489'>memory.</span></p>
<p id=p490><span class='token pointer' id='tok-70-490'>The</span><span class='token pointer' id='tok-70-491'>functionality</span><span class='token pointer' id='tok-70-492'>remained</span><span class='token pointer' id='tok-70-493'>the</span><span class='token pointer' id='tok-70-494'>same</span><span class='token pointer' id='tok-70-495'>even</span><span class='token pointer' id='tok-70-496'>after</span><span class='token pointer' id='tok-70-497'>making</span><span class='token pointer' id='tok-70-498'>changes</span><span class='token pointer' id='tok-70-499'>to</span><span class='token pointer' id='tok-70-500'>the</span><span class='token pointer' id='tok-70-501'>binary.</span><span class='token pointer' id='tok-70-502'>It</span><span class='token pointer' id='tok-70-503'>is</span><span class='token pointer' id='tok-70-504'>still</span><span class='token pointer' id='tok-70-505'>able</span><span class='token pointer' id='tok-70-506'>to</span><span class='token pointer' id='tok-70-507'>get</span><span class='token pointer' id='tok-70-508'>the</span><span class='token pointer' id='tok-70-509'>password</span><span class='token pointer' id='tok-70-510'>from</span><span class='token pointer' id='tok-70-511'>the</span><span class='token pointer' id='tok-70-512'>memory</span><span class='token pointer' id='tok-70-513'>as</span><span class='token pointer' id='tok-70-514'>shown</span><span class='token pointer' id='tok-70-515'>below.</span></p>
<p id=p516><span class='token pointer' id='tok-70-516'>HyperionEncrypting</span><span class='token pointer' id='tok-70-517'>the</span><span class='token pointer' id='tok-70-518'>binary</span><span class='token pointer' id='tok-70-519'>is</span><span class='token pointer' id='tok-70-520'>one</span><span class='token pointer' id='tok-70-521'>of</span><span class='token pointer' id='tok-70-522'>the</span><span class='token pointer' id='tok-70-523'>common</span><span class='token pointer' id='tok-70-524'>ways</span><span class='token pointer' id='tok-70-525'>to</span><span class='token pointer' id='tok-70-526'>bypass</span><span class='token pointer' id='tok-70-527'>antivirus</span><span class='token pointer' id='tok-70-528'>detection.</span><span class='token pointer' id='tok-70-529'>The</span><span class='token pointer' id='tok-70-530'>logic</span><span class='token pointer' id='tok-70-531'>behind</span><span class='token pointer' id='tok-70-532'>using</span><span class='token pointer' id='tok-70-533'>encrypters</span><span class='token pointer' id='tok-70-534'>is</span><span class='token pointer' id='tok-70-535'>to</span><span class='token pointer' id='tok-70-536'>obfuscate</span><span class='token pointer' id='tok-70-537'>the</span><span class='token pointer' id='tok-70-538'>binary</span><span class='token pointer' id='tok-70-539'>from</span><span class='token pointer' id='tok-70-540'>antivirus</span><span class='token pointer' id='tok-70-541'>tools</span><span class='token pointer' id='tok-70-542'>by</span><span class='token pointer' id='tok-70-543'>encrypting</span><span class='token pointer' id='tok-70-544'>it.</span><span class='token pointer' id='tok-70-545'>This</span><span class='token pointer' id='tok-70-546'>will</span><span class='token pointer' id='tok-70-547'>be</span><span class='token pointer' id='tok-70-548'>decrypted</span><span class='token pointer' id='tok-70-549'>back</span><span class='token pointer' id='tok-70-550'>when</span><span class='token pointer' id='tok-70-551'>the</span><span class='token pointer' id='tok-70-552'>binary</span><span class='token pointer' id='tok-70-553'>is</span><span class='token pointer' id='tok-70-554'>run.</span><span class='token pointer' id='tok-70-555'>Kali</span><span class='token pointer' id='tok-70-556'>Linux</span><span class='token pointer' id='tok-70-557'>has</span><span class='token pointer' id='tok-70-558'>got</span><span class='token pointer' id='tok-70-559'>an</span><span class='token pointer' id='tok-70-560'>open</span><span class='token pointer' id='tok-70-561'>source</span><span class='token pointer' id='tok-70-562'>encrypter</span><span class='token pointer' id='tok-70-563'>named</span><span class='token pointer' id='tok-70-564'>Hyperion</span><span class='token pointer' id='tok-70-565'>available</span><span class='token pointer' id='tok-70-566'>in</span><span class='token pointer' id='tok-70-567'>it.</span><span class='token pointer' id='tok-70-568'>This</span><span class='token pointer' id='tok-70-569'>can</span><span class='token pointer' id='tok-70-570'>also</span><span class='token pointer' id='tok-70-571'>be</span><span class='token pointer' id='tok-70-572'>downloaded</span><span class='token pointer' id='tok-70-573'>from</span><span class='token pointer' id='tok-70-574'>the</span><span class='token pointer' id='tok-70-575'>link</span><span class='token pointer' id='tok-70-576'>below.</span></p>
<p id=p577><span class='token pointer' id='tok-70-577'>http://nullsecurity.net/tools/binary.html</span></p>
<p id=p578><span class='token pointer' id='tok-70-578'>I</span><span class='token pointer' id='tok-70-579'>am</span><span class='token pointer' id='tok-70-580'>using</span><span class='token pointer' id='tok-70-581'>the</span><span class='token pointer' id='tok-70-582'>one</span><span class='token pointer' id='tok-70-583'>I</span><span class='token pointer' id='tok-70-584'>have</span><span class='token pointer' id='tok-70-585'>downloaded</span><span class='token pointer' id='tok-70-586'>from</span><span class='token pointer' id='tok-70-587'>the</span><span class='token pointer' id='tok-70-588'>above</span><span class='token pointer' id='tok-70-589'>link.</span><span class='token pointer' id='tok-70-590'>Let</span><span class='token pointer' id='tok-70-591'>us</span><span class='token pointer' id='tok-70-592'>see</span><span class='token pointer' id='tok-70-593'>how</span><span class='token pointer' id='tok-70-594'>we</span><span class='token pointer' id='tok-70-595'>can</span><span class='token pointer' id='tok-70-596'>use</span><span class='token pointer' id='tok-70-597'>this</span><span class='token pointer' id='tok-70-598'>tool.</span></p>
<p id=p599><span class='token pointer' id='tok-70-599'>Before</span><span class='token pointer' id='tok-70-600'>we</span><span class='token pointer' id='tok-70-601'>use</span><span class='token pointer' id='tok-70-602'>Hyperion,</span><span class='token pointer' id='tok-70-603'>let's</span><span class='token pointer' id='tok-70-604'>scan</span><span class='token pointer' id='tok-70-605'>the</span><span class='token pointer' id='tok-70-606'>32</span><span class='token pointer' id='tok-70-607'>bit</span><span class='token pointer' id='tok-70-608'>version</span><span class='token pointer' id='tok-70-609'>of</span><span class='token pointer' id='tok-70-610'>wce.exe</span><span class='token pointer' id='tok-70-611'>file</span><span class='token pointer' id='tok-70-612'>through</span><span class='token pointer' id='tok-70-613'>virustotal.com</span><span class='token pointer' id='tok-70-614'>first.</span></p>
<p id=p615><span class='token pointer' id='tok-70-615'>As</span><span class='token pointer' id='tok-70-616'>we</span><span class='token pointer' id='tok-70-617'>can</span><span class='token pointer' id='tok-70-618'>notice,</span><span class='token pointer' id='tok-70-619'>44</span><span class='token pointer' id='tok-70-620'>antivirus</span><span class='token pointer' id='tok-70-621'>applications</span><span class='token pointer' id='tok-70-622'>have</span><span class='token pointer' id='tok-70-623'>flagged</span><span class='token pointer' id='tok-70-624'>this</span><span class='token pointer' id='tok-70-625'>as</span><span class='token pointer' id='tok-70-626'>malicious.</span></p>
<p id=p627><span class='token pointer' id='tok-70-627'>Let's</span><span class='token pointer' id='tok-70-628'>encrypt</span><span class='token pointer' id='tok-70-629'>this</span><span class='token pointer' id='tok-70-630'>file</span><span class='token pointer' id='tok-70-631'>with</span><span class='token pointer' id='tok-70-632'>Hyperion</span><span class='token pointer' id='tok-70-633'>as</span><span class='token pointer' id='tok-70-634'>shown</span><span class='token pointer' id='tok-70-635'>below.</span></p>
<p id=p636><span class='token pointer' id='tok-70-636'>Let's</span><span class='token pointer' id='tok-70-637'>scan</span><span class='token pointer' id='tok-70-638'>this</span><span class='token pointer' id='tok-70-639'>newly</span><span class='token pointer' id='tok-70-640'>generated</span><span class='token pointer' id='tok-70-641'>file</span><span class='token pointer' id='tok-70-642'>once</span><span class='token pointer' id='tok-70-643'>again</span><span class='token pointer' id='tok-70-644'>and</span><span class='token pointer' id='tok-70-645'>see</span><span class='token pointer' id='tok-70-646'>the</span><span class='token pointer' id='tok-70-647'>detection</span><span class='token pointer' id='tok-70-648'>ratio.</span></p>
<p id=p649><span class='token pointer' id='tok-70-649'>As</span><span class='token pointer' id='tok-70-650'>we</span><span class='token pointer' id='tok-70-651'>can</span><span class='token pointer' id='tok-70-652'>see</span><span class='token pointer' id='tok-70-653'>in</span><span class='token pointer' id='tok-70-654'>the</span><span class='token pointer' id='tok-70-655'>figure</span><span class='token pointer' id='tok-70-656'>above,</span><span class='token pointer' id='tok-70-657'>this</span><span class='token pointer' id='tok-70-658'>has</span><span class='token pointer' id='tok-70-659'>got</span><span class='token pointer' id='tok-70-660'>lesser</span><span class='token pointer' id='tok-70-661'>detection</span><span class='token pointer' id='tok-70-662'>compared</span><span class='token pointer' id='tok-70-663'>to</span><span class='token pointer' id='tok-70-664'>the</span><span class='token pointer' id='tok-70-665'>unencrypted</span><span class='token pointer' id='tok-70-666'>binary.</span></p>
<p id=p667><span class='token pointer' id='tok-70-667'>Veil-EvasionVeil-Evasion</span><span class='token pointer' id='tok-70-668'>is</span><span class='token pointer' id='tok-70-669'>another</span><span class='token pointer' id='tok-70-670'>popular</span><span class='token pointer' id='tok-70-671'>framework</span><span class='token pointer' id='tok-70-672'>written</span><span class='token pointer' id='tok-70-673'>in</span><span class='token pointer' id='tok-70-674'>python.</span><span class='token pointer' id='tok-70-675'>We</span><span class='token pointer' id='tok-70-676'>can</span><span class='token pointer' id='tok-70-677'>use</span><span class='token pointer' id='tok-70-678'>this</span><span class='token pointer' id='tok-70-679'>framework</span><span class='token pointer' id='tok-70-680'>to</span><span class='token pointer' id='tok-70-681'>generate</span><span class='token pointer' id='tok-70-682'>payloads</span><span class='token pointer' id='tok-70-683'>that</span><span class='token pointer' id='tok-70-684'>can</span><span class='token pointer' id='tok-70-685'>evade</span><span class='token pointer' id='tok-70-686'>majority</span><span class='token pointer' id='tok-70-687'>of</span><span class='token pointer' id='tok-70-688'>AVs.</span></p>
<p id=p689><span class='token pointer' id='tok-70-689'>Veil-evasion</span><span class='token pointer' id='tok-70-690'>can</span><span class='token pointer' id='tok-70-691'>be</span><span class='token pointer' id='tok-70-692'>downloaded</span><span class='token pointer' id='tok-70-693'>from</span><span class='token pointer' id='tok-70-694'>their</span><span class='token pointer' id='tok-70-695'>official</span><span class='token pointer' id='tok-70-696'>website.</span></p>
<p id=p697><span class='token pointer' id='tok-70-697'>https://www.veil-framework.com</span></p>
<p id=p698><span class='token pointer' id='tok-70-698'>First</span><span class='token pointer' id='tok-70-699'>download</span><span class='token pointer' id='tok-70-700'>and</span><span class='token pointer' id='tok-70-701'>install</span><span class='token pointer' id='tok-70-702'>Veil-Evasion</span><span class='token pointer' id='tok-70-703'>and</span><span class='token pointer' id='tok-70-704'>run</span><span class='token pointer' id='tok-70-705'>it</span><span class='token pointer' id='tok-70-706'>using</span><span class='token pointer' id='tok-70-707'>the</span><span class='token pointer' id='tok-70-708'>following</span><span class='token pointer' id='tok-70-709'>command</span></p>
<p id=p710><span class='token pointer' id='tok-70-710'>"veil-evasion"</span></p>
<p id=p711><span class='token pointer' id='tok-70-711'>As</span><span class='token pointer' id='tok-70-712'>we</span><span class='token pointer' id='tok-70-713'>can</span><span class='token pointer' id='tok-70-714'>see,</span><span class='token pointer' id='tok-70-715'>46</span><span class='token pointer' id='tok-70-716'>payloads</span><span class='token pointer' id='tok-70-717'>have</span><span class='token pointer' id='tok-70-718'>been</span><span class='token pointer' id='tok-70-719'>loaded.</span><span class='token pointer' id='tok-70-720'>To</span><span class='token pointer' id='tok-70-721'>use</span><span class='token pointer' id='tok-70-722'>a</span><span class='token pointer' id='tok-70-723'>specific</span><span class='token pointer' id='tok-70-724'>payload,</span><span class='token pointer' id='tok-70-725'>we</span><span class='token pointer' id='tok-70-726'>can</span><span class='token pointer' id='tok-70-727'>type</span><span class='token pointer' id='tok-70-728'>"use"</span><span class='token pointer' id='tok-70-729'>command.</span></p>
<p id=p730><span class='token pointer' id='tok-70-730'>I</span><span class='token pointer' id='tok-70-731'>am</span><span class='token pointer' id='tok-70-732'>going</span><span class='token pointer' id='tok-70-733'>to</span><span class='token pointer' id='tok-70-734'>choose</span><span class='token pointer' id='tok-70-735'>option</span><span class='token pointer' id='tok-70-736'>31</span><span class='token pointer' id='tok-70-737'>to</span><span class='token pointer' id='tok-70-738'>create</span><span class='token pointer' id='tok-70-739'>the</span><span class='token pointer' id='tok-70-740'>executable</span><span class='token pointer' id='tok-70-741'>payload</span><span class='token pointer' id='tok-70-742'>python/meterpreter/rev_tcp.</span><span class='token pointer' id='tok-70-743'>Infact,</span><span class='token pointer' id='tok-70-744'>it</span><span class='token pointer' id='tok-70-745'>creates</span><span class='token pointer' id='tok-70-746'>a</span><span class='token pointer' id='tok-70-747'>python</span><span class='token pointer' id='tok-70-748'>script,</span><span class='token pointer' id='tok-70-749'>which</span><span class='token pointer' id='tok-70-750'>in</span><span class='token pointer' id='tok-70-751'>turn</span><span class='token pointer' id='tok-70-752'>will</span><span class='token pointer' id='tok-70-753'>be</span><span class='token pointer' id='tok-70-754'>converted</span><span class='token pointer' id='tok-70-755'>into</span><span class='token pointer' id='tok-70-756'>an</span><span class='token pointer' id='tok-70-757'>executable</span><span class='token pointer' id='tok-70-758'>using</span><span class='token pointer' id='tok-70-759'>tools</span><span class='token pointer' id='tok-70-760'>like</span><span class='token pointer' id='tok-70-761'>pyinstaller.</span></p>
<p id=p762><span class='token pointer' id='tok-70-762'>In</span><span class='token pointer' id='tok-70-763'>the</span><span class='token pointer' id='tok-70-764'>above</span><span class='token pointer' id='tok-70-765'>figure,</span><span class='token pointer' id='tok-70-766'>we</span><span class='token pointer' id='tok-70-767'>have</span><span class='token pointer' id='tok-70-768'>set</span><span class='token pointer' id='tok-70-769'>the</span><span class='token pointer' id='tok-70-770'>LHOST</span><span class='token pointer' id='tok-70-771'>to</span><span class='token pointer' id='tok-70-772'>192.168.56.101</span><span class='token pointer' id='tok-70-773'>and</span><span class='token pointer' id='tok-70-774'>typed</span><span class='token pointer' id='tok-70-775'>"generate"</span><span class='token pointer' id='tok-70-776'>command</span><span class='token pointer' id='tok-70-777'>to</span><span class='token pointer' id='tok-70-778'>generate</span><span class='token pointer' id='tok-70-779'>the</span><span class='token pointer' id='tok-70-780'>payload.</span></p>
<p id=p781><span class='token pointer' id='tok-70-781'>Next,</span><span class='token pointer' id='tok-70-782'>it</span><span class='token pointer' id='tok-70-783'>will</span><span class='token pointer' id='tok-70-784'>ask</span><span class='token pointer' id='tok-70-785'>us</span><span class='token pointer' id='tok-70-786'>to</span><span class='token pointer' id='tok-70-787'>enter</span><span class='token pointer' id='tok-70-788'>a</span><span class='token pointer' id='tok-70-789'>name</span><span class='token pointer' id='tok-70-790'>for</span><span class='token pointer' id='tok-70-791'>the</span><span class='token pointer' id='tok-70-792'>payload.</span><span class='token pointer' id='tok-70-793'>I</span><span class='token pointer' id='tok-70-794'>named</span><span class='token pointer' id='tok-70-795'>it</span><span class='token pointer' id='tok-70-796'>"backdoor".</span><span class='token pointer' id='tok-70-797'>As</span><span class='token pointer' id='tok-70-798'>mentioned</span><span class='token pointer' id='tok-70-799'>earlier,</span><span class='token pointer' id='tok-70-800'>Veil</span><span class='token pointer' id='tok-70-801'>converts</span><span class='token pointer' id='tok-70-802'>python</span><span class='token pointer' id='tok-70-803'>files</span><span class='token pointer' id='tok-70-804'>to</span><span class='token pointer' id='tok-70-805'>exe.</span><span class='token pointer' id='tok-70-806'>It</span><span class='token pointer' id='tok-70-807'>asks</span><span class='token pointer' id='tok-70-808'>us</span><span class='token pointer' id='tok-70-809'>to</span><span class='token pointer' id='tok-70-810'>choose</span><span class='token pointer' id='tok-70-811'>which</span><span class='token pointer' id='tok-70-812'>tool</span><span class='token pointer' id='tok-70-813'>we</span><span class='token pointer' id='tok-70-814'>want</span><span class='token pointer' id='tok-70-815'>to</span><span class='token pointer' id='tok-70-816'>use</span><span class='token pointer' id='tok-70-817'>for</span><span class='token pointer' id='tok-70-818'>this</span><span class='token pointer' id='tok-70-819'>process.</span><span class='token pointer' id='tok-70-820'>Personally,</span><span class='token pointer' id='tok-70-821'>I</span><span class='token pointer' id='tok-70-822'>like</span><span class='token pointer' id='tok-70-823'>Pyinstaller</span><span class='token pointer' id='tok-70-824'>and</span><span class='token pointer' id='tok-70-825'>I</span><span class='token pointer' id='tok-70-826'>am</span><span class='token pointer' id='tok-70-827'>going</span><span class='token pointer' id='tok-70-828'>for</span><span class='token pointer' id='tok-70-829'>it</span><span class='token pointer' id='tok-70-830'>with</span><span class='token pointer' id='tok-70-831'>option</span><span class='token pointer' id='tok-70-832'>1.</span><span class='token pointer' id='tok-70-833'>These</span><span class='token pointer' id='tok-70-834'>two</span><span class='token pointer' id='tok-70-835'>steps</span><span class='token pointer' id='tok-70-836'>are</span><span class='token pointer' id='tok-70-837'>shown</span><span class='token pointer' id='tok-70-838'>below.</span></p>
<p id=p839><span class='token pointer' id='tok-70-839'>Once</span><span class='token pointer' id='tok-70-840'>done,</span><span class='token pointer' id='tok-70-841'>it</span><span class='token pointer' id='tok-70-842'>will</span><span class='token pointer' id='tok-70-843'>create</span><span class='token pointer' id='tok-70-844'>our</span><span class='token pointer' id='tok-70-845'>final</span><span class='token pointer' id='tok-70-846'>payload</span><span class='token pointer' id='tok-70-847'>and</span><span class='token pointer' id='tok-70-848'>gives</span><span class='token pointer' id='tok-70-849'>us</span><span class='token pointer' id='tok-70-850'>the</span><span class='token pointer' id='tok-70-851'>location</span><span class='token pointer' id='tok-70-852'>of</span><span class='token pointer' id='tok-70-853'>it</span><span class='token pointer' id='tok-70-854'>as</span><span class='token pointer' id='tok-70-855'>shown</span><span class='token pointer' id='tok-70-856'>below.</span></p>
<p id=p857><span class='token pointer' id='tok-70-857'>As</span><span class='token pointer' id='tok-70-858'>we</span><span class='token pointer' id='tok-70-859'>can</span><span class='token pointer' id='tok-70-860'>see</span><span class='token pointer' id='tok-70-861'>in</span><span class='token pointer' id='tok-70-862'>the</span><span class='token pointer' id='tok-70-863'>figure</span><span class='token pointer' id='tok-70-864'>above,</span><span class='token pointer' id='tok-70-865'>the</span><span class='token pointer' id='tok-70-866'>authors</span><span class='token pointer' id='tok-70-867'>of</span><span class='token pointer' id='tok-70-868'>this</span><span class='token pointer' id='tok-70-869'>framework</span><span class='token pointer' id='tok-70-870'>are</span><span class='token pointer' id='tok-70-871'>suggesting</span><span class='token pointer' id='tok-70-872'>not</span><span class='token pointer' id='tok-70-873'>to</span><span class='token pointer' id='tok-70-874'>submit</span><span class='token pointer' id='tok-70-875'>these</span><span class='token pointer' id='tok-70-876'>samples</span><span class='token pointer' id='tok-70-877'>online.</span><span class='token pointer' id='tok-70-878'>Therefore,</span><span class='token pointer' id='tok-70-879'>I</span><span class='token pointer' id='tok-70-880'>have</span><span class='token pointer' id='tok-70-881'>checked</span><span class='token pointer' id='tok-70-882'>this</span><span class='token pointer' id='tok-70-883'>payload</span><span class='token pointer' id='tok-70-884'>in</span><span class='token pointer' id='tok-70-885'>sandboxed</span><span class='token pointer' id='tok-70-886'>environment</span><span class='token pointer' id='tok-70-887'>with</span><span class='token pointer' id='tok-70-888'>Avast</span><span class='token pointer' id='tok-70-889'>Antivirus</span><span class='token pointer' id='tok-70-890'>and</span><span class='token pointer' id='tok-70-891'>it</span><span class='token pointer' id='tok-70-892'>is</span><span class='token pointer' id='tok-70-893'>not</span><span class='token pointer' id='tok-70-894'>detected.</span></p>
<p id=p895><span class='token pointer' id='tok-70-895'>Ethical</span><span class='token pointer' id='tok-70-896'>Hacking</span><span class='token pointer' id='tok-70-897'>Training</span><span class='token pointer' id='tok-70-898'>â€“</span><span class='token pointer' id='tok-70-899'>Resources</span><span class='token pointer' id='tok-70-900'>(InfoSec)</span></p>
<p id=p901><span class='token pointer' id='tok-70-901'>These</span><span class='token pointer' id='tok-70-902'>payloads</span><span class='token pointer' id='tok-70-903'>also</span><span class='token pointer' id='tok-70-904'>work</span><span class='token pointer' id='tok-70-905'>fine</span><span class='token pointer' id='tok-70-906'>when</span><span class='token pointer' id='tok-70-907'>they</span><span class='token pointer' id='tok-70-908'>are</span><span class='token pointer' id='tok-70-909'>executed</span><span class='token pointer' id='tok-70-910'>on</span><span class='token pointer' id='tok-70-911'>Victim's</span><span class='token pointer' id='tok-70-912'>machines.</span></p>
<p id=p913><span class='token pointer' id='tok-70-913'>Following</span><span class='token pointer' id='tok-70-914'>figure</span><span class='token pointer' id='tok-70-915'>shows</span><span class='token pointer' id='tok-70-916'>a</span><span class='token pointer' id='tok-70-917'>meterpreter</span><span class='token pointer' id='tok-70-918'>shell</span><span class='token pointer' id='tok-70-919'>obtained</span><span class='token pointer' id='tok-70-920'>using</span><span class='token pointer' id='tok-70-921'>the</span><span class='token pointer' id='tok-70-922'>payload</span><span class='token pointer' id='tok-70-923'>created</span><span class='token pointer' id='tok-70-924'>above.</span></p>
<p id=p925><span class='token pointer' id='tok-70-925'>Try</span><span class='token pointer' id='tok-70-926'>with</span><span class='token pointer' id='tok-70-927'>other</span><span class='token pointer' id='tok-70-928'>payloads</span><span class='token pointer' id='tok-70-929'>that</span><span class='token pointer' id='tok-70-930'>use</span><span class='token pointer' id='tok-70-931'>encryption</span><span class='token pointer' id='tok-70-932'>to</span><span class='token pointer' id='tok-70-933'>get</span><span class='token pointer' id='tok-70-934'>better</span><span class='token pointer' id='tok-70-935'>output.</span></p>
<p id=p936><span class='token pointer' id='tok-70-936'>peCloak:</span></p>
<p id=p937><span class='token pointer' id='tok-70-937'>peCloak</span><span class='token pointer' id='tok-70-938'>is</span><span class='token pointer' id='tok-70-939'>another</span><span class='token pointer' id='tok-70-940'>interesting</span><span class='token pointer' id='tok-70-941'>tool</span><span class='token pointer' id='tok-70-942'>that</span><span class='token pointer' id='tok-70-943'>I</span><span class='token pointer' id='tok-70-944'>came</span><span class='token pointer' id='tok-70-945'>across</span><span class='token pointer' id='tok-70-946'>from</span><span class='token pointer' id='tok-70-947'>the</span><span class='token pointer' id='tok-70-948'>following</span><span class='token pointer' id='tok-70-949'>link.</span></p>
<p id=p950><span class='token pointer' id='tok-70-950'>http://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/</span></p>
<p id=p951><span class='token pointer' id='tok-70-951'>This</span><span class='token pointer' id='tok-70-952'>script</span><span class='token pointer' id='tok-70-953'>automates</span><span class='token pointer' id='tok-70-954'>multiple</span><span class='token pointer' id='tok-70-955'>tricks</span><span class='token pointer' id='tok-70-956'>to</span><span class='token pointer' id='tok-70-957'>evade</span><span class='token pointer' id='tok-70-958'>AVs.</span><span class='token pointer' id='tok-70-959'>The</span><span class='token pointer' id='tok-70-960'>author</span><span class='token pointer' id='tok-70-961'>has</span><span class='token pointer' id='tok-70-962'>written</span><span class='token pointer' id='tok-70-963'>this</span><span class='token pointer' id='tok-70-964'>for</span><span class='token pointer' id='tok-70-965'>his</span><span class='token pointer' id='tok-70-966'>own</span><span class='token pointer' id='tok-70-967'>purposes</span><span class='token pointer' id='tok-70-968'>and</span><span class='token pointer' id='tok-70-969'>he</span><span class='token pointer' id='tok-70-970'>released</span><span class='token pointer' id='tok-70-971'>it</span><span class='token pointer' id='tok-70-972'>publicly</span><span class='token pointer' id='tok-70-973'>as</span><span class='token pointer' id='tok-70-974'>a</span><span class='token pointer' id='tok-70-975'>beta</span><span class='token pointer' id='tok-70-976'>version.</span><span class='token pointer' id='tok-70-977'>This</span><span class='token pointer' id='tok-70-978'>script</span><span class='token pointer' id='tok-70-979'>gives</span><span class='token pointer' id='tok-70-980'>us</span><span class='token pointer' id='tok-70-981'>an</span><span class='token pointer' id='tok-70-982'>idea</span><span class='token pointer' id='tok-70-983'>of</span><span class='token pointer' id='tok-70-984'>how</span><span class='token pointer' id='tok-70-985'>we</span><span class='token pointer' id='tok-70-986'>can</span><span class='token pointer' id='tok-70-987'>write</span><span class='token pointer' id='tok-70-988'>our</span><span class='token pointer' id='tok-70-989'>own</span><span class='token pointer' id='tok-70-990'>scripts</span><span class='token pointer' id='tok-70-991'>to</span><span class='token pointer' id='tok-70-992'>evade</span><span class='token pointer' id='tok-70-993'>Antiviruses.</span></p>
<p id=p994><span class='token pointer' id='tok-70-994'>Let's</span><span class='token pointer' id='tok-70-995'>see</span><span class='token pointer' id='tok-70-996'>this</span><span class='token pointer' id='tok-70-997'>in</span><span class='token pointer' id='tok-70-998'>action.</span></p>
<p id=p999><span class='token pointer' id='tok-70-999'>I</span><span class='token pointer' id='tok-70-1000'>am</span><span class='token pointer' id='tok-70-1001'>going</span><span class='token pointer' id='tok-70-1002'>to</span><span class='token pointer' id='tok-70-1003'>create</span><span class='token pointer' id='tok-70-1004'>a</span><span class='token pointer' id='tok-70-1005'>meterpreter</span><span class='token pointer' id='tok-70-1006'>payload</span><span class='token pointer' id='tok-70-1007'>using</span><span class='token pointer' id='tok-70-1008'>msfvenom</span><span class='token pointer' id='tok-70-1009'>for</span><span class='token pointer' id='tok-70-1010'>this</span><span class='token pointer' id='tok-70-1011'>purpose.</span><span class='token pointer' id='tok-70-1012'>This</span><span class='token pointer' id='tok-70-1013'>is</span><span class='token pointer' id='tok-70-1014'>shown</span><span class='token pointer' id='tok-70-1015'>below.</span></p>
<p id=p1016><span class='token pointer' id='tok-70-1016'>Let</span><span class='token pointer' id='tok-70-1017'>us</span><span class='token pointer' id='tok-70-1018'>scan</span><span class='token pointer' id='tok-70-1019'>the</span><span class='token pointer' id='tok-70-1020'>payload</span><span class='token pointer' id='tok-70-1021'>"test.exe"</span><span class='token pointer' id='tok-70-1022'>through</span><span class='token pointer' id='tok-70-1023'>virustotal.com</span><span class='token pointer' id='tok-70-1024'>as</span><span class='token pointer' id='tok-70-1025'>shown</span><span class='token pointer' id='tok-70-1026'>below.</span></p>
<p id=p1027><span class='token pointer' id='tok-70-1027'>36</span><span class='token pointer' id='tok-70-1028'>out</span><span class='token pointer' id='tok-70-1029'>of</span><span class='token pointer' id='tok-70-1030'>56</span><span class='token pointer' id='tok-70-1031'>antivirus</span><span class='token pointer' id='tok-70-1032'>engines</span><span class='token pointer' id='tok-70-1033'>have</span><span class='token pointer' id='tok-70-1034'>flagged</span><span class='token pointer' id='tok-70-1035'>this</span><span class='token pointer' id='tok-70-1036'>as</span><span class='token pointer' id='tok-70-1037'>malicious.</span></p>
<p id=p1038><span class='token pointer' id='tok-70-1038'>Now,</span><span class='token pointer' id='tok-70-1039'>lets</span><span class='token pointer' id='tok-70-1040'>run</span><span class='token pointer' id='tok-70-1041'>this</span><span class='token pointer' id='tok-70-1042'>using</span><span class='token pointer' id='tok-70-1043'>peCloak.py</span><span class='token pointer' id='tok-70-1044'>script.</span></p>
<p id=p1045><span class='token pointer' id='tok-70-1045'>I</span><span class='token pointer' id='tok-70-1046'>am</span><span class='token pointer' id='tok-70-1047'>using</span><span class='token pointer' id='tok-70-1048'>the</span><span class='token pointer' id='tok-70-1049'>script</span><span class='token pointer' id='tok-70-1050'>with</span><span class='token pointer' id='tok-70-1051'>the</span><span class='token pointer' id='tok-70-1052'>default</span><span class='token pointer' id='tok-70-1053'>options</span><span class='token pointer' id='tok-70-1054'>as</span><span class='token pointer' id='tok-70-1055'>shown</span><span class='token pointer' id='tok-70-1056'>below.</span></p>
<p id=p1057><span class='token pointer' id='tok-70-1057'>It</span><span class='token pointer' id='tok-70-1058'>creates</span><span class='token pointer' id='tok-70-1059'>a</span><span class='token pointer' id='tok-70-1060'>file</span><span class='token pointer' id='tok-70-1061'>called</span><span class='token pointer' id='tok-70-1062'>"cloaked.exe"</span><span class='token pointer' id='tok-70-1063'>as</span><span class='token pointer' id='tok-70-1064'>shown</span><span class='token pointer' id='tok-70-1065'>in</span><span class='token pointer' id='tok-70-1066'>the</span><span class='token pointer' id='tok-70-1067'>figure</span><span class='token pointer' id='tok-70-1068'>above.</span></p>
<p id=p1069><span class='token pointer' id='tok-70-1069'>Let's</span><span class='token pointer' id='tok-70-1070'>scan</span><span class='token pointer' id='tok-70-1071'>this</span><span class='token pointer' id='tok-70-1072'>new</span><span class='token pointer' id='tok-70-1073'>payload</span><span class='token pointer' id='tok-70-1074'>and</span><span class='token pointer' id='tok-70-1075'>see</span><span class='token pointer' id='tok-70-1076'>how</span><span class='token pointer' id='tok-70-1077'>many</span><span class='token pointer' id='tok-70-1078'>antivirus</span><span class='token pointer' id='tok-70-1079'>engines</span><span class='token pointer' id='tok-70-1080'>detect</span><span class='token pointer' id='tok-70-1081'>is</span><span class='token pointer' id='tok-70-1082'>as</span><span class='token pointer' id='tok-70-1083'>malicious.</span></p>
<p id=p1084><span class='token pointer' id='tok-70-1084'>Only</span><span class='token pointer' id='tok-70-1085'>26</span><span class='token pointer' id='tok-70-1086'>out</span><span class='token pointer' id='tok-70-1087'>of</span><span class='token pointer' id='tok-70-1088'>56</span><span class='token pointer' id='tok-70-1089'>have</span><span class='token pointer' id='tok-70-1090'>flagged</span><span class='token pointer' id='tok-70-1091'>it</span><span class='token pointer' id='tok-70-1092'>as</span><span class='token pointer' id='tok-70-1093'>malicious.</span></p>
<p id=p1094><span class='token pointer' id='tok-70-1094'>Conclusion:</span><span class='token pointer' id='tok-70-1095'>Apart</span><span class='token pointer' id='tok-70-1096'>from</span><span class='token pointer' id='tok-70-1097'>the</span><span class='token pointer' id='tok-70-1098'>tools</span><span class='token pointer' id='tok-70-1099'>mentioned</span><span class='token pointer' id='tok-70-1100'>in</span><span class='token pointer' id='tok-70-1101'>this</span><span class='token pointer' id='tok-70-1102'>article,</span><span class='token pointer' id='tok-70-1103'>there</span><span class='token pointer' id='tok-70-1104'>are</span><span class='token pointer' id='tok-70-1105'>a</span><span class='token pointer' id='tok-70-1106'>couple</span><span class='token pointer' id='tok-70-1107'>of</span><span class='token pointer' id='tok-70-1108'>other</span><span class='token pointer' id='tok-70-1109'>tools</span><span class='token pointer' id='tok-70-1110'>out</span><span class='token pointer' id='tok-70-1111'>there</span><span class='token pointer' id='tok-70-1112'>such</span><span class='token pointer' id='tok-70-1113'>as</span><span class='token pointer' id='tok-70-1114'>Metasploit's</span><span class='token pointer' id='tok-70-1115'>encoders.</span><span class='token pointer' id='tok-70-1116'>It</span><span class='token pointer' id='tok-70-1117'>is</span><span class='token pointer' id='tok-70-1118'>better</span><span class='token pointer' id='tok-70-1119'>to</span><span class='token pointer' id='tok-70-1120'>write</span><span class='token pointer' id='tok-70-1121'>custom</span><span class='token pointer' id='tok-70-1122'>payloads</span><span class='token pointer' id='tok-70-1123'>and</span><span class='token pointer' id='tok-70-1124'>keep</span><span class='token pointer' id='tok-70-1125'>them</span><span class='token pointer' id='tok-70-1126'>simple</span><span class='token pointer' id='tok-70-1127'>to</span><span class='token pointer' id='tok-70-1128'>be</span><span class='token pointer' id='tok-70-1129'>away</span><span class='token pointer' id='tok-70-1130'>from</span><span class='token pointer' id='tok-70-1131'>Antivirus</span><span class='token pointer' id='tok-70-1132'>detection</span><span class='token pointer' id='tok-70-1133'>rather</span><span class='token pointer' id='tok-70-1134'>than</span><span class='token pointer' id='tok-70-1135'>creating</span><span class='token pointer' id='tok-70-1136'>payloads</span><span class='token pointer' id='tok-70-1137'>using</span><span class='token pointer' id='tok-70-1138'>popular</span><span class='token pointer' id='tok-70-1139'>frameworks.</span><span class='token pointer' id='tok-70-1140'>A</span><span class='token pointer' id='tok-70-1141'>side</span><span class='token pointer' id='tok-70-1142'>note:</span><span class='token pointer' id='tok-70-1143'>The</span><span class='token pointer' id='tok-70-1144'>results</span><span class='token pointer' id='tok-70-1145'>shown</span><span class='token pointer' id='tok-70-1146'>in</span><span class='token pointer' id='tok-70-1147'>this</span><span class='token pointer' id='tok-70-1148'>article</span><span class='token pointer' id='tok-70-1149'>may</span><span class='token pointer' id='tok-70-1150'>change</span><span class='token pointer' id='tok-70-1151'>when</span><span class='token pointer' id='tok-70-1152'>you</span><span class='token pointer' id='tok-70-1153'>read</span><span class='token pointer' id='tok-70-1154'>this</span><span class='token pointer' id='tok-70-1155'>article</span><span class='token pointer' id='tok-70-1156'>as</span><span class='token pointer' id='tok-70-1157'>Antivirus</span><span class='token pointer' id='tok-70-1158'></span><span class='token pointer' id='tok-70-1159'></span><span class='token pointer' id='tok-70-1160'></span><span class='token pointer' id='tok-70-1161'>