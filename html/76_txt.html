<p id=p0><span class='token pointer' id='tok-76-0'>The</span><span class='token pointer' id='tok-76-1'>document</span><span class='token pointer' id='tok-76-2'>below</span><span class='token pointer' id='tok-76-3'>is</span><span class='token pointer' id='tok-76-4'>an</span><span class='token pointer' id='tok-76-5'>initial</span><span class='token pointer' id='tok-76-6'>level</span><span class='token pointer' id='tok-76-7'>analysis</span><span class='token pointer' id='tok-76-8'>of</span><span class='token pointer' id='tok-76-9'>the</span><span class='token pointer' id='tok-76-10'>recent</span><span class='token pointer' id='tok-76-11'>Petya</span><span class='token pointer' id='tok-76-12'>Ransomware</span><span class='token pointer' id='tok-76-13'>(2017).</span><span class='token pointer' id='tok-76-14'>We</span><span class='token pointer' id='tok-76-15'>will</span><span class='token pointer' id='tok-76-16'>also</span><span class='token pointer' id='tok-76-17'>discuss</span><span class='token pointer' id='tok-76-18'>an</span><span class='token pointer' id='tok-76-19'>analysis</span><span class='token pointer' id='tok-76-20'>of</span><span class='token pointer' id='tok-76-21'>a</span><span class='token pointer' id='tok-76-22'>dll</span><span class='token pointer' id='tok-76-23'>variant</span><span class='token pointer' id='tok-76-24'>of</span><span class='token pointer' id='tok-76-25'>the</span><span class='token pointer' id='tok-76-26'>ransomware.</span></p>
<p id=p27><span class='token pointer' id='tok-76-27'>Ransomware</span><span class='token pointer' id='tok-76-28'>Objective:Encrypt</span><span class='token pointer' id='tok-76-29'>the</span><span class='token pointer' id='tok-76-30'>target</span><span class='token pointer' id='tok-76-31'>machine</span><span class='token pointer' id='tok-76-32'>and</span><span class='token pointer' id='tok-76-33'>ask</span><span class='token pointer' id='tok-76-34'>for</span><span class='token pointer' id='tok-76-35'>ransom</span><span class='token pointer' id='tok-76-36'>(in</span><span class='token pointer' id='tok-76-37'>Bitcoins)</span><span class='token pointer' id='tok-76-38'>to</span><span class='token pointer' id='tok-76-39'>decrypt</span><span class='token pointer' id='tok-76-40'>it.</span></p>
<p id=p41><span class='token pointer' id='tok-76-41'>Analysis</span><span class='token pointer' id='tok-76-42'>Objective:First,</span><span class='token pointer' id='tok-76-43'>this</span><span class='token pointer' id='tok-76-44'>document</span><span class='token pointer' id='tok-76-45'>does</span><span class='token pointer' id='tok-76-46'>not</span><span class='token pointer' id='tok-76-47'>contain</span><span class='token pointer' id='tok-76-48'>all</span><span class='token pointer' id='tok-76-49'>of</span><span class='token pointer' id='tok-76-50'>the</span><span class='token pointer' id='tok-76-51'>indicators</span><span class='token pointer' id='tok-76-52'>but</span><span class='token pointer' id='tok-76-53'>will</span><span class='token pointer' id='tok-76-54'>explain</span><span class='token pointer' id='tok-76-55'>the</span><span class='token pointer' id='tok-76-56'>specimen</span><span class='token pointer' id='tok-76-57'>process.</span><span class='token pointer' id='tok-76-58'>The</span><span class='token pointer' id='tok-76-59'>analysis</span><span class='token pointer' id='tok-76-60'>objective</span><span class='token pointer' id='tok-76-61'>is</span><span class='token pointer' id='tok-76-62'>to</span><span class='token pointer' id='tok-76-63'>do</span><span class='token pointer' id='tok-76-64'>some</span><span class='token pointer' id='tok-76-65'>code</span><span class='token pointer' id='tok-76-66'>analysis</span><span class='token pointer' id='tok-76-67'>in</span><span class='token pointer' id='tok-76-68'>a</span><span class='token pointer' id='tok-76-69'>dissembler</span><span class='token pointer' id='tok-76-70'>and</span><span class='token pointer' id='tok-76-71'>then</span><span class='token pointer' id='tok-76-72'>perform</span><span class='token pointer' id='tok-76-73'>a</span><span class='token pointer' id='tok-76-74'>dynamic</span><span class='token pointer' id='tok-76-75'>analysis</span><span class='token pointer' id='tok-76-76'>as</span><span class='token pointer' id='tok-76-77'>well</span><span class='token pointer' id='tok-76-78'>to</span><span class='token pointer' id='tok-76-79'>see</span><span class='token pointer' id='tok-76-80'>artifacts</span><span class='token pointer' id='tok-76-81'>while</span><span class='token pointer' id='tok-76-82'>the</span><span class='token pointer' id='tok-76-83'>malware</span><span class='token pointer' id='tok-76-84'>is</span><span class='token pointer' id='tok-76-85'>in</span><span class='token pointer' id='tok-76-86'>action.</span></p>
<p id=p87><span class='token pointer' id='tok-76-87'>Certificate</span><span class='token pointer' id='tok-76-88'>InformationThe</span><span class='token pointer' id='tok-76-89'>Petya</span><span class='token pointer' id='tok-76-90'>variant</span><span class='token pointer' id='tok-76-91'>is</span><span class='token pointer' id='tok-76-92'>using</span><span class='token pointer' id='tok-76-93'>an</span><span class='token pointer' id='tok-76-94'>expired</span><span class='token pointer' id='tok-76-95'>Microsoft</span><span class='token pointer' id='tok-76-96'>Certificate.</span></p>
<p id=p97><span class='token pointer' id='tok-76-97'>Since</span><span class='token pointer' id='tok-76-98'>the</span><span class='token pointer' id='tok-76-99'>objective</span><span class='token pointer' id='tok-76-100'>of</span><span class='token pointer' id='tok-76-101'>this</span><span class='token pointer' id='tok-76-102'>ransomware</span><span class='token pointer' id='tok-76-103'>is</span><span class='token pointer' id='tok-76-104'>to</span><span class='token pointer' id='tok-76-105'>encrypt</span><span class='token pointer' id='tok-76-106'>the</span><span class='token pointer' id='tok-76-107'>target</span><span class='token pointer' id='tok-76-108'>machine,</span><span class='token pointer' id='tok-76-109'>I</span><span class='token pointer' id='tok-76-110'>prefer</span><span class='token pointer' id='tok-76-111'>to</span><span class='token pointer' id='tok-76-112'>do</span><span class='token pointer' id='tok-76-113'>some</span><span class='token pointer' id='tok-76-114'>static</span><span class='token pointer' id='tok-76-115'>analysis</span><span class='token pointer' id='tok-76-116'>(i.e.</span><span class='token pointer' id='tok-76-117'>to</span><span class='token pointer' id='tok-76-118'>analyze</span><span class='token pointer' id='tok-76-119'>malware</span><span class='token pointer' id='tok-76-120'>without</span><span class='token pointer' id='tok-76-121'>running</span><span class='token pointer' id='tok-76-122'>it)</span><span class='token pointer' id='tok-76-123'>in</span><span class='token pointer' id='tok-76-124'>IDA</span><span class='token pointer' id='tok-76-125'>Pro</span><span class='token pointer' id='tok-76-126'>and</span><span class='token pointer' id='tok-76-127'>check</span><span class='token pointer' id='tok-76-128'>whether</span><span class='token pointer' id='tok-76-129'>we</span><span class='token pointer' id='tok-76-130'>can</span><span class='token pointer' id='tok-76-131'>see</span><span class='token pointer' id='tok-76-132'>any</span><span class='token pointer' id='tok-76-133'>interesting</span><span class='token pointer' id='tok-76-134'>functions.</span></p>
<p id=p135><span class='token pointer' id='tok-76-135'>Static</span><span class='token pointer' id='tok-76-136'>AnalysisDll</span><span class='token pointer' id='tok-76-137'>is</span><span class='token pointer' id='tok-76-138'>loaded</span><span class='token pointer' id='tok-76-139'>into</span><span class='token pointer' id='tok-76-140'>IDA</span><span class='token pointer' id='tok-76-141'>pro,</span><span class='token pointer' id='tok-76-142'>and</span><span class='token pointer' id='tok-76-143'>as</span><span class='token pointer' id='tok-76-144'>expected</span><span class='token pointer' id='tok-76-145'>it</span><span class='token pointer' id='tok-76-146'>stops</span><span class='token pointer' id='tok-76-147'>at</span><span class='token pointer' id='tok-76-148'>dll</span><span class='token pointer' id='tok-76-149'>Entry</span><span class='token pointer' id='tok-76-150'>Point(main()</span><span class='token pointer' id='tok-76-151'>for</span><span class='token pointer' id='tok-76-152'>dll).</span></p>
<p id=p153><span class='token pointer' id='tok-76-153'>The</span><span class='token pointer' id='tok-76-154'>specimen</span><span class='token pointer' id='tok-76-155'>is</span><span class='token pointer' id='tok-76-156'>using</span><span class='token pointer' id='tok-76-157'>the</span><span class='token pointer' id='tok-76-158'>function</span><span class='token pointer' id='tok-76-159'>below,</span><span class='token pointer' id='tok-76-160'>calling</span><span class='token pointer' id='tok-76-161'>CreateToolhelp32snapshot</span><span class='token pointer' id='tok-76-162'>followed</span><span class='token pointer' id='tok-76-163'>by</span><span class='token pointer' id='tok-76-164'>Process32First</span><span class='token pointer' id='tok-76-165'>and</span><span class='token pointer' id='tok-76-166'>Process</span><span class='token pointer' id='tok-76-167'>32</span><span class='token pointer' id='tok-76-168'>Next.</span><span class='token pointer' id='tok-76-169'>This</span><span class='token pointer' id='tok-76-170'>means</span><span class='token pointer' id='tok-76-171'>the</span><span class='token pointer' id='tok-76-172'>specimen</span><span class='token pointer' id='tok-76-173'>is</span><span class='token pointer' id='tok-76-174'>enumerating</span><span class='token pointer' id='tok-76-175'>the</span><span class='token pointer' id='tok-76-176'>victim</span><span class='token pointer' id='tok-76-177'>machine</span><span class='token pointer' id='tok-76-178'>for</span><span class='token pointer' id='tok-76-179'>running</span><span class='token pointer' id='tok-76-180'>processes.</span></p>
<p id=p181><span class='token pointer' id='tok-76-181'>The</span><span class='token pointer' id='tok-76-182'>authors</span><span class='token pointer' id='tok-76-183'>have</span><span class='token pointer' id='tok-76-184'>XOR'ed</span><span class='token pointer' id='tok-76-185'>the</span><span class='token pointer' id='tok-76-186'>Process</span><span class='token pointer' id='tok-76-187'>Names</span><span class='token pointer' id='tok-76-188'>they</span><span class='token pointer' id='tok-76-189'>are</span><span class='token pointer' id='tok-76-190'>reviewing.</span><span class='token pointer' id='tok-76-191'>After</span><span class='token pointer' id='tok-76-192'>a</span><span class='token pointer' id='tok-76-193'>bit</span><span class='token pointer' id='tok-76-194'>of</span><span class='token pointer' id='tok-76-195'>deobfuscation,</span><span class='token pointer' id='tok-76-196'>it</span><span class='token pointer' id='tok-76-197'>turned</span><span class='token pointer' id='tok-76-198'>out</span><span class='token pointer' id='tok-76-199'>that</span><span class='token pointer' id='tok-76-200'>they</span><span class='token pointer' id='tok-76-201'>are</span><span class='token pointer' id='tok-76-202'>checking</span><span class='token pointer' id='tok-76-203'>for</span><span class='token pointer' id='tok-76-204'>the</span><span class='token pointer' id='tok-76-205'>following</span><span class='token pointer' id='tok-76-206'>AVKaspersky,</span><span class='token pointer' id='tok-76-207'>Norton</span><span class='token pointer' id='tok-76-208'>Security,</span><span class='token pointer' id='tok-76-209'>Symantec.Based</span><span class='token pointer' id='tok-76-210'>on</span><span class='token pointer' id='tok-76-211'>SeDebugPrivilege</span><span class='token pointer' id='tok-76-212'>permissions,</span><span class='token pointer' id='tok-76-213'>the</span><span class='token pointer' id='tok-76-214'>malware</span><span class='token pointer' id='tok-76-215'>will</span><span class='token pointer' id='tok-76-216'>call</span><span class='token pointer' id='tok-76-217'>three</span><span class='token pointer' id='tok-76-218'>APIs</span><span class='token pointer' id='tok-76-219'>to</span><span class='token pointer' id='tok-76-220'>encrypt</span><span class='token pointer' id='tok-76-221'>the</span><span class='token pointer' id='tok-76-222'>files</span><span class='token pointer' id='tok-76-223'>using</span><span class='token pointer' id='tok-76-224'>AES</span><span class='token pointer' id='tok-76-225'>encryption</span><span class='token pointer' id='tok-76-226'>in</span><span class='token pointer' id='tok-76-227'>memory.FindFileMapViewOfFileFLushViewOfFileAfter</span><span class='token pointer' id='tok-76-228'>that</span><span class='token pointer' id='tok-76-229'>specimen,</span><span class='token pointer' id='tok-76-230'>it</span><span class='token pointer' id='tok-76-231'>deletes</span><span class='token pointer' id='tok-76-232'>its</span><span class='token pointer' id='tok-76-233'>activities</span><span class='token pointer' id='tok-76-234'>by</span><span class='token pointer' id='tok-76-235'>deleting</span><span class='token pointer' id='tok-76-236'>Setup,</span><span class='token pointer' id='tok-76-237'>System,</span><span class='token pointer' id='tok-76-238'>Security</span><span class='token pointer' id='tok-76-239'>and</span><span class='token pointer' id='tok-76-240'>Application</span><span class='token pointer' id='tok-76-241'>Event</span><span class='token pointer' id='tok-76-242'>Logs</span><span class='token pointer' id='tok-76-243'>using</span><span class='token pointer' id='tok-76-244'>weutil.</span><span class='token pointer' id='tok-76-245'>It</span><span class='token pointer' id='tok-76-246'>also</span><span class='token pointer' id='tok-76-247'>used</span><span class='token pointer' id='tok-76-248'>fsutil</span><span class='token pointer' id='tok-76-249'>to</span><span class='token pointer' id='tok-76-250'>delete</span><span class='token pointer' id='tok-76-251'>the</span><span class='token pointer' id='tok-76-252'>USN</span><span class='token pointer' id='tok-76-253'>change</span><span class='token pointer' id='tok-76-254'>journal(to</span><span class='token pointer' id='tok-76-255'>remove</span><span class='token pointer' id='tok-76-256'>traces</span><span class='token pointer' id='tok-76-257'>of</span><span class='token pointer' id='tok-76-258'>any</span><span class='token pointer' id='tok-76-259'>update</span><span class='token pointer' id='tok-76-260'>to</span><span class='token pointer' id='tok-76-261'>volume.)Notice</span><span class='token pointer' id='tok-76-262'>wevutil</span><span class='token pointer' id='tok-76-263'>cl</span><span class='token pointer' id='tok-76-264'>and</span><span class='token pointer' id='tok-76-265'>fsutil</span><span class='token pointer' id='tok-76-266'>/D</span><span class='token pointer' id='tok-76-267'>command</span><span class='token pointer' id='tok-76-268'>below</span></p>
<p id=p269><span class='token pointer' id='tok-76-269'>For</span><span class='token pointer' id='tok-76-270'>lateral</span><span class='token pointer' id='tok-76-271'>movement,</span><span class='token pointer' id='tok-76-272'>Petya</span><span class='token pointer' id='tok-76-273'>does</span><span class='token pointer' id='tok-76-274'>the</span><span class='token pointer' id='tok-76-275'>following:It</span><span class='token pointer' id='tok-76-276'>tries</span><span class='token pointer' id='tok-76-277'>to</span><span class='token pointer' id='tok-76-278'>make</span><span class='token pointer' id='tok-76-279'>a</span><span class='token pointer' id='tok-76-280'>connection</span><span class='token pointer' id='tok-76-281'>to</span><span class='token pointer' id='tok-76-282'>admin$</span><span class='token pointer' id='tok-76-283'>with</span><span class='token pointer' id='tok-76-284'>a</span><span class='token pointer' id='tok-76-285'>call</span><span class='token pointer' id='tok-76-286'>to</span><span class='token pointer' id='tok-76-287'>WNetAddConnection</span><span class='token pointer' id='tok-76-288'>with</span><span class='token pointer' id='tok-76-289'>a</span><span class='token pointer' id='tok-76-290'>null</span><span class='token pointer' id='tok-76-291'>username</span><span class='token pointer' id='tok-76-292'>and</span><span class='token pointer' id='tok-76-293'>password,</span><span class='token pointer' id='tok-76-294'>which</span><span class='token pointer' id='tok-76-295'>means</span><span class='token pointer' id='tok-76-296'>that</span><span class='token pointer' id='tok-76-297'>specimen</span><span class='token pointer' id='tok-76-298'>is</span><span class='token pointer' id='tok-76-299'>using</span><span class='token pointer' id='tok-76-300'>current</span><span class='token pointer' id='tok-76-301'>user</span><span class='token pointer' id='tok-76-302'>credentials</span><span class='token pointer' id='tok-76-303'>which</span><span class='token pointer' id='tok-76-304'>will</span><span class='token pointer' id='tok-76-305'>exploit</span><span class='token pointer' id='tok-76-306'>shared</span><span class='token pointer' id='tok-76-307'>local</span><span class='token pointer' id='tok-76-308'>administrator</span><span class='token pointer' id='tok-76-309'>accounts.</span></p>
<p id=p310><span class='token pointer' id='tok-76-310'>After</span><span class='token pointer' id='tok-76-311'>the</span><span class='token pointer' id='tok-76-312'>connection</span><span class='token pointer' id='tok-76-313'>is</span><span class='token pointer' id='tok-76-314'>made,</span><span class='token pointer' id='tok-76-315'>the</span><span class='token pointer' id='tok-76-316'>malware</span><span class='token pointer' id='tok-76-317'>will</span><span class='token pointer' id='tok-76-318'>create</span><span class='token pointer' id='tok-76-319'>a</span><span class='token pointer' id='tok-76-320'>copy</span><span class='token pointer' id='tok-76-321'>of</span><span class='token pointer' id='tok-76-322'>itself</span><span class='token pointer' id='tok-76-323'>using</span><span class='token pointer' id='tok-76-324'>CreateFile()</span><span class='token pointer' id='tok-76-325'>and</span><span class='token pointer' id='tok-76-326'>WriteFile()Then</span><span class='token pointer' id='tok-76-327'>the</span><span class='token pointer' id='tok-76-328'>newly</span><span class='token pointer' id='tok-76-329'>created</span><span class='token pointer' id='tok-76-330'>file</span><span class='token pointer' id='tok-76-331'>is</span><span class='token pointer' id='tok-76-332'>executed</span><span class='token pointer' id='tok-76-333'>using</span><span class='token pointer' id='tok-76-334'>an</span><span class='token pointer' id='tok-76-335'>embedded</span><span class='token pointer' id='tok-76-336'>utility</span><span class='token pointer' id='tok-76-337'>which</span><span class='token pointer' id='tok-76-338'>the</span><span class='token pointer' id='tok-76-339'>specimen</span><span class='token pointer' id='tok-76-340'>extracts</span><span class='token pointer' id='tok-76-341'>as</span><span class='token pointer' id='tok-76-342'>dllhost.dat</span><span class='token pointer' id='tok-76-343'>(C:\Windows)</span><span class='token pointer' id='tok-76-344'>on</span><span class='token pointer' id='tok-76-345'>the</span><span class='token pointer' id='tok-76-346'>target</span><span class='token pointer' id='tok-76-347'>system.</span><span class='token pointer' id='tok-76-348'>This</span><span class='token pointer' id='tok-76-349'>dllhost.dat</span><span class='token pointer' id='tok-76-350'>file</span><span class='token pointer' id='tok-76-351'>uses</span><span class='token pointer' id='tok-76-352'>%s</span><span class='token pointer' id='tok-76-353'>-acceptula</span><span class='token pointer' id='tok-76-354'>-s,</span><span class='token pointer' id='tok-76-355'>which</span><span class='token pointer' id='tok-76-356'>is</span><span class='token pointer' id='tok-76-357'>a</span><span class='token pointer' id='tok-76-358'>silent</span><span class='token pointer' id='tok-76-359'>option</span><span class='token pointer' id='tok-76-360'>for</span><span class='token pointer' id='tok-76-361'>PSEXEC.</span><span class='token pointer' id='tok-76-362'>Submitting</span><span class='token pointer' id='tok-76-363'>dllhost.dat</span><span class='token pointer' id='tok-76-364'>files</span><span class='token pointer' id='tok-76-365'>to</span><span class='token pointer' id='tok-76-366'>VirtuTotal</span><span class='token pointer' id='tok-76-367'>reveals</span><span class='token pointer' id='tok-76-368'>it</span><span class='token pointer' id='tok-76-369'>as</span><span class='token pointer' id='tok-76-370'>PSEXEC.If</span><span class='token pointer' id='tok-76-371'>above</span><span class='token pointer' id='tok-76-372'>approach</span><span class='token pointer' id='tok-76-373'>fails,</span><span class='token pointer' id='tok-76-374'>then</span><span class='token pointer' id='tok-76-375'>the</span><span class='token pointer' id='tok-76-376'>malware</span><span class='token pointer' id='tok-76-377'>will</span><span class='token pointer' id='tok-76-378'>try</span><span class='token pointer' id='tok-76-379'>to</span><span class='token pointer' id='tok-76-380'>execute</span><span class='token pointer' id='tok-76-381'>the</span><span class='token pointer' id='tok-76-382'>dllhost.dat</span><span class='token pointer' id='tok-76-383'>file</span><span class='token pointer' id='tok-76-384'>using</span><span class='token pointer' id='tok-76-385'>WMIC.exe.</span></p>
<p id=p386><span class='token pointer' id='tok-76-386'>The</span><span class='token pointer' id='tok-76-387'>specimen</span><span class='token pointer' id='tok-76-388'>also</span><span class='token pointer' id='tok-76-389'>uses</span><span class='token pointer' id='tok-76-390'>DHcpEnumSubnets,</span><span class='token pointer' id='tok-76-391'>DHCPSubnetINfo,</span><span class='token pointer' id='tok-76-392'>DHCPSubnetCLients</span><span class='token pointer' id='tok-76-393'>to</span><span class='token pointer' id='tok-76-394'>enumerate</span><span class='token pointer' id='tok-76-395'>all</span><span class='token pointer' id='tok-76-396'>the</span><span class='token pointer' id='tok-76-397'>clients</span><span class='token pointer' id='tok-76-398'>in</span><span class='token pointer' id='tok-76-399'>the</span><span class='token pointer' id='tok-76-400'>domain.</span></p>
<p id=p401><span class='token pointer' id='tok-76-401'>If</span><span class='token pointer' id='tok-76-402'>the</span><span class='token pointer' id='tok-76-403'>specimen</span><span class='token pointer' id='tok-76-404'>gets</span><span class='token pointer' id='tok-76-405'>SEDebugPrivilege,</span><span class='token pointer' id='tok-76-406'>then</span><span class='token pointer' id='tok-76-407'>the</span><span class='token pointer' id='tok-76-408'>specimen</span><span class='token pointer' id='tok-76-409'>will</span><span class='token pointer' id='tok-76-410'>also</span><span class='token pointer' id='tok-76-411'>access</span><span class='token pointer' id='tok-76-412'>the</span><span class='token pointer' id='tok-76-413'>physical</span><span class='token pointer' id='tok-76-414'>device.The</span><span class='token pointer' id='tok-76-415'>specimen</span><span class='token pointer' id='tok-76-416'>collects</span><span class='token pointer' id='tok-76-417'>all</span><span class='token pointer' id='tok-76-418'>the</span><span class='token pointer' id='tok-76-419'>files</span><span class='token pointer' id='tok-76-420'>as</span><span class='token pointer' id='tok-76-421'>listed</span><span class='token pointer' id='tok-76-422'>below.</span></p>
<p id=p423><span class='token pointer' id='tok-76-423'>Below</span><span class='token pointer' id='tok-76-424'>is</span><span class='token pointer' id='tok-76-425'>some</span><span class='token pointer' id='tok-76-426'>of</span><span class='token pointer' id='tok-76-427'>the</span><span class='token pointer' id='tok-76-428'>text</span><span class='token pointer' id='tok-76-429'>of</span><span class='token pointer' id='tok-76-430'>Petya</span><span class='token pointer' id='tok-76-431'>banner</span><span class='token pointer' id='tok-76-432'>that</span><span class='token pointer' id='tok-76-433'>we</span><span class='token pointer' id='tok-76-434'>will</span><span class='token pointer' id='tok-76-435'>see</span><span class='token pointer' id='tok-76-436'>once</span><span class='token pointer' id='tok-76-437'>the</span><span class='token pointer' id='tok-76-438'>target</span><span class='token pointer' id='tok-76-439'>system</span><span class='token pointer' id='tok-76-440'>is</span><span class='token pointer' id='tok-76-441'>encrypted</span></p>
<p id=p442><span class='token pointer' id='tok-76-442'>Below</span><span class='token pointer' id='tok-76-443'>is</span><span class='token pointer' id='tok-76-444'>the</span><span class='token pointer' id='tok-76-445'>Fake</span><span class='token pointer' id='tok-76-446'>CHKDSK</span><span class='token pointer' id='tok-76-447'>message.</span></p>
<p id=p448><span class='token pointer' id='tok-76-448'>Ethical</span><span class='token pointer' id='tok-76-449'>Hacking</span><span class='token pointer' id='tok-76-450'>Training</span><span class='token pointer' id='tok-76-451'>â€“</span><span class='token pointer' id='tok-76-452'>Resources</span><span class='token pointer' id='tok-76-453'>(InfoSec)</span></p>
<p id=p454><span class='token pointer' id='tok-76-454'>Dynamic</span><span class='token pointer' id='tok-76-455'>AnalysisSince</span><span class='token pointer' id='tok-76-456'>this</span><span class='token pointer' id='tok-76-457'>is</span><span class='token pointer' id='tok-76-458'>a</span><span class='token pointer' id='tok-76-459'>dll,</span><span class='token pointer' id='tok-76-460'>it</span><span class='token pointer' id='tok-76-461'>needs</span><span class='token pointer' id='tok-76-462'>to</span><span class='token pointer' id='tok-76-463'>be</span><span class='token pointer' id='tok-76-464'>run</span><span class='token pointer' id='tok-76-465'>with</span><span class='token pointer' id='tok-76-466'>rundll32</span><span class='token pointer' id='tok-76-467'>like</span><span class='token pointer' id='tok-76-468'>below</span></p>
<p id=p469><span class='token pointer' id='tok-76-469'>As</span><span class='token pointer' id='tok-76-470'>soon</span><span class='token pointer' id='tok-76-471'>as</span><span class='token pointer' id='tok-76-472'>the</span><span class='token pointer' id='tok-76-473'>task</span><span class='token pointer' id='tok-76-474'>is</span><span class='token pointer' id='tok-76-475'>created,</span><span class='token pointer' id='tok-76-476'>it</span><span class='token pointer' id='tok-76-477'>creates</span><span class='token pointer' id='tok-76-478'>a</span><span class='token pointer' id='tok-76-479'>Scheduled</span><span class='token pointer' id='tok-76-480'>task</span><span class='token pointer' id='tok-76-481'>to</span><span class='token pointer' id='tok-76-482'>shut</span><span class='token pointer' id='tok-76-483'>down</span><span class='token pointer' id='tok-76-484'>the</span><span class='token pointer' id='tok-76-485'>system.</span><span class='token pointer' id='tok-76-486'>I</span><span class='token pointer' id='tok-76-487'>have</span><span class='token pointer' id='tok-76-488'>observed</span><span class='token pointer' id='tok-76-489'>that</span><span class='token pointer' id='tok-76-490'>it</span><span class='token pointer' id='tok-76-491'>gives</span><span class='token pointer' id='tok-76-492'>a</span><span class='token pointer' id='tok-76-493'>buffer</span><span class='token pointer' id='tok-76-494'>of</span><span class='token pointer' id='tok-76-495'>around</span><span class='token pointer' id='tok-76-496'>one</span><span class='token pointer' id='tok-76-497'>hour</span><span class='token pointer' id='tok-76-498'>before</span><span class='token pointer' id='tok-76-499'>the</span><span class='token pointer' id='tok-76-500'>scheduled</span><span class='token pointer' id='tok-76-501'>tasks</span><span class='token pointer' id='tok-76-502'>kick</span><span class='token pointer' id='tok-76-503'>in.</span><span class='token pointer' id='tok-76-504'>In</span><span class='token pointer' id='tok-76-505'>this</span><span class='token pointer' id='tok-76-506'>buffer</span><span class='token pointer' id='tok-76-507'>period,</span><span class='token pointer' id='tok-76-508'>malware</span><span class='token pointer' id='tok-76-509'>will</span><span class='token pointer' id='tok-76-510'>get</span><span class='token pointer' id='tok-76-511'>a</span><span class='token pointer' id='tok-76-512'>hold</span><span class='token pointer' id='tok-76-513'>of</span><span class='token pointer' id='tok-76-514'>the</span><span class='token pointer' id='tok-76-515'>whole</span><span class='token pointer' id='tok-76-516'>system</span><span class='token pointer' id='tok-76-517'>and</span><span class='token pointer' id='tok-76-518'>also</span><span class='token pointer' id='tok-76-519'>try</span><span class='token pointer' id='tok-76-520'>to</span><span class='token pointer' id='tok-76-521'>enumerate</span><span class='token pointer' id='tok-76-522'>the</span><span class='token pointer' id='tok-76-523'>network,</span><span class='token pointer' id='tok-76-524'>since</span><span class='token pointer' id='tok-76-525'>just</span><span class='token pointer' id='tok-76-526'>before</span><span class='token pointer' id='tok-76-527'>the</span><span class='token pointer' id='tok-76-528'>shutdown,</span><span class='token pointer' id='tok-76-529'>malware</span><span class='token pointer' id='tok-76-530'>will</span><span class='token pointer' id='tok-76-531'>delete</span><span class='token pointer' id='tok-76-532'>itself</span><span class='token pointer' id='tok-76-533'>and</span><span class='token pointer' id='tok-76-534'>if</span><span class='token pointer' id='tok-76-535'>it</span><span class='token pointer' id='tok-76-536'>immediately</span><span class='token pointer' id='tok-76-537'>shuts</span><span class='token pointer' id='tok-76-538'>itself</span><span class='token pointer' id='tok-76-539'>down,</span><span class='token pointer' id='tok-76-540'>then</span><span class='token pointer' id='tok-76-541'>it</span><span class='token pointer' id='tok-76-542'>misses</span><span class='token pointer' id='tok-76-543'>the</span><span class='token pointer' id='tok-76-544'>chance</span><span class='token pointer' id='tok-76-545'>to</span><span class='token pointer' id='tok-76-546'>spread</span><span class='token pointer' id='tok-76-547'>in</span><span class='token pointer' id='tok-76-548'>the</span><span class='token pointer' id='tok-76-549'>network.4</span></p>
<p id=p550><span class='token pointer' id='tok-76-550'>As</span><span class='token pointer' id='tok-76-551'>stated</span><span class='token pointer' id='tok-76-552'>above,</span><span class='token pointer' id='tok-76-553'>the</span><span class='token pointer' id='tok-76-554'>specimen</span><span class='token pointer' id='tok-76-555'>tries</span><span class='token pointer' id='tok-76-556'>to</span><span class='token pointer' id='tok-76-557'>map</span><span class='token pointer' id='tok-76-558'>admin</span><span class='token pointer' id='tok-76-559'>share</span><span class='token pointer' id='tok-76-560'>to</span><span class='token pointer' id='tok-76-561'>other</span><span class='token pointer' id='tok-76-562'>machines</span><span class='token pointer' id='tok-76-563'>on</span><span class='token pointer' id='tok-76-564'>the</span><span class='token pointer' id='tok-76-565'>network.</span></p>
<p id=p566><span class='token pointer' id='tok-76-566'>Following</span><span class='token pointer' id='tok-76-567'>are</span><span class='token pointer' id='tok-76-568'>the</span><span class='token pointer' id='tok-76-569'>processes</span><span class='token pointer' id='tok-76-570'>created</span><span class='token pointer' id='tok-76-571'>by</span><span class='token pointer' id='tok-76-572'>the</span><span class='token pointer' id='tok-76-573'>specimen.As</span><span class='token pointer' id='tok-76-574'>mentioned</span><span class='token pointer' id='tok-76-575'>above</span><span class='token pointer' id='tok-76-576'>in</span><span class='token pointer' id='tok-76-577'>static</span><span class='token pointer' id='tok-76-578'>analysisIt</span><span class='token pointer' id='tok-76-579'>creates</span><span class='token pointer' id='tok-76-580'>a</span><span class='token pointer' id='tok-76-581'>scheduled</span><span class='token pointer' id='tok-76-582'>taskCreates</span><span class='token pointer' id='tok-76-583'>a</span><span class='token pointer' id='tok-76-584'>tmp</span><span class='token pointer' id='tok-76-585'>file</span><span class='token pointer' id='tok-76-586'>in</span><span class='token pointer' id='tok-76-587'>AppData</span><span class='token pointer' id='tok-76-588'>local</span><span class='token pointer' id='tok-76-589'>folderCreates</span><span class='token pointer' id='tok-76-590'>dllhost.dat</span><span class='token pointer' id='tok-76-591'>file</span><span class='token pointer' id='tok-76-592'>in</span><span class='token pointer' id='tok-76-593'>C:\WindowsI</span><span class='token pointer' id='tok-76-594'>also</span><span class='token pointer' id='tok-76-595'>noticed</span><span class='token pointer' id='tok-76-596'>that</span><span class='token pointer' id='tok-76-597'>the</span><span class='token pointer' id='tok-76-598'>specimen</span><span class='token pointer' id='tok-76-599'>will</span><span class='token pointer' id='tok-76-600'>delete</span><span class='token pointer' id='tok-76-601'>the</span><span class='token pointer' id='tok-76-602'>malicious</span><span class='token pointer' id='tok-76-603'>file</span><span class='token pointer' id='tok-76-604'>(petya.dll)</span><span class='token pointer' id='tok-76-605'>in</span><span class='token pointer' id='tok-76-606'>this</span><span class='token pointer' id='tok-76-607'>case</span><span class='token pointer' id='tok-76-608'>and</span><span class='token pointer' id='tok-76-609'>will</span><span class='token pointer' id='tok-76-610'>copy</span><span class='token pointer' id='tok-76-611'>to</span><span class='token pointer' id='tok-76-612'>C:\Windows.</span><span class='token pointer' id='tok-76-613'>Those</span><span class='token pointer' id='tok-76-614'>who</span><span class='token pointer' id='tok-76-615'>are</span><span class='token pointer' id='tok-76-616'>still</span><span class='token pointer' id='tok-76-617'>following</span><span class='token pointer' id='tok-76-618'>the</span><span class='token pointer' id='tok-76-619'>document</span><span class='token pointer' id='tok-76-620'>will</span><span class='token pointer' id='tok-76-621'>know</span><span class='token pointer' id='tok-76-622'>why</span><span class='token pointer' id='tok-76-623'>I</span><span class='token pointer' id='tok-76-624'>mentioned</span><span class='token pointer' id='tok-76-625'>this</span><span class='token pointer' id='tok-76-626'>point.</span><span class='token pointer' id='tok-76-627'>(Later</span><span class='token pointer' id='tok-76-628'>in</span><span class='token pointer' id='tok-76-629'>Kill</span><span class='token pointer' id='tok-76-630'>Switch)</span></p>
<p id=p631><span class='token pointer' id='tok-76-631'>There</span><span class='token pointer' id='tok-76-632'>are</span><span class='token pointer' id='tok-76-633'>a</span><span class='token pointer' id='tok-76-634'>whole</span><span class='token pointer' id='tok-76-635'>lot</span><span class='token pointer' id='tok-76-636'>of</span><span class='token pointer' id='tok-76-637'>CreateFile</span><span class='token pointer' id='tok-76-638'>events</span><span class='token pointer' id='tok-76-639'>by</span><span class='token pointer' id='tok-76-640'>this</span><span class='token pointer' id='tok-76-641'>specimen</span><span class='token pointer' id='tok-76-642'>since</span><span class='token pointer' id='tok-76-643'>it</span><span class='token pointer' id='tok-76-644'>needs</span><span class='token pointer' id='tok-76-645'>to</span><span class='token pointer' id='tok-76-646'>get</span><span class='token pointer' id='tok-76-647'>hold</span><span class='token pointer' id='tok-76-648'>of</span><span class='token pointer' id='tok-76-649'>the</span><span class='token pointer' id='tok-76-650'>files</span><span class='token pointer' id='tok-76-651'>in</span><span class='token pointer' id='tok-76-652'>the</span><span class='token pointer' id='tok-76-653'>system</span><span class='token pointer' id='tok-76-654'>to</span><span class='token pointer' id='tok-76-655'>encrypt.After</span><span class='token pointer' id='tok-76-656'>the</span><span class='token pointer' id='tok-76-657'>scheduled</span><span class='token pointer' id='tok-76-658'>tasks</span><span class='token pointer' id='tok-76-659'>kick</span><span class='token pointer' id='tok-76-660'>in,</span><span class='token pointer' id='tok-76-661'>then</span><span class='token pointer' id='tok-76-662'>as</span><span class='token pointer' id='tok-76-663'>expected</span><span class='token pointer' id='tok-76-664'>the</span><span class='token pointer' id='tok-76-665'>FAKECHKDSK</span><span class='token pointer' id='tok-76-666'>message</span><span class='token pointer' id='tok-76-667'>will</span><span class='token pointer' id='tok-76-668'>appear.</span></p>
<p id=p669><span class='token pointer' id='tok-76-669'>Defeating</span><span class='token pointer' id='tok-76-670'>Petya</span><span class='token pointer' id='tok-76-671'>process(trial)I</span><span class='token pointer' id='tok-76-672'>thought</span><span class='token pointer' id='tok-76-673'>to</span><span class='token pointer' id='tok-76-674'>try</span><span class='token pointer' id='tok-76-675'>a</span><span class='token pointer' id='tok-76-676'>couple</span><span class='token pointer' id='tok-76-677'>of</span><span class='token pointer' id='tok-76-678'>techniques</span><span class='token pointer' id='tok-76-679'>to</span><span class='token pointer' id='tok-76-680'>avoid</span><span class='token pointer' id='tok-76-681'>either</span><span class='token pointer' id='tok-76-682'>the</span><span class='token pointer' id='tok-76-683'>encryption</span><span class='token pointer' id='tok-76-684'>process</span><span class='token pointer' id='tok-76-685'>or</span><span class='token pointer' id='tok-76-686'>to</span><span class='token pointer' id='tok-76-687'>stop</span><span class='token pointer' id='tok-76-688'>the</span><span class='token pointer' id='tok-76-689'>malware</span><span class='token pointer' id='tok-76-690'>from</span><span class='token pointer' id='tok-76-691'>running</span><span class='token pointer' id='tok-76-692'>altogether.</span></p>
<p id=p693><span class='token pointer' id='tok-76-693'>I</span><span class='token pointer' id='tok-76-694'>tried</span><span class='token pointer' id='tok-76-695'>using</span><span class='token pointer' id='tok-76-696'>the</span><span class='token pointer' id='tok-76-697'>Cisco</span><span class='token pointer' id='tok-76-698'>MBRFilter</span><span class='token pointer' id='tok-76-699'>driver</span><span class='token pointer' id='tok-76-700'>utility</span><span class='token pointer' id='tok-76-701'>which</span><span class='token pointer' id='tok-76-702'>per</span><span class='token pointer' id='tok-76-703'>Cisco</span><span class='token pointer' id='tok-76-704'>will</span><span class='token pointer' id='tok-76-705'>prevent</span><span class='token pointer' id='tok-76-706'>any</span><span class='token pointer' id='tok-76-707'>attempts</span><span class='token pointer' id='tok-76-708'>to</span><span class='token pointer' id='tok-76-709'>overwrite</span><span class='token pointer' id='tok-76-710'>MBR</span><span class='token pointer' id='tok-76-711'>record.</span></p>
<p id=p712><span class='token pointer' id='tok-76-712'>This</span><span class='token pointer' id='tok-76-713'>did</span><span class='token pointer' id='tok-76-714'>not</span><span class='token pointer' id='tok-76-715'>work</span><span class='token pointer' id='tok-76-716'>for</span><span class='token pointer' id='tok-76-717'>me,</span><span class='token pointer' id='tok-76-718'>and</span><span class='token pointer' id='tok-76-719'>Petya</span><span class='token pointer' id='tok-76-720'>successfully</span><span class='token pointer' id='tok-76-721'>encrypted</span><span class='token pointer' id='tok-76-722'>my</span><span class='token pointer' id='tok-76-723'>system</span><span class='token pointer' id='tok-76-724'>even</span><span class='token pointer' id='tok-76-725'>with</span><span class='token pointer' id='tok-76-726'>this</span><span class='token pointer' id='tok-76-727'>driver</span><span class='token pointer' id='tok-76-728'>running</span><span class='token pointer' id='tok-76-729'>L.</span></p>
<p id=p730><span class='token pointer' id='tok-76-730'>There</span><span class='token pointer' id='tok-76-731'>is</span><span class='token pointer' id='tok-76-732'>some</span><span class='token pointer' id='tok-76-733'>news</span><span class='token pointer' id='tok-76-734'>of</span><span class='token pointer' id='tok-76-735'>a</span><span class='token pointer' id='tok-76-736'>Kill</span><span class='token pointer' id='tok-76-737'>Switch</span><span class='token pointer' id='tok-76-738'>of</span><span class='token pointer' id='tok-76-739'>Petya</span><span class='token pointer' id='tok-76-740'>of</span><span class='token pointer' id='tok-76-741'>including</span><span class='token pointer' id='tok-76-742'>perfc</span><span class='token pointer' id='tok-76-743'>file</span><span class='token pointer' id='tok-76-744'>in</span><span class='token pointer' id='tok-76-745'>C:\Windows\</span><span class='token pointer' id='tok-76-746'>directory.</span><span class='token pointer' id='tok-76-747'>I</span><span class='token pointer' id='tok-76-748'>blindly</span><span class='token pointer' id='tok-76-749'>followed</span><span class='token pointer' id='tok-76-750'>the</span><span class='token pointer' id='tok-76-751'>news</span><span class='token pointer' id='tok-76-752'>and</span><span class='token pointer' id='tok-76-753'>created</span><span class='token pointer' id='tok-76-754'>following</span><span class='token pointer' id='tok-76-755'>perfc*</span><span class='token pointer' id='tok-76-756'>app</span><span class='token pointer' id='tok-76-757'>files</span><span class='token pointer' id='tok-76-758'>in</span><span class='token pointer' id='tok-76-759'>read</span><span class='token pointer' id='tok-76-760'>only</span><span class='token pointer' id='tok-76-761'>mode.But</span><span class='token pointer' id='tok-76-762'>it</span><span class='token pointer' id='tok-76-763'>did</span><span class='token pointer' id='tok-76-764'>not</span><span class='token pointer' id='tok-76-765'>work,</span><span class='token pointer' id='tok-76-766'>and</span><span class='token pointer' id='tok-76-767'>Petya</span><span class='token pointer' id='tok-76-768'>again</span><span class='token pointer' id='tok-76-769'>encrypted</span><span class='token pointer' id='tok-76-770'>my</span><span class='token pointer' id='tok-76-771'>device.</span><span class='token pointer' id='tok-76-772'>Reading</span><span class='token pointer' id='tok-76-773'>the</span><span class='token pointer' id='tok-76-774'>code</span><span class='token pointer' id='tok-76-775'>reveals</span><span class='token pointer' id='tok-76-776'>that</span><span class='token pointer' id='tok-76-777'>the</span><span class='token pointer' id='tok-76-778'>specimen</span><span class='token pointer' id='tok-76-779'>is</span><span class='token pointer' id='tok-76-780'>looking</span><span class='token pointer' id='tok-76-781'>for</span><span class='token pointer' id='tok-76-782'>the</span><span class='token pointer' id='tok-76-783'>exact</span><span class='token pointer' id='tok-76-784'>same</span><span class='token pointer' id='tok-76-785'>file</span><span class='token pointer' id='tok-76-786'>which</span><span class='token pointer' id='tok-76-787'>is</span><span class='token pointer' id='tok-76-788'>run</span><span class='token pointer' id='tok-76-789'>as</span><span class='token pointer' id='tok-76-790'>a</span><span class='token pointer' id='tok-76-791'>specimen.</span><span class='token pointer' id='tok-76-792'>In</span><span class='token pointer' id='tok-76-793'>our</span><span class='token pointer' id='tok-76-794'>case</span><span class='token pointer' id='tok-76-795'>it</span><span class='token pointer' id='tok-76-796'>is</span><span class='token pointer' id='tok-76-797'>petya.dll.</span><span class='token pointer' id='tok-76-798'>So</span><span class='token pointer' id='tok-76-799'>I</span><span class='token pointer' id='tok-76-800'>created</span><span class='token pointer' id='tok-76-801'>a</span><span class='token pointer' id='tok-76-802'>new</span><span class='token pointer' id='tok-76-803'>Petya.dll</span><span class='token pointer' id='tok-76-804'>app</span><span class='token pointer' id='tok-76-805'>file</span><span class='token pointer' id='tok-76-806'>and</span><span class='token pointer' id='tok-76-807'>make</span><span class='token pointer' id='tok-76-808'>it</span><span class='token pointer' id='tok-76-809'>read</span><span class='token pointer' id='tok-76-810'>only</span></p>
<p id=p811><span class='token pointer' id='tok-76-811'>And</span><span class='token pointer' id='tok-76-812'>this</span><span class='token pointer' id='tok-76-813'>time</span><span class='token pointer' id='tok-76-814'>it</span><span class='token pointer' id='tok-76-815'>worked.</span><span class='token pointer' id='tok-76-816'>I</span><span class='token pointer' id='tok-76-817'>could</span><span class='token pointer' id='tok-76-818'>see</span><span class='token pointer' id='tok-76-819'>the</span><span class='token pointer' id='tok-76-820'>malware</span><span class='token pointer' id='tok-76-821'>process</span><span class='token pointer' id='tok-76-822'>created</span><span class='token pointer' id='tok-76-823'>but</span><span class='token pointer' id='tok-76-824'>then</span><span class='token pointer' id='tok-76-825'>deleted</span><span class='token pointer' id='tok-76-826'>itself</span><span class='token pointer' id='tok-76-827'>after</span><span class='token pointer' id='tok-76-828'>it</span><span class='token pointer' id='tok-76-829'>saw</span><span class='token pointer' id='tok-76-830'>the</span><span class='token pointer' id='tok-76-831'>existence</span><span class='token pointer' id='tok-76-832'>of</span><span class='token pointer' id='tok-76-833'>petya.dll.</span><span class='token pointer' id='tok-76-834'>There</span><span class='token pointer' id='tok-76-835'>was</span><span class='token pointer' id='tok-76-836'>no</span><span class='token pointer' id='tok-76-837'>creation</span><span class='token pointer' id='tok-76-838'>of</span><span class='token pointer' id='tok-76-839'>a</span><span class='token pointer' id='tok-76-840'>scheduled</span><span class='token pointer' id='tok-76-841'>task</span><span class='token pointer' id='tok-76-842'>as</span><span class='token pointer' id='tok-76-843'>is</span><span class='token pointer' id='tok-76-844'>mentioned</span><span class='token pointer' id='tok-76-845'>above.</span></p>
<p id=p846><span class='token pointer' id='tok-76-846'>To</span><span class='token pointer' id='tok-76-847'>be</span><span class='token pointer' id='tok-76-848'>on</span><span class='token pointer' id='tok-76-849'>the</span><span class='token pointer' id='tok-76-850'>safe</span><span class='token pointer' id='tok-76-851'>side,</span><span class='token pointer' id='tok-76-852'>I</span><span class='token pointer' id='tok-76-853'>restarted</span><span class='token pointer' id='tok-76-854'>my</span><span class='token pointer' id='tok-76-855'>system,</span><span class='token pointer' id='tok-76-856'>and</span><span class='token pointer' id='tok-76-857'>it</span><span class='token pointer' id='tok-76-858'>came</span><span class='token pointer' id='tok-76-859'>back</span><span class='token pointer' id='tok-76-860'>in</span><span class='token pointer' id='tok-76-861'>good</span><span class='token pointer' id='tok-76-862'>shape.</span></p>
<p id=p863><span class='token pointer' id='tok-76-863'>So,</span><span class='token pointer' id='tok-76-864'>this</span><span class='token pointer' id='tok-76-865'>is</span><span class='token pointer' id='tok-76-866'>the</span><span class='token pointer' id='tok-76-867'>initial</span><span class='token pointer' id='tok-76-868'>Analysis.</span><span class='token pointer' id='tok-76-869'>I</span><span class='token pointer' id='tok-76-870'>will</span><span class='token pointer' id='tok-76-871'>work</span><span class='token pointer' id='tok-76-872'>on</span><span class='token pointer' id='tok-76-873'>the</span><span class='token pointer' id='tok-76-874'>credential</span><span class='token pointer' id='tok-76-875'>extraction</span><span class='token pointer' id='tok-76-876'>process</span><span class='token pointer' id='tok-76-877'>in</span><span class='token pointer' id='tok-76-878'>this</span><span class='token pointer' id='tok-76-879'>malware</span><span class='token pointer' id='tok-76-880'>and</span><span class='token pointer' id='tok-76-881'>will</span><span class='token pointer' id='tok-76-882'>also</span><span class='token pointer' id='tok-76-883'>review</span><span class='token pointer' id='tok-76-884'>what</span><span class='token pointer' id='tok-76-885'>stack</span><span class='token pointer' id='tok-76-886'>parameters</span><span class='token pointer' id='tok-76-887'>can</span><span class='token pointer' id='tok-76-888'>be</span><span class='token pointer' id='tok-76-889'>seen</span><span class='token pointer' id='tok-76-890'>in</span><span class='token pointer' id='tok-76-891'>the</span><span class='token pointer' id='tok-76-892'>debugger.</span></p>
<p id=p893><span class='token pointer' id='tok-76-893'></span><span class='token pointer' id='tok-76-894'></span><span class='token pointer' id='tok-76-895'></span><span class='token pointer' id='tok-76-896'></span><span class='token pointer' id='tok-76-897'></span><span class='token pointer' id='tok-76-898'>