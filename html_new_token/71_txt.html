<p id=p0><span id='tok'>This</span><span id='tok'>challenge</span><span id='tok'>includes</span><span id='tok'>a</span><span class='token pointer' id='tok-71-0' style='color:red'>application</span><span class='token pointer' id='tok-71-1' style='color:red'>web</span><span id='tok'>designed</span><span id='tok'>for</span><span class='token pointer' id='tok-71-2' style='color:red'>image hosting.</span><span id='tok'>application</span><span id='tok'>has</span><span id='tok'>a</span><span id='tok'>few</span><span class='token pointer' id='tok-71-3' style='color:red'>vulnerabilities.</span><span id='tok'>The</span><span id='tok'>challenge</span><span id='tok'>is</span><span id='tok'>to</span><span id='tok'>exploit</span><span id='tok'>the</span><span class='token pointer' id='tok-71-4' style='color:red'>application's</span><span id='tok'>vulnerability</span><span id='tok'>and</span><span id='tok'>find</span><span id='tok'>the</span><span id='tok'>hidden</span><span id='tok'>message</span><span id='tok'>for</span><span id='tok'>a</span><span id='tok'>date</span><span id='tok'>arrangement</span><span id='tok'>that</span><span id='tok'>Bob</span><span id='tok'>sent</span><span id='tok'>to</span><span id='tok'>Alice.</span></p><p id=p39><span class='token pointer' id='tok-71-5' style='color:red'>virtual</span><span class='token pointer' id='tok-71-6' style='color:red'>machine</span><span class='token pointer' id='tok-71-7' style='color:red'>Host the</span><span id='tok'>let's</span><span id='tok'>start</span><span id='tok'>by</span><span id='tok'>identifying</span><span id='tok'>the</span><span id='tok'>target</span><span class='token pointer' id='tok-71-8' style='color:red'>IP.</span><span id='tok'>We</span><span id='tok'>will</span><span id='tok'>run</span><span id='tok'>an</span><span class='token pointer' id='tok-71-9' style='color:red'>Nmap ping scan</span><span id='tok'>detecting</span><span id='tok'>all</span><span id='tok'>live</span><span id='tok'>hosts.</span></p><p id=p63><span id='tok'>As</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>above</span><span id='tok'>figure,</span><span class='token pointer' id='tok-71-10' style='color:red'>nmap</span><span id='tok'>detected</span><span id='tok'>three</span><span id='tok'>hosts:</span><span id='tok'>The</span><span id='tok'>IP</span><span id='tok'>192.168.0.1</span><span id='tok'>is</span><span id='tok'>my</span><span id='tok'>router,</span><span id='tok'>the</span><span id='tok'>IP</span><span id='tok'>192.168.0.100</span><span id='tok'>is</span><span id='tok'>my</span><span id='tok'>system's</span><span id='tok'>IP,</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>IP</span><span id='tok'>192.168.0.103</span><span id='tok'>is</span><span id='tok'>our</span><span id='tok'>target.</span><span id='tok'>Try</span><span id='tok'>to</span><span id='tok'>open</span><span id='tok'>this</span><span id='tok'>IP</span><span id='tok'>from</span><span id='tok'>browser.</span></p><p id=p101><span id='tok'>There</span><span id='tok'>is</span><span id='tok'>an</span><span id='tok'>application</span><span id='tok'>that</span><span id='tok'>seems</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>for</span><span id='tok'>image</span><span id='tok'>hosting.</span><span id='tok'>First,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>start</span><span class='token pointer' id='tok-71-11' style='color:red'>enumerating</span><span id='tok'>the</span><span id='tok'>whole</span><span id='tok'>application</span><span id='tok'>try</span><span id='tok'>to</span><span id='tok'>find</span><span id='tok'>all</span><span id='tok'>possible</span><span id='tok'>URLs</span><span id='tok'>of</span><span id='tok'>this</span><span id='tok'>application.</span><span id='tok'>For</span><span class='token pointer' id='tok-71-12' style='color:red'>enumeration</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>use</span></p><p id=p138><span id='tok'>After</span><span class='token pointer' id='tok-71-13' style='color:red'>spidering</span><span id='tok'>the</span><span id='tok'>application,</span><span id='tok'>we</span><span id='tok'>now</span><span id='tok'>have</span><span id='tok'>some</span><span id='tok'>internal</span><span id='tok'>URLs</span><span id='tok'>for</span><span id='tok'>the</span><span id='tok'>application.</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>some</span><span class='token pointer' id='tok-71-14' style='color:red'>PHP</span><span id='tok'>files</span><span id='tok'>over</span><span id='tok'>there.</span><span id='tok'>The</span><span id='tok'>upload.php</span><span id='tok'>file</span><span id='tok'>is</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>file</span><span id='tok'>upload</span><span id='tok'>functionality,</span><span id='tok'>but</span><span id='tok'>what</span><span id='tok'>is</span><span id='tok'>that</span><span id='tok'>myphp.php</span><span id='tok'>file?</span><span id='tok'>Let's</span><span id='tok'>find</span><span id='tok'>out</span><span id='tok'>what</span><span id='tok'>is</span><span id='tok'>hidden</span><span id='tok'>in</span><span id='tok'>that</span><span id='tok'>page.</span><span id='tok'>Open</span><span id='tok'>the</span><span id='tok'>URL</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>browser</span><span id='tok'>and</span><span id='tok'>add</span><span id='tok'>an</span><span id='tok'>id</span><span class='token pointer' id='tok-71-15' style='color:red'>parameter</span><span id='tok'>with</span><span id='tok'>some</span><span id='tok'>integer</span><span id='tok'>value.</span><span id='tok'>For</span><span id='tok'>example,</span><span id='tok'>we</span><span id='tok'>added</span><span id='tok'>id=100</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>URL</span><span id='tok'>looks</span><span id='tok'>like</span><span id='tok'>this:</span><span id='tok'>http://192.168.0.103:8880/myphp?id=100</span></p><p id=p210><span id='tok'>The</span><span id='tok'>application</span><span id='tok'>is</span><span id='tok'>showing</span><span id='tok'>a</span><span id='tok'>message,</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>giving</span><span id='tok'>us</span><span id='tok'>a</span><span id='tok'>hint</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>should</span><span id='tok'>dig</span><span id='tok'>more.</span><span id='tok'>Let's</span><span id='tok'>try</span><span id='tok'>some</span><span id='tok'>more</span><span id='tok'>values</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>id</span><span id='tok'>parameter;</span><span id='tok'>this</span><span id='tok'>time,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>pass</span><span id='tok'>101</span><span id='tok'>as</span><span id='tok'>the</span><span id='tok'>id</span><span id='tok'>parameter.</span></p><p id=p246><span id='tok'>The</span><span id='tok'>PHP</span><span id='tok'>version</span><span id='tok'>disclosed</span><span id='tok'>some</span><span id='tok'>sensitive</span><span id='tok'>information.</span><span id='tok'>Try</span><span id='tok'>with</span><span id='tok'>another</span><span id='tok'>value,</span><span id='tok'>like</span><span id='tok'>102:</span></p><p id=p259><span id='tok'>No</span><span id='tok'>such</span><span id='tok'>information</span><span id='tok'>is</span><span id='tok'>showing,</span><span id='tok'>only</span><span id='tok'>a</span><span class='token pointer' id='tok-71-16' style='color:red'>"PHP Credits"</span><span id='tok'>Change</span><span id='tok'>the</span><span id='tok'>id</span><span id='tok'>value</span><span id='tok'>to</span><span id='tok'>104:</span></p><p id=p275><span id='tok'>Now</span><span id='tok'>this</span><span id='tok'>time</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>some</span><span id='tok'>juicy</span><span id='tok'>information;</span><span id='tok'>the</span><span id='tok'>full</span><span id='tok'>PHP</span><span id='tok'>configuration</span><span id='tok'>is</span><span id='tok'>disclosed.</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>all</span><span id='tok'>PHP</span><span id='tok'>functions</span><span id='tok'>that</span><span id='tok'>are</span><span id='tok'>disabled</span><span id='tok'>from</span><span id='tok'>configuration</span><span id='tok'>file.</span><span id='tok'>Again</span><span id='tok'>we</span><span id='tok'>changed</span><span id='tok'>the</span><span id='tok'>id</span><span id='tok'>value</span><span id='tok'>to</span><span id='tok'>108.</span></p><p id=p309><span id='tok'>Ethical</span><span class='token pointer' id='tok-71-17' style='color:red'>Hacking</span><span id='tok'>Boot</span><span id='tok'>Camp</span><span id='tok'>â€”</span><span id='tok'>93%</span><span id='tok'>Exam</span><span id='tok'>Pass</span><span id='tok'>Rate</span></p><p id=p318><span id='tok'>This</span><span id='tok'>time</span><span id='tok'>we</span><span id='tok'>get</span><span id='tok'>the</span><span id='tok'>Apache</span><span class='token pointer' id='tok-71-18' style='color:red'>server</span><span id='tok'>details,</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>version,</span><span id='tok'>installed</span><span id='tok'>modules,</span><span id='tok'>etc.</span><span id='tok'>That</span><span id='tok'>is</span><span id='tok'>enough</span><span id='tok'>for</span><span id='tok'>our</span><span id='tok'>enumeration</span><span id='tok'>phase;</span><span id='tok'>we</span><span id='tok'>now</span><span id='tok'>have</span><span id='tok'>much</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>our</span><span id='tok'>target.</span><span id='tok'>Now</span><span id='tok'>go</span><span id='tok'>back</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>home</span><span id='tok'>page</span><span id='tok'>and</span><span id='tok'>try</span><span id='tok'>out</span><span id='tok'>the</span><span id='tok'>application's</span><span id='tok'>functionality</span><span id='tok'>to</span><span id='tok'>see</span><span id='tok'>how</span><span id='tok'>it</span><span id='tok'>works?</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>that</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>file</span><span id='tok'>upload</span><span id='tok'>functionality</span><span id='tok'>there,</span><span id='tok'>so</span><span id='tok'>try</span><span id='tok'>to</span><span id='tok'>upload</span><span id='tok'>an</span><span id='tok'>image</span><span id='tok'>file.</span></p><p id=p386><span id='tok'>For</span><span id='tok'>an</span><span id='tok'>example,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>upload</span><span id='tok'>an</span><span id='tok'>image</span><span id='tok'>named</span><span id='tok'>fishy.jpg.</span><span id='tok'>After</span><span id='tok'>successfully</span><span id='tok'>uploading</span><span id='tok'>the</span><span id='tok'>image,</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>redirect</span><span id='tok'>to</span><span id='tok'>image.php</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>showing</span><span id='tok'>our</span><span id='tok'>uploaded</span><span id='tok'>image.</span></p><p id=p412><span id='tok'>Let's</span><span id='tok'>check</span><span id='tok'>out</span><span id='tok'>the</span><span class='token pointer' id='tok-71-19' style='color:red'>source code</span><span id='tok'>the</span><span id='tok'>page</span><span id='tok'>from</span><span id='tok'>which</span><span id='tok'>the</span><span id='tok'>image</span><span id='tok'>comes.</span><span id='tok'>Right-click</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>browser</span><span id='tok'>and</span><span id='tok'>select</span><span id='tok'>"View</span><span id='tok'>Source."</span></p><p id=p434><span id='tok'>As</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>above,</span><span id='tok'>the</span><span id='tok'>uploaded</span><span id='tok'>image</span><span id='tok'>is</span><span id='tok'>coming</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>images</span><span id='tok'>directory</span><span id='tok'>and</span><span id='tok'>our</span><span id='tok'>uploaded</span><span id='tok'>image</span><span id='tok'>name</span><span id='tok'>is</span><span id='tok'>changed</span><span id='tok'>to</span><span id='tok'>some</span><span id='tok'>kind</span><span id='tok'>of</span><span id='tok'>hash</span><span id='tok'>value.</span><span id='tok'>We</span><span id='tok'>identified</span><span id='tok'>that</span><span id='tok'>this</span><span id='tok'>is</span><span id='tok'>a</span><span class='token pointer' id='tok-71-20' style='color:red'>MD5 Hash</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>32</span><span id='tok'>bytes</span><span id='tok'>long</span><span id='tok'>and</span><span id='tok'>contains</span><span id='tok'>only</span><span id='tok'>numbers</span><span id='tok'>and</span><span id='tok'>a-f</span><span id='tok'>characters.</span><span id='tok'>So</span><span id='tok'>let's</span><span id='tok'>verify</span><span id='tok'>that</span><span id='tok'>this</span><span id='tok'>MD5</span><span id='tok'>hash</span><span id='tok'>value</span><span id='tok'>matches</span><span id='tok'>with</span><span id='tok'>our</span><span id='tok'>file</span><span id='tok'>name.</span><span id='tok'>First,</span><span id='tok'>we</span><span id='tok'>calculate</span><span id='tok'>the</span><span id='tok'>MD5</span><span id='tok'>value</span><span id='tok'>for</span><span id='tok'>"fishy"</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>output</span><span id='tok'>was</span><span id='tok'>"29c3a60c13d1e0eda25d65f65a761b47";</span><span id='tok'>this</span><span id='tok'>value</span><span id='tok'>does</span><span id='tok'>not</span><span id='tok'>match</span><span id='tok'>the</span><span id='tok'>current</span><span id='tok'>value.</span><span id='tok'>Next,</span><span id='tok'>we</span><span id='tok'>use</span><span id='tok'>the</span><span id='tok'>full</span><span id='tok'>name</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>file,</span><span id='tok'>"fishy.jpg,"</span><span id='tok'>and</span><span id='tok'>calculate</span><span id='tok'>the</span><span id='tok'>MD5</span><span id='tok'>hash</span><span id='tok'>value;</span><span id='tok'>the</span><span id='tok'>output</span><span id='tok'>is</span><span id='tok'>"e1a9d5f33b65b29243ca47bd3f5fd3af,"</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>correct</span><span id='tok'>value.</span></p><p id=p541><span id='tok'>fishy</span><span id='tok'>=</span><span id='tok'>29c3a60c13d1e0eda25d65f65a761b47</span><span id='tok'>fishy.jpg</span><span id='tok'>=</span><span id='tok'>e1a9d5f33b65b29243ca47bd3f5fd3af</span></p><p id=p547><span id='tok'>It</span><span id='tok'>means</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>calculates</span><span id='tok'>the</span><span id='tok'>MD5</span><span id='tok'>hash</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>full</span><span id='tok'>file</span><span id='tok'>name,</span><span id='tok'>including</span><span id='tok'>the</span><span id='tok'>extension.</span></p><p id=p563><span id='tok'>Now</span><span id='tok'>we</span><span id='tok'>know</span><span id='tok'>where</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>stores</span><span id='tok'>an</span><span id='tok'>uploaded</span><span id='tok'>file</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>name</span><span id='tok'>it</span><span id='tok'>uses.</span><span id='tok'>Let's</span><span id='tok'>try</span><span id='tok'>to</span><span id='tok'>upload</span><span id='tok'>a</span><span id='tok'>PHP</span><span id='tok'>file.</span></p><p id=p585><span id='tok'>It</span><span id='tok'>does</span><span id='tok'>not</span><span id='tok'>allow</span><span id='tok'>us</span><span id='tok'>to</span><span id='tok'>upload</span><span id='tok'>a</span><span id='tok'>PHP</span><span id='tok'>file.</span><span id='tok'>We</span><span id='tok'>tried</span><span id='tok'>some</span><span id='tok'>different</span><span id='tok'>techniques</span><span id='tok'>to</span><span id='tok'>bypass</span><span id='tok'>this</span><span id='tok'>restriction.</span><span id='tok'>Finally,</span><span id='tok'>we</span><span id='tok'>added</span><span id='tok'>a</span><span id='tok'>double</span><span id='tok'>file</span><span id='tok'>extension</span><span id='tok'>like</span><span id='tok'>this:</span><span id='tok'>"k.jpg.php"</span><span id='tok'>and</span><span id='tok'>tried</span><span id='tok'>to</span><span id='tok'>upload</span><span id='tok'>it.</span></p><p id=p619><span id='tok'>The</span><span id='tok'>file</span><span id='tok'>is</span><span id='tok'>successfully</span><span id='tok'>uploaded.</span><span id='tok'>But</span><span id='tok'>we</span><span id='tok'>can't</span><span id='tok'>see</span><span id='tok'>any</span><span id='tok'>image.</span></p><p id=p630><span id='tok'>We</span><span id='tok'>checked</span><span id='tok'>the</span><span id='tok'>source</span><span id='tok'>code</span><span id='tok'>and</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>nothing:</span></p><p id=p639><span id='tok'>But</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>no</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>worry.</span><span id='tok'>We</span><span id='tok'>know</span><span id='tok'>where</span><span id='tok'>our</span><span id='tok'>image</span><span id='tok'>is</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>current</span><span id='tok'>name</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>PHP</span><span id='tok'>file.</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>access</span><span id='tok'>our</span><span id='tok'>PHP</span><span id='tok'>file</span><span id='tok'>by</span><span id='tok'>changing</span><span id='tok'>the</span><span id='tok'>file</span><span id='tok'>name</span><span id='tok'>into</span><span id='tok'>a</span><span id='tok'>MD5</span><span id='tok'>hash.</span><span id='tok'>First,</span><span id='tok'>calculate</span><span id='tok'>the</span><span id='tok'>MD5</span><span id='tok'>for</span><span id='tok'>k.jpg.php:</span></p><p id=p681><span id='tok'>Now</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>the</span><span id='tok'>MD5</span><span id='tok'>hash;</span><span id='tok'>let's</span><span id='tok'>try</span><span id='tok'>to</span><span id='tok'>access</span><span id='tok'>our</span><span id='tok'>uploaded</span><span id='tok'>PHP</span><span id='tok'>file</span><span id='tok'>by</span><span id='tok'>calling.</span></p><p id=p697><span id='tok'>Yes,</span><span id='tok'>our</span><span id='tok'>PHP</span><span id='tok'>file</span><span id='tok'>is</span><span id='tok'>successfully</span><span id='tok'>executed:</span><span id='tok'>It</span><span id='tok'>shows</span><span id='tok'>"www-data"</span><span id='tok'>because,</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>PHP</span><span id='tok'>file,</span><span id='tok'>we</span><span id='tok'>used</span><span id='tok'>the</span><span id='tok'>"whoami"</span><span id='tok'>command.</span><span id='tok'>Now</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>confirmed</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>a</span><span id='tok'>PHP</span><span id='tok'>file</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>server.</span><span id='tok'>So</span><span id='tok'>let's</span><span id='tok'>upload</span><span id='tok'>another</span><span id='tok'>PHP</span><span id='tok'>file,</span><span id='tok'>but</span><span id='tok'>this</span><span id='tok'>time</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>use</span><span id='tok'>execute</span><span id='tok'>all</span><span id='tok'>Unix</span><span id='tok'>commands</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>server;</span><span id='tok'>that's</span><span id='tok'>why</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>written</span><span id='tok'>this</span><span id='tok'>small</span><span id='tok'>piece</span><span id='tok'>of</span><span id='tok'>code:</span></p><p id=p762><span id='tok'>Now</span><span id='tok'>upload</span><span id='tok'>this</span><span id='tok'>PHP</span><span id='tok'>file</span><span id='tok'>by</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>technique.</span><span id='tok'>Locate</span><span id='tok'>the</span><span id='tok'>file</span><span id='tok'>and</span><span id='tok'>access</span><span id='tok'>it</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>URL.</span><span id='tok'>Whatever</span><span id='tok'>command</span><span id='tok'>we</span><span id='tok'>want</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>server,</span><span id='tok'>we</span><span id='tok'>just</span><span id='tok'>have</span><span id='tok'>to</span><span id='tok'>pass</span><span id='tok'>the</span><span id='tok'>command</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>c</span><span id='tok'>parameter.</span><span id='tok'>For</span><span id='tok'>example,</span><span id='tok'>we</span><span id='tok'>want</span><span id='tok'>to</span><span id='tok'>check</span><span id='tok'>which</span><span id='tok'>directory</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>currently</span><span id='tok'>in,</span><span id='tok'>so</span><span id='tok'>we</span><span id='tok'>passed</span><span id='tok'>"c=pwd."</span></p><p id=p817><span id='tok'>And</span><span id='tok'>it</span><span id='tok'>shows</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>current</span><span id='tok'>directory</span><span id='tok'>is</span><span id='tok'>images.</span><span id='tok'>We</span><span id='tok'>want</span><span id='tok'>to</span><span id='tok'>see</span><span id='tok'>all</span><span id='tok'>the</span><span id='tok'>files</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>current</span><span id='tok'>directory</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>file</span><span id='tok'>permissions,</span><span id='tok'>so</span><span id='tok'>we</span><span id='tok'>use</span><span id='tok'>this</span><span id='tok'>command:</span><span id='tok'>"ls</span><span id='tok'>-la</span><span id='tok'>./</span><span id='tok'>></span><span id='tok'>dirlist.txt":</span></p><p id=p851><span id='tok'>After</span><span id='tok'>executing</span><span id='tok'>the</span><span id='tok'>command</span><span id='tok'>we</span><span id='tok'>know</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>result</span><span id='tok'>is</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>dirlist.txt</span><span id='tok'>file</span><span id='tok'>so</span><span id='tok'>let's</span><span id='tok'>open</span><span id='tok'>the</span><span id='tok'>dirlist.txt</span><span id='tok'>file</span><span id='tok'>from</span><span id='tok'>images</span><span id='tok'>directory.</span></p><p id=p874><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>the</span><span id='tok'>all</span><span id='tok'>files</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>images</span><span id='tok'>directory.</span><span id='tok'>Here</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>nothing</span><span id='tok'>that</span><span id='tok'>will</span><span id='tok'>help</span><span id='tok'>us</span><span id='tok'>to</span><span id='tok'>find</span><span id='tok'>the</span><span id='tok'>hidden</span><span id='tok'>files.</span><span id='tok'>So</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>now</span><span id='tok'>check</span><span id='tok'>the</span><span id='tok'>root</span><span id='tok'>directory</span><span id='tok'>files.</span><span id='tok'>Type</span><span id='tok'>in</span><span id='tok'>"ls</span><span id='tok'>-la</span><span id='tok'>/var/www</span><span id='tok'>></span><span id='tok'>dirlist.txt":</span></p><p id=p916><span id='tok'>Open</span><span id='tok'>the</span><span id='tok'>dirlist.txt</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>location</span><span id='tok'>as</span><span id='tok'>we</span><span id='tok'>previously</span><span id='tok'>did.</span></p><p id=p927><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>the</span><span id='tok'>all</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>files</span><span id='tok'>,</span><span id='tok'>but</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>searching</span><span id='tok'>for</span><span id='tok'>a</span><span id='tok'>hidden</span><span id='tok'>file.</span><span id='tok'>What's</span><span id='tok'>the</span><span id='tok'>.proof</span><span id='tok'>file?</span><span id='tok'>Let's</span><span id='tok'>see</span><span id='tok'>type</span><span id='tok'>in</span><span id='tok'>"cat</span><span id='tok'>/var/www/.proof</span><span id='tok'>></span><span id='tok'>proof.txt":</span></p><p id=p956><span id='tok'>Access</span><span id='tok'>the</span><span id='tok'>proof.txt</span><span id='tok'>file</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>images</span><span id='tok'>directory.</span></p><p id=p964><span id='tok'>Yeah!</span><span id='tok'>We</span><span id='tok'>finally</span><span id='tok'>found</span><span id='tok'>something,</span><span id='tok'>a</span><span id='tok'>Secret</span><span id='tok'>code:</span><span id='tok'>TGglMUxecjJDSDclN1Ej</span><span id='tok'>,</span><span id='tok'>this</span><span id='tok'>code</span><span id='tok'>looks</span><span id='tok'>as</span><span id='tok'>if</span><span id='tok'>it's</span><span class='token pointer' id='tok-71-21' style='color:red'>Base64 encoded,</span><span id='tok'>we</span><span id='tok'>decoded</span><span id='tok'>this;</span><span id='tok'>the</span><span id='tok'>output</span><span id='tok'>is</span><span id='tok'>"Lh%1L^r2CH7%7Q#."</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>small</span><span id='tok'>conversation</span><span id='tok'>is</span><span id='tok'>between</span><span id='tok'>bob</span><span id='tok'>and</span><span id='tok'>an</span><span id='tok'>unknown</span><span id='tok'>person.</span><span id='tok'>Now</span><span id='tok'>who</span><span id='tok'>is</span><span id='tok'>bob?</span><span id='tok'>Is</span><span id='tok'>bob</span><span id='tok'>a</span><span id='tok'>user?</span><span id='tok'>Let's</span><span id='tok'>check</span><span id='tok'>the</span><span id='tok'>home</span><span id='tok'>directory:</span><span id='tok'>Type</span><span id='tok'>in</span><span id='tok'>"ls</span><span id='tok'>-la</span><span id='tok'>-R</span><span id='tok'>/home</span><span id='tok'>></span><span id='tok'>bob.txt":</span></p><p id=p1026><span id='tok'>After</span><span id='tok'>executing</span><span id='tok'>the</span><span id='tok'>command,</span><span id='tok'>open</span><span id='tok'>the</span><span id='tok'>bob.txt</span><span id='tok'>file</span><span id='tok'>to</span><span id='tok'>check</span><span id='tok'>out</span><span id='tok'>the</span><span id='tok'>home</span><span id='tok'>directory</span><span id='tok'>files.</span></p><p id=p1041><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>that</span><span id='tok'>bob</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>user</span><span id='tok'>on</span><span id='tok'>this</span><span id='tok'>server</span><span id='tok'>and</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>his</span><span id='tok'>all</span><span id='tok'>directories.</span><span id='tok'>There</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>public_html</span><span id='tok'>folder,</span><span id='tok'>which</span><span id='tok'>means</span><span id='tok'>he</span><span id='tok'>has</span><span id='tok'>a</span><span id='tok'>web</span><span id='tok'>application.</span></p><p id=p1071><span id='tok'>The</span><span id='tok'>application</span><span id='tok'>is</span><span id='tok'>asking</span><span id='tok'>for</span><span id='tok'>a</span><span id='tok'>Secret.</span><span id='tok'>We</span><span id='tok'>already</span><span id='tok'>have</span><span id='tok'>that</span><span id='tok'>secret</span><span id='tok'>code,</span><span id='tok'>we</span><span id='tok'>provided</span><span id='tok'>this</span><span id='tok'>code:</span><span id='tok'>Lh%1L^r2CH7%7Q#</span></p><p id=p1089><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>message</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>write</span><span id='tok'>we</span><span id='tok'>write</span><span id='tok'>these</span><span id='tok'>number</span><span id='tok'>into</span><span id='tok'>Google</span><span id='tok'>Maps,</span><span id='tok'>we</span><span id='tok'>get</span><span id='tok'>the</span><span id='tok'>secret</span><span id='tok'>location:</span></p><p id=p1111><span id='tok'>Coast</span><span id='tok'>Tombazis</span><span id='tok'>7,</span><span id='tok'>Chania</span><span id='tok'>Crete,</span><span id='tok'>Greece.
</span></p>