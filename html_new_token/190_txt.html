<p id=p0><span class='token pointer' id='tok-190-0' style='color:red'>Darkleech</span><span id='tok'>is</span><span id='tok'>long-running</span><span id='tok'>campaign</span><span id='tok'>that</span><span id='tok'>uses</span><span class='token pointer' id='tok-190-1' style='color:red'>exploit</span><span id='tok'>kits</span><span class='token pointer' id='tok-190-2' style='color:red'>(EKs)</span><span id='tok'>to</span><span id='tok'>deliver</span><span class='token pointer' id='tok-190-3' style='color:red'>malware.</span><span id='tok'>First</span><span id='tok'>identified</span><span id='tok'>in</span><span id='tok'>2012,</span><span id='tok'>this</span><span id='tok'>campaign</span><span id='tok'>has</span><span id='tok'>used</span><span id='tok'>different</span><span id='tok'>EKs</span><span id='tok'>to</span><span id='tok'>distribute</span><span id='tok'>various</span><span id='tok'>types</span><span id='tok'>of</span><span id='tok'>malware</span><span id='tok'>during</span><span id='tok'>the</span><span id='tok'>past</span><span id='tok'>few</span><span id='tok'>years.</span><span id='tok'>We</span><span id='tok'>reviewed</span><span id='tok'>the</span><span id='tok'>most</span><span id='tok'>recent</span><span id='tok'>iteration</span><span id='tok'>of</span><span id='tok'>this</span><span id='tok'>campaign</span><span id='tok'>in</span><span id='tok'>March</span><span id='tok'>2016</span><span id='tok'>after</span><span id='tok'>it</span><span id='tok'>had</span><span id='tok'>settled</span><span id='tok'>into</span><span id='tok'>a</span><span id='tok'>pattern</span><span id='tok'>of</span><span id='tok'>distributing</span><span class='token pointer' id='tok-190-4' style='color:red'>ransomware.</span><span id='tok'>Now</span><span id='tok'>dubbed</span><span class='token pointer' id='tok-190-5' style='color:red'>"pseudo-Darkleech,"</span><span id='tok'>this</span><span id='tok'>campaign</span><span id='tok'>has</span><span id='tok'>undergone</span><span id='tok'>significant</span><span id='tok'>changes</span><span id='tok'>since</span><span id='tok'>the</span><span id='tok'>last</span><span id='tok'>time</span><span id='tok'>we</span><span id='tok'>examined</span><span id='tok'>it.</span><span id='tok'>Our</span><span id='tok'>blog</span><span id='tok'>post</span><span id='tok'>today</span><span id='tok'>focuses</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>evolution</span><span id='tok'>of</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>traffic</span><span id='tok'>since</span><span id='tok'>March</span><span id='tok'>2016.</span></p><p id=p85><span id='tok'>Chain</span><span id='tok'>of</span><span id='tok'>events</span></p><p id=p88><span id='tok'>Successful</span><span class='token pointer' id='tok-190-6' style='color:red'>infections</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>have</span><span id='tok'>generally</span><span id='tok'>followed</span><span id='tok'>a</span><span id='tok'>set</span><span id='tok'>sequence</span><span id='tok'>of</span><span id='tok'>events.</span><span id='tok'>This</span><span id='tok'>happens</span><span id='tok'>regardless</span><span id='tok'>of</span><span id='tok'>the</span><span class='token pointer' id='tok-190-7' style='color:red'>EK</span><span id='tok'>used</span><span id='tok'>or</span><span id='tok'>the</span><span id='tok'>payload</span><span id='tok'>delivered.</span><span id='tok'>The</span><span id='tok'>sequence</span><span id='tok'>is:</span></p><p id=p116><span id='tok'>Step</span><span id='tok'>1:</span><span id='tok'>Victim</span><span id='tok'>host</span><span id='tok'>views</span><span id='tok'>a</span><span id='tok'>compromised</span><span class='token pointer' id='tok-190-8' style='color:red'>website</span><span id='tok'>with</span><span class='token pointer' id='tok-190-9' style='color:red'>malicious</span><span id='tok'>injected</span><span class='token pointer' id='tok-190-10' style='color:red'>script.</span></p><p id=p128><span id='tok'>Step</span><span id='tok'>2:</span><span id='tok'>The</span><span id='tok'>injected</span><span id='tok'>script</span><span id='tok'>generates</span><span id='tok'>an</span><span class='token pointer' id='tok-190-11' style='color:red'>HTTP</span><span id='tok'>request</span><span id='tok'>for</span><span id='tok'>an</span><span id='tok'>EK</span><span id='tok'>landing</span><span id='tok'>page.</span></p><p id=p142><span id='tok'>Step</span><span id='tok'>3:</span><span id='tok'>The</span><span id='tok'>EK</span><span id='tok'>landing</span><span id='tok'>page</span><span id='tok'>determines</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>computer</span><span id='tok'>has</span><span id='tok'>any</span><span class='token pointer' id='tok-190-12' style='color:red'>vulnerable</span><span id='tok'>browser-based</span><span id='tok'>applications.</span></p><p id=p157><span id='tok'>Step</span><span id='tok'>4:</span><span id='tok'>The</span><span id='tok'>EK</span><span id='tok'>sends</span><span id='tok'>an</span><span id='tok'>exploit</span><span id='tok'>for</span><span id='tok'>any</span><span id='tok'>vulnerable</span><span id='tok'>applications</span><span id='tok'>(for</span><span id='tok'>example,</span><span id='tok'>out-of-date</span><span id='tok'>versions</span><span id='tok'>of</span><span id='tok'>Internet</span><span id='tok'>Explorer</span><span id='tok'>or</span><span id='tok'>Flash</span><span id='tok'>player).</span></p><p id=p178><span id='tok'>Step</span><span id='tok'>5:</span><span id='tok'>If</span><span id='tok'>the</span><span id='tok'>exploit</span><span id='tok'>is</span><span id='tok'>successful,</span><span id='tok'>the</span><span id='tok'>EK</span><span id='tok'>sends</span><span id='tok'>a</span><span id='tok'>payload</span><span id='tok'>and</span><span id='tok'>executes</span><span id='tok'>it</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>background</span><span id='tok'>process.</span></p><p id=p197><span id='tok'>Step</span><span id='tok'>6:</span><span id='tok'>The</span><span class='token pointer' id='tok-190-13' style='color:red'>victim's</span><span id='tok'>host</span><span id='tok'>is</span><span id='tok'>infected</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>payload.In</span><span id='tok'>some</span><span id='tok'>cases,</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>has</span><span id='tok'>used</span><span id='tok'>a</span><span id='tok'>gate</span><span id='tok'>between</span><span id='tok'>the</span><span id='tok'>compromised</span><span id='tok'>website</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>EK</span><span id='tok'>landing</span><span id='tok'>page.</span><span id='tok'>However,</span><span id='tok'>we</span><span id='tok'>far</span><span id='tok'>more</span><span id='tok'>frequently</span><span id='tok'>see</span><span id='tok'>injected</span><span id='tok'>script</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>compromised</span><span id='tok'>website</span><span id='tok'>lead</span><span id='tok'>directly</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>EK</span><span id='tok'>landing</span><span id='tok'>page.</span><span id='tok'>To</span><span id='tok'>get</span><span id='tok'>a</span><span id='tok'>better</span><span id='tok'>idea</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>relationship</span><span id='tok'>between</span><span id='tok'>EKs</span><span id='tok'>and</span><span id='tok'>campaigns,</span><span id='tok'>see</span><span id='tok'>our</span><span id='tok'>previous</span><span id='tok'>blog</span><span id='tok'>on</span><span id='tok'>EK</span><span id='tok'>fundamentals.</span></p><p id=p264><span id='tok'>EKs</span><span id='tok'>used</span><span id='tok'>by</span><span id='tok'>pseudo-Darkleech</span></p><p id=p268><span id='tok'>The</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>used</span><span id='tok'>Angler</span><span id='tok'>EK</span><span id='tok'>until</span><span id='tok'>that</span><span id='tok'>EK</span><span id='tok'>disappeared</span><span id='tok'>in</span><span id='tok'>mid-June</span><span id='tok'>2016.</span><span id='tok'>Like</span><span id='tok'>many</span><span id='tok'>other</span><span id='tok'>campaigns,</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>switched</span><span id='tok'>to</span><span class='token pointer' id='tok-190-14' style='color:red'>Neutrino</span><span id='tok'>EK</span><span id='tok'>after</span><span id='tok'>Angler</span><span id='tok'>EK</span><span id='tok'>disappeared.</span></p><p id=p294><span class='token pointer' id='tok-190-15' style='color:red'>Pseudo-Darkleech</span><span id='tok'>stayed</span><span id='tok'>with</span><span id='tok'>Neutrino</span><span id='tok'>EK</span><span id='tok'>until</span><span id='tok'>mid-September</span><span id='tok'>2016.</span><span id='tok'>At</span><span id='tok'>that</span><span id='tok'>point,</span><span id='tok'>Neutrino</span><span id='tok'>EK</span><span id='tok'>ceased</span><span id='tok'>operations.</span><span id='tok'>The</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>then</span><span id='tok'>switched</span><span id='tok'>to</span><span id='tok'>Rig</span><span id='tok'>EK,</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>stay</span><span id='tok'>with</span><span id='tok'>Rig</span><span id='tok'>since</span><span id='tok'>then.</span><span id='tok'>We</span><span id='tok'>still</span><span id='tok'>see</span><span id='tok'>indications</span><span id='tok'>of</span><span id='tok'>a</span><span id='tok'>Neutrino</span><span id='tok'>EK</span><span id='tok'>variant,</span><span id='tok'>but</span><span id='tok'>at</span><span id='tok'>much</span><span id='tok'>reduced</span><span id='tok'>levels</span><span id='tok'>compared</span><span id='tok'>to</span><span id='tok'>before.</span></p><p id=p342><span id='tok'>Searching</span><span id='tok'>for</span><span id='tok'>EK</span><span id='tok'>activity</span><span id='tok'>in</span><span class='token pointer' id='tok-190-16' style='color:red'>AutoFocus,</span><span id='tok'>we</span><span id='tok'>saw</span><span id='tok'>a</span><span id='tok'>significant</span><span id='tok'>drop</span><span id='tok'>in</span><span id='tok'>Neutrino</span><span id='tok'>and</span><span id='tok'>a</span><span id='tok'>corresponding</span><span id='tok'>rise</span><span id='tok'>in</span><span id='tok'>Rig</span><span id='tok'>activity</span><span id='tok'>starting</span><span id='tok'>in</span><span id='tok'>mid-September</span><span id='tok'>2016.</span></p><p id=p366><span id='tok'>Payloads</span><span id='tok'>sent</span><span id='tok'>by</span><span id='tok'>pseudo-Darkleech</span></p><p id=p370><span id='tok'>When</span><span id='tok'>we</span><span id='tok'>last</span><span id='tok'>reviewed</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>in</span><span id='tok'>March</span><span id='tok'>2016,</span><span id='tok'>it</span><span id='tok'>was</span><span id='tok'>delivering</span><span class='token pointer' id='tok-190-17' style='color:red'>TeslaCrypt</span><span id='tok'>ransomware.</span><span id='tok'>Since</span><span id='tok'>that</span><span id='tok'>time,</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>has</span><span id='tok'>changed</span><span id='tok'>the</span><span id='tok'>ransomware</span><span id='tok'>payloads</span><span id='tok'>it</span><span id='tok'>delivers.</span><span id='tok'>In</span><span id='tok'>April</span><span id='tok'>2016,</span><span id='tok'>this</span><span id='tok'>campaign</span><span id='tok'>switched</span><span id='tok'>to</span><span class='token pointer' id='tok-190-18' style='color:red'>CryptXXX</span><span id='tok'>ransomware</span><span id='tok'>after</span><span id='tok'>TeslaCrypt</span><span id='tok'>shut</span><span id='tok'>down</span><span id='tok'>and</span><span id='tok'>released</span><span id='tok'>its</span><span id='tok'>master</span><span id='tok'>decryption</span><span id='tok'>key.</span><span id='tok'>By</span><span id='tok'>August</span><span id='tok'>2016,</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>had</span><span id='tok'>switched</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>new</span><span id='tok'>variant</span><span id='tok'>of</span><span id='tok'>CryptXXX</span><span id='tok'>ransomware</span><span id='tok'>dubbed</span><span class='token pointer' id='tok-190-19' style='color:red'>CrypMIC.</span></p><p id=p430><span id='tok'>By</span><span id='tok'>October</span><span id='tok'>2016,</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>switched</span><span id='tok'>to</span><span id='tok'>distributing</span><span class='token pointer' id='tok-190-20' style='color:red'>Cerber</span><span id='tok'>ransomware,</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>continued</span><span id='tok'>sending</span><span id='tok'>Cerber</span><span id='tok'>as</span><span id='tok'>of</span><span id='tok'>early</span><span id='tok'>December</span><span id='tok'>2016.</span><span id='tok'>Below</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>summary</span><span id='tok'>of</span><span id='tok'>EKs</span><span id='tok'>and</span><span id='tok'>payloads</span><span id='tok'>used</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>so</span><span id='tok'>far</span><span id='tok'>in</span><span id='tok'>2016.</span></p><p id=p467><span id='tok'>Jan</span><span id='tok'>2016:</span><span id='tok'>Angler</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>CryptoWall</span><span id='tok'>ransomwareFeb</span><span id='tok'>2016:</span><span id='tok'>Angler</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>TeslaCrypt</span><span id='tok'>ransomwareApr</span><span id='tok'>2016:</span><span id='tok'>Angler</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>CryptXXX</span><span id='tok'>ransomwareJun</span><span id='tok'>2016:</span><span id='tok'>Neutrino</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>CryptXXX</span><span id='tok'>ransomwareAug</span><span id='tok'>2016:</span><span id='tok'>Neutrino</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>CrypMIC</span><span id='tok'>ransomwareSep</span><span id='tok'>2016:</span><span id='tok'>Rig</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>CrypMIC</span><span id='tok'>ransomwareOct</span><span id='tok'>2016:</span><span id='tok'>Rig</span><span id='tok'>EK</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>Cerber</span><span id='tok'>ransomwarePatterns</span><span id='tok'>of</span><span id='tok'>injected</span><span id='tok'>script</span></p><p id=p520><span id='tok'>Any</span><span id='tok'>EK</span><span id='tok'>infection</span><span id='tok'>chain</span><span id='tok'>almost</span><span id='tok'>always</span><span id='tok'>starts</span><span id='tok'>with</span><span id='tok'>injected</span><span id='tok'>script</span><span id='tok'>from</span><span id='tok'>a</span><span id='tok'>particular</span><span id='tok'>campaign</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>page</span><span id='tok'>from</span><span id='tok'>a</span><span id='tok'>compromised</span><span id='tok'>website.</span><span id='tok'>These</span><span id='tok'>pages</span><span id='tok'>are</span><span id='tok'>from</span><span class='token pointer' id='tok-190-21' style='color:red'>legitimate</span><span id='tok'>websites</span><span id='tok'>that</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>compromised</span><span id='tok'>and</span><span id='tok'>are</span><span id='tok'>being</span><span id='tok'>used</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>campaign.</span></p><p id=p558><span id='tok'>When</span><span id='tok'>we</span><span id='tok'>last</span><span id='tok'>examined</span><span id='tok'>injected</span><span id='tok'>script</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign,</span><span id='tok'>it</span><span id='tok'>was</span><span id='tok'>a</span><span id='tok'>large</span><span id='tok'>block</span><span id='tok'>of</span><span id='tok'>heavily-obfuscated</span><span id='tok'>text</span><span id='tok'>that</span><span id='tok'>averaged</span><span id='tok'>from</span><span id='tok'>12,000</span><span id='tok'>to</span><span id='tok'>18,000</span><span id='tok'>characters</span><span id='tok'>in</span><span id='tok'>size.</span><span id='tok'>It</span><span id='tok'>remained</span><span id='tok'>large</span><span id='tok'>and</span><span id='tok'>obfuscated</span><span id='tok'>through</span><span id='tok'>June</span><span id='tok'>2016.</span></p><p id=p593><span id='tok'>But</span><span id='tok'>by</span><span id='tok'>July</span><span id='tok'>1st</span><span id='tok'>2016,</span><span id='tok'>injected</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>script</span><span id='tok'>stopped</span><span id='tok'>using</span><span id='tok'>obfuscation</span><span id='tok'>and</span><span id='tok'>became</span><span id='tok'>a</span><span id='tok'>straight-forward</span><span id='tok'>iframe.</span><span id='tok'>This</span><span id='tok'>iframe</span><span id='tok'>has</span><span id='tok'>a</span><span id='tok'>span</span><span id='tok'>value</span><span id='tok'>that</span><span id='tok'>puts</span><span id='tok'>it</span><span id='tok'>outside</span><span id='tok'>the</span><span id='tok'>viewable</span><span id='tok'>area</span><span id='tok'>of</span><span id='tok'>your</span><span class='token pointer' id='tok-190-22' style='color:red'>web</span><span class='token pointer' id='tok-190-23' style='color:red'>browser's</span><span class='token pointer' id='tok-190-24' style='color:red'>window.</span></p><p id=p627><span id='tok'>The</span><span id='tok'>injected</span><span id='tok'>script</span><span id='tok'>has</span><span id='tok'>changed</span><span id='tok'>slightly</span><span id='tok'>since</span><span id='tok'>then,</span><span id='tok'>but</span><span id='tok'>it</span><span id='tok'>remains</span><span id='tok'>short</span><span id='tok'>and</span><span id='tok'>unobfuscated</span><span id='tok'>as</span><span id='tok'>of</span><span id='tok'>early</span><span id='tok'>December</span><span id='tok'>2016.</span></p><p id=p646><span id='tok'>Conclusion</span></p><p id=p647><span id='tok'>With</span><span id='tok'>the</span><span id='tok'>recent</span><span id='tok'>rise</span><span id='tok'>of</span><span id='tok'>ransomware,</span><span id='tok'>we</span><span id='tok'>continue</span><span id='tok'>to</span><span id='tok'>see</span><span id='tok'>different</span><span id='tok'>vectors</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>both</span><span id='tok'>targeted</span><span id='tok'>attacks</span><span id='tok'>and</span><span id='tok'>wide-scale</span><span id='tok'>distribution.</span><span id='tok'>EKs</span><span id='tok'>are</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>many</span><span id='tok'>attack</span><span id='tok'>vectors</span><span id='tok'>for</span><span id='tok'>ransomware.</span><span id='tok'>The</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>a</span><span class='token pointer' id='tok-190-25' style='color:red'>prominent</span><span id='tok'>distributer</span><span id='tok'>of</span><span id='tok'>ransomware</span><span id='tok'>through</span><span id='tok'>EKs,</span><span id='tok'>and</span><span id='tok'>we</span><span id='tok'>predict</span><span id='tok'>this</span><span id='tok'>trend</span><span id='tok'>will</span><span id='tok'>continue</span><span id='tok'>into</span><span id='tok'>2017.</span></p><p id=p697><span class='token pointer' id='tok-190-26' style='color:red'>Domains,</span><span class='token pointer' id='tok-190-27' style='color:red'>IP</span><span class='token pointer' id='tok-190-28' style='color:red'>addresses,</span><span id='tok'>and</span><span id='tok'>other</span><span id='tok'>indicators</span><span id='tok'>associated</span><span id='tok'>with</span><span id='tok'>this</span><span id='tok'>campaign</span><span id='tok'>are</span><span id='tok'>constantly</span><span id='tok'>changing.</span><span id='tok'>Customers</span><span id='tok'>of</span><span id='tok'>Palo</span><span id='tok'>Alto</span><span class='token pointer' id='tok-190-29' style='color:red'>Networks</span><span id='tok'>are</span><span id='tok'>protected</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>pseudo-Darkleech</span><span id='tok'>campaign</span><span id='tok'>through</span><span id='tok'>our</span><span id='tok'>next-generation</span><span id='tok'>security</span><span id='tok'>platform,</span><span id='tok'>including</span><span id='tok'>Traps,</span><span id='tok'>our</span><span id='tok'>advanced</span><span id='tok'>endpoint</span><span id='tok'>solution</span><span id='tok'>that</span><span id='tok'>prevent</span><span id='tok'>EKs</span><span id='tok'>from</span><span class='token pointer' id='tok-190-30' style='color:red'>compromising</span><span id='tok'>a</span><span id='tok'>system.</span><span id='tok'>We</span><span id='tok'>will</span><span id='tok'>continue</span><span id='tok'>to</span><span id='tok'>investigate</span><span id='tok'>this</span><span id='tok'>campaign,</span><span id='tok'>inform</span><span id='tok'>the</span><span id='tok'>community</span><span id='tok'>of</span><span id='tok'>our</span><span id='tok'>results,</span><span id='tok'>and</span><span id='tok'>further</span><span id='tok'>enhance</span><span id='tok'>our</span><span id='tok'>threat</span><span id='tok'>prevention.
</span></p>