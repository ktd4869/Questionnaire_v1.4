<p id=p0><span class='token pointer' id='tok-63-0'>In</span><span class='token pointer' id='tok-63-1'>this</span><span class='token pointer' id='tok-63-2'>article,</span><span class='token pointer' id='tok-63-3'>we</span><span class='token pointer' id='tok-63-4'>will</span><span class='token pointer' id='tok-63-5'>be</span><span class='token pointer' id='tok-63-6'>solving</span><span class='token pointer' id='tok-63-7'>all</span><span class='token pointer' id='tok-63-8' style='color:red'>networking</span><span class='token pointer' id='tok-63-9'>challenges</span><span class='token pointer' id='tok-63-10'>and</span><span class='token pointer' id='tok-63-11'>one</span><span class='token pointer' id='tok-63-13' style='color:red'>remote buffer overflow challenge</span><span class='token pointer' id='tok-63-14'>Protostar.</span></p><p id=p15><span class='token pointer' id='tok-63-15'>IntroductionThese</span><span class='token pointer' id='tok-63-16'>levels</span><span class='token pointer' id='tok-63-17' style='color:red'>introduce</span><span class='token pointer' id='tok-63-18'>us</span><span class='token pointer' id='tok-63-19'>to</span><span class='token pointer' id='tok-63-20'>the</span><span class='token pointer' id='tok-63-21'>fundamental</span><span class='token pointer' id='tok-63-22'>concept</span><span class='token pointer' id='tok-63-23'>of</span><span class='token pointer' id='tok-63-24'>sending</span><span class='token pointer' id='tok-63-25'>and</span><span class='token pointer' id='tok-63-26'>receiving</span><span class='token pointer' id='tok-63-27'>data</span><span class='token pointer' id='tok-63-28'>over</span><span class='token pointer' id='tok-63-29'>a</span><span class='token pointer' id='tok-63-30'>network</span><span class='token pointer' id='tok-63-31'>in</span><span class='token pointer' id='tok-63-32'>a</span><span class='token pointer' id='tok-63-33' style='color:red'>different</span><span class='token pointer' id='tok-63-34'>format,</span><span class='token pointer' id='tok-63-35'>and</span><span class='token pointer' id='tok-63-36'>the</span><span class='token pointer' id='tok-63-37'>hurdles</span><span class='token pointer' id='tok-63-38'>of</span><span class='token pointer' id='tok-63-39'>debugging</span><span class='token pointer' id='tok-63-40'>and</span><span class='token pointer' id='tok-63-41'>developing</span><span class='token pointer' id='tok-63-42' style='color:red'>an</span><span class='token pointer' id='tok-63-43'>exploit</span><span class='token pointer' id='tok-63-44'>for</span><span class='token pointer' id='tok-63-45'>remote</span><span class='token pointer' id='tok-63-47' style='color:red'>stack overflows. We will have</span><span class='token pointer' id='tok-63-49' style='color:red'>at</span><span class='token pointer' id='tok-63-50' style='color:red'>look</span><span class='token pointer' id='tok-63-51'>we</span><span class='token pointer' id='tok-63-52'>can</span><span class='token pointer' id='tok-63-53'>debug</span><span class='token pointer' id='tok-63-54'>and</span><span class='token pointer' id='tok-63-55'>understand</span><span class='token pointer' id='tok-63-56'>what</span><span class='token pointer' id='tok-63-57'>inputs</span><span class='token pointer' id='tok-63-58'>the</span><span class='token pointer' id='tok-63-59'>program</span><span class='token pointer' id='tok-63-60' style='color:red'>expects</span><span class='token pointer' id='tok-63-61'>from</span><span class='token pointer' id='tok-63-62'>us.</span></p><p id=p63><span class='token pointer' id='tok-63-63'>The</span><span class='token pointer' id='tok-63-64'>following</span><span class='token pointer' id='tok-63-65'>assembly</span><span class='token pointer' id='tok-63-66' style='color:red'>code</span><span class='token pointer' id='tok-63-67'>is</span><span class='token pointer' id='tok-63-68'>obtained</span><span class='token pointer' id='tok-63-69'>after</span><span class='token pointer' id='tok-63-70'>disassembling</span><span class='token pointer' id='tok-63-71'>the</span><span class='token pointer' id='tok-63-73' style='color:red'>binary.</span><span class='token pointer' id='tok-63-74' style='color:red'>Net0</span><span class='token pointer' id='tok-63-75'>we</span><span class='token pointer' id='tok-63-76'>can</span><span class='token pointer' id='tok-63-77'>see,</span><span class='token pointer' id='tok-63-78'>the</span><span class='token pointer' id='tok-63-79' style='color:red'>application</span><span class='token pointer' id='tok-63-80' style='color:red'>executes</span><span class='token pointer' id='tok-63-81'>run</span><span class='token pointer' id='tok-63-82'>function</span><span class='token pointer' id='tok-63-83'>from</span><span class='token pointer' id='tok-63-84'>the</span><span class='token pointer' id='tok-63-85'>main</span><span class='token pointer' id='tok-63-86'>function.</span><span class='token pointer' id='tok-63-87'>The</span><span class='token pointer' id='tok-63-89' style='color:red'>run function</span><span class='token pointer' id='tok-63-90'>a</span><span class='token pointer' id='tok-63-91'>random</span><span class='token pointer' id='tok-63-92'>number</span><span class='token pointer' id='tok-63-93'>and</span><span class='token pointer' id='tok-63-94'>uses</span><span class='token pointer' id='tok-63-95'>printf</span><span class='token pointer' id='tok-63-96'>function</span><span class='token pointer' id='tok-63-97'>call</span><span class='token pointer' id='tok-63-98'>to</span><span class='token pointer' id='tok-63-99'>print</span><span class='token pointer' id='tok-63-100'>it</span><span class='token pointer' id='tok-63-101'>on</span><span class='token pointer' id='tok-63-102'>the</span><span class='token pointer' id='tok-63-104' style='color:red'>screen. It</span><span class='token pointer' id='tok-63-106' style='color:red'>checks whether our</span><span class='token pointer' id='tok-63-107'>matches</span><span class='token pointer' id='tok-63-108'>to</span><span class='token pointer' id='tok-63-109'>the</span><span class='token pointer' id='tok-63-110'>random()</span><span class='token pointer' id='tok-63-111'>number</span><span class='token pointer' id='tok-63-112'>generated</span><span class='token pointer' id='tok-63-113'>by</span><span class='token pointer' id='tok-63-114'>comparing</span><span class='token pointer' id='tok-63-115'>our</span><span class='token pointer' id='tok-63-116'>raw</span><span class='token pointer' id='tok-63-117'>input</span><span class='token pointer' id='tok-63-118'>and</span><span class='token pointer' id='tok-63-119'>random</span><span class='token pointer' id='tok-63-120'>number</span><span class='token pointer' id='tok-63-121'>generated</span><span class='token pointer' id='tok-63-122'>previously.</span></p><p id=p123><span class='token pointer' id='tok-63-123'>Our</span><span class='token pointer' id='tok-63-124'>logic</span><span class='token pointer' id='tok-63-125'>for</span><span class='token pointer' id='tok-63-126'>solving</span><span class='token pointer' id='tok-63-128' style='color:red'>this challenge</span><span class='token pointer' id='tok-63-129'>be</span><span class='token pointer' id='tok-63-130'>composed</span><span class='token pointer' id='tok-63-131'>of</span><span class='token pointer' id='tok-63-132'>following</span><span class='token pointer' id='tok-63-133'>steps:</span></p><p id=p134><span class='token pointer' id='tok-63-134'>Connect</span><span class='token pointer' id='tok-63-135'>to</span><span class='token pointer' id='tok-63-136'>serverRecv()</span><span class='token pointer' id='tok-63-137'>some</span><span class='token pointer' id='tok-63-138'>dataParse</span><span class='token pointer' id='tok-63-139'>the</span><span class='token pointer' id='tok-63-140'>data</span><span class='token pointer' id='tok-63-141'>and</span><span class='token pointer' id='tok-63-142'>take</span><span class='token pointer' id='tok-63-143'>out</span><span class='token pointer' id='tok-63-144'>the</span><span class='token pointer' id='tok-63-145'>random</span><span class='token pointer' id='tok-63-147' style='color:red'>number ask by</span><span class='token pointer' id='tok-63-148' style='color:red'>applicationPack</span><span class='token pointer' id='tok-63-149'>the</span><span class='token pointer' id='tok-63-150' style='color:red'>random</span><span class='token pointer' id='tok-63-151'>number</span><span class='token pointer' id='tok-63-152'>in</span><span class='token pointer' id='tok-63-153'>little-endian</span><span class='token pointer' id='tok-63-154'>format</span><span class='token pointer' id='tok-63-155'>and</span><span class='token pointer' id='tok-63-156'>send</span><span class='token pointer' id='tok-63-157'>it</span><span class='token pointer' id='tok-63-158'>back.Using</span><span class='token pointer' id='tok-63-159'>the</span><span class='token pointer' id='tok-63-160'>logic</span><span class='token pointer' id='tok-63-161'>listed</span><span class='token pointer' id='tok-63-162' style='color:red'>above,</span><span class='token pointer' id='tok-63-163'>we</span><span class='token pointer' id='tok-63-164'>came</span><span class='token pointer' id='tok-63-165'>up</span><span class='token pointer' id='tok-63-166'>with</span><span class='token pointer' id='tok-63-168' style='color:red'>the following</span><span class='token pointer' id='tok-63-169'>of</span><span class='token pointer' id='tok-63-170'>code</span><span class='token pointer' id='tok-63-171'>and</span><span class='token pointer' id='tok-63-172'>successfully</span><span class='token pointer' id='tok-63-173'>passed</span><span class='token pointer' id='tok-63-174'>this</span><span class='token pointer' id='tok-63-175'>challenge.</span></p><p id=p176><span class='token pointer' id='tok-63-176'>Net</span><span class='token pointer' id='tok-63-177'>1By</span><span class='token pointer' id='tok-63-178'>looking</span><span class='token pointer' id='tok-63-179'>at</span><span class='token pointer' id='tok-63-180'>the</span><span class='token pointer' id='tok-63-181'>disassembled</span><span class='token pointer' id='tok-63-182'>code</span><span class='token pointer' id='tok-63-183'>of</span><span class='token pointer' id='tok-63-184'>binary</span><span class='token pointer' id='tok-63-185'>Net1,</span><span class='token pointer' id='tok-63-186'>we</span><span class='token pointer' id='tok-63-187'>can</span><span class='token pointer' id='tok-63-188'>understand</span><span class='token pointer' id='tok-63-189'>following</span><span class='token pointer' id='tok-63-190'>things:</span></p><p id=p191><span class='token pointer' id='tok-63-192' style='color:red'>The program</span><span class='token pointer' id='tok-63-193'>a</span><span class='token pointer' id='tok-63-194'>random</span><span class='token pointer' id='tok-63-195'>number</span><span class='token pointer' id='tok-63-196'>and</span><span class='token pointer' id='tok-63-197'>stores</span><span class='token pointer' id='tok-63-198'>the</span><span class='token pointer' id='tok-63-200' style='color:red'>as</span><span class='token pointer' id='tok-63-201' style='color:red'>integer</span><span class='token pointer' id='tok-63-202'>string</span><span class='token pointer' id='tok-63-203'>at</span><span class='token pointer' id='tok-63-204'>ebp-0x24.It</span><span class='token pointer' id='tok-63-205'>then</span><span class='token pointer' id='tok-63-206'>writes</span><span class='token pointer' id='tok-63-207'>the</span><span class='token pointer' id='tok-63-208'>content</span><span class='token pointer' id='tok-63-209'>of</span><span class='token pointer' id='tok-63-210'>number</span><span class='token pointer' id='tok-63-211'>generated</span><span class='token pointer' id='tok-63-212'>to</span><span class='token pointer' id='tok-63-213'>stdout.It</span><span class='token pointer' id='tok-63-214'>then</span><span class='token pointer' id='tok-63-215' style='color:red'>takes</span><span class='token pointer' id='tok-63-216'>input</span><span class='token pointer' id='tok-63-217'>from</span><span class='token pointer' id='tok-63-218'>user</span><span class='token pointer' id='tok-63-219'>removes</span><span class='token pointer' id='tok-63-220' style='color:red'>CRLF</span><span class='token pointer' id='tok-63-221'>characters</span><span class='token pointer' id='tok-63-222'>and</span><span class='token pointer' id='tok-63-223'>compare</span><span class='token pointer' id='tok-63-224'>the</span><span class='token pointer' id='tok-63-225'>input</span><span class='token pointer' id='tok-63-226'>with</span><span class='token pointer' id='tok-63-227'>the</span><span class='token pointer' id='tok-63-228'>contents</span><span class='token pointer' id='tok-63-229' style='color:red'>of</span><span class='token pointer' id='tok-63-230'>ebp-0x24</span><span class='token pointer' id='tok-63-231'>variable</span><span class='token pointer' id='tok-63-232'>saved</span><span class='token pointer' id='tok-63-233'>earlier.As</span><span class='token pointer' id='tok-63-234'>in</span><span class='token pointer' id='tok-63-235'>this</span><span class='token pointer' id='tok-63-237' style='color:red'>case, the</span><span class='token pointer' id='tok-63-238'>is</span><span class='token pointer' id='tok-63-239'>already</span><span class='token pointer' id='tok-63-240'>packed</span><span class='token pointer' id='tok-63-241'>in</span><span class='token pointer' id='tok-63-242'>32-bit</span><span class='token pointer' id='tok-63-243'>integers.</span><span class='token pointer' id='tok-63-244'>We</span><span class='token pointer' id='tok-63-245'>will</span><span class='token pointer' id='tok-63-246' style='color:red'>be</span><span class='token pointer' id='tok-63-247'>using</span><span class='token pointer' id='tok-63-248'>similar</span><span class='token pointer' id='tok-63-249'>logic</span><span class='token pointer' id='tok-63-250'>from</span><span class='token pointer' id='tok-63-251'>the</span><span class='token pointer' id='tok-63-252'>NET0</span><span class='token pointer' id='tok-63-253'>level</span><span class='token pointer' id='tok-63-254' style='color:red'>and</span><span class='token pointer' id='tok-63-255'>after</span><span class='token pointer' id='tok-63-256'>receiving</span><span class='token pointer' id='tok-63-257'>the</span><span class='token pointer' id='tok-63-258'>data</span><span class='token pointer' id='tok-63-260' style='color:red'>we will</span><span class='token pointer' id='tok-63-261'>unpacking</span><span class='token pointer' id='tok-63-262'>it</span><span class='token pointer' id='tok-63-263'>to</span><span class='token pointer' id='tok-63-264'>32-bit</span><span class='token pointer' id='tok-63-265'>integer</span><span class='token pointer' id='tok-63-266'>and</span><span class='token pointer' id='tok-63-267'>send</span><span class='token pointer' id='tok-63-268'>the</span><span class='token pointer' id='tok-63-269' style='color:red'>unpacked</span><span class='token pointer' id='tok-63-270'>value</span><span class='token pointer' id='tok-63-271'>back</span><span class='token pointer' id='tok-63-272'>as</span><span class='token pointer' id='tok-63-273'>it</span><span class='token pointer' id='tok-63-274'>is.</span></p><p id=p275><span class='token pointer' id='tok-63-275'>Finally,</span><span class='token pointer' id='tok-63-276'>we</span><span class='token pointer' id='tok-63-277'>came</span><span class='token pointer' id='tok-63-278'>up</span><span class='token pointer' id='tok-63-279'>with</span><span class='token pointer' id='tok-63-280'>following</span><span class='token pointer' id='tok-63-281'>piece</span><span class='token pointer' id='tok-63-282'>of</span><span class='token pointer' id='tok-63-283'>code</span><span class='token pointer' id='tok-63-284'>that</span><span class='token pointer' id='tok-63-285'>will</span><span class='token pointer' id='tok-63-286'>solve</span><span class='token pointer' id='tok-63-287'>this</span><span class='token pointer' id='tok-63-288'>challenge.</span></p><p id=p289><span class='token pointer' id='tok-63-289'>Net</span><span class='token pointer' id='tok-63-290'>2By</span><span class='token pointer' id='tok-63-291'>looking</span><span class='token pointer' id='tok-63-292'>at</span><span class='token pointer' id='tok-63-293'>the</span><span class='token pointer' id='tok-63-294'>disassembled</span><span class='token pointer' id='tok-63-295'>code</span><span class='token pointer' id='tok-63-296'>of</span><span class='token pointer' id='tok-63-297'>binary</span><span class='token pointer' id='tok-63-298'>Net2,</span><span class='token pointer' id='tok-63-299'>we</span><span class='token pointer' id='tok-63-300'>can</span><span class='token pointer' id='tok-63-301'>understand</span><span class='token pointer' id='tok-63-302'>following</span><span class='token pointer' id='tok-63-303'>things:</span></p><p id=p304><span class='token pointer' id='tok-63-304'>The</span><span class='token pointer' id='tok-63-305'>application</span><span class='token pointer' id='tok-63-306'>generates</span><span class='token pointer' id='tok-63-308' style='color:red'>four random</span><span class='token pointer' id='tok-63-309'>and</span><span class='token pointer' id='tok-63-310'>sends</span><span class='token pointer' id='tok-63-311'>in</span><span class='token pointer' id='tok-63-312'>four</span><span class='token pointer' id='tok-63-313'>iterations</span><span class='token pointer' id='tok-63-314'>using</span><span class='token pointer' id='tok-63-316' style='color:red'>().</span><span class='token pointer' id='tok-63-317' style='color:red'>write</span><span class='token pointer' id='tok-63-318'>also</span><span class='token pointer' id='tok-63-319'>keeps</span><span class='token pointer' id='tok-63-320'>on</span><span class='token pointer' id='tok-63-321'>adding</span><span class='token pointer' id='tok-63-322'>them</span><span class='token pointer' id='tok-63-323'>and</span><span class='token pointer' id='tok-63-324'>stores</span><span class='token pointer' id='tok-63-325'>the</span><span class='token pointer' id='tok-63-326'>overall</span><span class='token pointer' id='tok-63-327'>result</span><span class='token pointer' id='tok-63-328'>at</span><span class='token pointer' id='tok-63-329'>ebp-0xc.</span><span class='token pointer' id='tok-63-330'>As</span><span class='token pointer' id='tok-63-331'>a</span><span class='token pointer' id='tok-63-333' style='color:red'>result might</span><span class='token pointer' id='tok-63-334'>its</span><span class='token pointer' id='tok-63-335'>limit,</span><span class='token pointer' id='tok-63-336'>it</span><span class='token pointer' id='tok-63-337'>will</span><span class='token pointer' id='tok-63-338'>wrap,</span><span class='token pointer' id='tok-63-339'>so</span><span class='token pointer' id='tok-63-340'>we</span><span class='token pointer' id='tok-63-341'>need</span><span class='token pointer' id='tok-63-342'>to</span><span class='token pointer' id='tok-63-343'>take</span><span class='token pointer' id='tok-63-344'>care</span><span class='token pointer' id='tok-63-345'>of</span><span class='token pointer' id='tok-63-346'>that</span><span class='token pointer' id='tok-63-347'>in</span><span class='token pointer' id='tok-63-348' style='color:red'>our</span><span class='token pointer' id='tok-63-349'>code</span><span class='token pointer' id='tok-63-350'>too.</span><span class='token pointer' id='tok-63-351'>Finally,</span><span class='token pointer' id='tok-63-352'>it</span><span class='token pointer' id='tok-63-353'>checks</span><span class='token pointer' id='tok-63-354'>the</span><span class='token pointer' id='tok-63-355'>input</span><span class='token pointer' id='tok-63-356'>provided</span><span class='token pointer' id='tok-63-357'>by</span><span class='token pointer' id='tok-63-358'>the</span><span class='token pointer' id='tok-63-359'>user</span><span class='token pointer' id='tok-63-360'>matches</span><span class='token pointer' id='tok-63-361'>the</span><span class='token pointer' id='tok-63-362'>added</span><span class='token pointer' id='tok-63-363'>numbers,</span><span class='token pointer' id='tok-63-364'>so</span><span class='token pointer' id='tok-63-365'>we</span><span class='token pointer' id='tok-63-366'>need</span><span class='token pointer' id='tok-63-367'>to</span><span class='token pointer' id='tok-63-368'>pack</span><span class='token pointer' id='tok-63-369'>our</span><span class='token pointer' id='tok-63-370'>input</span><span class='token pointer' id='tok-63-371'>to</span><span class='token pointer' id='tok-63-372'>an</span><span class='token pointer' id='tok-63-373'>unsigned</span><span class='token pointer' id='tok-63-374'>int</span><span class='token pointer' id='tok-63-375'>to</span><span class='token pointer' id='tok-63-376'>take</span><span class='token pointer' id='tok-63-377'>care</span><span class='token pointer' id='tok-63-378'>of</span><span class='token pointer' id='tok-63-379'>that.</span></p><p id=p380><span class='token pointer' id='tok-63-380'>We</span><span class='token pointer' id='tok-63-381'>came</span><span class='token pointer' id='tok-63-382'>up</span><span class='token pointer' id='tok-63-383'>with</span><span class='token pointer' id='tok-63-384'>the</span><span class='token pointer' id='tok-63-385'>following</span><span class='token pointer' id='tok-63-386'>piece</span><span class='token pointer' id='tok-63-387'>of</span><span class='token pointer' id='tok-63-388'>code</span><span class='token pointer' id='tok-63-389'>to</span><span class='token pointer' id='tok-63-390'>solve</span><span class='token pointer' id='tok-63-391'>this</span><span class='token pointer' id='tok-63-392'>challenge</span><span class='token pointer' id='tok-63-393'>using</span><span class='token pointer' id='tok-63-394'>the</span><span class='token pointer' id='tok-63-395'>following</span><span class='token pointer' id='tok-63-396'>algorithm:</span></p><p id=p397><span class='token pointer' id='tok-63-397'>Connect</span><span class='token pointer' id='tok-63-398'>to</span><span class='token pointer' id='tok-63-399'>the</span><span class='token pointer' id='tok-63-400'>server.recv</span><span class='token pointer' id='tok-63-401'>()</span><span class='token pointer' id='tok-63-402'>four</span><span class='token pointer' id='tok-63-403'>bytes</span><span class='token pointer' id='tok-63-404'>of</span><span class='token pointer' id='tok-63-405'>data</span><span class='token pointer' id='tok-63-406'>from</span><span class='token pointer' id='tok-63-407'>the</span><span class='token pointer' id='tok-63-408'>server</span><span class='token pointer' id='tok-63-409'>iteratively</span><span class='token pointer' id='tok-63-410'>four</span><span class='token pointer' id='tok-63-411'>times</span><span class='token pointer' id='tok-63-412'>and</span><span class='token pointer' id='tok-63-413'>add</span><span class='token pointer' id='tok-63-414'>them.DO</span><span class='token pointer' id='tok-63-415'>an</span><span class='token pointer' id='tok-63-416'>AND</span><span class='token pointer' id='tok-63-417'>operation</span><span class='token pointer' id='tok-63-418'>with</span><span class='token pointer' id='tok-63-419'>the</span><span class='token pointer' id='tok-63-421' style='color:red'>final sum,</span><span class='token pointer' id='tok-63-422'>the</span><span class='token pointer' id='tok-63-423' style='color:red'>result</span><span class='token pointer' id='tok-63-424'>stays</span><span class='token pointer' id='tok-63-425'>in</span><span class='token pointer' id='tok-63-426'>32</span><span class='token pointer' id='tok-63-427'>unsigned</span><span class='token pointer' id='tok-63-428'>int's</span><span class='token pointer' id='tok-63-429'>range.Pack</span><span class='token pointer' id='tok-63-430'>the</span><span class='token pointer' id='tok-63-431'>result</span><span class='token pointer' id='tok-63-432'>and</span><span class='token pointer' id='tok-63-433'>send</span><span class='token pointer' id='tok-63-435' style='color:red'>it back to the</span></p><p id=p436><span class='token pointer' id='tok-63-437' style='color:red'>This level</span><span class='token pointer' id='tok-63-438'>us</span><span class='token pointer' id='tok-63-439'>back</span><span class='token pointer' id='tok-63-440'>to</span><span class='token pointer' id='tok-63-441'>simple</span><span class='token pointer' id='tok-63-442'>stack</span><span class='token pointer' id='tok-63-443'>based</span><span class='token pointer' id='tok-63-444'>buffer</span><span class='token pointer' id='tok-63-445'>overflows</span><span class='token pointer' id='tok-63-446'>with</span><span class='token pointer' id='tok-63-448' style='color:red'>little restrictions added here</span><span class='token pointer' id='tok-63-449'>there.</span><span class='token pointer' id='tok-63-450'>Let's</span><span class='token pointer' id='tok-63-451'>have</span><span class='token pointer' id='tok-63-452'>a</span><span class='token pointer' id='tok-63-453'>look</span><span class='token pointer' id='tok-63-454'>at</span><span class='token pointer' id='tok-63-455'>the</span><span class='token pointer' id='tok-63-456'>disassembled</span><span class='token pointer' id='tok-63-457'>code</span><span class='token pointer' id='tok-63-458'>for</span><span class='token pointer' id='tok-63-459'>this</span><span class='token pointer' id='tok-63-460'>level.</span><span class='token pointer' id='tok-63-461'>By</span><span class='token pointer' id='tok-63-462'>looking</span><span class='token pointer' id='tok-63-463'>at</span><span class='token pointer' id='tok-63-464'>the</span><span class='token pointer' id='tok-63-465'>code</span><span class='token pointer' id='tok-63-468' style='color:red'>can quickly figure out</span><span class='token pointer' id='tok-63-469'>vulnerable</span><span class='token pointer' id='tok-63-470'>function</span><span class='token pointer' id='tok-63-471'>gets()</span><span class='token pointer' id='tok-63-472'>is</span><span class='token pointer' id='tok-63-473'>used</span><span class='token pointer' id='tok-63-474'>but</span><span class='token pointer' id='tok-63-475'>the</span><span class='token pointer' id='tok-63-476'>problem</span><span class='token pointer' id='tok-63-477'>is</span><span class='token pointer' id='tok-63-478'>our</span><span class='token pointer' id='tok-63-479'>input</span><span class='token pointer' id='tok-63-480'>gets</span><span class='token pointer' id='tok-63-481'>passed</span><span class='token pointer' id='tok-63-482'>through</span><span class='token pointer' id='tok-63-483'>the</span><span class='token pointer' id='tok-63-484'>for</span><span class='token pointer' id='tok-63-485'>loop</span><span class='token pointer' id='tok-63-486'>which</span><span class='token pointer' id='tok-63-487'>iterates</span><span class='token pointer' id='tok-63-488'>each</span><span class='token pointer' id='tok-63-489'>of</span><span class='token pointer' id='tok-63-490'>our</span><span class='token pointer' id='tok-63-491'>provided</span><span class='token pointer' id='tok-63-492'>bytes</span><span class='token pointer' id='tok-63-493'>thus</span><span class='token pointer' id='tok-63-494'>it</span><span class='token pointer' id='tok-63-495'>will</span><span class='token pointer' id='tok-63-496'>corrupt</span><span class='token pointer' id='tok-63-497'>any</span><span class='token pointer' id='tok-63-498'>non-alpha</span><span class='token pointer' id='tok-63-499'>uppercase</span><span class='token pointer' id='tok-63-500'>shellcode.</span></p><p id=p501><span class='token pointer' id='tok-63-502' style='color:red'>So, let's</span><span class='token pointer' id='tok-63-503'>with</span><span class='token pointer' id='tok-63-504'>fuzzing</span><span class='token pointer' id='tok-63-505'>the</span><span class='token pointer' id='tok-63-506'>application</span><span class='token pointer' id='tok-63-507'>and</span><span class='token pointer' id='tok-63-508'>figuring</span><span class='token pointer' id='tok-63-509'>out</span><span class='token pointer' id='tok-63-510'>the</span><span class='token pointer' id='tok-63-511'>offset</span><span class='token pointer' id='tok-63-512'>to</span><span class='token pointer' id='tok-63-513'>EIP.</span><span class='token pointer' id='tok-63-514'>First,</span><span class='token pointer' id='tok-63-515'>we</span><span class='token pointer' id='tok-63-516'>use</span><span class='token pointer' id='tok-63-517'>Python's</span><span class='token pointer' id='tok-63-518'>pwntools</span><span class='token pointer' id='tok-63-519'>library</span><span class='token pointer' id='tok-63-520'>for</span><span class='token pointer' id='tok-63-521'>generating</span><span class='token pointer' id='tok-63-522'>a</span><span class='token pointer' id='tok-63-523'>cyclic</span><span class='token pointer' id='tok-63-524'>pattern</span><span class='token pointer' id='tok-63-525'>and</span><span class='token pointer' id='tok-63-526'>end</span><span class='token pointer' id='tok-63-527'>up</span><span class='token pointer' id='tok-63-528'>with</span><span class='token pointer' id='tok-63-530' style='color:red'>following snippet of</span></p><p id=p531><span class='token pointer' id='tok-63-531' style='color:red'>An</span><span class='token pointer' id='tok-63-532'>observant</span><span class='token pointer' id='tok-63-533'>user</span><span class='token pointer' id='tok-63-534'>must</span><span class='token pointer' id='tok-63-535'>have</span><span class='token pointer' id='tok-63-536'>noticed</span><span class='token pointer' id='tok-63-537'>that</span><span class='token pointer' id='tok-63-538'>application</span><span class='token pointer' id='tok-63-539'>is</span><span class='token pointer' id='tok-63-540'>using</span><span class='token pointer' id='tok-63-541'>forking</span><span class='token pointer' id='tok-63-542'>technique</span><span class='token pointer' id='tok-63-544' style='color:red'>to serve connections</span><span class='token pointer' id='tok-63-545' style='color:red'>debugging</span><span class='token pointer' id='tok-63-546'>using</span><span class='token pointer' id='tok-63-547'>process</span><span class='token pointer' id='tok-63-548'>id</span><span class='token pointer' id='tok-63-549' style='color:red'>will</span><span class='token pointer' id='tok-63-551' style='color:red'>not work</span><span class='token pointer' id='tok-63-552'>runtime</span><span class='token pointer' id='tok-63-553'>analysis.</span><span class='token pointer' id='tok-63-554'>Therefore,</span><span class='token pointer' id='tok-63-556' style='color:red'>we need</span><span class='token pointer' id='tok-63-557'>debug</span><span class='token pointer' id='tok-63-558'>child</span><span class='token pointer' id='tok-63-559'>process.</span><span class='token pointer' id='tok-63-560'>We</span><span class='token pointer' id='tok-63-561'>placed</span><span class='token pointer' id='tok-63-562'>a</span><span class='token pointer' id='tok-63-563'>breakpoint</span><span class='token pointer' id='tok-63-564'>after</span><span class='token pointer' id='tok-63-565'>strdup</span><span class='token pointer' id='tok-63-566'>(0x0804982a)</span><span class='token pointer' id='tok-63-567'>and</span><span class='token pointer' id='tok-63-568'>started</span><span class='token pointer' id='tok-63-569'>analyzing</span><span class='token pointer' id='tok-63-570'>the</span><span class='token pointer' id='tok-63-571'>state</span><span class='token pointer' id='tok-63-572'>of</span><span class='token pointer' id='tok-63-573'>the</span><span class='token pointer' id='tok-63-574'>process.</span></p><p id=p575><span class='token pointer' id='tok-63-576' style='color:red'>As we</span><span class='token pointer' id='tok-63-577'>need</span><span class='token pointer' id='tok-63-578'>to</span><span class='token pointer' id='tok-63-579'>debug</span><span class='token pointer' id='tok-63-580'>the</span><span class='token pointer' id='tok-63-581'>same</span><span class='token pointer' id='tok-63-582'>process</span><span class='token pointer' id='tok-63-583'>multiple</span><span class='token pointer' id='tok-63-584'>times</span><span class='token pointer' id='tok-63-585'>so</span><span class='token pointer' id='tok-63-586'>it</span><span class='token pointer' id='tok-63-587'>will</span><span class='token pointer' id='tok-63-588'>be</span><span class='token pointer' id='tok-63-590' style='color:red'>a bit</span><span class='token pointer' id='tok-63-591'>to</span><span class='token pointer' id='tok-63-592'>set</span><span class='token pointer' id='tok-63-593'>gdb</span><span class='token pointer' id='tok-63-594'>commands</span><span class='token pointer' id='tok-63-595'>every</span><span class='token pointer' id='tok-63-597' style='color:red'>time, therefore</span><span class='token pointer' id='tok-63-598'>will</span><span class='token pointer' id='tok-63-599'>be</span><span class='token pointer' id='tok-63-600'>using</span><span class='token pointer' id='tok-63-601'>the</span><span class='token pointer' id='tok-63-602'>.gdbinit</span><span class='token pointer' id='tok-63-604' style='color:red'>file for</span><span class='token pointer' id='tok-63-605'>sake</span><span class='token pointer' id='tok-63-606'>of</span><span class='token pointer' id='tok-63-607'>automation.</span></p><p id=p608><span class='token pointer' id='tok-63-608'>After</span><span class='token pointer' id='tok-63-609'>editing</span><span class='token pointer' id='tok-63-610'>the</span><span class='token pointer' id='tok-63-611'>.gdbinit</span><span class='token pointer' id='tok-63-612'>file</span><span class='token pointer' id='tok-63-613'>and</span><span class='token pointer' id='tok-63-614'>sending</span><span class='token pointer' id='tok-63-615'>our</span><span class='token pointer' id='tok-63-616'>fuzz</span><span class='token pointer' id='tok-63-617'>string</span><span class='token pointer' id='tok-63-618'>we</span><span class='token pointer' id='tok-63-619'>got</span><span class='token pointer' id='tok-63-620'>an</span><span class='token pointer' id='tok-63-621'>$eip</span><span class='token pointer' id='tok-63-622'>overwrite</span><span class='token pointer' id='tok-63-623'>at</span><span class='token pointer' id='tok-63-624'>0x46414149,</span><span class='token pointer' id='tok-63-625'>our</span><span class='token pointer' id='tok-63-626'>input</span><span class='token pointer' id='tok-63-627'>is</span><span class='token pointer' id='tok-63-628'>placed</span><span class='token pointer' id='tok-63-629'>on</span><span class='token pointer' id='tok-63-630'>the</span><span class='token pointer' id='tok-63-631'>stack</span><span class='token pointer' id='tok-63-632'>and</span><span class='token pointer' id='tok-63-634' style='color:red'>$eax points</span><span class='token pointer' id='tok-63-635'>some</span><span class='token pointer' id='tok-63-636'>part</span><span class='token pointer' id='tok-63-637'>of</span><span class='token pointer' id='tok-63-638'>our</span><span class='token pointer' id='tok-63-639'>shellcode</span><span class='token pointer' id='tok-63-640'>mainly</span><span class='token pointer' id='tok-63-641'>from</span><span class='token pointer' id='tok-63-642'>the</span><span class='token pointer' id='tok-63-643' style='color:red'>start</span><span class='token pointer' id='tok-63-644'>because</span><span class='token pointer' id='tok-63-645'>of</span><span class='token pointer' id='tok-63-646'>strdup()</span><span class='token pointer' id='tok-63-647'>function</span><span class='token pointer' id='tok-63-648'>which</span><span class='token pointer' id='tok-63-649' style='color:red'>returns</span><span class='token pointer' id='tok-63-650'>in</span><span class='token pointer' id='tok-63-651'>$eax.</span><span class='token pointer' id='tok-63-652'>We</span><span class='token pointer' id='tok-63-654' style='color:red'>further used cyclic_find</span><span class='token pointer' id='tok-63-655'>from</span><span class='token pointer' id='tok-63-656'>pwntools</span><span class='token pointer' id='tok-63-657'>to</span><span class='token pointer' id='tok-63-659' style='color:red'>get offset</span><span class='token pointer' id='tok-63-660'>$eip</span><span class='token pointer' id='tok-63-661'>at</span><span class='token pointer' id='tok-63-662'>532.</span></p><p id=p663><span class='token pointer' id='tok-63-664' style='color:red'>Ethical Hacking</span><span class='token pointer' id='tok-63-665'>–</span><span class='token pointer' id='tok-63-666' style='color:red'>Resources</span><span class='token pointer' id='tok-63-667'>(InfoSec)</span></p><p id=p668><span class='token pointer' id='tok-63-668'>Now</span><span class='token pointer' id='tok-63-669'>there</span><span class='token pointer' id='tok-63-670'>are</span><span class='token pointer' id='tok-63-671'>multiple</span><span class='token pointer' id='tok-63-672'>options</span><span class='token pointer' id='tok-63-673'>for</span><span class='token pointer' id='tok-63-674'>writing</span><span class='token pointer' id='tok-63-675' style='color:red'>exploit</span><span class='token pointer' id='tok-63-676'>for</span><span class='token pointer' id='tok-63-677'>this</span><span class='token pointer' id='tok-63-678'>program:</span></p><p id=p679><span class='token pointer' id='tok-63-679'>Return</span><span class='token pointer' id='tok-63-680'>to</span><span class='token pointer' id='tok-63-681'>register:</span><span class='token pointer' id='tok-63-682'>call</span><span class='token pointer' id='tok-63-683'>eax</span><span class='token pointer' id='tok-63-684'>(required</span><span class='token pointer' id='tok-63-685'>Alpha</span><span class='token pointer' id='tok-63-686'>upper</span><span class='token pointer' id='tok-63-687'>shellcode)Jump</span><span class='token pointer' id='tok-63-688'>to</span><span class='token pointer' id='tok-63-690' style='color:red'>stack: At</span><span class='token pointer' id='tok-63-691'>time</span><span class='token pointer' id='tok-63-692'>of</span><span class='token pointer' id='tok-63-693'>the</span><span class='token pointer' id='tok-63-694'>crash,</span><span class='token pointer' id='tok-63-695'>no</span><span class='token pointer' id='tok-63-696'>pointers</span><span class='token pointer' id='tok-63-697'>to</span><span class='token pointer' id='tok-63-699' style='color:red'>our shellcode</span><span class='token pointer' id='tok-63-700'>present</span><span class='token pointer' id='tok-63-701' style='color:red'>on</span><span class='token pointer' id='tok-63-702'>the</span><span class='token pointer' id='tok-63-703'>stack</span><span class='token pointer' id='tok-63-704'>we</span><span class='token pointer' id='tok-63-705'>need</span><span class='token pointer' id='tok-63-706'>to</span><span class='token pointer' id='tok-63-707'>rely</span><span class='token pointer' id='tok-63-708'>on</span><span class='token pointer' id='tok-63-709'>the</span><span class='token pointer' id='tok-63-710'>hardcoded</span><span class='token pointer' id='tok-63-711'>address</span><span class='token pointer' id='tok-63-712'>(Not</span><span class='token pointer' id='tok-63-713'>a</span><span class='token pointer' id='tok-63-714'>reliable</span><span class='token pointer' id='tok-63-715'>way).</span><span class='token pointer' id='tok-63-716'>Also,</span><span class='token pointer' id='tok-63-717'>we</span><span class='token pointer' id='tok-63-718'>do</span><span class='token pointer' id='tok-63-719'>not</span><span class='token pointer' id='tok-63-720'>need</span><span class='token pointer' id='tok-63-721'>alphanumeric</span><span class='token pointer' id='tok-63-722'>shellcode</span><span class='token pointer' id='tok-63-723'>in</span><span class='token pointer' id='tok-63-724'>this</span><span class='token pointer' id='tok-63-725'>case</span><span class='token pointer' id='tok-63-727' style='color:red'>as gets will copying our</span><span class='token pointer' id='tok-63-728'>into</span><span class='token pointer' id='tok-63-729'>buffer</span><span class='token pointer' id='tok-63-730'>after</span><span class='token pointer' id='tok-63-731'>it</span><span class='token pointer' id='tok-63-732'>meets</span><span class='token pointer' id='tok-63-733'>a</span><span class='token pointer' id='tok-63-734' style='color:red'>null</span><span class='token pointer' id='tok-63-735'>bytes</span><span class='token pointer' id='tok-63-736'>(\x00).ROP</span><span class='token pointer' id='tok-63-737'>Chain</span><span class='token pointer' id='tok-63-738'>via</span><span class='token pointer' id='tok-63-739'>ret2libc:</span><span class='token pointer' id='tok-63-740'>As</span><span class='token pointer' id='tok-63-741'>there</span><span class='token pointer' id='tok-63-742'>is</span><span class='token pointer' id='tok-63-743'>no</span><span class='token pointer' id='tok-63-744'>ASLR</span><span class='token pointer' id='tok-63-745'>enabled</span><span class='token pointer' id='tok-63-746'>on</span><span class='token pointer' id='tok-63-747'>the</span><span class='token pointer' id='tok-63-748'>system</span><span class='token pointer' id='tok-63-749'>we</span><span class='token pointer' id='tok-63-750'>can</span><span class='token pointer' id='tok-63-751'>rely</span><span class='token pointer' id='tok-63-752'>on</span><span class='token pointer' id='tok-63-753'>the</span><span class='token pointer' id='tok-63-754'>PLT</span><span class='token pointer' id='tok-63-755'>address</span><span class='token pointer' id='tok-63-756'>from</span><span class='token pointer' id='tok-63-757'>the</span><span class='token pointer' id='tok-63-758'>executable</span><span class='token pointer' id='tok-63-759'>itself</span><span class='token pointer' id='tok-63-760'>construct</span><span class='token pointer' id='tok-63-761'>a</span><span class='token pointer' id='tok-63-762'>simple</span><span class='token pointer' id='tok-63-763'>ROP</span><span class='token pointer' id='tok-63-764'>chain.</span><span class='token pointer' id='tok-63-765'>(Reliable</span><span class='token pointer' id='tok-63-766'>unless</span><span class='token pointer' id='tok-63-767'>ASLR</span><span class='token pointer' id='tok-63-768'>is</span><span class='token pointer' id='tok-63-769'>enabled</span><span class='token pointer' id='tok-63-770'>even</span><span class='token pointer' id='tok-63-771'>in</span><span class='token pointer' id='tok-63-772'>that</span><span class='token pointer' id='tok-63-773'>case</span><span class='token pointer' id='tok-63-774'>we</span><span class='token pointer' id='tok-63-775'>need</span><span class='token pointer' id='tok-63-776'>to</span><span class='token pointer' id='tok-63-777'>modify</span><span class='token pointer' id='tok-63-778'>our</span><span class='token pointer' id='tok-63-779'>shellcode</span><span class='token pointer' id='tok-63-780'>to</span><span class='token pointer' id='tok-63-781'>make</span><span class='token pointer' id='tok-63-782' style='color:red'>it</span><span class='token pointer' id='tok-63-783'>work</span><span class='token pointer' id='tok-63-784'>again</span><span class='token pointer' id='tok-63-785'>slightly)Our</span><span class='token pointer' id='tok-63-786'>ROP</span><span class='token pointer' id='tok-63-787'>chain</span><span class='token pointer' id='tok-63-788'>will</span></p><p id=p790><span class='token pointer' id='tok-63-790'>Read</span><span class='token pointer' id='tok-63-791'>the</span><span class='token pointer' id='tok-63-792'>contents</span><span class='token pointer' id='tok-63-793'>of</span><span class='token pointer' id='tok-63-794'>system</span><span class='token pointer' id='tok-63-795'>command</span><span class='token pointer' id='tok-63-796'>in</span><span class='token pointer' id='tok-63-797' style='color:red'>.dynamic</span><span class='token pointer' id='tok-63-798'>section.Pass</span><span class='token pointer' id='tok-63-799'>the</span><span class='token pointer' id='tok-63-800'>pointer</span><span class='token pointer' id='tok-63-801'>of</span><span class='token pointer' id='tok-63-802'>.dynamic</span><span class='token pointer' id='tok-63-803'>to</span><span class='token pointer' id='tok-63-804'>execve.</span></p><p id=p805><span class='token pointer' id='tok-63-805'>As</span><span class='token pointer' id='tok-63-806'>we</span><span class='token pointer' id='tok-63-807'>see</span><span class='token pointer' id='tok-63-808'>in</span><span class='token pointer' id='tok-63-809'>the</span><span class='token pointer' id='tok-63-810'>following</span><span class='token pointer' id='tok-63-811'>screenshot,</span><span class='token pointer' id='tok-63-812'>we</span><span class='token pointer' id='tok-63-813'>were</span><span class='token pointer' id='tok-63-814'>able</span><span class='token pointer' id='tok-63-815'>to</span><span class='token pointer' id='tok-63-816'>obtain</span><span class='token pointer' id='tok-63-817'>remote</span><span class='token pointer' id='tok-63-818'>shell</span><span class='token pointer' id='tok-63-819'>by</span><span class='token pointer' id='tok-63-820'>exploiting</span><span class='token pointer' id='tok-63-821'>final0</span><span class='token pointer' id='tok-63-822'>binary.</span></p><p id=p823><span class='token pointer' id='tok-63-823'></span><span class='token pointer' id='tok-63-824'></span><span class='token pointer' id='tok-63-825'></span><span class='token pointer' id='tok-63-826'></span></p>