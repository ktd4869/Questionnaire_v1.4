<p id=p0>The <span class='token pointer' id='tok-37-0' style='color:red'>attack</span><span class='token pointer' id='tok-37-1' style='color:red'>bypasses</span><span class='token pointer' id='tok-37-2' style='color:red'>BIOS</span><span class='token pointer' id='tok-37-3' style='color:red'>mitigations</span>for <span class='token pointer' id='tok-37-4' style='color:red'>compromise</span><span class='token pointer' id='tok-37-5' style='color:red'>cold-boot</span>models from Apple, Dell, Lenovo and all others made in the last 10 years. </p><p id=p23>A pair of researchers have developed an attack method that can <span class='token pointer' id='tok-37-6' style='color:red'>bypass mitigations</span>cold-boot attacks on <span class='token pointer' id='tok-37-7' style='color:red'>laptops.</span>A physical attacker can compromise a laptop that's in sleep mode, potentially lifting sensitive passwords, <span class='token pointer' id='tok-37-8' style='color:red'>encryption</span>keys and other information. </p><p id=p61>The <span class='token pointer' id='tok-37-9' style='color:red'>ramifications</span>are, on the surface, vast – given that the attack will work on any laptop manufactured in the last decade, including models from Apple, Dell and Lenovo, and even if there's full disk encryption on the device. However, putting the attack together is a rather involved process, which fortunately raises the barrier to <span class='token pointer' id='tok-37-10' style='color:red'>exploitation.</span></p><p id=p117>Even so, "sleep mode is <span class='token pointer' id='tok-37-11' style='color:red'>vulnerable</span>mode," said F-Secure principal security consultant Olle <span class='token pointer' id='tok-37-12' style='color:red'>Segerdahl,</span>in a Thursday posting on the attack. </p><p id=p138>"It's not exactly easy to do, but it's not a hard-enough issue to find and exploit for us to ignore the probability that some attackers have already figured this out," said Segerdahl. "It's not exactly the kind of thing that attackers looking for easy targets will use. But it is the kind of thing that attackers looking for bigger <span class='token pointer' id='tok-37-13' style='color:red'>phish,</span>like a bank or large enterprise, will know how to use." </p><p id=p209>Cold Boot: A Chilling Attack </p><p id=p214>Cold-boot attacks were pioneered 10 years ago by researchers; they found that when a platform reboots or shuts down, there's a short timeframe during which an attacker can turn off or reboot the platform, and quickly turn it back on to boot into a program that dumps the contents of memory. Thus, encryption keys and other secrets can be easily compromised. </p><p id=p275>Trusted Computing Group (TCG) swiftly issued a <span class='token pointer' id='tok-37-14' style='color:red'>fix,</span>which has been implemented into computers wholesale ever since: On the next platform reboot, the BIOS simply overwrites the system memory with information unrelated to any secrets that may be exposed. </p><p id=p314>Segerdahl and his fellow F-Secure cybersecurity consultant Pasi Saarinen have now <span class='token pointer' id='tok-37-15' style='color:red'>discovered</span>a way to disable this overwrite feature using a hardware-based attack that rewrites the memory chip that contains the settings, <span class='token pointer' id='tok-37-16' style='color:red'>paving</span>the way for cold-boot attacks to be carried out by <span class='token pointer' id='tok-37-17' style='color:red'>booting</span>a special program off a USB stick. </p><p id=p365>How-To: The Bypass Attack </p><p id=p369>To re-enable the original cold-boot attacks despite the <span class='token pointer' id='tok-37-18' style='color:red'>TCG protections,</span>researchers used physical access [video demonstration, here] to modify the system firmware/firmware settings. </p><p id=p393>"This lets us bypass the TCG memory overwrite mitigation and any password protected configuration options such as allowed external boot devices," Segerdahl told Threatpost. </p><p id=p417>To carry out the attack, an adversary would boot Windows with BitLocker (or <span class='token pointer' id='tok-37-19' style='color:red'>steal</span>a powered-on device) and then put the computer to sleep; he or she could then use physical access to set the NVRAM variable "MemoryOverwriteRequest" to zero (the NVRAM "BootOrder" variable can also be modified here to allow booting from external media, if necessary). </p><p id=p474>After a machine reset, the attacker would then boot from external media and use crafted software to scan the device's memory for the <span class='token pointer' id='tok-37-20' style='color:red'>BitLocker key.</span>then possible to boot Linux and use the open-source "dislocker" package to mount the BitLocker volume using the key, to read or modify any data on that protected volume. </p><p id=p529>Carrying this out requires a special tool for the physical access step, "which is basically any <span class='token pointer' id='tok-37-21' style='color:red'>microcontroller</span>– which can be used to interface to the SPI flash chip [using an SOIC-8 'chip-clip' on the target motherboard]," Segerdahl told us. "We used an Arduino Nano that we built from scratch to rewrite the NVRAM." </p><p id=p583>Using this technique, any modern device using BitLocker can be unlocked by extracting AES keys from RAM, Segerdahl noted; he added that even a device configured with pre-boot authentication is vulnerable if it's found in a booted or sleep state. </p><p id=p623>But that's not all: "Cold-boot attacks are a known method of obtaining encryption keys from devices (BitLocker, FileVault2, LUKS, etc.)," Segerdahl said. "But the reality is that attackers can get their hands on all kinds of information using these attacks." </p><p id=p663>He explained to Threatpost that passwords, credentials to corporate networks and any data stored on the machine is at risk. </p><p id=p683>"The obvious target is disk encryption keys since these give access to all information stored on the protected volume," he said. "You can of course steal passwords from memory, but more likely you will be able to steal passwords and VPN credentials from the encrypted disk or plant <span class='token pointer' id='tok-37-22' style='color:red'>a backdoor</span>the encrypted disk that allows you to log in and use the machine (including any configured </p><p id=p752>Mitigations </p><p id=p753>Segerdahl said that there's no easy fix <span class='token pointer' id='tok-37-23' style='color:red'>available</span>to vendors, and any coordinated response will take time (though F-Secure notified Microsoft, Intel and Apple). So, the mitigations are mainly on the end-user side for now. </p><p id=p788>"Microsoft updated their guidance on BitLocker countermeasures," he said. "And according to Apple, Macs equipped with an Apple T2 Chip contain security measures designed to protect devices from attacks like [ours]. Apple also recommends users set a firmware password to help harden Macs without a T2 chip." </p><p id=p835>Interestingly, hibernating machines are not at risk. </p><p id=p842>"When a computer goes into hibernation, it moves everything from the RAM to the encrypted hard drive and securely deletes the encryption keys from memory," Segerdahl told Threatpost. "As there are no secrets left in the RAM, there is nothing for an attacker to steal. Laptops forced to hibernate/shut down after a certain period of time and require the BitLocker PIN to be entered when leaving hibernate (or powered on) are therefore going to be the most resilient to the attack." </p><p id=p923>Companies, meanwhile, can configure laptops "so that an attacker using a cold-boot attack won't find anything to steal," he said. Mainly, this is done by IT, which can configure all company computers to either shut down or hibernate (not enter sleep mode) and require users to enter their Bitlocker PIN whenever they power up or restore their computers. </p><p id=p981>"An attacker could still perform a <span class='token pointer' id='tok-37-24' style='color:red'>successful</span>cold boot attack against machines configured like this," Segerdahl said. "But encryption keys aren't stored in the RAM when a machine hibernates or shuts down. So, there's no valuable info for an attacker to steal." </p><p id=p1023>Awareness is also important – leaving laptops unattended is never a good idea, in any case.
 </p>