<p id=p0>The big challenge with <span class='token pointer' id='tok-29-0' style='color:red'>IoT</span><span class='token pointer' id='tok-29-1' style='color:red'>devices</span>is that they are all different: Each manufacturer has its own <span class='token pointer' id='tok-29-2' style='color:red'>firmware,</span>uses different <span class='token pointer' id='tok-29-3' style='color:red'>protocols,</span>and designs its own <span class='token pointer' id='tok-29-4' style='color:red'>architecture.</span>So, the first step before carrying out any analysis is to understand the architecture, find out what <span class='token pointer' id='tok-29-5' style='color:red'>components</span>are involved, and how they interact and communicate among themselves. </p><p id=p54>Nowadays, a lot of attacks take place by tricking the user in some way, such as to open a file, click on a malicious link, or enter their personal data into a fake website. </p><p id=p88>But when it comes to <span class='token pointer' id='tok-29-6' style='color:red'>the "Internet of Things"</span>the methods are a little different. In principle, this is partly because in many cases there is no <span class='token pointer' id='tok-29-7' style='color:red'>interface</span>for the user to interact with, but added to that, the devices themselves often present <span class='token pointer' id='tok-29-8' style='color:red'>vulnerabilities</span>and poor implementations of security measures. </p><p id=p138>The big challenge <span class='token pointer' id='tok-29-9' style='color:red'>with IoT</span>devices is that they are all different: Each manufacturer has its own firmware, uses different protocols, and designs its own architecture. So, the first step before carrying out any analysis is to understand the architecture, find out what components are involved, and how they interact and communicate among themselves. The ideal thing at this stage is to make a diagram of the device, as precisely as possible, including each component and its interactions, in order to determine what could go wrong with each of the parts involved. </p><p id=p228>This way, you will be in a better position to define the <span class='token pointer' id='tok-29-10' style='color:red'>attack surface and</span>out the various individual <span class='token pointer' id='tok-29-11' style='color:red'>vectors</span>that could be used. </p><p id=p251>At this first stage, your analysis can be as in-depth as you want, you can even open each device and analyze the internal components from an electronics or communications perspective. Try to identify which components could be useful to you when you come to search for possible vulnerabilities, like <span class='token pointer' id='tok-29-12' style='color:red'>filtering</span><span class='token pointer' id='tok-29-13' style='color:red'>modules, JTAG</span><span class='token pointer' id='tok-29-14' style='color:red'>interfaces,</span><span class='token pointer' id='tok-29-15' style='color:red'>flash drives,</span></p><p id=p310>Now you have your diagram, you have your analysis lab ready, but… what are you actually looking for? </p><p id=p326>Basically, anything that can be <span class='token pointer' id='tok-29-16' style='color:red'>intercepted</span>or manipulated from beyond the usual <span class='token pointer' id='tok-29-17' style='color:red'>flow.</span>A good way to start looking for possible vulnerabilities is to try and see how you can interact with the various components beyond the usual flow, for example, <span class='token pointer' id='tok-29-18' style='color:red'>hijacking</span>a component or <span class='token pointer' id='tok-29-19' style='color:red'>disrupting</span>a controller. </p><p id=p374>You can start with means of communication, intercepting any type of traffic that enters or exits a device, whether it's via <span class='token pointer' id='tok-29-20' style='color:red'>Bluetooth,</span><span class='token pointer' id='tok-29-21' style='color:red'>Wi-Fi,</span><span class='token pointer' id='tok-29-22' style='color:red'>radio frequencies,</span>even an <span class='token pointer' id='tok-29-23' style='color:red'>infrared controller</span>as a <span class='token pointer' id='tok-29-24' style='color:red'>standard remote control</span>a TV. </p><p id=p413>One clear example of this is the <span class='token pointer' id='tok-29-25' style='color:red'>vulnerability</span>discovered in 2013 by the researcher Nitesh Dhanjani in the communication between Philips Hue lamps and their <span class='token pointer' id='tok-29-26' style='color:red'>hub</span>or <span class='token pointer' id='tok-29-27' style='color:red'>controller.</span>These devices communicate among themselves via the <span class='token pointer' id='tok-29-28' style='color:red'>Zigbee wireless protocol,</span>if attackers run a <span class='token pointer' id='tok-29-29' style='color:red'>successful sniffer attack</span>on this traffic, they will be able to analyze and understand the communication between the hub and the lights, and even disrupt or change the <span class='token pointer' id='tok-29-30' style='color:red'>data packets,</span>as to switch the lights on and off, regardless of what order is sent by the hub. That means—as Nitesh showed in his research—causing a <span class='token pointer' id='tok-29-31' style='color:red'>permanent blackout</span>a <span class='token pointer' id='tok-29-32' style='color:red'>Hue lighting system.</span>this vulnerability in the <span class='token pointer' id='tok-29-33' style='color:red'>Zigbee protocol</span>corrected and so the <span class='token pointer' id='tok-29-34' style='color:red'>Philips lights</span>other affected devices were <span class='token pointer' id='tok-29-35' style='color:red'>patched.</span>Still, it is a good example of a vulnerability found by means of <span class='token pointer' id='tok-29-36' style='color:red'>a sniffer and man-in-the-middle</span><span class='token pointer' id='tok-29-37' style='color:red'>technique</span>that was adapted to suit the new architecture. </p><p id=p559>There are many more examples like this out there, including some that are still current, affecting toys, <span class='token pointer' id='tok-29-38' style='color:red'>IP cameras,</span>thermostats, household appliances, and almost any other smart device. Many of them present known vulnerabilities in their components or communication, or do not implement sufficiently strong security measures to keep an attacker out. </p><p id=p610>It is very common for these devices to send plain text information among some of their components, to use <span class='token pointer' id='tok-29-39' style='color:red'>encryption,</span><span class='token pointer' id='tok-29-40' style='color:red'>insufficient</span>even not to request any kind of <span class='token pointer' id='tok-29-41' style='color:red'>authentication.</span></p><p id=p640>Another example involved a well-known baby monitor which offered an interface operating via the <span class='token pointer' id='tok-29-42' style='color:red'>Internet,</span>whereby the parents could not only see the child through a camera, but also talk and send sounds to the baby. Due to the method of authentication and a vulnerability in the <span class='token pointer' id='tok-29-43' style='color:red'>platform,</span>an attacker could send sounds and even play music through various monitors. That's pretty dangerous when you consider the level of access to a family's privacy that these devices have. </p><p id=p718>If you have any <span class='token pointer' id='tok-29-44' style='color:red'>smart devices</span>your home, you can start running your own security tests. Start by making a diagram of the architecture, understanding it, and defining the <span class='token pointer' id='tok-29-45' style='color:red'>attack surface.</span>for possible vulnerabilities by <span class='token pointer' id='tok-29-46' style='color:red'>intercepting traffic,</span>whether the information is <span class='token pointer' id='tok-29-47' style='color:red'>encrypted,</span>and seeing how it can be manipulated. The operating <span class='token pointer' id='tok-29-48' style='color:red'>system AttfyOS,</span>which we recommended previously, is a good tool to start with. </p><p id=p783>In future posts, we will be analyzing the different tools it offers and showing you some techniques for analyzing IoT devices.
 </p>