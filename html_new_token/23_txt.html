<p id=p0><span id='tok'>Introduction</span></p><p id=p1><span id='tok'>In</span><span id='tok'>1968</span><span id='tok'>and</span><span id='tok'>1969,</span><span id='tok'>the</span><span class='token pointer' id='tok-23-0' style='color:red'>smartcard</span><span id='tok'>was</span><span class='token pointer' id='tok-23-1' style='color:red'>patented</span><span id='tok'>in</span><span id='tok'>German</span><span id='tok'>by</span><span id='tok'>Helmut</span><span id='tok'>Gröttrup</span><span id='tok'>and</span><span class='token pointer' id='tok-23-2' style='color:red'>Jürgen</span><span id='tok'>Dethloff.</span><span id='tok'>The</span><span id='tok'>smartcard</span><span id='tok'>is</span><span id='tok'>simply</span><span id='tok'>a</span><span id='tok'>card</span><span id='tok'>with</span><span id='tok'>an</span><span class='token pointer' id='tok-23-3' style='color:red'>Integrated</span><span class='token pointer' id='tok-23-4' style='color:red'>Circuit</span><span id='tok'>that</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>programmed.</span><span id='tok'>This</span><span class='token pointer' id='tok-23-5' style='color:red'>technology</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>used</span><span id='tok'>widely</span><span id='tok'>in</span><span id='tok'>our</span><span id='tok'>daily</span><span id='tok'>lives</span><span id='tok'>and</span><span id='tok'>will</span><span id='tok'>become</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>important</span><span id='tok'>keys</span><span id='tok'>in</span><span class='token pointer' id='tok-23-6' style='color:red'>Internet of Things (IoT)</span><span class='token pointer' id='tok-23-7' style='color:red'>(M2M)</span><span class='token pointer' id='tok-23-8' style='color:red'>Machine to Machine</span><span class='token pointer' id='tok-23-9' style='color:red'>Smartcard</span><span id='tok'>applications</span><span id='tok'>could</span><span id='tok'>be</span><span class='token pointer' id='tok-23-10' style='color:red'>Java</span><span class='token pointer' id='tok-23-11' style='color:red'>Card,</span><span class='token pointer' id='tok-23-12' style='color:red'>programmed using</span><span id='tok'>open</span><span id='tok'>platform</span><span id='tok'>from</span><span id='tok'>Sun</span><span class='token pointer' id='tok-23-13' style='color:red'>Microsystems.</span><span id='tok'>Today,</span><span id='tok'>we</span><span id='tok'>find</span><span id='tok'>smartcard</span><span id='tok'>technology</span><span id='tok'>mostly</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>communications</span><span class='token pointer' id='tok-23-14' style='color:red'>(GSM/CDMA Sim Card)</span><span id='tok'>payments</span><span id='tok'>(credit/debit</span><span id='tok'>card).</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>an</span><span id='tok'>example</span><span id='tok'>of</span><span id='tok'>smartcard</span><span id='tok'>technology</span><span id='tok'>that</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>Indonesia:</span></p><p id=p103><span id='tok'>Computer</span><span id='tok'>Forensics</span><span id='tok'>Training</span><span id='tok'>–</span><span id='tok'>Resources</span><span id='tok'>(InfoSec)</span></p><p id=p109><span id='tok'>How</span><span id='tok'>Does</span><span id='tok'>the</span><span id='tok'>Smartcard</span><span id='tok'>Work?</span></p><p id=p114><span id='tok'>1.</span></p><p id=p117><span id='tok'>In</span><span id='tok'>order</span><span id='tok'>to</span><span id='tok'>interact</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>that</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>connected</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>smartcard</span><span class='token pointer' id='tok-23-15' style='color:red'>terminal,</span><span id='tok'>it</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>activated</span><span id='tok'>using</span><span id='tok'>electrical</span><span class='token pointer' id='tok-23-16' style='color:red'>signals</span><span class='token pointer' id='tok-23-17' style='color:red'>according</span><span id='tok'>to</span><span id='tok'>smartcard</span><span id='tok'>specification</span><span class='token pointer' id='tok-23-18' style='color:red'>(ISO/IEC</span><span class='token pointer' id='tok-23-19' style='color:red'>class A, B, or C</span><span id='tok'>The</span><span id='tok'>activation</span><span id='tok'>sequence</span><span id='tok'>goes</span><span id='tok'>like</span><span id='tok'>this:</span></p><p id=p156><span class='token pointer' id='tok-23-20' style='color:red'>RST</span><span class='token pointer' id='tok-23-21' style='color:red'>pin</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>put</span><span id='tok'>to</span><span id='tok'>LOW</span><span id='tok'>state.Vcc</span><span id='tok'>pin</span><span id='tok'>should</span><span id='tok'>be</span><span class='token pointer' id='tok-23-22' style='color:red'>powered.I/O</span><span id='tok'>pin</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>terminal</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>put</span><span id='tok'>to</span><span id='tok'>receive</span><span id='tok'>mode,</span><span id='tok'>even</span><span id='tok'>though</span><span id='tok'>it</span><span id='tok'>could</span><span id='tok'>ignore</span><span id='tok'>the</span><span class='token pointer' id='tok-23-23' style='color:red'>I/O</span><span class='token pointer' id='tok-23-24' style='color:red'>place.CLK</span><span class='token pointer' id='tok-23-25' style='color:red'>logic while smartcard activation takes</span><span id='tok'>should</span><span id='tok'>provide</span><span id='tok'>clock</span><span class='token pointer' id='tok-23-26' style='color:red'>signal</span><span id='tok'>to</span><span id='tok'>the</span><span class='token pointer' id='tok-23-27' style='color:red'>smartcard.More</span><span id='tok'>detailed</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>this</span><span id='tok'>smartcard</span><span id='tok'>activation</span><span id='tok'>(before</span><span id='tok'>timing</span><span class='token pointer' id='tok-23-28' style='color:red'>Ta)</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>picture:</span></p><p id=p215><span id='tok'>2.</span><span id='tok'>Cold</span><span id='tok'>Reset</span></p><p id=p218><span id='tok'>At</span><span id='tok'>the</span><span id='tok'>end</span><span id='tok'>of</span><span id='tok'>activation</span><span id='tok'>(RST</span><span id='tok'>pin</span><span id='tok'>pulled</span><span id='tok'>to</span><span id='tok'>LOW,</span><span id='tok'>Vcc</span><span id='tok'>pin</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>powered,</span><span id='tok'>I/O</span><span id='tok'>on</span><span id='tok'>smartcard</span><span id='tok'>terminal</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>put</span><span id='tok'>to</span><span id='tok'>receive</span><span id='tok'>mode</span><span id='tok'>and</span><span class='token pointer' id='tok-23-29' style='color:red'>CLK</span><span id='tok'>pin</span><span id='tok'>supplied</span><span id='tok'>a</span><span id='tok'>stable</span><span id='tok'>clock</span><span id='tok'>signal),</span><span id='tok'>then</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>is</span><span id='tok'>ready</span><span id='tok'>to</span><span id='tok'>enter</span><span id='tok'>Cold</span><span id='tok'>Reset.</span></p><p id=p260><span id='tok'>As</span><span id='tok'>you</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>picture,</span><span id='tok'>the</span><span id='tok'>clock</span><span id='tok'>signal</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>CLK</span><span id='tok'>pin</span><span id='tok'>starts</span><span id='tok'>at</span><span id='tok'>Ta</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>will</span><span id='tok'>set</span><span id='tok'>the</span><span class='token pointer' id='tok-23-30' style='color:red'>I/O signal</span><span id='tok'>HIGH</span><span id='tok'>in</span><span id='tok'>200</span><span id='tok'>clock</span><span id='tok'>cycle</span><span id='tok'>(ta</span><span id='tok'>delay)</span><span id='tok'>after</span><span id='tok'>the</span><span id='tok'>clock</span><span id='tok'>signal</span><span id='tok'>is</span><span id='tok'>applied</span><span id='tok'>to</span><span id='tok'>CLK</span><span id='tok'>pin</span><span id='tok'>(Ta</span><span id='tok'>+</span><span id='tok'>ta).</span><span id='tok'>The</span><span id='tok'>RST</span><span id='tok'>pin</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>kept</span><span id='tok'>in</span><span id='tok'>LOW</span><span id='tok'>state</span><span id='tok'>for</span><span id='tok'>at</span><span id='tok'>least</span><span id='tok'>400</span><span id='tok'>clock</span><span id='tok'>cycles</span><span id='tok'>(tb</span><span id='tok'>delay)</span><span id='tok'>after</span><span id='tok'>clock</span><span id='tok'>signal</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>given</span><span id='tok'>to</span><span id='tok'>CLK</span><span id='tok'>pin</span><span class='token pointer' id='tok-23-31' style='color:red'>(Ta + tb).</span><span id='tok'>smartcard</span><span id='tok'>terminal</span><span id='tok'>could</span><span id='tok'>ignore</span><span id='tok'>the</span><span id='tok'>logic</span><span id='tok'>in</span><span id='tok'>I/O</span><span id='tok'>pin</span><span id='tok'>when</span><span id='tok'>RST</span><span id='tok'>pin</span><span id='tok'>is</span><span id='tok'>on</span><span id='tok'>LOW</span><span id='tok'>state.</span></p><p id=p352><span id='tok'>RST</span><span id='tok'>pin</span><span id='tok'>then</span><span id='tok'>change</span><span id='tok'>to</span><span id='tok'>HIGH</span><span id='tok'>state</span><span id='tok'>after</span><span id='tok'>reaching</span><span class='token pointer' id='tok-23-32' style='color:red'>Tb.</span><span id='tok'>I/O</span><span id='tok'>pin</span><span id='tok'>will</span><span id='tok'>begin</span><span id='tok'>the</span><span class='token pointer' id='tok-23-33' style='color:red'>Answer-to-Reset</span><span id='tok'>from</span><span id='tok'>400</span><span id='tok'>to</span><span id='tok'>40000</span><span id='tok'>clock</span><span id='tok'>cycle</span><span id='tok'>(tc</span><span id='tok'>delay)</span><span id='tok'>after</span><span id='tok'>rising</span><span id='tok'>edge</span><span id='tok'>signal</span><span id='tok'>in</span><span id='tok'>RST</span><span id='tok'>pin</span><span id='tok'>(Tb</span><span id='tok'>+</span><span id='tok'>tc).</span><span id='tok'>If</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>no</span><span id='tok'>answer</span><span id='tok'>after</span><span id='tok'>the</span><span id='tok'>40000</span><span id='tok'>clock</span><span id='tok'>cycle</span><span id='tok'>when</span><span id='tok'>the</span><span id='tok'>RST</span><span id='tok'>pin</span><span id='tok'>is</span><span id='tok'>in</span><span id='tok'>HIGH</span><span id='tok'>state,</span><span id='tok'>then</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>terminal</span><span id='tok'>could</span><span id='tok'>deactivate</span><span id='tok'>the</span><span id='tok'>smartcard.</span></p><p id=p412><span id='tok'>3.</span><span class='token pointer' id='tok-23-34' style='color:red'>ATR</span><span class='token pointer' id='tok-23-35' style='color:red'>Smartcard</span></p><p id=p416><span id='tok'>After</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>performs</span><span id='tok'>a</span><span id='tok'>cold</span><span id='tok'>reset,</span><span id='tok'>then</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>continue</span><span id='tok'>with</span><span id='tok'>Answer-to-Reset</span><span id='tok'>(ATR).</span><span id='tok'>The</span><span id='tok'>complete</span><span id='tok'>ATR</span><span id='tok'>structure</span><span id='tok'>is</span><span id='tok'>covered</span><span id='tok'>in</span><span class='token pointer' id='tok-23-36' style='color:red'>ISO/IEC 7816-3,</span><span id='tok'>it</span><span id='tok'>looks</span><span id='tok'>like</span><span id='tok'>this:</span></p><p id=p444><span id='tok'>TS</span><span id='tok'>T0</span><span class='token pointer' id='tok-23-37' style='color:red'>TA1</span><span id='tok'>TB1</span><span id='tok'>TC1</span><span id='tok'>TD1</span><span id='tok'>TA2</span><span id='tok'>…</span><span id='tok'>…</span><span id='tok'>TDn</span><span id='tok'>T1</span><span id='tok'>…</span><span id='tok'>TK</span><span id='tok'>TCK</span></p><p id=p458><span id='tok'>For</span><span id='tok'>example,</span><span id='tok'>this</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>Answer-to-Reset</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>receive</span><span id='tok'>after</span><span id='tok'>performing</span><span id='tok'>a</span><span id='tok'>cold</span><span id='tok'>reset</span><span id='tok'>on</span><span id='tok'>a</span><span id='tok'>smartcard:</span></p><p id=p475><span id='tok'>3B</span><span id='tok'>BE</span><span id='tok'>94</span><span id='tok'>00</span><span id='tok'>40</span><span id='tok'>14</span><span id='tok'>47</span><span id='tok'>47</span><span id='tok'>33</span><span id='tok'>53</span><span id='tok'>33</span><span id='tok'>44</span><span id='tok'>48</span><span id='tok'>41</span><span id='tok'>54</span><span id='tok'>4C</span><span id='tok'>39</span><span id='tok'>31</span><span id='tok'>30</span><span id='tok'>30</span></p><p id=p495><span id='tok'>After</span><span id='tok'>receiving</span><span id='tok'>the</span><span id='tok'>ATR</span><span id='tok'>above,</span><span id='tok'>we</span><span id='tok'>then</span><span id='tok'>continue</span><span id='tok'>with</span><span id='tok'>interpreting</span><span id='tok'>the</span><span id='tok'>data</span><span id='tok'>as</span><span id='tok'>follows:</span></p><p id=p509><span id='tok'>TS</span><span id='tok'>=</span><span class='token pointer' id='tok-23-38' style='color:red'>3BIt</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>operates</span><span id='tok'>using</span><span id='tok'>direct</span><span id='tok'>convention</span><span id='tok'>that</span><span id='tok'>works</span><span id='tok'>almost</span><span id='tok'>like</span><span id='tok'>UART</span><span id='tok'>protocol.</span><span id='tok'>The</span><span id='tok'>direct</span><span class='token pointer' id='tok-23-39' style='color:red'>convention</span><span id='tok'>operation</span><span id='tok'>was</span><span id='tok'>covered</span><span id='tok'>in</span><span id='tok'>ISO/IEC</span><span id='tok'>7816-3.</span></p><p id=p535><span class='token pointer' id='tok-23-40' style='color:red'>High nibble (B16 = 10112)</span><span id='tok'>that</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>data</span><span id='tok'>on</span><span id='tok'>TA1,</span><span id='tok'>TB1,</span><span id='tok'>dan</span><span id='tok'>TD1.</span></p><p id=p556><span id='tok'>–</span><span class='token pointer' id='tok-23-41' style='color:red'>Low nibble (E16 = 1410)</span><span id='tok'>that</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>14</span><span id='tok'>bytes</span><span id='tok'>of</span><span id='tok'>history</span><span id='tok'>data</span><span id='tok'>(TK).</span></p><p id=p572><span id='tok'>TA1</span><span id='tok'>=</span><span id='tok'>94</span><span id='tok'>(1001</span><span id='tok'>01002)–</span><span id='tok'>High</span><span class='token pointer' id='tok-23-42' style='color:red'>nibble</span><span id='tok'>(916</span><span id='tok'>=</span><span id='tok'>10012)</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>clock</span><span id='tok'>rate</span><span id='tok'>is</span><span class='token pointer' id='tok-23-43' style='color:red'>Fi = 512</span><span id='tok'>fmax</span><span id='tok'>=</span><span id='tok'>5</span><span id='tok'>MHz.</span></p><p id=p596><span id='tok'>–</span><span id='tok'>Low</span><span id='tok'>nibble</span><span id='tok'>(416</span><span id='tok'>=</span><span id='tok'>01002)</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>bit</span><span id='tok'>rate</span><span id='tok'>Di</span><span id='tok'>=</span><span id='tok'>8.</span></p><p id=p609><span id='tok'>TB1</span><span id='tok'>=</span><span id='tok'>00According</span><span id='tok'>to</span><span id='tok'>ISO/IEC</span><span id='tok'>7816-3,</span><span id='tok'>the</span><span id='tok'>TB1</span><span id='tok'>and</span><span id='tok'>TB2</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>deprecated</span><span id='tok'>and</span><span id='tok'>not</span><span id='tok'>used</span><span id='tok'>anymore</span><span id='tok'>so</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>doesn't</span><span id='tok'>have</span><span id='tok'>to</span><span id='tok'>transmit</span><span id='tok'>it</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>terminal</span><span id='tok'>could</span><span id='tok'>just</span><span id='tok'>ignore</span><span id='tok'>it.</span></p><p id=p642><span id='tok'>TD1</span><span id='tok'>=</span><span id='tok'>40</span><span id='tok'>(0100</span><span id='tok'>00002)–</span><span id='tok'>High</span><span id='tok'>nibble</span><span id='tok'>(416</span><span id='tok'>=</span><span id='tok'>01002)</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>TC2</span><span id='tok'>contains</span><span id='tok'>data.</span></p><p id=p657><span id='tok'>–</span><span id='tok'>Low</span><span id='tok'>nibble</span><span id='tok'>(016</span><span id='tok'>=</span><span id='tok'>00002)</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>is</span><span id='tok'>using</span><span id='tok'>T</span><span id='tok'>=</span><span id='tok'>0</span><span id='tok'>protocol.</span></p><p id=p673><span id='tok'>TC2</span><span id='tok'>=</span><span id='tok'>14</span><span id='tok'>(2010)This</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>Waiting</span><span id='tok'>Time</span><span id='tok'>Integer</span><span id='tok'>(WI)</span><span id='tok'>with</span><span id='tok'>a</span><span id='tok'>value</span><span id='tok'>of</span><span id='tok'>20.</span><span id='tok'>From</span><span id='tok'>the</span><span id='tok'>ISO/IEC</span><span id='tok'>7816-3,</span><span id='tok'>the</span><span id='tok'>value</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>calculate</span><span id='tok'>Waiting</span><span id='tok'>Time</span><span id='tok'>(WT)</span><span id='tok'>with</span><span id='tok'>this</span><span id='tok'>formula:</span></p><p id=p705><span id='tok'>History</span><span id='tok'>bytes</span><span id='tok'>=</span><span id='tok'>47</span><span id='tok'>47</span><span id='tok'>33</span><span id='tok'>53</span><span id='tok'>33</span><span id='tok'>44</span><span id='tok'>48</span><span id='tok'>41</span><span id='tok'>54</span><span id='tok'>4C</span><span id='tok'>39</span><span id='tok'>31</span><span id='tok'>30</span><span id='tok'>30This</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>converted</span><span id='tok'>to</span><span class='token pointer' id='tok-23-44' style='color:red'>ASCII</span><span id='tok'>:</span><span id='tok'>G</span><span id='tok'>G</span><span id='tok'>3</span><span id='tok'>S</span><span id='tok'>3</span><span id='tok'>D</span><span id='tok'>H</span><span id='tok'>A</span><span id='tok'>T</span><span id='tok'>L</span><span id='tok'>9</span><span id='tok'>1</span><span id='tok'>0</span><span id='tok'>0</span></p><p id=p742><span id='tok'>4.</span><span class='token pointer' id='tok-23-45' style='color:red'>Protocol</span><span id='tok'>and</span><span class='token pointer' id='tok-23-46' style='color:red'>Parameter</span><span class='token pointer' id='tok-23-47' style='color:red'>Selection</span><span id='tok'>Interface</span><span class='token pointer' id='tok-23-48' style='color:red'>(PPS)</span></p><p id=p749><span id='tok'>After</span><span id='tok'>getting</span><span id='tok'>Answer-to-Reset</span><span id='tok'>(ATR),</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>interface</span><span id='tok'>then</span><span id='tok'>could</span><span id='tok'>send</span><span id='tok'>PPS</span><span id='tok'>instruction</span><span id='tok'>to</span><span id='tok'>choose</span><span id='tok'>which</span><span id='tok'>protocol</span><span id='tok'>and</span><span id='tok'>parameter</span><span id='tok'>it</span><span id='tok'>would</span><span id='tok'>use</span><span id='tok'>to</span><span id='tok'>make</span><span id='tok'>data</span><span id='tok'>transfer</span><span id='tok'>between</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>terminal</span><span id='tok'>easier.</span></p><p id=p781><span id='tok'>5.</span><span id='tok'>Data</span><span class='token pointer' id='tok-23-49' style='color:red'>Transfer</span><span id='tok'>Between</span><span id='tok'>Smartcard</span><span id='tok'>and</span><span id='tok'>Terminal</span></p><p id=p788><span id='tok'>After</span><span id='tok'>the</span><span id='tok'>Protocol</span><span id='tok'>and</span><span id='tok'>Parameter</span><span id='tok'>Selection</span><span id='tok'>(PPS)</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>setup,</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>terminal</span><span id='tok'>interface</span><span id='tok'>could</span><span id='tok'>begin</span><span id='tok'>transferring</span><span id='tok'>data</span><span id='tok'>using</span><span id='tok'>Application</span><span id='tok'>Protocol</span><span id='tok'>Data</span><span id='tok'>Unit</span><span class='token pointer' id='tok-23-50' style='color:red'>(APDU).</span><span id='tok'>The</span><span id='tok'>complete</span><span id='tok'>structure</span><span id='tok'>for</span><span id='tok'>APDU</span><span id='tok'>is</span><span id='tok'>covered</span><span id='tok'>in</span><span id='tok'>ISO</span><span class='token pointer' id='tok-23-51' style='color:red'>7816-4.</span></p><p id=p824><span class='token pointer' id='tok-23-52' style='color:red'>Vulnerabilities</span></p><p id=p825><span id='tok'>There</span><span id='tok'>are</span><span id='tok'>quite</span><span id='tok'>a</span><span id='tok'>lot</span><span id='tok'>of</span><span id='tok'>vulnerabilities</span><span id='tok'>related</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>java</span><span id='tok'>card,</span><span id='tok'>and</span><span id='tok'>most</span><span id='tok'>of</span><span id='tok'>them</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>documented</span><span id='tok'>across</span><span id='tok'>the</span><span id='tok'>Internet.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>some</span><span id='tok'>of</span><span id='tok'>the</span><span class='token pointer' id='tok-23-53' style='color:red'>smartcard's</span><span id='tok'>attack</span><span id='tok'>vector:</span></p><p id=p855><span id='tok'>1.</span><span id='tok'>Physical</span><span id='tok'>attack:</span></p><p id=p858><span id='tok'>Reverse</span><span class='token pointer' id='tok-23-54' style='color:red'>engineering.Smartcard</span><span id='tok'>cloning.2.</span><span id='tok'>Remote</span><span id='tok'>attack:</span></p><p id=p863><span id='tok'>IMSI</span><span class='token pointer' id='tok-23-55' style='color:red'>catcher.Attacking</span><span id='tok'>a</span><span id='tok'>Smartcard</span></p><p id=p867><span id='tok'>1.</span><span id='tok'>Physical</span><span id='tok'>Attack</span></p><p id=p870><span id='tok'>Physical</span><span id='tok'>attack</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>carried</span><span id='tok'>out</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>has</span><span id='tok'>physical</span><span id='tok'>contact</span><span id='tok'>with</span><span id='tok'>victim's</span><span id='tok'>smartcard</span><span id='tok'>and</span><span id='tok'>gets</span><span id='tok'>access</span><span id='tok'>to</span><span id='tok'>important</span><span id='tok'>data</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>smartcard.</span><span id='tok'>Once</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>has</span><span id='tok'>access</span><span id='tok'>to</span><span id='tok'>that</span><span id='tok'>important</span><span id='tok'>data,</span><span id='tok'>he/she</span><span id='tok'>could</span><span id='tok'>perform</span><span id='tok'>a</span><span id='tok'>smartcard</span><span id='tok'>cloning</span><span id='tok'>or</span><span id='tok'>reprogramming</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>smartcard.</span></p><p id=p914><span id='tok'>1.1.</span><span id='tok'>Reverse</span><span id='tok'>Engineering</span></p><p id=p917><span id='tok'>Reverse</span><span id='tok'>engineering</span><span id='tok'>smartcard</span><span id='tok'>at</span><span id='tok'>silicon</span><span id='tok'>level</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>an</span><span id='tok'>easy</span><span id='tok'>task</span><span id='tok'>and</span><span id='tok'>requires</span><span id='tok'>some</span><span id='tok'>special</span><span id='tok'>tools</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>Scanning</span><span class='token pointer' id='tok-23-56' style='color:red'>(SEM)</span><span class='token pointer' id='tok-23-57' style='color:red'>Electron Microscope</span><span id='tok'>Focused</span><span id='tok'>Ion</span><span id='tok'>Beam</span><span class='token pointer' id='tok-23-58' style='color:red'>(FIB).</span></p><p id=p944><span id='tok'>1.2.</span><span id='tok'>Smartcard</span><span class='token pointer' id='tok-23-59' style='color:red'>Cloning</span></p><p id=p947><span id='tok'>For</span><span id='tok'>this</span><span id='tok'>purpose,</span><span id='tok'>an</span><span id='tok'>attacker</span><span id='tok'>could</span><span id='tok'>use</span><span id='tok'>a</span><span id='tok'>couple</span><span id='tok'>of</span><span id='tok'>devices</span><span id='tok'>like</span><span id='tok'>an</span><span id='tok'>oscilloscope</span><span id='tok'>and</span><span id='tok'>smartcard</span><span id='tok'>reader.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>an</span><span id='tok'>example</span><span id='tok'>of</span><span id='tok'>DIY</span><span id='tok'>smartcard</span><span id='tok'>reader</span><span id='tok'>(phoenix</span><span id='tok'>reader):</span></p><p id=p974><span id='tok'>However,</span><span id='tok'>there's</span><span id='tok'>a</span><span id='tok'>catch</span><span id='tok'>for</span><span id='tok'>the</span><span id='tok'>phoenix</span><span id='tok'>reader</span><span id='tok'>like</span><span id='tok'>the</span><span id='tok'>one</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>picture</span><span id='tok'>–</span><span id='tok'>its</span><span id='tok'>lack</span><span id='tok'>of</span><span id='tok'>application</span><span id='tok'>for</span><span id='tok'>interfacing</span><span id='tok'>with</span><span id='tok'>smartcard.</span><span id='tok'>The</span><span id='tok'>reference</span><span id='tok'>schematic</span><span id='tok'>for</span><span id='tok'>phoenix</span><span id='tok'>reader</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>picture</span><span id='tok'>was</span><span id='tok'>developed</span><span id='tok'>by</span><span id='tok'>Dejan</span><span id='tok'>Kaljevic</span><span id='tok'>and</span><span id='tok'>is</span><span id='tok'>freely</span><span id='tok'>available.</span></p><p id=p1018><span id='tok'>Smartcard</span><span id='tok'>cloning</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>just</span><span id='tok'>about</span><span id='tok'>programming</span><span id='tok'>the</span><span id='tok'>smartcard,</span><span id='tok'>but</span><span id='tok'>also</span><span id='tok'>retrieving</span><span id='tok'>important</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>victim's</span><span id='tok'>smartcard</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>which</span><span id='tok'>vendor</span><span id='tok'>issued</span><span id='tok'>the</span><span id='tok'>card.</span><span id='tok'>The</span><span id='tok'>more</span><span class='token pointer' id='tok-23-60' style='color:red'>convenient</span><span id='tok'>way</span><span id='tok'>to</span><span id='tok'>interact</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>is</span><span id='tok'>by</span><span id='tok'>using</span><span class='token pointer' id='tok-23-61' style='color:red'>PCSC</span><span id='tok'>reader</span><span id='tok'>with</span><span id='tok'>an</span><span id='tok'>opensource</span><span id='tok'>application</span><span id='tok'>called</span><span class='token pointer' id='tok-23-62' style='color:red'>pcsc_scan.</span><span id='tok'></span></p><p id=p1064><span id='tok'>As</span><span id='tok'>you</span><span id='tok'>may</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>picture</span><span id='tok'>above,</span><span id='tok'>we</span><span id='tok'>could</span><span id='tok'>get</span><span id='tok'>some</span><span id='tok'>information</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>smartcard</span><span class='token pointer' id='tok-23-63' style='color:red'>attached</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>terminal.</span><span id='tok'>Picture</span><span id='tok'>10</span><span id='tok'>shows</span><span id='tok'>a</span><span id='tok'>smartcard</span><span id='tok'>that's</span><span id='tok'>commonly</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>financial</span><span id='tok'>institution</span><span id='tok'>which</span><span id='tok'>complies</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-23-64' style='color:red'>EMV standard,</span><span id='tok'>picture</span><span id='tok'>11</span><span id='tok'>shows</span><span id='tok'>a</span><span id='tok'>smartcard</span><span class='token pointer' id='tok-23-65' style='color:red'>(USIM)</span><span id='tok'>that's</span><span id='tok'>commonly</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>communication</span><span id='tok'>(3G/4G).</span><span id='tok'>That</span><span id='tok'>information</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>determine</span><span id='tok'>what</span><span id='tok'>kind</span><span id='tok'>of</span><span id='tok'>encryption</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>uses,</span><span id='tok'>since</span><span id='tok'>vendors</span><span id='tok'>tends</span><span id='tok'>to</span><span id='tok'>follow</span><span id='tok'>standard</span><span id='tok'>specs</span><span id='tok'>and</span><span id='tok'>not</span><span id='tok'>use</span><span id='tok'>custom</span><span id='tok'>encryption.</span><span id='tok'>Attackers</span><span id='tok'>could</span><span id='tok'>then</span><span id='tok'>use</span><span id='tok'>the</span><span id='tok'>information</span><span id='tok'>to</span><span id='tok'>perform</span><span id='tok'>a</span><span id='tok'>remote</span><span id='tok'>attack.</span></p><p id=p1152><span id='tok'>2.</span><span id='tok'>Remote</span><span id='tok'>Attack</span></p><p id=p1155><span id='tok'>Remote</span><span id='tok'>attacking</span><span id='tok'>smartcard</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>achieved</span><span id='tok'>by</span><span id='tok'>exploiting</span><span id='tok'>vulnerabilities</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>smartcard.</span><span id='tok'>For</span><span id='tok'>example;</span><span id='tok'>by</span><span id='tok'>injecting</span><span id='tok'>malicious</span></p><p id=p1174><span id='tok'>2.1.</span></p><p id=p1177><span id='tok'>The</span><span id='tok'>cost</span><span id='tok'>for</span><span id='tok'>this</span><span id='tok'>kind</span><span id='tok'>of</span><span id='tok'>attack</span><span id='tok'>is</span><span id='tok'>quite</span><span id='tok'>high,</span><span id='tok'>since</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>must</span><span id='tok'>have</span><span id='tok'>some</span><span id='tok'>kind</span><span id='tok'>of</span><span id='tok'>hardware</span><span id='tok'>that</span><span id='tok'>could</span><span id='tok'>run</span><span class='token pointer' id='tok-23-66' style='color:red'>OpenBTS</span><span id='tok'>and</span><span id='tok'>work</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>fake</span><span class='token pointer' id='tok-23-67' style='color:red'>BTS.</span><span id='tok'>In</span><span id='tok'>order</span><span id='tok'>to</span><span id='tok'>become</span><span id='tok'>a</span><span id='tok'>fake</span><span id='tok'>BTS,</span><span id='tok'>that</span><span id='tok'>hardware</span><span id='tok'>should</span><span id='tok'>generate</span><span id='tok'>a</span><span class='token pointer' id='tok-23-68' style='color:red'>stronger</span><span id='tok'>signals</span><span id='tok'>than</span><span id='tok'>the</span><span id='tok'>real</span><span id='tok'>BTS</span><span id='tok'>to</span><span id='tok'>force</span><span id='tok'>the</span><span id='tok'>victim's</span><span id='tok'>terminal</span><span id='tok'>(i.e</span><span id='tok'>mobile</span><span id='tok'>phone)</span><span id='tok'>to</span><span id='tok'>connect</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>fake</span><span id='tok'>BTS.</span></p><p id=p1238><span id='tok'>After</span><span id='tok'>the</span><span id='tok'>victim's</span><span id='tok'>mobile</span><span id='tok'>phone</span><span id='tok'>is</span><span id='tok'>connected</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>fake</span><span id='tok'>BTS,</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>then</span><span id='tok'>could</span><span id='tok'>send</span><span id='tok'>a</span><span id='tok'>payload</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-23-69' style='color:red'>Over-the-Air</span><span id='tok'>(OTA)</span><span id='tok'>method</span><span id='tok'>that</span><span id='tok'>is</span><span id='tok'>common</span><span id='tok'>for</span><span class='token pointer' id='tok-23-70' style='color:red'>networks</span><span class='token pointer' id='tok-23-71' style='color:red'>GSM</span><span id='tok'>direct</span><span id='tok'>the</span><span id='tok'>payload</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>smartcard</span><span id='tok'>inside</span><span id='tok'>the</span><span id='tok'>mobile</span><span id='tok'>phone.</span></p><p id=p1278><span id='tok'>Conclusion</span></p><p id=p1279><span id='tok'>From</span><span id='tok'>the</span><span id='tok'>explanation</span><span id='tok'>above,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>conclude</span><span id='tok'>that</span><span id='tok'>an</span><span id='tok'>attacker</span><span id='tok'>who</span><span id='tok'>could</span><span id='tok'>exploit</span><span id='tok'>a</span><span id='tok'>vulnerability</span><span id='tok'>on</span><span id='tok'>smartcard</span><span id='tok'>would</span><span id='tok'>result</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>catastrophic</span><span id='tok'>event,</span><span id='tok'>especially</span><span id='tok'>if</span><span id='tok'>it's</span><span id='tok'>related</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>critical</span><span id='tok'>infrastructure,</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>SCADA</span><span id='tok'>installation</span><span id='tok'>that</span><span id='tok'>utilizes</span><span id='tok'>GSM</span><span id='tok'>networks</span><span id='tok'>or</span><span id='tok'>financial</span><span id='tok'>institution</span><span id='tok'>that</span><span id='tok'>utilize</span><span id='tok'>GSM</span><span id='tok'>networks</span><span id='tok'>for</span><span id='tok'>their</span><span id='tok'>mobile</span><span id='tok'>banking.</span><span id='tok'>In</span><span id='tok'>order</span><span id='tok'>to</span><span id='tok'>prevent</span><span id='tok'>such</span><span id='tok'>an</span><span id='tok'>attack</span><span id='tok'>on</span><span id='tok'>a</span><span id='tok'>smartcard,</span><span id='tok'>vendors</span><span id='tok'>could</span><span id='tok'>implement</span><span id='tok'>some</span><span id='tok'>protection,</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>developing</span><span id='tok'>custom</span><span class='token pointer' id='tok-23-72' style='color:red'>EEPROM</span><span id='tok'>for</span><span id='tok'>java</span><span id='tok'>card.</span></p><p id=p1353><span id='tok'></span><span id='tok'></span><span id='tok'></span><span id='tok'></span><span id='tok'></span><span id='tok'></span></p>