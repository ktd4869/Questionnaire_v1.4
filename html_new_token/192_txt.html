<p id=p0>Evidence shows that three of the most destructive <span class='token pointer' id='tok-192-0' style='color:red'>incidents</span>seen in modern <span class='token pointer' id='tok-192-1' style='color:red'>cyber-history</span>are the work of one <span class='token pointer' id='tok-192-2' style='color:red'>APT.</span></p><p id=p19>The massive <span class='token pointer' id='tok-192-3' style='color:red'>NotPetya</span><span class='token pointer' id='tok-192-4' style='color:red'>ransomware outbreak</span><span class='token pointer' id='tok-192-5' style='color:red'>crippled</span>organizations around the world last year turns out to have links to the <span class='token pointer' id='tok-192-6' style='color:red'>Industroyer</span><span class='token pointer' id='tok-192-7' style='color:red'>backdoor,</span>which targets <span class='token pointer' id='tok-192-8' style='color:red'>industrial control systems</span>and took down the Ukrainian <span class='token pointer' id='tok-192-9' style='color:red'>power grid in</span>in 2016. </p><p id=p58>In fact, the same <span class='token pointer' id='tok-192-10' style='color:red'>threat actor</span>dubbed <span class='token pointer' id='tok-192-11' style='color:red'>TeleBots</span>(a.k.a. <span class='token pointer' id='tok-192-12' style='color:red'>Sandworm)</span><span class='token pointer' id='tok-192-13' style='color:red'>ESET</span><span class='token pointer' id='tok-192-14' style='color:red'>by</span>– appears to be behind NotPetya, the 2015 <span class='token pointer' id='tok-192-15' style='color:red'>BlackEnergy</span><span class='token pointer' id='tok-192-16' style='color:red'>attack</span>that also caused <span class='token pointer' id='tok-192-17' style='color:red'>blackouts</span>in <span class='token pointer' id='tok-192-18' style='color:red'>Ukraine,</span>and the Industroyer campaign a year later. </p><p id=p95>NotPetya (a.k.a. ExPetr) broke out last June, and was initially believed to be another <span class='token pointer' id='tok-192-19' style='color:red'>global ransomware attack</span>par with <span class='token pointer' id='tok-192-20' style='color:red'>WannaCry</span>– but it turned out to be a <span class='token pointer' id='tok-192-21' style='color:red'>wiper</span>in disguise. While the <span class='token pointer' id='tok-192-22' style='color:red'>malware</span>has a ransomware component, NotPetya can't <span class='token pointer' id='tok-192-23' style='color:red'>decrypt</span>victims' <span class='token pointer' id='tok-192-24' style='color:red'>disk,</span>even if a payment is made. </p><p id=p145>It claimed thousands of victims worldwide, including some of the <span class='token pointer' id='tok-192-25' style='color:red'>highest-profile</span>manufacturers, critical infrastructure providers and financial services organizations – tying up giants like the Merck pharmaceutical company and Maersk, the shipping <span class='token pointer' id='tok-192-26' style='color:red'>behemoth.</span></p><p id=p178>According to ESET analysts Anton Cherepanov and Robert Lipovsky, the BlackEnergy malware responsible for the 2015 Ukraine blackout contains the same <span class='token pointer' id='tok-192-27' style='color:red'>KillDisk</span><span class='token pointer' id='tok-192-28' style='color:red'>encryption</span>component seen in the NotPetya malware, which is a hallmark of the TeleBots group. </p><p id=p215>"In the final stage of its <span class='token pointer' id='tok-192-29' style='color:red'>attacks,</span>the TeleBots group always used the KillDisk malware to overwrite <span class='token pointer' id='tok-192-30' style='color:red'>files</span>with specific <span class='token pointer' id='tok-192-31' style='color:red'>file extensions on</span>victims' disks," they wrote last year. They also discovered that the outbreak started spreading from companies afflicted with a <span class='token pointer' id='tok-192-32' style='color:red'>TeleBots backdoor,</span>from the <span class='token pointer' id='tok-192-33' style='color:red'>compromise</span>of the financial <span class='token pointer' id='tok-192-34' style='color:red'>software</span><span class='token pointer' id='tok-192-35' style='color:red'>M.E.Doc,</span>popular in Ukraine. </p><p id=p272>Meanwhile, Industroyer (a.k.a. Crash Override) is the <span class='token pointer' id='tok-192-36' style='color:red'>code</span>used in attacks against the Ukrainian power grid in Dec. 2016. That attack and the 2015 BlackEnergy offensive targeted the same Ukrainian <span class='token pointer' id='tok-192-37' style='color:red'>networks</span>(and together, the 2015 and 2016 incidents are considered the only successful <span class='token pointer' id='tok-192-38' style='color:red'>hacks</span>of an <span class='token pointer' id='tok-192-39' style='color:red'>energy grid to</span>however, no hard evidence has been seen to tie the two to the same APT until ESET researchers this year uncovered strong code similarities, tying them both to TeleBots through an analysis of a recent backdoor. </p><p id=p358>In fact, TeleBots' latest malware, dubbed <span class='token pointer' id='tok-192-40' style='color:red'>Win32/Exaramel,</span>shows it to be an improved version of the Industroyer backdoor. It was detected at an organization in Ukraine (though not an <span class='token pointer' id='tok-192-41' style='color:red'>industrial</span>facility), exfiltrating <span class='token pointer' id='tok-192-42' style='color:red'>information.</span>It copies files, automatically <span class='token pointer' id='tok-192-43' style='color:red'>encrypts them</span>sends them off to the <span class='token pointer' id='tok-192-44' style='color:red'>command-and-control (C2) server;</span>it's being used with some of TeleBots' older <span class='token pointer' id='tok-192-45' style='color:red'>tools,</span>including a custom <span class='token pointer' id='tok-192-46' style='color:red'>password stealer,</span>a slightly-modified <span class='token pointer' id='tok-192-47' style='color:red'>Mimikatz.</span></p><p id=p427>A closer look under the hood revealed there are several aspects in the code that show it to be closely related to Industroyer. </p><p id=p450>For one, the Win32/Exaramel backdoor is initially deployed by a <span class='token pointer' id='tok-192-48' style='color:red'>dropper,</span>they found, which starts a <span class='token pointer' id='tok-192-49' style='color:red'>Windows service</span><span class='token pointer' id='tok-192-50' style='color:red'>"wsmprovav,"</span>with the description </p><p id=p476>"As can be seen from the first line of the <span class='token pointer' id='tok-192-51' style='color:red'>configuration,</span>the attackers are grouping their targets based on the security solutions in use," ESET researchers said in a posting last week. "Similar behavior can be found in the Industroyer <span class='token pointer' id='tok-192-52' style='color:red'>toolset</span>– specifically some of the Industroyer backdoors were also disguised as an <span class='token pointer' id='tok-192-53' style='color:red'>AV-related</span>service (deployed under the name <span class='token pointer' id='tok-192-54' style='color:red'>avtask.exe)</span>and used the same grouping." </p><p id=p541>Once the backdoor is running, it connects to its <span class='token pointer' id='tok-192-55' style='color:red'>C2 server</span>receives various <span class='token pointer' id='tok-192-56' style='color:red'>commands</span>to be <span class='token pointer' id='tok-192-57' style='color:red'>executed.</span>The code of the <span class='token pointer' id='tok-192-58' style='color:red'>command loop</span>implementations of the first six commands <span class='token pointer' id='tok-192-59' style='color:red'>process,</span><span class='token pointer' id='tok-192-60' style='color:red'>(launch</span>process under specified Windows user, write data to a <span class='token pointer' id='tok-192-61' style='color:red'>file</span>in specified <span class='token pointer' id='tok-192-62' style='color:red'>path,</span>copy file into <span class='token pointer' id='tok-192-63' style='color:red'>sub-directory</span><span class='token pointer' id='tok-192-64' style='color:red'>storage</span>file), <span class='token pointer' id='tok-192-65' style='color:red'>execute</span><span class='token pointer' id='tok-192-66' style='color:red'>command</span><span class='token pointer' id='tok-192-67' style='color:red'>shell</span>execute <span class='token pointer' id='tok-192-68' style='color:red'>shell command</span>specified Windows user) are very similar to those found in a backdoor used in the Industroyer toolset, according to ESET. </p><p id=p623>Both malware families also use a report file for storing the resulting output of executed shell commands and launched <span class='token pointer' id='tok-192-69' style='color:red'>processes.</span></p><p id=p643>"In case of the <span class='token pointer' id='tok-192-70' style='color:red'>Win32/Industroyer</span>backdoor, the report file is stored in a temporary <span class='token pointer' id='tok-192-71' style='color:red'>folder</span>under a random <span class='token pointer' id='tok-192-72' style='color:red'>filename,"</span>the team explained. "In the case of the Win32/Exaramel backdoor, the report file is <span class='token pointer' id='tok-192-73' style='color:red'>named report.txt and</span><span class='token pointer' id='tok-192-74' style='color:red'>storage path</span>defined in the <span class='token pointer' id='tok-192-75' style='color:red'>backdoor's</span>configuration file." </p><p id=p689>There are other similarities. For instance, in order <span class='token pointer' id='tok-192-76' style='color:red'>(stdout)</span><span class='token pointer' id='tok-192-77' style='color:red'>standard output</span><span class='token pointer' id='tok-192-78' style='color:red'>(stderr)</span><span class='token pointer' id='tok-192-79' style='color:red'>standard error</span>the report file, both backdoors set the <span class='token pointer' id='tok-192-80' style='color:red'>hStdError</span><span class='token pointer' id='tok-192-81' style='color:red'>parameters to</span>handle of the report file. </p><p id=p725>Meanwhile, the main difference between the backdoor from the Industroyer toolset and the new TeleBots backdoor is that the latter uses <span class='token pointer' id='tok-192-82' style='color:red'>XML</span>format for <span class='token pointer' id='tok-192-83' style='color:red'>communication</span>and configuration instead of a <span class='token pointer' id='tok-192-84' style='color:red'>binary</span><span class='token pointer' id='tok-192-85' style='color:red'>format.</span></p><p id=p758>"The discovery of <span class='token pointer' id='tok-192-86' style='color:red'>Exaramel</span>shows that the TeleBots group is still active in 2018 and the attackers keep improving their tools and tactics," ESET researchers said. "The strong code similarity between the Win32/Exaramel backdoor and the Industroyer main backdoor is the first publicly-presented evidence linking Industroyer to TeleBots, and hence to NotPetya and BlackEnergy. While the possibility of <span class='token pointer' id='tok-192-87' style='color:red'>false flags –</span>a coincidental code sharing by another threat actor – should always be kept in mind when attempting attribution, in this case we consider it unlikely." </p><p id=p845>While ESET declined to attempt nation-state attribution for the TeleBots APT, Phil Neray, vice president of Industrial <span class='token pointer' id='tok-192-88' style='color:red'>Cybersecurity at CyberX,</span>that he believes Russian intelligence to be behind this hat-trick of destructive incidents. </p><p id=p879>"The ESET report is significant because it ties a single group of <span class='token pointer' id='tok-192-89' style='color:red'>GRU</span>threat actors to several major <span class='token pointer' id='tok-192-90' style='color:red'>cyberattacks,</span>including the first Ukrainian grid attack in 2015 (BlackEnergy), the second grid attack in 2016 (Industroyer), and NotPetya which disabled <span class='token pointer' id='tok-192-91' style='color:red'>production facilities</span>in 2017 and has been called the most devastating <span class='token pointer' id='tok-192-92' style='color:red'>cyberattack</span>in history," he said via <span class='token pointer' id='tok-192-93' style='color:red'>email.
</span></p>