<p id=p0><span class='token pointer' id='tok-142-0' style='color:red'>Coinbase and</span><span class='token pointer' id='tok-142-1' style='color:red'>Overstock.com</span>just fixed a serious glitch that allowed Overstock customers to buy any item at a <span class='token pointer' id='tok-142-2' style='color:red'>tiny</span><span class='token pointer' id='tok-142-3' style='color:red'>fraction</span>of the listed price. Potentially more punishing, the flaw let anyone paying with <span class='token pointer' id='tok-142-4' style='color:red'>bitcoin</span>reap many times the authorized bitcoin refund amount on any canceled Overstock orders. </p><p id=p44>In January 2014, Overstock.com partnered with <span class='token pointer' id='tok-142-5' style='color:red'>Coinbase</span>to let customers pay for merchandise using bitcoin, making it among the first of the largest e-commerce vendors to accept the virtual currency. </p><p id=p74>On December 19, 2017, as the price of bitcoin soared to more than $17,000 per coin, Coinbase added support for <span class='token pointer' id='tok-142-6' style='color:red'>Bitcoin</span>Cash — an offshoot (or "fork") from bitcoin designed to address the <span class='token pointer' id='tok-142-7' style='color:red'>cryptocurrency's</span>scalability challenges. </p><p id=p109>As a result of the change, Coinbase customers with balances of bitcoin at the time of the fork were given an equal amount of bitcoin cash stored by Coinbase. However, there is a significant price difference between the two currencies: A single bitcoin is worth almost $15,000 right now, whereas a unit of bitcoin cash is valued at around $2,400. </p><p id=p169>On Friday, Jan. 5, <span class='token pointer' id='tok-142-8' style='color:red'>KrebsOnSecurity</span>was contacted by JB Snyder, owner of North Carolina-based <span class='token pointer' id='tok-142-9' style='color:red'>Bancsec,</span>a company that gets paid to break into banks and test their security. An early adopter of bitcoin, Snyder said he was using some of his virtual currency to purchase an item at Overstock when he noticed something alarming. </p><p id=p222>During the checkout process for those paying by bitcoin, Overstock.com provides the customer a bitcoin wallet address that can be used to pay the invoice and complete the transaction. But Snyder discovered that Overstock's site just as happily accepted bitcoin cash as payment, even though bitcoin cash is currently worth only about 15 percent of the value of bitcoin. </p><p id=p281>To confirm and replicate Snyder's experience firsthand, KrebsOnSecurity purchased a set of three outdoor solar lamps from Overstock for a grand total of $78.27. </p><p id=p305>The solar lights I purchased from Overstock.com to test Snyder's finding. They cost $78.27 in bitcoin, but because I was able to pay for them in bitcoin cash I only paid $12.02. </p><p id=p337>After indicating I wished to pay for the lamps in bitcoin, the site produced a payment invoice instructing me to send exactly 0.00475574 bitcoins to a specific address. </p><p id=p365>The payment invoice I received from Overstock.com. </p><p id=p372>Logging into Coinbase, I took the bitcoin address and pasted that into the "pay to:" field, and then told Coinbase to send 0.00475574 in bitcoin cash instead of bitcoin. The site responded that the payment was complete. Within a few seconds I received an email from Overstock congratulating me on my purchase and stating that the items would be shipped shortly. </p><p id=p433>I had just made a $78 purchase by sending approximately USD $12 worth of bitcoin cash. <span class='token pointer' id='tok-142-10' style='color:red'>Crypto-currency</span><span class='token pointer' id='tok-142-11' style='color:red'>alchemy</span>at last! </p><p id=p453>But that wasn't the worst part. I didn't really want the solar lights, but also I had no interest in ripping off Overstock. So I cancelled the order. To my surprise, the system refunded my purchase in bitcoin, not bitcoin cash! </p><p id=p494>Consider the <span class='token pointer' id='tok-142-12' style='color:red'>implications</span>here: A <span class='token pointer' id='tok-142-13' style='color:red'>dishonest</span>customer could have used this bug to make ridiculous sums of bitcoin in a very short period of time. Let's say I purchased one of the more <span class='token pointer' id='tok-142-14' style='color:red'>expensive</span>items for sale on Overstock, such as this $100,000, 3-carat platinum diamond ring. I then pay for it in Bitcoin cash, using an amount equivalent to approximately 1 bitcoin ($~15,000). </p><p id=p557>Then I simply cancel my order, and <span class='token pointer' id='tok-142-15' style='color:red'>Overstock/Coinbase</span>sends me almost $100,000 in bitcoin, <span class='token pointer' id='tok-142-16' style='color:red'>netting</span>me a tidy $85,000 profit. Rinse, wash, repeat. </p><p id=p580>Reached for comment, Overstock.com said the company changed no code in its site and that a fix implemented by Coinbase <span class='token pointer' id='tok-142-17' style='color:red'>resolved</span>the issue. </p><p id=p603>"We were made aware of an issue affecting <span class='token pointer' id='tok-142-18' style='color:red'>cryptocurrency</span>transactions and refunds by an independent researcher. After working with the researcher to confirm the finding, that method of payment was disabled while we worked with our cryptocurrency integration partner, Coinbase, to ensure they resolved the issue. We have since confirmed that the issue described in the finding has been resolved, and the cryptocurrency payment option has been re-enabled." </p><p id=p671>Coinbase said "the issue was caused by the merchant partner improperly using the return values in our merchant integration API. No other Coinbase customer had this <span class='token pointer' id='tok-142-19' style='color:red'>problem."Coinbase</span>told me the bug only existed for approximately three weeks." </p><p id=p708>"After being made aware of an issue in our joint refund processing code on <span class='token pointer' id='tok-142-20' style='color:red'>Saturday, Coinbase and</span>Overstock worked together to deploy a fix within hours," The Coinbase statement continued. "While a patch was being developed and tested, orders were <span class='token pointer' id='tok-142-21' style='color:red'>proactively</span>disabled to protect customers. To our knowledge, a very small number of transactions were impacted by this <span class='token pointer' id='tok-142-22' style='color:red'>issue. Coinbase actively</span>works with merchant partners to identify and solve issues like this in an ongoing, <span class='token pointer' id='tok-142-23' style='color:red'>collaborative</span>manner and since being made aware of this have ensured that no other partners are affected." </p><p id=p795><span class='token pointer' id='tok-142-24' style='color:red'>Bancsec's</span>Snyder and I both checked for the presence of this glitch at multiple other merchants that work directly with Coinbase in their checkout process, but we found no other examples of this flaw. </p><p id=p829>The snafu comes as many businesses that have long accepted bitcoin are now distancing themselves from the currency thanks to the recent volatility in bitcoin prices and associated fees. </p><p id=p858>Earlier this week, it <span class='token pointer' id='tok-142-25' style='color:red'>emerged</span>that <span class='token pointer' id='tok-142-26' style='color:red'>Microsoft</span>had ceased accepting payments in Bitcoin, citing volatility concerns. In December, online game giant Steam said it was dropping support for bitcoin payments for the same reason. </p><p id=p891>And, as KrebsOnSecurity noted last month, even cybercriminals who run online stores that sell stolen identities and credit cards are urging their customers to transact in something other than bitcoin. </p><p id=p921>Interestingly, bitcoin is thought to have been behind a huge jump in Overstock's stock price in 2017. In December, Overstock CEO Patrick Byrne reportedly stoked the cryptocurrency fires when he said that he might want to sell Overstock's e-tailing operations and pour the extra cash into accelerating his blockchain-based business ideas instead. </p><p id=p972>In case anyone is wondering what I did with the "profit" I made from this scheme, I offered to send it back to Overstock, but they told me to keep it. Instead, I <span class='token pointer' id='tok-142-27' style='color:red'>donated</span>it to archive.org, a site that has come in handy for many stories published here.
 </p>