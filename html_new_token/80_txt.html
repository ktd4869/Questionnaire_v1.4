<p id=p0><span id='tok'>The</span><span id='tok'>OilRig</span><span class='token pointer' id='tok-80-0' style='color:red'>group</span><span class='token pointer' id='tok-80-1' style='color:red'>remains</span><span class='token pointer' id='tok-80-2' style='color:red'>highly</span><span id='tok'>active</span><span id='tok'>in</span><span id='tok'>their</span><span class='token pointer' id='tok-80-3' style='color:red'>attack</span><span class='token pointer' id='tok-80-4' style='color:red'>campaigns</span><span id='tok'>while</span><span id='tok'>they</span><span id='tok'>continue</span><span id='tok'>to</span><span class='token pointer' id='tok-80-5' style='color:red'>evolve</span><span id='tok'>their</span><span class='token pointer' id='tok-80-6' style='color:red'>toolset.</span><span id='tok'>On</span><span id='tok'>January</span><span id='tok'>8,</span><span id='tok'>2018,</span><span id='tok'>Unit</span><span id='tok'>42</span><span id='tok'>observed</span><span id='tok'>the</span><span class='token pointer' id='tok-80-7' style='color:red'>OilRig</span><span class='token pointer' id='tok-80-8' style='color:red'>threat group</span><span id='tok'>out</span><span id='tok'>an</span><span id='tok'>attack</span><span id='tok'>on</span><span id='tok'>an</span><span class='token pointer' id='tok-80-9' style='color:red'>insurance</span><span class='token pointer' id='tok-80-10' style='color:red'>agency</span><span id='tok'>based</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-80-11' style='color:red'>Middle</span><span id='tok'>East.</span><span id='tok'>Just</span><span id='tok'>over</span><span id='tok'>a</span><span id='tok'>week</span><span id='tok'>later,</span><span id='tok'>on</span><span id='tok'>January</span><span id='tok'>16,</span><span id='tok'>2018,</span><span id='tok'>we</span><span id='tok'>observed</span><span id='tok'>an</span><span id='tok'>attack</span><span id='tok'>on</span><span id='tok'>a</span><span id='tok'>Middle</span><span id='tok'>Eastern</span><span class='token pointer' id='tok-80-12' style='color:red'>financial</span><span id='tok'>institution.</span><span id='tok'>In</span><span id='tok'>both</span><span class='token pointer' id='tok-80-13' style='color:red'>attacks,</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>group</span><span class='token pointer' id='tok-80-14' style='color:red'>attempted</span><span id='tok'>to</span><span class='token pointer' id='tok-80-15' style='color:red'>deliver</span><span id='tok'>a</span><span id='tok'>new</span><span class='token pointer' id='tok-80-16' style='color:red'>Trojan</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>are</span><span class='token pointer' id='tok-80-17' style='color:red'>tracking</span><span id='tok'>as</span><span class='token pointer' id='tok-80-18' style='color:red'>OopsIE.</span></p><p id=p78><span id='tok'>The</span><span id='tok'>January</span><span id='tok'>8</span><span id='tok'>attack</span><span id='tok'>used</span><span id='tok'>a</span><span id='tok'>variant</span><span id='tok'>of</span><span id='tok'>the</span><span class='token pointer' id='tok-80-19' style='color:red'>document,</span><span class='token pointer' id='tok-80-20' style='color:red'>delivery</span><span id='tok'>we</span><span id='tok'>identified</span><span id='tok'>as</span><span class='token pointer' id='tok-80-21' style='color:red'>part</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>toolset</span><span id='tok'>based</span><span id='tok'>on</span><span id='tok'>attacks</span><span id='tok'>that</span><span id='tok'>occurred</span><span id='tok'>in</span><span id='tok'>August</span><span id='tok'>2017.</span></p><p id=p107><span id='tok'>However,</span><span id='tok'>the</span><span id='tok'>attack</span><span id='tok'>on</span><span id='tok'>January</span><span id='tok'>16</span><span id='tok'>did</span><span id='tok'>not</span><span id='tok'>involve</span><span id='tok'>ThreeDollars</span><span id='tok'>at</span><span id='tok'>all.</span><span id='tok'>Instead,</span><span id='tok'>this</span><span id='tok'>attack</span><span id='tok'>involved</span><span id='tok'>delivering</span><span id='tok'>the</span><span id='tok'>OopsIE</span><span class='token pointer' id='tok-80-22' style='color:red'>Trojan directly</span><span id='tok'>the</span><span class='token pointer' id='tok-80-23' style='color:red'>victim,</span><span id='tok'>most</span><span id='tok'>likely</span><span id='tok'>using</span><span id='tok'>a</span><span class='token pointer' id='tok-80-24' style='color:red'>link</span><span id='tok'>in</span><span id='tok'>a</span><span class='token pointer' id='tok-80-25' style='color:red'>email.</span><span class='token pointer' id='tok-80-26' style='color:red'>spear phishing</span><span id='tok'>the</span><span class='token pointer' id='tok-80-27' style='color:red'>targeted</span><span id='tok'>organization</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>January</span><span id='tok'>16</span><span id='tok'>attack</span><span id='tok'>had</span><span id='tok'>already</span><span id='tok'>been</span><span id='tok'>targeted</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>group</span><span id='tok'>a</span><span id='tok'>year</span><span id='tok'>ago</span><span id='tok'>on</span><span id='tok'>January</span><span id='tok'>2017.</span><span id='tok'>This</span><span id='tok'>repeat</span><span id='tok'>attack</span><span id='tok'>may</span><span id='tok'>suggest</span><span id='tok'>that</span><span id='tok'>the</span><span class='token pointer' id='tok-80-28' style='color:red'>adversaries</span><span id='tok'>have</span><span id='tok'>lost</span><span id='tok'>their</span><span class='token pointer' id='tok-80-29' style='color:red'>foothold</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>targeted</span><span id='tok'>organization,</span><span id='tok'>or</span><span id='tok'>that</span><span id='tok'>it</span><span id='tok'>may</span><span id='tok'>be</span><span id='tok'>considered</span><span id='tok'>a</span></p><p id=p190><span id='tok'>A</span><span id='tok'>New</span><span id='tok'>Attack</span></p><p id=p193><span id='tok'>On</span><span id='tok'>January</span><span id='tok'>8,</span><span id='tok'>2018,</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>threat</span><span id='tok'>group</span><span id='tok'>sent</span><span id='tok'>an</span><span id='tok'>email</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>subject</span><span id='tok'>Beirut</span><span id='tok'>Insurance</span><span id='tok'>Seminar</span><span id='tok'>Invitation</span><span id='tok'>to</span><span id='tok'>an</span><span id='tok'>insurance</span><span id='tok'>agency</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>Middle</span><span id='tok'>East.</span><span id='tok'>The</span><span id='tok'>OilRig</span><span id='tok'>group</span><span id='tok'>sent</span><span id='tok'>two</span><span class='token pointer' id='tok-80-30' style='color:red'>emails</span><span id='tok'>to</span><span id='tok'>two</span><span id='tok'>different</span><span id='tok'>email</span><span class='token pointer' id='tok-80-31' style='color:red'>addresses</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>organization</span><span id='tok'>within</span><span id='tok'>a</span><span id='tok'>six</span><span id='tok'>minutes</span><span id='tok'>time</span><span id='tok'>span.</span><span id='tok'>The</span><span id='tok'>recipient</span><span id='tok'>email</span><span id='tok'>addresses</span><span id='tok'>suggest</span><span id='tok'>they</span><span id='tok'>may</span><span id='tok'>be</span><span id='tok'>the</span><span id='tok'>addresses</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>specific</span><span class='token pointer' id='tok-80-32' style='color:red'>regional branches</span><span id='tok'>the</span><span id='tok'>targeted</span><span id='tok'>organization.</span></p><p id=p259><span id='tok'>Both</span><span id='tok'>emails</span><span id='tok'>originated</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>same</span><span class='token pointer' id='tok-80-33' style='color:red'>address.</span><span id='tok'>The</span><span id='tok'>email</span><span id='tok'>address</span><span id='tok'>is</span><span id='tok'>associated</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>Lebanese</span><span class='token pointer' id='tok-80-34' style='color:red'>domain</span><span id='tok'>of</span><span id='tok'>a</span><span id='tok'>major</span><span id='tok'>global</span><span id='tok'>financial</span><span id='tok'>institution.</span><span id='tok'>However,</span><span id='tok'>based</span><span id='tok'>upon</span><span id='tok'>the</span><span id='tok'>captured</span><span class='token pointer' id='tok-80-35' style='color:red'>session data,</span><span id='tok'>is</span><span id='tok'>highly</span><span id='tok'>likely</span><span id='tok'>the</span><span id='tok'>source</span><span id='tok'>email</span><span id='tok'>address</span><span id='tok'>was</span><span class='token pointer' id='tok-80-36' style='color:red'>spoofed.</span><span id='tok'>The</span><span id='tok'>email</span><span id='tok'>contained</span><span id='tok'>an</span><span class='token pointer' id='tok-80-37' style='color:red'>attachment</span><span id='tok'>named</span><span id='tok'>Seminar-Invitation.doc,</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>a</span><span class='token pointer' id='tok-80-38' style='color:red'>malicious</span><span class='token pointer' id='tok-80-39' style='color:red'>Microsoft</span><span id='tok'>Word</span><span id='tok'>document</span><span id='tok'>we</span><span id='tok'>track</span><span id='tok'>as</span><span id='tok'>ThreeDollars.</span><span id='tok'>Examining</span><span id='tok'>this</span><span id='tok'>sample</span><span id='tok'>of</span><span id='tok'>ThreeDollars</span><span id='tok'>reveals</span><span id='tok'>that</span><span id='tok'>it</span><span id='tok'>contains</span><span id='tok'>a</span><span id='tok'>new</span><span class='token pointer' id='tok-80-40' style='color:red'>payload,</span><span id='tok'>which</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>named</span><span id='tok'>OopsIE.</span></p><p id=p333><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>January</span><span id='tok'>16,</span><span id='tok'>2018</span><span id='tok'>attack,</span><span id='tok'>we</span><span id='tok'>observed</span><span id='tok'>OilRig</span><span id='tok'>attacking</span><span id='tok'>an</span><span id='tok'>organization</span><span id='tok'>it</span><span id='tok'>previously</span><span id='tok'>targeted</span><span id='tok'>in</span><span id='tok'>January</span><span id='tok'>2017.</span><span id='tok'>In</span><span id='tok'>this</span><span id='tok'>case,</span><span id='tok'>the</span><span id='tok'>ThreeDollars</span><span id='tok'>delivery</span><span id='tok'>document</span><span id='tok'>was</span><span id='tok'>not</span><span id='tok'>used</span><span id='tok'>and</span><span id='tok'>instead</span><span id='tok'>an</span><span id='tok'>attempt</span><span id='tok'>was</span><span id='tok'>made</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>the</span><span id='tok'>OopsIE</span><span id='tok'>Trojan</span><span id='tok'>directly</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>targeted</span><span id='tok'>organization,</span><span id='tok'>likely</span><span id='tok'>via</span><span id='tok'>a</span><span id='tok'>link</span><span id='tok'>within</span><span id='tok'>an</span><span id='tok'>email.</span><span id='tok'>The</span><span id='tok'>Trojan</span><span id='tok'>was</span><span id='tok'>directly</span><span class='token pointer' id='tok-80-41' style='color:red'>downloaded</span><span id='tok'>from</span><span id='tok'>the</span><span class='token pointer' id='tok-80-42' style='color:red'>server</span><span class='token pointer' id='tok-80-43' style='color:red'>command and control</span><span id='tok'>OopsIE,</span><span id='tok'>signifying</span><span id='tok'>that</span><span id='tok'>this</span><span id='tok'>server</span><span id='tok'>was</span><span id='tok'>also</span><span id='tok'>used</span><span id='tok'>for</span><span class='token pointer' id='tok-80-44' style='color:red'>staging.</span><span id='tok'>This</span><span id='tok'>suggests</span><span id='tok'>that</span><span id='tok'>due</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>January</span><span id='tok'>2017</span><span id='tok'>attack,</span><span id='tok'>the</span><span id='tok'>targeted</span><span id='tok'>organization</span><span id='tok'>may</span><span id='tok'>have</span><span id='tok'>taken</span><span id='tok'>actions</span><span id='tok'>to</span><span class='token pointer' id='tok-80-45' style='color:red'>counter</span><span id='tok'>known</span><span id='tok'>OilRig</span><span class='token pointer' id='tok-80-46' style='color:red'>TTPs,</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>case</span><span id='tok'>delivering</span><span id='tok'>malicious</span><span class='token pointer' id='tok-80-47' style='color:red'>macro documents,</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>operators</span><span id='tok'>to</span><span id='tok'>adopt</span><span id='tok'>a</span><span id='tok'>different</span><span id='tok'>delivery</span><span class='token pointer' id='tok-80-48' style='color:red'>tactic.</span></p><p id=p444><span id='tok'>We</span><span id='tok'>also</span><span id='tok'>identified</span><span id='tok'>another</span><span id='tok'>sample</span><span id='tok'>of</span><span id='tok'>ThreeDollars,</span><span id='tok'>created</span><span id='tok'>on</span><span id='tok'>January</span><span id='tok'>15,</span><span id='tok'>2017</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-80-49' style='color:red'>file name</span><span id='tok'>preparation.dot.</span><span id='tok'>While</span><span id='tok'>this</span><span id='tok'>sample</span><span id='tok'>was</span><span id='tok'>very</span><span id='tok'>similar</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>Seminar-Invitation.doc</span><span id='tok'>sample</span><span id='tok'>it</span><span id='tok'>also</span><span id='tok'>had</span><span id='tok'>some</span><span id='tok'>significant</span><span id='tok'>differences.</span><span id='tok'>The</span><span id='tok'>primary</span><span id='tok'>difference</span><span id='tok'>was</span><span id='tok'>that</span><span id='tok'>this</span><span id='tok'>sample</span><span id='tok'>was</span><span class='token pointer' id='tok-80-50' style='color:red'>encrypted</span><span id='tok'>and</span><span class='token pointer' id='tok-80-51' style='color:red'>password</span><span class='token pointer' id='tok-80-52' style='color:red'>protected,</span><span id='tok'>requiring</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>to</span><span id='tok'>enter</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>password</span><span id='tok'>which</span><span id='tok'>was</span><span id='tok'>likely</span><span id='tok'>provided</span><span id='tok'>by</span><span id='tok'>the</span><span class='token pointer' id='tok-80-53' style='color:red'>adversary</span><span id='tok'>to</span><span id='tok'>view</span><span id='tok'>the</span><span id='tok'>document.</span><span id='tok'>While</span><span id='tok'>this</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>a</span><span id='tok'>new</span><span id='tok'>tactic,</span><span id='tok'>this</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>first</span><span id='tok'>instance</span><span id='tok'>where</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>observed</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>using</span><span id='tok'>it</span><span id='tok'>in</span><span id='tok'>their</span><span class='token pointer' id='tok-80-54' style='color:red'>playbook.</span><span id='tok'>Typically,</span><span id='tok'>password</span><span id='tok'>protected</span><span class='token pointer' id='tok-80-55' style='color:red'>documents</span><span id='tok'>is</span><span id='tok'>commonly</span><span id='tok'>used</span><span id='tok'>by</span><span id='tok'>adversaries</span><span id='tok'>as</span><span id='tok'>an</span><span class='token pointer' id='tok-80-56' style='color:red'>evasion</span><span id='tok'>tactic</span><span id='tok'>to</span><span class='token pointer' id='tok-80-57' style='color:red'>bypass</span><span class='token pointer' id='tok-80-58' style='color:red'>automated analysis</span><span id='tok'>due</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>password</span><span id='tok'>requirement</span><span id='tok'>for</span><span id='tok'>successful</span><span class='token pointer' id='tok-80-59' style='color:red'>execution.</span><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>observed</span><span id='tok'>throughout</span><span id='tok'>our</span><span id='tok'>tracking</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>group,</span><span id='tok'>adopting</span><span class='token pointer' id='tok-80-60' style='color:red'>proven tactics</span><span id='tok'>been</span><span id='tok'>a</span><span id='tok'>common</span><span id='tok'>behavior</span><span id='tok'>over</span><span id='tok'>time.</span></p><p id=p579><span id='tok'> </span></p><p id=p580><span id='tok'>ThreeDollars</span><span id='tok'>Document</span><span id='tok'>Analysis</span></p><p id=p583><span id='tok'>The</span><span id='tok'>samples</span><span id='tok'>of</span><span id='tok'>ThreeDollars</span><span id='tok'>we</span><span id='tok'>collected</span><span id='tok'>in</span><span id='tok'>these</span><span id='tok'>attacks</span><span id='tok'>are</span><span id='tok'>structurally</span><span id='tok'>very</span><span id='tok'>similar</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>first</span><span id='tok'>sample</span><span id='tok'>we</span><span id='tok'>analyzed</span><span id='tok'>in</span><span id='tok'>October</span><span id='tok'>2017,</span><span id='tok'>down</span><span id='tok'>to</span><span id='tok'>the</span><span class='token pointer' id='tok-80-61' style='color:red'>lure</span><span id='tok'>image</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>trick</span><span id='tok'>the</span><span id='tok'>recipient</span><span id='tok'>into</span><span class='token pointer' id='tok-80-62' style='color:red'>clicking</span><span id='tok'>the</span><span class='token pointer' id='tok-80-63' style='color:red'>Content"</span><span class='token pointer' id='tok-80-64' style='color:red'>button</span><span class='token pointer' id='tok-80-65' style='color:red'>"Enable</span><span class='token pointer' id='tok-80-66' style='color:red'>execute</span><span id='tok'>the</span><span id='tok'>malicious</span><span id='tok'>macro.</span><span id='tok'>The</span><span id='tok'>images</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>January</span><span id='tok'>2018</span><span id='tok'>attacks</span><span id='tok'>were</span><span id='tok'>the</span><span id='tok'>exact</span><span id='tok'>same</span><span id='tok'>in</span><span id='tok'>each</span><span id='tok'>sample,</span><span id='tok'>verified</span><span id='tok'>by</span><span class='token pointer' id='tok-80-67' style='color:red'>hash.</span></p><p id=p645><span class='token pointer' id='tok-80-68' style='color:red'>Malicious</span><span class='token pointer' id='tok-80-69' style='color:red'>Macro</span><span id='tok'>Analysis</span></p><p id=p648><span id='tok'>When</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>opens</span><span id='tok'>the</span><span id='tok'>ThreeDollars</span><span id='tok'>document</span><span id='tok'>they</span><span id='tok'>are</span><span id='tok'>presented</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>lure</span><span id='tok'>image</span><span id='tok'>and</span><span class='token pointer' id='tok-80-70' style='color:red'>prompted</span><span id='tok'>to</span><span class='token pointer' id='tok-80-71' style='color:red'>click</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>"Enable</span><span id='tok'>Content"</span><span id='tok'>button.</span><span id='tok'>When</span><span id='tok'>button</span><span id='tok'>is</span><span id='tok'>clicked,</span><span id='tok'>a</span><span id='tok'>malicious</span><span id='tok'>macro</span><span id='tok'>is</span><span id='tok'>silently</span><span class='token pointer' id='tok-80-72' style='color:red'>run</span><span id='tok'>which</span><span class='token pointer' id='tok-80-73' style='color:red'>installs</span><span id='tok'>then</span><span class='token pointer' id='tok-80-74' style='color:red'>executes</span><span id='tok'>a</span><span id='tok'>payload</span><span id='tok'>on</span><span id='tok'>a</span><span class='token pointer' id='tok-80-75' style='color:red'>system.</span><span id='tok'>A</span><span class='token pointer' id='tok-80-76' style='color:red'>decoy image</span><span id='tok'>also</span><span id='tok'>displayed</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>to</span><span id='tok'>lower</span><span id='tok'>suspicion</span><span id='tok'>of</span><span class='token pointer' id='tok-80-77' style='color:red'>malicious activity.</span><span class='token pointer' id='tok-80-78' style='color:red'>decoy message</span><span id='tok'>is</span><span id='tok'>eventually</span><span id='tok'>presented</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>does</span><span id='tok'>not</span><span id='tok'>actually</span><span id='tok'>show</span><span id='tok'>the</span><span id='tok'>expected</span><span id='tok'>content</span><span id='tok'>of</span><span id='tok'>an</span><span id='tok'>insurance</span><span id='tok'>seminar</span><span id='tok'>invitation</span><span id='tok'>as</span><span id='tok'>presented</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>delivery</span><span id='tok'>email.</span><span id='tok'>Instead,</span><span id='tok'>it</span><span id='tok'>displays</span><span id='tok'>a</span><span id='tok'>fake</span><span class='token pointer' id='tok-80-79' style='color:red'>error message</span><span class='token pointer' id='tok-80-80' style='color:red'>NullRefrencedException!</span><span id='tok'>error</span><span id='tok'>has</span><span id='tok'>occurred</span><span id='tok'>in</span><span id='tok'>user32.dll</span><span id='tok'>by</span><span id='tok'>0x32ef2121</span><span id='tok'>within</span><span id='tok'>the</span><span class='token pointer' id='tok-80-81' style='color:red'>Word</span><span id='tok'>document.</span></p><p id=p753><span id='tok'>OopsIE</span><span id='tok'>Trojan</span><span id='tok'>Analysis</span></p><p id=p756><span id='tok'>The</span><span id='tok'>OopsIE</span><span id='tok'>Trojan</span><span class='token pointer' id='tok-80-82' style='color:red'>delivered</span><span id='tok'>in</span><span id='tok'>these</span><span id='tok'>attacks</span><span id='tok'>is</span><span class='token pointer' id='tok-80-83' style='color:red'>packed</span><span id='tok'>with</span><span id='tok'>SmartAssembly</span><span id='tok'>and</span><span id='tok'>further</span><span class='token pointer' id='tok-80-84' style='color:red'>obfuscated</span><span id='tok'>with</span><span class='token pointer' id='tok-80-85' style='color:red'>ConfuserEx</span><span id='tok'>v1.0.0.</span><span id='tok'>To</span><span id='tok'>run</span><span class='token pointer' id='tok-80-86' style='color:red'>persistently</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>system,</span><span id='tok'>the</span><span id='tok'>Trojan</span><span id='tok'>will</span><span id='tok'>first</span><span id='tok'>create</span><span id='tok'>a</span><span class='token pointer' id='tok-80-87' style='color:red'>VBScript</span><span id='tok'>file:</span></p><p id=p787><span id='tok'>SpecialFolder.CommonApplicationData\srvResesponded.vbs</span></p><p id=p788><span id='tok'>that</span><span id='tok'>contains:</span></p><p id=p790><span id='tok'>CreateObject("WScript.Shell").Run("%app%")</span></p><p id=p791><span id='tok'>The</span><span id='tok'>Trojan</span><span id='tok'>replaces</span><span id='tok'>the</span><span id='tok'>%app%</span><span class='token pointer' id='tok-80-88' style='color:red'>string</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>VBScript</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-80-89' style='color:red'>path</span><span id='tok'>to</span><span id='tok'>its</span><span class='token pointer' id='tok-80-90' style='color:red'>executable.</span><span id='tok'>Finally,</span><span id='tok'>the</span><span id='tok'>Trojan</span><span id='tok'>creates</span><span id='tok'>a</span><span id='tok'>scheduled</span><span class='token pointer' id='tok-80-91' style='color:red'>task</span><span id='tok'>to</span><span id='tok'>run</span><span id='tok'>itself</span><span id='tok'>every</span><span id='tok'>three</span><span id='tok'>minutes</span><span id='tok'>by</span><span id='tok'>running</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-80-92' style='color:red'>command</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>command</span><span class='token pointer' id='tok-80-93' style='color:red'>prompt</span><span id='tok'>after</span><span id='tok'>replacing</span><span id='tok'>the</span><span id='tok'>%path%</span><span id='tok'>string</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>path</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>srvResesponded.vbs</span><span id='tok'>VBScript.</span></p><p id=p841><span id='tok'>The</span><span id='tok'>Trojan</span><span id='tok'>uses</span><span class='token pointer' id='tok-80-94' style='color:red'>HTTP</span><span id='tok'>to</span><span id='tok'>communicate</span><span id='tok'>with</span><span id='tok'>its</span><span class='token pointer' id='tok-80-95' style='color:red'>C2</span><span id='tok'>server,</span><span id='tok'>specifically</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-80-96' style='color:red'>InternetExplorer</span><span class='token pointer' id='tok-80-97' style='color:red'>application</span><span class='token pointer' id='tok-80-98' style='color:red'>object</span><span id='tok'>within</span><span id='tok'>an</span><span class='token pointer' id='tok-80-99' style='color:red'>embedded</span><span class='token pointer' id='tok-80-100' style='color:red'>Framework</span><span class='token pointer' id='tok-80-101' style='color:red'>assembly</span><span class='token pointer' id='tok-80-102' style='color:red'>Microsoft .NET</span><span id='tok'>Interop.SHDocVw.</span><span id='tok'>The</span><span id='tok'>Trojan</span><span class='token pointer' id='tok-80-103' style='color:red'>extracts</span><span id='tok'>and</span><span class='token pointer' id='tok-80-104' style='color:red'>loads</span><span id='tok'>this</span><span id='tok'>embedded</span><span id='tok'>assembly</span><span id='tok'>by</span><span class='token pointer' id='tok-80-105' style='color:red'>concatenating</span><span id='tok'>the</span><span id='tok'>contents</span><span id='tok'>of</span><span id='tok'>two</span><span class='token pointer' id='tok-80-106' style='color:red'>resources</span><span id='tok'>named</span><span id='tok'>S1</span><span id='tok'>and</span><span id='tok'>S2</span><span id='tok'>and</span><span class='token pointer' id='tok-80-107' style='color:red'>decompresses</span><span id='tok'>the</span><span id='tok'>resulting</span><span class='token pointer' id='tok-80-108' style='color:red'>data</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>GZipSteam</span><span class='token pointer' id='tok-80-109' style='color:red'>class.</span><span id='tok'>The</span><span id='tok'>resulting</span><span id='tok'>Interop.SHDocVw</span><span id='tok'>.NET</span><span id='tok'>assembly</span><span id='tok'>is</span><span id='tok'>packed</span><span id='tok'>with</span><span id='tok'>SmartAssembly</span><span id='tok'>and</span><span id='tok'>further</span><span id='tok'>obfuscated</span><span id='tok'>using</span><span id='tok'>Confuser</span><span id='tok'>v1.9.0.0.</span><span id='tok'>The</span><span class='token pointer' id='tok-80-110' style='color:red'>concatenation of</span><span id='tok'>to</span><span class='token pointer' id='tok-80-111' style='color:red'>construct</span><span id='tok'>embedded</span><span class='token pointer' id='tok-80-112' style='color:red'>assemblies</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>a</span><span id='tok'>new</span><span id='tok'>technique</span><span id='tok'>for</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>group,</span><span id='tok'>as</span><span id='tok'>they</span><span id='tok'>used</span><span id='tok'>the</span><span id='tok'>very</span><span id='tok'>same</span><span id='tok'>technique</span><span id='tok'>in</span><span id='tok'>October</span><span id='tok'>2017</span><span id='tok'>in</span><span id='tok'>their</span><span class='token pointer' id='tok-80-113' style='color:red'>ISMInjector</span><span class='token pointer' id='tok-80-114' style='color:red'>tool</span><span id='tok'>to</span><span id='tok'>construct</span><span id='tok'>its</span><span id='tok'>embedded</span><span id='tok'>libraries</span><span id='tok'>Joiner.dll</span><span id='tok'>and</span><span id='tok'>Inner.dll.</span></p><p id=p948><span id='tok'>By</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>InternetExplorer</span><span id='tok'>application</span><span id='tok'>object,</span><span id='tok'>all</span><span id='tok'>C2</span><span id='tok'>related</span><span id='tok'>requests</span><span id='tok'>will</span><span id='tok'>look</span><span id='tok'>as</span><span id='tok'>if</span><span id='tok'>they</span><span id='tok'>came</span><span id='tok'>from</span><span id='tok'>the</span><span class='token pointer' id='tok-80-115' style='color:red'>legitimate</span><span class='token pointer' id='tok-80-116' style='color:red'>browser</span><span id='tok'>and</span><span id='tok'>therefore</span><span id='tok'>will</span><span id='tok'>not</span><span id='tok'>contain</span><span id='tok'>any</span><span id='tok'>anomalous</span><span class='token pointer' id='tok-80-117' style='color:red'>fields</span><span id='tok'>within</span><span id='tok'>the</span><span id='tok'>request,</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>custom</span><span class='token pointer' id='tok-80-118' style='color:red'>User-Agents.</span><span id='tok'>The</span><span id='tok'>OopsIE</span><span id='tok'>Trojan</span><span id='tok'>is</span><span class='token pointer' id='tok-80-119' style='color:red'>configured</span><span id='tok'>to</span><span id='tok'>use</span><span id='tok'>a</span><span id='tok'>C2</span><span id='tok'>server</span><span class='token pointer' id='tok-80-120' style='color:red'>hosted.</span></p><p id=p994><span id='tok'>The</span><span id='tok'>Trojan</span><span id='tok'>will</span><span id='tok'>construct</span><span id='tok'>specific</span><span class='token pointer' id='tok-80-121' style='color:red'>URLs</span><span id='tok'>to</span><span id='tok'>communicate</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>C2</span><span id='tok'>server</span><span id='tok'>and</span><span class='token pointer' id='tok-80-122' style='color:red'>parses</span><span id='tok'>the</span><span id='tok'>C2</span><span class='token pointer' id='tok-80-123' style='color:red'>server's</span><span id='tok'>response</span><span id='tok'>looking</span><span id='tok'>for</span><span id='tok'>content</span><span id='tok'>within</span><span id='tok'>the</span><span class='token pointer' id='tok-80-124' style='color:red'>tags</span><span id='tok'><pre></span><span id='tok'>and</span><span id='tok'></pre>.</span><span id='tok'>The</span><span id='tok'>initial</span><span id='tok'>HTTP</span><span id='tok'>request</span><span id='tok'>acts</span><span id='tok'>as</span><span id='tok'>a</span><span class='token pointer' id='tok-80-125' style='color:red'>beacon,</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>image</span><span id='tok'>below.</span></p><p id=p1035><span id='tok'> </span></p><p id=p1036><span id='tok'>Conclusion</span></p><p id=p1037><span id='tok'>The</span><span id='tok'>OilRig</span><span id='tok'>group</span><span id='tok'>continues</span><span id='tok'>to</span><span id='tok'>remain</span><span id='tok'>a</span><span id='tok'>highly</span><span id='tok'>active</span><span id='tok'>adversary</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>Middle</span><span id='tok'>East</span><span id='tok'>region.</span><span id='tok'>This</span><span id='tok'>group</span><span id='tok'>has</span><span id='tok'>repeatedly</span><span id='tok'>shown</span><span id='tok'>evidence</span><span id='tok'>of</span><span id='tok'>a</span><span id='tok'>willingness</span><span id='tok'>to</span><span id='tok'>adapt</span><span id='tok'>and</span><span id='tok'>evolve</span><span id='tok'>their</span><span id='tok'>tactics,</span><span id='tok'>while</span><span id='tok'>also</span><span id='tok'>reusing</span><span id='tok'>certain</span><span id='tok'>aspects</span><span id='tok'>as</span><span id='tok'>well.</span><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>now</span><span id='tok'>observed</span><span id='tok'>this</span><span id='tok'>adversary</span><span id='tok'>deploy</span><span id='tok'>a</span><span id='tok'>multitude</span><span id='tok'>of</span><span class='token pointer' id='tok-80-126' style='color:red'>tools,</span><span id='tok'>with</span><span id='tok'>each</span><span id='tok'>appearing</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>some</span><span id='tok'>form</span><span id='tok'>of</span><span class='token pointer' id='tok-80-127' style='color:red'>iterative</span><span id='tok'>variation</span><span id='tok'>of</span><span id='tok'>something</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>past.</span><span id='tok'>However,</span><span id='tok'>although</span><span id='tok'>the</span><span id='tok'>tools</span><span id='tok'>themselves</span><span id='tok'>have</span><span class='token pointer' id='tok-80-128' style='color:red'>morphed</span><span id='tok'>over</span><span id='tok'>time,</span><span id='tok'>the</span><span id='tok'>plays</span><span id='tok'>they</span><span id='tok'>have</span><span class='token pointer' id='tok-80-129' style='color:red'>executed</span><span id='tok'>in</span><span id='tok'>their</span><span id='tok'>playbook</span><span id='tok'>largely</span><span id='tok'>remain</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>when</span><span class='token pointer' id='tok-80-130' style='color:red'>examined</span><span id='tok'>over</span><span id='tok'>the</span><span id='tok'>attack</span><span id='tok'>life</span><span id='tok'>cycle.</span><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>added</span><span id='tok'>this</span><span id='tok'>play</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>OilRig</span><span id='tok'>playbook,</span><span id='tok'>which</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>viewed</span><span class='token pointer' id='tok-80-131' style='color:red'>online</span><span id='tok'>via</span><span id='tok'>our</span><span id='tok'>Playbook</span><span class='token pointer' id='tok-80-132' style='color:red'>Viewer.
</span></p>