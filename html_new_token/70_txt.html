<p id=p0><span id='tok'>Often</span><span id='tok'>during</span><span id='tok'>our</span><span class='token pointer' id='tok-70-0' style='color:red'>penetration</span><span id='tok'>testing</span><span id='tok'>engagements,</span><span id='tok'>we</span><span id='tok'>may</span><span id='tok'>have</span><span id='tok'>to</span><span class='token pointer' id='tok-70-1' style='color:red'>applications</span><span class='token pointer' id='tok-70-2' style='color:red'>antivirus</span><span id='tok'>especially</span><span id='tok'>during</span><span id='tok'>the</span><span id='tok'>post</span><span class='token pointer' id='tok-70-3' style='color:red'>exploitation</span><span id='tok'>phase</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>certain</span><span class='token pointer' id='tok-70-4' style='color:red'>files</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span class='token pointer' id='tok-70-5' style='color:red'>machines.</span><span id='tok'>Sometimes</span><span class='token pointer' id='tok-70-6' style='color:red'>it</span><span id='tok'>is</span><span id='tok'>challenging</span><span id='tok'>to</span><span class='token pointer' id='tok-70-7' style='color:red'>bypass</span><span id='tok'>certain</span><span class='token pointer' id='tok-70-8' style='color:red'>antivirus</span><span id='tok'>applications,</span><span id='tok'>as</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>no</span><span id='tok'>standard</span><span class='token pointer' id='tok-70-9' style='color:red'>method/technique</span><span id='tok'>available</span><span id='tok'>to</span><span id='tok'>bypass</span><span id='tok'>all</span><span id='tok'>the</span><span id='tok'>antivirus</span><span class='token pointer' id='tok-70-10' style='color:red'>software.</span><span id='tok'>Thus,</span><span id='tok'>we</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>try</span><span id='tok'>out</span><span id='tok'>different</span><span id='tok'>methods</span><span id='tok'>to</span><span id='tok'>bypass</span><span id='tok'>them.</span><span id='tok'>This</span><span id='tok'>article</span><span id='tok'>walks</span><span id='tok'>the</span><span id='tok'>reader</span><span id='tok'>through</span><span id='tok'>some</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>popular</span><span class='token pointer' id='tok-70-11' style='color:red'>tools</span><span id='tok'>available</span><span id='tok'>to</span><span id='tok'>play</span><span id='tok'>with</span><span class='token pointer' id='tok-70-12' style='color:red'>Antivirus</span><span id='tok'>evasion.</span></p><p id=p78><span class='token pointer' id='tok-70-13' style='color:red'>File Splitters</span><span class='token pointer' id='tok-70-14' style='color:red'>editors</span><span class='token pointer' id='tok-70-15' style='color:red'>Hex</span><span id='tok'>first</span><span id='tok'>technique</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>going</span><span id='tok'>to</span><span id='tok'>discuss</span><span id='tok'>is</span><span id='tok'>using</span><span class='token pointer' id='tok-70-16' style='color:red'>file splitting</span><span id='tok'>to</span><span id='tok'>identify</span><span id='tok'>the</span><span id='tok'>exact</span><span id='tok'>signature</span><span id='tok'>that</span><span id='tok'>is</span><span id='tok'>being</span><span class='token pointer' id='tok-70-17' style='color:red'>detected</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>antivirus</span><span class='token pointer' id='tok-70-18' style='color:red'>application</span><span id='tok'>and</span><span class='token pointer' id='tok-70-19' style='color:red'>modify</span><span id='tok'>it.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>oldest</span><span id='tok'>ways</span><span id='tok'>to</span><span id='tok'>bypass</span><span id='tok'>AV</span><span id='tok'>tools.</span><span id='tok'>This</span><span id='tok'>technique</span><span id='tok'>is</span><span id='tok'>efficient</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>locate</span><span id='tok'>the</span><span id='tok'>exact</span><span id='tok'>signature</span><span id='tok'>that</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>detected.</span><span id='tok'>However,</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>limitation</span><span id='tok'>with</span><span id='tok'>this</span><span id='tok'>technique.</span><span id='tok'>If</span><span id='tok'>we</span><span id='tok'>mess</span><span id='tok'>the</span><span id='tok'>functionality</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>application,</span><span id='tok'>it</span><span id='tok'>becomes</span><span id='tok'>useless</span><span id='tok'>even</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>bypass</span><span id='tok'>antivirus.</span><span id='tok'>So,</span><span id='tok'>as</span><span id='tok'>long</span><span id='tok'>as</span><span id='tok'>the</span><span id='tok'>functionality</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>modified</span><span id='tok'>while</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>changing</span><span id='tok'>the</span><span id='tok'>signatures,</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>good</span><span id='tok'>to</span><span id='tok'>go.</span></p><p id=p183><span id='tok'>This</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>achieved</span><span id='tok'>by</span><span id='tok'>using</span><span class='token pointer' id='tok-70-20' style='color:red'>tool</span><span class='token pointer' id='tok-70-21' style='color:red'>file-splitting</span><span class='token pointer' id='tok-70-22' style='color:red'>split</span><span id='tok'>the</span><span class='token pointer' id='tok-70-23' style='color:red'>binary</span><span id='tok'>into</span><span id='tok'>many</span><span id='tok'>parts.</span><span id='tok'>This</span><span class='token pointer' id='tok-70-24' style='color:red'>splitting</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>done</span><span id='tok'>in</span><span id='tok'>such</span><span id='tok'>a</span><span id='tok'>way</span><span id='tok'>that</span><span id='tok'>each</span><span id='tok'>part</span><span id='tok'>is</span><span id='tok'>larger</span><span id='tok'>than</span><span id='tok'>the</span><span id='tok'>previous</span><span id='tok'>one</span><span id='tok'>by</span><span id='tok'>a</span><span id='tok'>fixed</span><span id='tok'>amount.</span><span id='tok'>Then</span><span id='tok'>we</span><span id='tok'>need</span><span id='tok'>to</span><span class='token pointer' id='tok-70-25' style='color:red'>run</span><span id='tok'>the</span><span id='tok'>Antivirus</span><span class='token pointer' id='tok-70-26' style='color:red'>scan</span><span id='tok'>on</span><span id='tok'>these</span><span id='tok'>parts</span><span id='tok'>to</span><span id='tok'>identify</span><span id='tok'>which</span><span id='tok'>part</span><span id='tok'>is</span><span class='token pointer' id='tok-70-27' style='color:red'>flagged</span><span id='tok'>first</span><span id='tok'>as</span><span class='token pointer' id='tok-70-28' style='color:red'>malicious.</span><span id='tok'>We</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>do</span><span id='tok'>this</span><span id='tok'>process</span><span id='tok'>repeatedly</span><span id='tok'>until</span><span id='tok'>the</span><span id='tok'>actual</span><span id='tok'>signature</span><span id='tok'>is</span><span id='tok'>located.</span><span id='tok'>Tools</span><span id='tok'>such</span><span id='tok'>as</span><span class='token pointer' id='tok-70-29' style='color:red'>"Dsplit"</span><span id='tok'>and</span><span class='token pointer' id='tok-70-30' style='color:red'>"Evade"</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>file</span><span id='tok'>splitting.</span><span id='tok'>Once</span><span id='tok'>the</span><span id='tok'>signature</span><span id='tok'>is</span><span id='tok'>located,</span><span id='tok'>we</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>modify</span><span id='tok'>it</span><span id='tok'>and</span><span id='tok'>save</span><span id='tok'>the</span><span id='tok'>modified</span><span id='tok'>binary.</span></p><p id=p281><span id='tok'>Let's</span><span id='tok'>have</span><span id='tok'>a</span><span id='tok'>look</span><span id='tok'>at</span><span id='tok'>an</span><span id='tok'>example</span><span id='tok'>of</span><span id='tok'>how</span><span id='tok'>this</span><span id='tok'>really</span><span id='tok'>works</span><span id='tok'>against</span><span id='tok'>Antivirus</span><span id='tok'>tools.</span></p><p id=p296><span id='tok'>I</span><span class='token pointer' id='tok-70-31' style='color:red'>have downloaded</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>link</span><span id='tok'>given</span><span id='tok'>below.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>commonly</span><span id='tok'>used</span><span id='tok'>tool</span><span id='tok'>during</span><span id='tok'>post</span><span id='tok'>exploitation</span><span id='tok'>for</span><span id='tok'>dumping</span><span class='token pointer' id='tok-70-32' style='color:red'>passwords</span><span id='tok'>in</span><span id='tok'>clear</span><span id='tok'>text.</span></p><p id=p322><span id='tok'>When</span><span id='tok'>we</span><span id='tok'>scan</span><span id='tok'>this</span><span id='tok'>tool</span><span id='tok'>through</span><span id='tok'>virustotal.com,</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>flagged</span><span id='tok'>as</span><span id='tok'>malicious</span><span id='tok'>by</span><span id='tok'>47</span><span class='token pointer' id='tok-70-33' style='color:red'>Antivirus softwares</span><span id='tok'>of</span><span id='tok'>56.</span></p><p id=p341><span id='tok'>By</span><span id='tok'>using</span><span id='tok'>Dsplit,</span><span id='tok'>I</span><span id='tok'>have</span><span id='tok'>noticed</span><span id='tok'>that</span><span id='tok'>some</span><span id='tok'>antivirus</span><span id='tok'>software</span><span id='tok'>is</span><span id='tok'>detecting</span><span id='tok'>it</span><span id='tok'>as</span><span id='tok'>malicious</span><span id='tok'>using</span><span id='tok'>its</span><span id='tok'>welcome</span><span id='tok'>text,</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>displayed</span><span id='tok'>when</span><span id='tok'>we</span><span id='tok'>run</span><span id='tok'>this</span><span id='tok'>tool.</span><span id='tok'>Therefore,</span><span id='tok'>I</span><span id='tok'>opened</span><span id='tok'>wce.exe</span><span id='tok'>in</span><span id='tok'>a</span><span class='token pointer' id='tok-70-34' style='color:red'>hex editor</span><span id='tok'>changed</span><span id='tok'>this</span><span id='tok'>signature</span><span id='tok'>from</span><span id='tok'>uppercase</span><span id='tok'>to</span><span id='tok'>lowercase</span><span id='tok'>and</span><span id='tok'>vice</span><span id='tok'>versa.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p391><span id='tok'>After</span><span id='tok'>making</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>shown</span><span id='tok'>modifications</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>binary,</span><span id='tok'>I</span><span id='tok'>have</span><span class='token pointer' id='tok-70-35' style='color:red'>scanned</span><span id='tok'>through</span><span id='tok'>virustotal.com</span><span id='tok'>once</span><span id='tok'>again</span><span id='tok'>and</span><span id='tok'>noticed</span><span id='tok'>that</span><span id='tok'>42</span><span id='tok'>antivirus</span><span class='token pointer' id='tok-70-36' style='color:red'>engines</span><span id='tok'>out</span><span id='tok'>of</span><span id='tok'>56</span><span id='tok'>have</span><span id='tok'>flagged</span><span id='tok'>it</span><span id='tok'>as</span><span id='tok'>malicious</span><span id='tok'>this</span><span id='tok'>time.</span></p><p id=p423><span id='tok'>However,</span><span id='tok'>this</span><span id='tok'>didn't</span><span id='tok'>bypass</span><span id='tok'>most</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>antivirus</span><span id='tok'>applications;</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>possible</span><span id='tok'>to</span><span id='tok'>do</span><span id='tok'>that</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>locate</span><span id='tok'>the</span><span id='tok'>exact</span><span id='tok'>signature</span><span id='tok'>that</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>detected</span><span id='tok'>by</span><span id='tok'>those</span><span id='tok'>AVs.</span></p><p id=p452><span id='tok'>When</span><span id='tok'>we</span><span id='tok'>use</span><span id='tok'>the</span><span id='tok'>above-mentioned</span><span id='tok'>technique,</span><span id='tok'>we</span><span id='tok'>should</span><span id='tok'>not</span><span id='tok'>forget</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>functionality</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>binary</span><span id='tok'>while</span><span id='tok'>making</span><span id='tok'>changes.</span></p><p id=p471><span id='tok'>As</span><span id='tok'>an</span><span id='tok'>example,</span><span id='tok'>here</span><span id='tok'>is</span><span id='tok'>the</span><span class='token pointer' id='tok-70-37' style='color:red'>output</span><span id='tok'>of</span><span id='tok'>original</span><span id='tok'>wce.exe</span><span id='tok'>dumping</span><span id='tok'>the</span><span class='token pointer' id='tok-70-38' style='color:red'>password</span><span id='tok'>from</span><span class='token pointer' id='tok-70-39' style='color:red'>memory.</span></p><p id=p486><span id='tok'>The</span><span id='tok'>functionality</span><span id='tok'>remained</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>even</span><span id='tok'>after</span><span id='tok'>making</span><span id='tok'>changes</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>binary.</span><span id='tok'>It</span><span id='tok'>is</span><span id='tok'>still</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>get</span><span id='tok'>the</span><span id='tok'>password</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>memory</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p512><span class='token pointer' id='tok-70-40' style='color:red'>HyperionEncrypting</span><span id='tok'>the</span><span id='tok'>binary</span><span id='tok'>is</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>common</span><span id='tok'>ways</span><span class='token pointer' id='tok-70-41' style='color:red'>to bypass</span><span class='token pointer' id='tok-70-42' style='color:red'>detection.</span><span id='tok'>The</span><span id='tok'>logic</span><span id='tok'>behind</span><span id='tok'>using</span><span class='token pointer' id='tok-70-43' style='color:red'>encrypters</span><span id='tok'>is</span><span id='tok'>to</span><span class='token pointer' id='tok-70-44' style='color:red'>obfuscate</span><span id='tok'>the</span><span id='tok'>binary</span><span id='tok'>from</span><span id='tok'>antivirus</span><span id='tok'>tools</span><span id='tok'>by</span><span id='tok'>encrypting</span><span id='tok'>it.</span><span id='tok'>This</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>decrypted</span><span id='tok'>back</span><span id='tok'>when</span><span id='tok'>the</span><span id='tok'>binary</span><span id='tok'>is</span><span id='tok'>run.</span><span class='token pointer' id='tok-70-45' style='color:red'>Kali Linux</span><span id='tok'>got</span><span id='tok'>an</span><span class='token pointer' id='tok-70-46' style='color:red'>encrypter</span><span class='token pointer' id='tok-70-47' style='color:red'>open source</span><span class='token pointer' id='tok-70-48' style='color:red'>Hyperion</span><span id='tok'>available</span><span id='tok'>in</span><span id='tok'>it.</span><span id='tok'></span></p><p id=p565><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>one</span><span id='tok'>I</span><span id='tok'>have</span><span id='tok'>downloaded</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>link.</span><span id='tok'>Let</span><span id='tok'>us</span><span id='tok'>see</span><span id='tok'>how</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>use</span><span id='tok'>this</span><span id='tok'>tool.</span></p><p id=p586><span id='tok'>Before</span><span id='tok'>we</span><span id='tok'>use</span><span id='tok'>Hyperion,</span><span id='tok'>let's</span><span id='tok'>scan</span><span id='tok'>the</span><span class='token pointer' id='tok-70-49' style='color:red'>version</span><span class='token pointer' id='tok-70-50' style='color:red'>32 bit</span><span id='tok'>wce.exe</span><span class='token pointer' id='tok-70-51' style='color:red'>file</span><span id='tok'>through</span><span id='tok'>virustotal.com</span><span id='tok'>first.</span></p><p id=p602><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>notice,</span><span id='tok'>44</span><span id='tok'>antivirus</span><span id='tok'>applications</span><span id='tok'>have</span><span id='tok'>flagged</span><span id='tok'>this</span><span id='tok'>as</span><span id='tok'>malicious.</span></p><p id=p614><span id='tok'>Let's</span><span class='token pointer' id='tok-70-52' style='color:red'>encrypt</span><span id='tok'>this</span><span id='tok'>file</span><span id='tok'>with</span><span id='tok'>Hyperion</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p623><span id='tok'>Let's</span><span id='tok'>scan</span><span id='tok'>this</span><span id='tok'>newly</span><span id='tok'>generated</span><span id='tok'>file</span><span id='tok'>once</span><span id='tok'>again</span><span id='tok'>and</span><span id='tok'>see</span><span id='tok'>the</span><span id='tok'>detection</span><span id='tok'>ratio.</span></p><p id=p636><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>figure</span><span id='tok'>above,</span><span id='tok'>this</span><span id='tok'>has</span><span id='tok'>got</span><span id='tok'>lesser</span><span id='tok'>detection</span><span id='tok'>compared</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>unencrypted</span><span id='tok'>binary.</span></p><p id=p654><span class='token pointer' id='tok-70-53' style='color:red'>Veil-EvasionVeil-Evasion</span><span id='tok'>is</span><span id='tok'>another</span><span id='tok'>popular</span><span class='token pointer' id='tok-70-54' style='color:red'>framework</span><span id='tok'>written</span><span id='tok'>in</span><span class='token pointer' id='tok-70-55' style='color:red'>python.</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>use</span><span id='tok'>this</span><span id='tok'>framework</span><span id='tok'>to</span><span id='tok'>generate</span><span class='token pointer' id='tok-70-56' style='color:red'>payloads</span><span id='tok'>that</span><span id='tok'>can</span><span class='token pointer' id='tok-70-57' style='color:red'>evade</span><span id='tok'>majority</span><span id='tok'>of</span><span id='tok'>AVs.</span></p><p id=p676><span id='tok'>First</span><span class='token pointer' id='tok-70-58' style='color:red'>download</span><span id='tok'>and</span><span class='token pointer' id='tok-70-59' style='color:red'>install</span><span class='token pointer' id='tok-70-60' style='color:red'>Veil-Evasion</span><span id='tok'>and</span><span id='tok'>run</span><span id='tok'>it</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-70-61' style='color:red'>command</span></p><p id=p688><span class='token pointer' id='tok-70-62' style='color:red'>"veil-evasion"</span></p><p id=p689><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see,</span><span id='tok'>46</span><span id='tok'>payloads</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>loaded.</span><span id='tok'>To</span><span id='tok'>use</span><span id='tok'>a</span><span id='tok'>specific</span><span id='tok'>payload,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>type</span><span id='tok'>"use"</span><span id='tok'>command.</span></p><p id=p708><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>going</span><span id='tok'>to</span><span id='tok'>choose</span><span id='tok'>option</span><span id='tok'>31</span><span id='tok'>to</span><span id='tok'>create</span><span id='tok'>the</span><span class='token pointer' id='tok-70-63' style='color:red'>executable</span><span id='tok'>payload</span><span class='token pointer' id='tok-70-64' style='color:red'>python/meterpreter/rev_tcp.</span><span id='tok'>Infact,</span><span id='tok'>it</span><span id='tok'>creates</span><span id='tok'>a</span><span id='tok'>python</span><span class='token pointer' id='tok-70-65' style='color:red'>script,</span><span id='tok'>which</span><span id='tok'>in</span><span id='tok'>turn</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>converted</span><span id='tok'>into</span><span id='tok'>an</span><span id='tok'>executable</span><span id='tok'>using</span><span id='tok'>tools</span><span id='tok'>like</span><span class='token pointer' id='tok-70-66' style='color:red'>pyinstaller.</span></p><p id=p740><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>figure,</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>set</span><span id='tok'>the</span><span class='token pointer' id='tok-70-67' style='color:red'>LHOST</span><span id='tok'>to</span><span id='tok'>192.168.56.101</span><span id='tok'>and</span><span id='tok'>typed</span><span id='tok'>"generate"</span><span id='tok'>command</span><span id='tok'>to</span><span id='tok'>generate</span><span id='tok'>the</span><span id='tok'>payload.</span></p><p id=p759><span id='tok'>Next,</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>ask</span><span id='tok'>us</span><span id='tok'>to</span><span id='tok'>enter</span><span id='tok'>a</span><span id='tok'>name</span><span id='tok'>for</span><span id='tok'>the</span><span id='tok'>payload.</span><span id='tok'>I</span><span id='tok'>named</span><span id='tok'>it</span><span id='tok'>"backdoor".</span><span id='tok'>As</span><span id='tok'>mentioned</span><span id='tok'>earlier,</span><span class='token pointer' id='tok-70-68' style='color:red'>Veil</span><span class='token pointer' id='tok-70-69' style='color:red'>converts</span><span id='tok'>python</span><span id='tok'>files</span><span id='tok'>to</span><span id='tok'>exe.</span><span id='tok'>It</span><span id='tok'>asks</span><span id='tok'>us</span><span id='tok'>to</span><span id='tok'>choose</span><span id='tok'>which</span><span id='tok'>tool</span><span id='tok'>we</span><span id='tok'>want</span><span id='tok'>to</span><span id='tok'>use</span><span id='tok'>for</span><span id='tok'>this</span><span id='tok'>process.</span><span id='tok'>Personally,</span><span id='tok'>I</span><span id='tok'>like</span><span class='token pointer' id='tok-70-70' style='color:red'>Pyinstaller</span><span id='tok'>and</span><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>going</span><span id='tok'>for</span><span id='tok'>it</span><span id='tok'>with</span><span id='tok'>option</span><span id='tok'>1.</span><span id='tok'>These</span><span id='tok'>two</span><span id='tok'>steps</span><span id='tok'>are</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p817><span id='tok'>Once</span><span id='tok'>done,</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>create</span><span id='tok'>our</span><span id='tok'>final</span><span id='tok'>payload</span><span id='tok'>and</span><span id='tok'>gives</span><span id='tok'>us</span><span id='tok'>the</span><span id='tok'>location</span><span id='tok'>of</span><span id='tok'>it</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p835><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>figure</span><span id='tok'>above,</span><span id='tok'>the</span><span id='tok'>authors</span><span id='tok'>of</span><span id='tok'>this</span><span id='tok'>framework</span><span id='tok'>are</span><span id='tok'>suggesting</span><span id='tok'>not</span><span id='tok'>to</span><span id='tok'>submit</span><span id='tok'>these</span><span id='tok'>samples</span><span class='token pointer' id='tok-70-71' style='color:red'>online.</span><span id='tok'>Therefore,</span><span id='tok'>I</span><span id='tok'>have</span><span id='tok'>checked</span><span id='tok'>this</span><span id='tok'>payload</span><span id='tok'>in</span><span class='token pointer' id='tok-70-72' style='color:red'>sandboxed</span><span id='tok'>environment</span><span id='tok'>with</span><span class='token pointer' id='tok-70-73' style='color:red'>Avast Antivirus</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>detected.</span></p><p id=p873><span class='token pointer' id='tok-70-74' style='color:red'>Ethical Hacking Training</span><span id='tok'>Resources</span><span class='token pointer' id='tok-70-75' style='color:red'>(InfoSec)</span></p><p id=p879><span id='tok'>These</span><span id='tok'>payloads</span><span id='tok'>also</span><span id='tok'>work</span><span id='tok'>fine</span><span id='tok'>when</span><span id='tok'>they</span><span id='tok'>are</span><span id='tok'>executed</span><span id='tok'>on</span><span id='tok'>Victim's</span><span id='tok'>machines.</span></p><p id=p891><span id='tok'>Following</span><span id='tok'>figure</span><span id='tok'>shows</span><span id='tok'>a</span><span id='tok'>meterpreter</span><span id='tok'>shell</span><span id='tok'>obtained</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>payload</span><span id='tok'>created</span><span id='tok'>above.</span></p><p id=p903><span id='tok'>Try</span><span id='tok'>with</span><span id='tok'>other</span><span id='tok'>payloads</span><span id='tok'>that</span><span id='tok'>use</span><span class='token pointer' id='tok-70-76' style='color:red'>encryption</span><span id='tok'>to</span><span id='tok'>get</span><span id='tok'>better</span><span id='tok'>output.</span></p><p id=p914><span id='tok'>This</span><span id='tok'>script</span><span class='token pointer' id='tok-70-77' style='color:red'>automates</span><span id='tok'>multiple</span><span id='tok'>tricks</span><span id='tok'>to</span><span id='tok'>evade</span><span id='tok'>AVs.</span><span id='tok'>The</span><span id='tok'>author</span><span id='tok'>has</span><span id='tok'>written</span><span id='tok'>this</span><span id='tok'>for</span><span id='tok'>his</span><span id='tok'>own</span><span id='tok'>purposes</span><span id='tok'>and</span><span id='tok'>he</span><span id='tok'>released</span><span id='tok'>it</span><span id='tok'>publicly</span><span id='tok'>as</span><span id='tok'>a</span><span class='token pointer' id='tok-70-78' style='color:red'>beta</span><span id='tok'>version.</span><span id='tok'>This</span><span id='tok'>script</span><span id='tok'>gives</span><span id='tok'>us</span><span id='tok'>an</span><span id='tok'>idea</span><span id='tok'>of</span><span id='tok'>how</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>write</span><span id='tok'>our</span><span id='tok'>own</span><span class='token pointer' id='tok-70-79' style='color:red'>scripts</span><span id='tok'>to</span><span id='tok'>evade</span><span class='token pointer' id='tok-70-80' style='color:red'>Antiviruses.</span></p><p id=p957><span id='tok'>Let's</span><span id='tok'>see</span><span id='tok'>this</span><span id='tok'>in</span><span id='tok'>action.</span></p><p id=p962><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>going</span><span id='tok'>to</span><span id='tok'>create</span><span id='tok'>a</span><span id='tok'>meterpreter</span><span id='tok'>payload</span><span id='tok'>using</span><span id='tok'>msfvenom</span><span id='tok'>for</span><span id='tok'>this</span><span id='tok'>purpose.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p979><span id='tok'>Let</span><span id='tok'>us</span><span id='tok'>scan</span><span id='tok'>the</span><span id='tok'>payload</span><span id='tok'>"test.exe"</span><span id='tok'>through</span><span id='tok'>virustotal.com</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p990><span id='tok'>36</span><span id='tok'>out</span><span id='tok'>of</span><span id='tok'>56</span><span id='tok'>antivirus</span><span id='tok'>engines</span><span id='tok'>have</span><span id='tok'>flagged</span><span id='tok'>this</span><span id='tok'>as</span><span id='tok'>malicious.</span></p><p id=p1001><span id='tok'>Now,</span><span id='tok'>lets</span><span id='tok'>run</span><span id='tok'>this</span><span id='tok'>using</span><span id='tok'>peCloak.py</span><span id='tok'>script.</span></p><p id=p1008><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>script</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-70-81' style='color:red'>default</span><span id='tok'>options.</span></p><p id=p1017><span id='tok'>It</span><span id='tok'>creates</span><span id='tok'>a</span><span id='tok'>file</span><span id='tok'>called</span><span id='tok'>"cloaked.exe".</span></p><p id=p1023><span id='tok'>Let's</span><span id='tok'>scan</span><span id='tok'>this</span><span id='tok'>new</span><span id='tok'>payload</span><span id='tok'>and</span><span id='tok'>see</span><span id='tok'>how</span><span id='tok'>many</span><span id='tok'>antivirus</span><span id='tok'>engines</span><span class='token pointer' id='tok-70-82' style='color:red'>detect</span><span id='tok'>is</span><span id='tok'>as</span><span id='tok'>malicious.</span></p><p id=p1038><span id='tok'>Only</span><span id='tok'>26</span><span id='tok'>out</span><span id='tok'>of</span><span id='tok'>56</span><span id='tok'>have</span><span id='tok'>flagged</span><span id='tok'>it</span><span id='tok'>as</span><span id='tok'>malicious.</span></p><p id=p1048><span id='tok'>Conclusion:</span><span id='tok'>Apart</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>tools</span><span id='tok'>mentioned</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>article,</span><span id='tok'>there</span><span id='tok'>are</span><span id='tok'>a</span><span id='tok'>couple</span><span id='tok'>of</span><span id='tok'>other</span><span id='tok'>tools</span><span id='tok'>out</span><span id='tok'>there</span><span id='tok'>such</span><span id='tok'>as</span><span id='tok'>Metasploit's</span><span class='token pointer' id='tok-70-83' style='color:red'>encoders.</span><span id='tok'>It</span><span id='tok'>is</span><span id='tok'>better</span><span id='tok'>to</span><span id='tok'>write</span><span id='tok'>custom</span><span id='tok'>payloads</span><span id='tok'>and</span><span id='tok'>keep</span><span id='tok'>them</span><span id='tok'>simple</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>away</span><span id='tok'>from</span><span id='tok'>Antivirus</span><span id='tok'>detection</span><span id='tok'>rather</span><span id='tok'>than</span><span id='tok'>creating</span><span id='tok'>payloads</span><span id='tok'>using</span><span id='tok'>popular</span><span class='token pointer' id='tok-70-84' style='color:red'>frameworks.</span><span id='tok'>A</span><span id='tok'>side</span><span id='tok'>note:</span><span id='tok'>The</span><span id='tok'>results</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>article</span><span id='tok'>may</span><span id='tok'>change</span><span id='tok'>when</span><span id='tok'>you</span><span id='tok'>read</span><span id='tok'>this</span><span id='tok'>article</span><span id='tok'>as</span><span id='tok'>Antivirus</span><span id='tok'></span><span id='tok'></span><span id='tok'></span><span id='tok'></span></p>