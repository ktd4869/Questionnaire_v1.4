<p id=p0><span class='token pointer' id='tok-70-0'>Often</span><span class='token pointer' id='tok-70-1'>during</span><span class='token pointer' id='tok-70-2'>our</span><span class='token pointer' id='tok-70-3' style='color:red'>penetration</span><span class='token pointer' id='tok-70-4'>testing</span><span class='token pointer' id='tok-70-5'>engagements,</span><span class='token pointer' id='tok-70-6'>we</span><span class='token pointer' id='tok-70-7'>may</span><span class='token pointer' id='tok-70-8'>have</span><span class='token pointer' id='tok-70-9'>to</span><span class='token pointer' id='tok-70-10' style='color:red'>applications</span><span class='token pointer' id='tok-70-11' style='color:red'>bypass antivirus</span><span class='token pointer' id='tok-70-12'>especially</span><span class='token pointer' id='tok-70-13'>during</span><span class='token pointer' id='tok-70-14'>the</span><span class='token pointer' id='tok-70-15'>post</span><span class='token pointer' id='tok-70-16' style='color:red'>exploitation</span><span class='token pointer' id='tok-70-17'>phase</span><span class='token pointer' id='tok-70-18'>to</span><span class='token pointer' id='tok-70-19'>execute</span><span class='token pointer' id='tok-70-20'>certain</span><span class='token pointer' id='tok-70-21' style='color:red'>files</span><span class='token pointer' id='tok-70-22'>on</span><span class='token pointer' id='tok-70-23'>the</span><span class='token pointer' id='tok-70-24'>target</span><span class='token pointer' id='tok-70-25' style='color:red'>machines.</span><span class='token pointer' id='tok-70-26'>Sometimes</span><span class='token pointer' id='tok-70-27' style='color:red'>it</span><span class='token pointer' id='tok-70-28'>is</span><span class='token pointer' id='tok-70-29'>challenging</span><span class='token pointer' id='tok-70-30'>to</span><span class='token pointer' id='tok-70-31' style='color:red'>bypass</span><span class='token pointer' id='tok-70-32'>certain</span><span class='token pointer' id='tok-70-33' style='color:red'>antivirus</span><span class='token pointer' id='tok-70-34'>applications,</span><span class='token pointer' id='tok-70-35'>as</span><span class='token pointer' id='tok-70-36'>there</span><span class='token pointer' id='tok-70-37'>is</span><span class='token pointer' id='tok-70-38'>no</span><span class='token pointer' id='tok-70-39'>standard</span><span class='token pointer' id='tok-70-40' style='color:red'>method/technique</span><span class='token pointer' id='tok-70-41'>available</span><span class='token pointer' id='tok-70-42'>to</span><span class='token pointer' id='tok-70-43'>bypass</span><span class='token pointer' id='tok-70-44'>all</span><span class='token pointer' id='tok-70-45'>the</span><span class='token pointer' id='tok-70-46'>antivirus</span><span class='token pointer' id='tok-70-47' style='color:red'>software.</span><span class='token pointer' id='tok-70-48'>Thus,</span><span class='token pointer' id='tok-70-49'>we</span><span class='token pointer' id='tok-70-50'>need</span><span class='token pointer' id='tok-70-51'>to</span><span class='token pointer' id='tok-70-52'>try</span><span class='token pointer' id='tok-70-53'>out</span><span class='token pointer' id='tok-70-54'>different</span><span class='token pointer' id='tok-70-55'>methods</span><span class='token pointer' id='tok-70-56'>to</span><span class='token pointer' id='tok-70-57'>bypass</span><span class='token pointer' id='tok-70-58'>them.</span><span class='token pointer' id='tok-70-59'>This</span><span class='token pointer' id='tok-70-60'>article</span><span class='token pointer' id='tok-70-61'>walks</span><span class='token pointer' id='tok-70-62'>the</span><span class='token pointer' id='tok-70-63'>reader</span><span class='token pointer' id='tok-70-64'>through</span><span class='token pointer' id='tok-70-65'>some</span><span class='token pointer' id='tok-70-66'>of</span><span class='token pointer' id='tok-70-67'>the</span><span class='token pointer' id='tok-70-68'>popular</span><span class='token pointer' id='tok-70-69' style='color:red'>tools</span><span class='token pointer' id='tok-70-70'>available</span><span class='token pointer' id='tok-70-71'>to</span><span class='token pointer' id='tok-70-72'>play</span><span class='token pointer' id='tok-70-73'>with</span><span class='token pointer' id='tok-70-74' style='color:red'>Antivirus</span><span class='token pointer' id='tok-70-75'>evasion.</span></p><p id=p78><span class='token pointer' id='tok-70-76' style='color:red'>File Splitters</span><span class='token pointer' id='tok-70-77' style='color:red'>Hex editors</span><span class='token pointer' id='tok-70-78'>first</span><span class='token pointer' id='tok-70-79'>technique</span><span class='token pointer' id='tok-70-80'>that</span><span class='token pointer' id='tok-70-81'>we</span><span class='token pointer' id='tok-70-82'>are</span><span class='token pointer' id='tok-70-83'>going</span><span class='token pointer' id='tok-70-84'>to</span><span class='token pointer' id='tok-70-85'>discuss</span><span class='token pointer' id='tok-70-86'>is</span><span class='token pointer' id='tok-70-87'>using</span><span class='token pointer' id='tok-70-88' style='color:red'>file splitting</span><span class='token pointer' id='tok-70-89'>to</span><span class='token pointer' id='tok-70-90'>identify</span><span class='token pointer' id='tok-70-91'>the</span><span class='token pointer' id='tok-70-92'>exact</span><span class='token pointer' id='tok-70-93'>signature</span><span class='token pointer' id='tok-70-94'>that</span><span class='token pointer' id='tok-70-95'>is</span><span class='token pointer' id='tok-70-96'>being</span><span class='token pointer' id='tok-70-97' style='color:red'>detected</span><span class='token pointer' id='tok-70-98'>by</span><span class='token pointer' id='tok-70-99'>the</span><span class='token pointer' id='tok-70-100'>antivirus</span><span class='token pointer' id='tok-70-101' style='color:red'>application</span><span class='token pointer' id='tok-70-102'>and</span><span class='token pointer' id='tok-70-103' style='color:red'>modify</span><span class='token pointer' id='tok-70-104'>it.</span><span class='token pointer' id='tok-70-105'>This</span><span class='token pointer' id='tok-70-106'>is</span><span class='token pointer' id='tok-70-107'>one</span><span class='token pointer' id='tok-70-108'>of</span><span class='token pointer' id='tok-70-109'>the</span><span class='token pointer' id='tok-70-110'>oldest</span><span class='token pointer' id='tok-70-111'>ways</span><span class='token pointer' id='tok-70-112'>to</span><span class='token pointer' id='tok-70-113'>bypass</span><span class='token pointer' id='tok-70-114'>AV</span><span class='token pointer' id='tok-70-115'>tools.</span><span class='token pointer' id='tok-70-116'>This</span><span class='token pointer' id='tok-70-117'>technique</span><span class='token pointer' id='tok-70-118'>is</span><span class='token pointer' id='tok-70-119'>efficient</span><span class='token pointer' id='tok-70-120'>if</span><span class='token pointer' id='tok-70-121'>we</span><span class='token pointer' id='tok-70-122'>can</span><span class='token pointer' id='tok-70-123'>locate</span><span class='token pointer' id='tok-70-124'>the</span><span class='token pointer' id='tok-70-125'>exact</span><span class='token pointer' id='tok-70-126'>signature</span><span class='token pointer' id='tok-70-127'>that</span><span class='token pointer' id='tok-70-128'>is</span><span class='token pointer' id='tok-70-129'>being</span><span class='token pointer' id='tok-70-130'>detected.</span><span class='token pointer' id='tok-70-131'>However,</span><span class='token pointer' id='tok-70-132'>there</span><span class='token pointer' id='tok-70-133'>is</span><span class='token pointer' id='tok-70-134'>a</span><span class='token pointer' id='tok-70-135'>limitation</span><span class='token pointer' id='tok-70-136'>with</span><span class='token pointer' id='tok-70-137'>this</span><span class='token pointer' id='tok-70-138'>technique.</span><span class='token pointer' id='tok-70-139'>If</span><span class='token pointer' id='tok-70-140'>we</span><span class='token pointer' id='tok-70-141'>mess</span><span class='token pointer' id='tok-70-142'>the</span><span class='token pointer' id='tok-70-143'>functionality</span><span class='token pointer' id='tok-70-144'>of</span><span class='token pointer' id='tok-70-145'>the</span><span class='token pointer' id='tok-70-146'>application,</span><span class='token pointer' id='tok-70-147'>it</span><span class='token pointer' id='tok-70-148'>becomes</span><span class='token pointer' id='tok-70-149'>useless</span><span class='token pointer' id='tok-70-150'>even</span><span class='token pointer' id='tok-70-151'>if</span><span class='token pointer' id='tok-70-152'>we</span><span class='token pointer' id='tok-70-153'>bypass</span><span class='token pointer' id='tok-70-154'>antivirus.</span><span class='token pointer' id='tok-70-155'>So,</span><span class='token pointer' id='tok-70-156'>as</span><span class='token pointer' id='tok-70-157'>long</span><span class='token pointer' id='tok-70-158'>as</span><span class='token pointer' id='tok-70-159'>the</span><span class='token pointer' id='tok-70-160'>functionality</span><span class='token pointer' id='tok-70-161'>is</span><span class='token pointer' id='tok-70-162'>not</span><span class='token pointer' id='tok-70-163'>modified</span><span class='token pointer' id='tok-70-164'>while</span><span class='token pointer' id='tok-70-165'>we</span><span class='token pointer' id='tok-70-166'>are</span><span class='token pointer' id='tok-70-167'>changing</span><span class='token pointer' id='tok-70-168'>the</span><span class='token pointer' id='tok-70-169'>signatures,</span><span class='token pointer' id='tok-70-170'>we</span><span class='token pointer' id='tok-70-171'>are</span><span class='token pointer' id='tok-70-172'>good</span><span class='token pointer' id='tok-70-173'>to</span><span class='token pointer' id='tok-70-174'>go.</span></p><p id=p183><span class='token pointer' id='tok-70-175'>This</span><span class='token pointer' id='tok-70-176'>can</span><span class='token pointer' id='tok-70-177'>be</span><span class='token pointer' id='tok-70-178'>achieved</span><span class='token pointer' id='tok-70-179'>by</span><span class='token pointer' id='tok-70-180'>using</span><span class='token pointer' id='tok-70-181' style='color:red'>tool</span><span class='token pointer' id='tok-70-182' style='color:red'>a file-splitting</span><span class='token pointer' id='tok-70-183' style='color:red'>split</span><span class='token pointer' id='tok-70-184'>the</span><span class='token pointer' id='tok-70-185' style='color:red'>binary</span><span class='token pointer' id='tok-70-186'>into</span><span class='token pointer' id='tok-70-187'>many</span><span class='token pointer' id='tok-70-188'>parts.</span><span class='token pointer' id='tok-70-189'>This</span><span class='token pointer' id='tok-70-190' style='color:red'>splitting</span><span class='token pointer' id='tok-70-191'>should</span><span class='token pointer' id='tok-70-192'>be</span><span class='token pointer' id='tok-70-193'>done</span><span class='token pointer' id='tok-70-194'>in</span><span class='token pointer' id='tok-70-195'>such</span><span class='token pointer' id='tok-70-196'>a</span><span class='token pointer' id='tok-70-197'>way</span><span class='token pointer' id='tok-70-198'>that</span><span class='token pointer' id='tok-70-199'>each</span><span class='token pointer' id='tok-70-200'>part</span><span class='token pointer' id='tok-70-201'>is</span><span class='token pointer' id='tok-70-202'>larger</span><span class='token pointer' id='tok-70-203'>than</span><span class='token pointer' id='tok-70-204'>the</span><span class='token pointer' id='tok-70-205'>previous</span><span class='token pointer' id='tok-70-206'>one</span><span class='token pointer' id='tok-70-207'>by</span><span class='token pointer' id='tok-70-208'>a</span><span class='token pointer' id='tok-70-209'>fixed</span><span class='token pointer' id='tok-70-210'>amount.</span><span class='token pointer' id='tok-70-211'>Then</span><span class='token pointer' id='tok-70-212'>we</span><span class='token pointer' id='tok-70-213'>need</span><span class='token pointer' id='tok-70-214'>to</span><span class='token pointer' id='tok-70-215' style='color:red'>run</span><span class='token pointer' id='tok-70-216'>the</span><span class='token pointer' id='tok-70-217'>Antivirus</span><span class='token pointer' id='tok-70-218' style='color:red'>scan</span><span class='token pointer' id='tok-70-219'>on</span><span class='token pointer' id='tok-70-220'>these</span><span class='token pointer' id='tok-70-221'>parts</span><span class='token pointer' id='tok-70-222'>to</span><span class='token pointer' id='tok-70-223'>identify</span><span class='token pointer' id='tok-70-224'>which</span><span class='token pointer' id='tok-70-225'>part</span><span class='token pointer' id='tok-70-226'>is</span><span class='token pointer' id='tok-70-227' style='color:red'>flagged</span><span class='token pointer' id='tok-70-228'>first</span><span class='token pointer' id='tok-70-229'>as</span><span class='token pointer' id='tok-70-230' style='color:red'>malicious.</span><span class='token pointer' id='tok-70-231'>We</span><span class='token pointer' id='tok-70-232'>need</span><span class='token pointer' id='tok-70-233'>to</span><span class='token pointer' id='tok-70-234'>do</span><span class='token pointer' id='tok-70-235'>this</span><span class='token pointer' id='tok-70-236'>process</span><span class='token pointer' id='tok-70-237'>repeatedly</span><span class='token pointer' id='tok-70-238'>until</span><span class='token pointer' id='tok-70-239'>the</span><span class='token pointer' id='tok-70-240'>actual</span><span class='token pointer' id='tok-70-241'>signature</span><span class='token pointer' id='tok-70-242'>is</span><span class='token pointer' id='tok-70-243'>located.</span><span class='token pointer' id='tok-70-244'>Tools</span><span class='token pointer' id='tok-70-245'>such</span><span class='token pointer' id='tok-70-246'>as</span><span class='token pointer' id='tok-70-247' style='color:red'>"Dsplit"</span><span class='token pointer' id='tok-70-248'>and</span><span class='token pointer' id='tok-70-249' style='color:red'>"Evade"</span><span class='token pointer' id='tok-70-250'>can</span><span class='token pointer' id='tok-70-251'>be</span><span class='token pointer' id='tok-70-252'>used</span><span class='token pointer' id='tok-70-253'>for</span><span class='token pointer' id='tok-70-254'>file</span><span class='token pointer' id='tok-70-255'>splitting.</span><span class='token pointer' id='tok-70-256'>Once</span><span class='token pointer' id='tok-70-257'>the</span><span class='token pointer' id='tok-70-258'>signature</span><span class='token pointer' id='tok-70-259'>is</span><span class='token pointer' id='tok-70-260'>located,</span><span class='token pointer' id='tok-70-261'>we</span><span class='token pointer' id='tok-70-262'>need</span><span class='token pointer' id='tok-70-263'>to</span><span class='token pointer' id='tok-70-264'>modify</span><span class='token pointer' id='tok-70-265'>it</span><span class='token pointer' id='tok-70-266'>and</span><span class='token pointer' id='tok-70-267'>save</span><span class='token pointer' id='tok-70-268'>the</span><span class='token pointer' id='tok-70-269'>modified</span><span class='token pointer' id='tok-70-270'>binary.</span></p><p id=p281><span class='token pointer' id='tok-70-271'>Let's</span><span class='token pointer' id='tok-70-272'>have</span><span class='token pointer' id='tok-70-273'>a</span><span class='token pointer' id='tok-70-274'>look</span><span class='token pointer' id='tok-70-275'>at</span><span class='token pointer' id='tok-70-276'>an</span><span class='token pointer' id='tok-70-277'>example</span><span class='token pointer' id='tok-70-278'>of</span><span class='token pointer' id='tok-70-279'>how</span><span class='token pointer' id='tok-70-280'>this</span><span class='token pointer' id='tok-70-281'>really</span><span class='token pointer' id='tok-70-282'>works</span><span class='token pointer' id='tok-70-283'>against</span><span class='token pointer' id='tok-70-284'>Antivirus</span><span class='token pointer' id='tok-70-285'>tools.</span></p><p id=p296><span class='token pointer' id='tok-70-286'>I</span><span class='token pointer' id='tok-70-287' style='color:red'>have downloaded</span><span class='token pointer' id='tok-70-288'>from</span><span class='token pointer' id='tok-70-289'>the</span><span class='token pointer' id='tok-70-290'>link</span><span class='token pointer' id='tok-70-291'>given</span><span class='token pointer' id='tok-70-292'>below.</span><span class='token pointer' id='tok-70-293'>This</span><span class='token pointer' id='tok-70-294'>is</span><span class='token pointer' id='tok-70-295'>one</span><span class='token pointer' id='tok-70-296'>of</span><span class='token pointer' id='tok-70-297'>the</span><span class='token pointer' id='tok-70-298'>commonly</span><span class='token pointer' id='tok-70-299'>used</span><span class='token pointer' id='tok-70-300'>tool</span><span class='token pointer' id='tok-70-301'>during</span><span class='token pointer' id='tok-70-302'>post</span><span class='token pointer' id='tok-70-303'>exploitation</span><span class='token pointer' id='tok-70-304'>for</span><span class='token pointer' id='tok-70-305'>dumping</span><span class='token pointer' id='tok-70-306' style='color:red'>passwords</span><span class='token pointer' id='tok-70-307'>in</span><span class='token pointer' id='tok-70-308'>clear</span><span class='token pointer' id='tok-70-309'>text.</span></p><p id=p322><span class='token pointer' id='tok-70-310'>When</span><span class='token pointer' id='tok-70-311'>we</span><span class='token pointer' id='tok-70-312'>scan</span><span class='token pointer' id='tok-70-313'>this</span><span class='token pointer' id='tok-70-314'>tool</span><span class='token pointer' id='tok-70-315'>through</span><span class='token pointer' id='tok-70-316'>virustotal.com,</span><span class='token pointer' id='tok-70-317'>it</span><span class='token pointer' id='tok-70-318'>is</span><span class='token pointer' id='tok-70-319'>flagged</span><span class='token pointer' id='tok-70-320'>as</span><span class='token pointer' id='tok-70-321'>malicious</span><span class='token pointer' id='tok-70-322'>by</span><span class='token pointer' id='tok-70-323'>47</span><span class='token pointer' id='tok-70-324' style='color:red'>Antivirus softwares</span><span class='token pointer' id='tok-70-325'>of</span><span class='token pointer' id='tok-70-326'>56.</span></p><p id=p341><span class='token pointer' id='tok-70-327'>By</span><span class='token pointer' id='tok-70-328'>using</span><span class='token pointer' id='tok-70-329'>Dsplit,</span><span class='token pointer' id='tok-70-330'>I</span><span class='token pointer' id='tok-70-331'>have</span><span class='token pointer' id='tok-70-332'>noticed</span><span class='token pointer' id='tok-70-333'>that</span><span class='token pointer' id='tok-70-334'>some</span><span class='token pointer' id='tok-70-335'>antivirus</span><span class='token pointer' id='tok-70-336'>software</span><span class='token pointer' id='tok-70-337'>is</span><span class='token pointer' id='tok-70-338'>detecting</span><span class='token pointer' id='tok-70-339'>it</span><span class='token pointer' id='tok-70-340'>as</span><span class='token pointer' id='tok-70-341'>malicious</span><span class='token pointer' id='tok-70-342'>using</span><span class='token pointer' id='tok-70-343'>its</span><span class='token pointer' id='tok-70-344'>welcome</span><span class='token pointer' id='tok-70-345'>text,</span><span class='token pointer' id='tok-70-346'>which</span><span class='token pointer' id='tok-70-347'>is</span><span class='token pointer' id='tok-70-348'>displayed</span><span class='token pointer' id='tok-70-349'>when</span><span class='token pointer' id='tok-70-350'>we</span><span class='token pointer' id='tok-70-351'>run</span><span class='token pointer' id='tok-70-352'>this</span><span class='token pointer' id='tok-70-353'>tool.</span><span class='token pointer' id='tok-70-354'>Therefore,</span><span class='token pointer' id='tok-70-355'>I</span><span class='token pointer' id='tok-70-356'>opened</span><span class='token pointer' id='tok-70-357'>wce.exe</span><span class='token pointer' id='tok-70-358'>in</span><span class='token pointer' id='tok-70-359'>a</span><span class='token pointer' id='tok-70-360' style='color:red'>hex editor</span><span class='token pointer' id='tok-70-361'>changed</span><span class='token pointer' id='tok-70-362'>this</span><span class='token pointer' id='tok-70-363'>signature</span><span class='token pointer' id='tok-70-364'>from</span><span class='token pointer' id='tok-70-365'>uppercase</span><span class='token pointer' id='tok-70-366'>to</span><span class='token pointer' id='tok-70-367'>lowercase</span><span class='token pointer' id='tok-70-368'>and</span><span class='token pointer' id='tok-70-369'>vice</span><span class='token pointer' id='tok-70-370'>versa.</span><span class='token pointer' id='tok-70-371'>This</span><span class='token pointer' id='tok-70-372'>is</span><span class='token pointer' id='tok-70-373'>shown</span><span class='token pointer' id='tok-70-374'>below.</span></p><p id=p391><span class='token pointer' id='tok-70-375'>After</span><span class='token pointer' id='tok-70-376'>making</span><span class='token pointer' id='tok-70-377'>the</span><span class='token pointer' id='tok-70-378'>above</span><span class='token pointer' id='tok-70-379'>shown</span><span class='token pointer' id='tok-70-380'>modifications</span><span class='token pointer' id='tok-70-381'>to</span><span class='token pointer' id='tok-70-382'>the</span><span class='token pointer' id='tok-70-383'>binary,</span><span class='token pointer' id='tok-70-384'>I</span><span class='token pointer' id='tok-70-385'>have</span><span class='token pointer' id='tok-70-386' style='color:red'>scanned</span><span class='token pointer' id='tok-70-387'>through</span><span class='token pointer' id='tok-70-388'>virustotal.com</span><span class='token pointer' id='tok-70-389'>once</span><span class='token pointer' id='tok-70-390'>again</span><span class='token pointer' id='tok-70-391'>and</span><span class='token pointer' id='tok-70-392'>noticed</span><span class='token pointer' id='tok-70-393'>that</span><span class='token pointer' id='tok-70-394'>42</span><span class='token pointer' id='tok-70-395'>antivirus</span><span class='token pointer' id='tok-70-396' style='color:red'>engines</span><span class='token pointer' id='tok-70-397'>out</span><span class='token pointer' id='tok-70-398'>of</span><span class='token pointer' id='tok-70-399'>56</span><span class='token pointer' id='tok-70-400'>have</span><span class='token pointer' id='tok-70-401'>flagged</span><span class='token pointer' id='tok-70-402'>it</span><span class='token pointer' id='tok-70-403'>as</span><span class='token pointer' id='tok-70-404'>malicious</span><span class='token pointer' id='tok-70-405'>this</span><span class='token pointer' id='tok-70-406'>time.</span></p><p id=p423><span class='token pointer' id='tok-70-407'>However,</span><span class='token pointer' id='tok-70-408'>this</span><span class='token pointer' id='tok-70-409'>didn't</span><span class='token pointer' id='tok-70-410'>bypass</span><span class='token pointer' id='tok-70-411'>most</span><span class='token pointer' id='tok-70-412'>of</span><span class='token pointer' id='tok-70-413'>the</span><span class='token pointer' id='tok-70-414'>antivirus</span><span class='token pointer' id='tok-70-415'>applications;</span><span class='token pointer' id='tok-70-416'>it</span><span class='token pointer' id='tok-70-417'>is</span><span class='token pointer' id='tok-70-418'>possible</span><span class='token pointer' id='tok-70-419'>to</span><span class='token pointer' id='tok-70-420'>do</span><span class='token pointer' id='tok-70-421'>that</span><span class='token pointer' id='tok-70-422'>if</span><span class='token pointer' id='tok-70-423'>we</span><span class='token pointer' id='tok-70-424'>can</span><span class='token pointer' id='tok-70-425'>locate</span><span class='token pointer' id='tok-70-426'>the</span><span class='token pointer' id='tok-70-427'>exact</span><span class='token pointer' id='tok-70-428'>signature</span><span class='token pointer' id='tok-70-429'>that</span><span class='token pointer' id='tok-70-430'>is</span><span class='token pointer' id='tok-70-431'>being</span><span class='token pointer' id='tok-70-432'>detected</span><span class='token pointer' id='tok-70-433'>by</span><span class='token pointer' id='tok-70-434'>those</span><span class='token pointer' id='tok-70-435'>AVs.</span></p><p id=p452><span class='token pointer' id='tok-70-436'>When</span><span class='token pointer' id='tok-70-437'>we</span><span class='token pointer' id='tok-70-438'>use</span><span class='token pointer' id='tok-70-439'>the</span><span class='token pointer' id='tok-70-440'>above-mentioned</span><span class='token pointer' id='tok-70-441'>technique,</span><span class='token pointer' id='tok-70-442'>we</span><span class='token pointer' id='tok-70-443'>should</span><span class='token pointer' id='tok-70-444'>not</span><span class='token pointer' id='tok-70-445'>forget</span><span class='token pointer' id='tok-70-446'>about</span><span class='token pointer' id='tok-70-447'>the</span><span class='token pointer' id='tok-70-448'>functionality</span><span class='token pointer' id='tok-70-449'>of</span><span class='token pointer' id='tok-70-450'>the</span><span class='token pointer' id='tok-70-451'>binary</span><span class='token pointer' id='tok-70-452'>while</span><span class='token pointer' id='tok-70-453'>making</span><span class='token pointer' id='tok-70-454'>changes.</span></p><p id=p471><span class='token pointer' id='tok-70-455'>As</span><span class='token pointer' id='tok-70-456'>an</span><span class='token pointer' id='tok-70-457'>example,</span><span class='token pointer' id='tok-70-458'>here</span><span class='token pointer' id='tok-70-459'>is</span><span class='token pointer' id='tok-70-460'>the</span><span class='token pointer' id='tok-70-461' style='color:red'>output</span><span class='token pointer' id='tok-70-462'>of</span><span class='token pointer' id='tok-70-463'>original</span><span class='token pointer' id='tok-70-464'>wce.exe</span><span class='token pointer' id='tok-70-465'>dumping</span><span class='token pointer' id='tok-70-466'>the</span><span class='token pointer' id='tok-70-467' style='color:red'>password</span><span class='token pointer' id='tok-70-468'>from</span><span class='token pointer' id='tok-70-469' style='color:red'>memory.</span></p><p id=p486><span class='token pointer' id='tok-70-470'>The</span><span class='token pointer' id='tok-70-471'>functionality</span><span class='token pointer' id='tok-70-472'>remained</span><span class='token pointer' id='tok-70-473'>the</span><span class='token pointer' id='tok-70-474'>same</span><span class='token pointer' id='tok-70-475'>even</span><span class='token pointer' id='tok-70-476'>after</span><span class='token pointer' id='tok-70-477'>making</span><span class='token pointer' id='tok-70-478'>changes</span><span class='token pointer' id='tok-70-479'>to</span><span class='token pointer' id='tok-70-480'>the</span><span class='token pointer' id='tok-70-481'>binary.</span><span class='token pointer' id='tok-70-482'>It</span><span class='token pointer' id='tok-70-483'>is</span><span class='token pointer' id='tok-70-484'>still</span><span class='token pointer' id='tok-70-485'>able</span><span class='token pointer' id='tok-70-486'>to</span><span class='token pointer' id='tok-70-487'>get</span><span class='token pointer' id='tok-70-488'>the</span><span class='token pointer' id='tok-70-489'>password</span><span class='token pointer' id='tok-70-490'>from</span><span class='token pointer' id='tok-70-491'>the</span><span class='token pointer' id='tok-70-492'>memory</span><span class='token pointer' id='tok-70-493'>as</span><span class='token pointer' id='tok-70-494'>shown</span><span class='token pointer' id='tok-70-495'>below.</span></p><p id=p512><span class='token pointer' id='tok-70-496' style='color:red'>HyperionEncrypting</span><span class='token pointer' id='tok-70-497'>the</span><span class='token pointer' id='tok-70-498'>binary</span><span class='token pointer' id='tok-70-499'>is</span><span class='token pointer' id='tok-70-500'>one</span><span class='token pointer' id='tok-70-501'>of</span><span class='token pointer' id='tok-70-502'>the</span><span class='token pointer' id='tok-70-503'>common</span><span class='token pointer' id='tok-70-504'>ways</span><span class='token pointer' id='tok-70-505' style='color:red'>to bypass</span><span class='token pointer' id='tok-70-506' style='color:red'>detection.</span><span class='token pointer' id='tok-70-507'>The</span><span class='token pointer' id='tok-70-508'>logic</span><span class='token pointer' id='tok-70-509'>behind</span><span class='token pointer' id='tok-70-510'>using</span><span class='token pointer' id='tok-70-511' style='color:red'>encrypters</span><span class='token pointer' id='tok-70-512'>is</span><span class='token pointer' id='tok-70-513'>to</span><span class='token pointer' id='tok-70-514' style='color:red'>obfuscate</span><span class='token pointer' id='tok-70-515'>the</span><span class='token pointer' id='tok-70-516'>binary</span><span class='token pointer' id='tok-70-517'>from</span><span class='token pointer' id='tok-70-518'>antivirus</span><span class='token pointer' id='tok-70-519'>tools</span><span class='token pointer' id='tok-70-520'>by</span><span class='token pointer' id='tok-70-521'>encrypting</span><span class='token pointer' id='tok-70-522'>it.</span><span class='token pointer' id='tok-70-523'>This</span><span class='token pointer' id='tok-70-524'>will</span><span class='token pointer' id='tok-70-525'>be</span><span class='token pointer' id='tok-70-526'>decrypted</span><span class='token pointer' id='tok-70-527'>back</span><span class='token pointer' id='tok-70-528'>when</span><span class='token pointer' id='tok-70-529'>the</span><span class='token pointer' id='tok-70-530'>binary</span><span class='token pointer' id='tok-70-531'>is</span><span class='token pointer' id='tok-70-532'>run.</span><span class='token pointer' id='tok-70-533' style='color:red'>Kali Linux</span><span class='token pointer' id='tok-70-534'>got</span><span class='token pointer' id='tok-70-535'>an</span><span class='token pointer' id='tok-70-536' style='color:red'>encrypter</span><span class='token pointer' id='tok-70-537' style='color:red'>open source</span><span class='token pointer' id='tok-70-538' style='color:red'>Hyperion</span><span class='token pointer' id='tok-70-539'>available</span><span class='token pointer' id='tok-70-540'>in</span><span class='token pointer' id='tok-70-541'>it.</span><span class='token pointer' id='tok-70-542'></span></p><p id=p565><span class='token pointer' id='tok-70-543'>I</span><span class='token pointer' id='tok-70-544'>am</span><span class='token pointer' id='tok-70-545'>using</span><span class='token pointer' id='tok-70-546'>the</span><span class='token pointer' id='tok-70-547'>one</span><span class='token pointer' id='tok-70-548'>I</span><span class='token pointer' id='tok-70-549'>have</span><span class='token pointer' id='tok-70-550'>downloaded</span><span class='token pointer' id='tok-70-551'>from</span><span class='token pointer' id='tok-70-552'>the</span><span class='token pointer' id='tok-70-553'>above</span><span class='token pointer' id='tok-70-554'>link.</span><span class='token pointer' id='tok-70-555'>Let</span><span class='token pointer' id='tok-70-556'>us</span><span class='token pointer' id='tok-70-557'>see</span><span class='token pointer' id='tok-70-558'>how</span><span class='token pointer' id='tok-70-559'>we</span><span class='token pointer' id='tok-70-560'>can</span><span class='token pointer' id='tok-70-561'>use</span><span class='token pointer' id='tok-70-562'>this</span><span class='token pointer' id='tok-70-563'>tool.</span></p><p id=p586><span class='token pointer' id='tok-70-564'>Before</span><span class='token pointer' id='tok-70-565'>we</span><span class='token pointer' id='tok-70-566'>use</span><span class='token pointer' id='tok-70-567'>Hyperion,</span><span class='token pointer' id='tok-70-568'>let's</span><span class='token pointer' id='tok-70-569'>scan</span><span class='token pointer' id='tok-70-570'>the</span><span class='token pointer' id='tok-70-571' style='color:red'>version</span><span class='token pointer' id='tok-70-572' style='color:red'>32 bit</span><span class='token pointer' id='tok-70-573'>wce.exe</span><span class='token pointer' id='tok-70-574' style='color:red'>file</span><span class='token pointer' id='tok-70-575'>through</span><span class='token pointer' id='tok-70-576'>virustotal.com</span><span class='token pointer' id='tok-70-577'>first.</span></p><p id=p602><span class='token pointer' id='tok-70-578'>As</span><span class='token pointer' id='tok-70-579'>we</span><span class='token pointer' id='tok-70-580'>can</span><span class='token pointer' id='tok-70-581'>notice,</span><span class='token pointer' id='tok-70-582'>44</span><span class='token pointer' id='tok-70-583'>antivirus</span><span class='token pointer' id='tok-70-584'>applications</span><span class='token pointer' id='tok-70-585'>have</span><span class='token pointer' id='tok-70-586'>flagged</span><span class='token pointer' id='tok-70-587'>this</span><span class='token pointer' id='tok-70-588'>as</span><span class='token pointer' id='tok-70-589'>malicious.</span></p><p id=p614><span class='token pointer' id='tok-70-590'>Let's</span><span class='token pointer' id='tok-70-591' style='color:red'>encrypt</span><span class='token pointer' id='tok-70-592'>this</span><span class='token pointer' id='tok-70-593'>file</span><span class='token pointer' id='tok-70-594'>with</span><span class='token pointer' id='tok-70-595'>Hyperion</span><span class='token pointer' id='tok-70-596'>as</span><span class='token pointer' id='tok-70-597'>shown</span><span class='token pointer' id='tok-70-598'>below.</span></p><p id=p623><span class='token pointer' id='tok-70-599'>Let's</span><span class='token pointer' id='tok-70-600'>scan</span><span class='token pointer' id='tok-70-601'>this</span><span class='token pointer' id='tok-70-602'>newly</span><span class='token pointer' id='tok-70-603'>generated</span><span class='token pointer' id='tok-70-604'>file</span><span class='token pointer' id='tok-70-605'>once</span><span class='token pointer' id='tok-70-606'>again</span><span class='token pointer' id='tok-70-607'>and</span><span class='token pointer' id='tok-70-608'>see</span><span class='token pointer' id='tok-70-609'>the</span><span class='token pointer' id='tok-70-610'>detection</span><span class='token pointer' id='tok-70-611'>ratio.</span></p><p id=p636><span class='token pointer' id='tok-70-612'>As</span><span class='token pointer' id='tok-70-613'>we</span><span class='token pointer' id='tok-70-614'>can</span><span class='token pointer' id='tok-70-615'>see</span><span class='token pointer' id='tok-70-616'>in</span><span class='token pointer' id='tok-70-617'>the</span><span class='token pointer' id='tok-70-618'>figure</span><span class='token pointer' id='tok-70-619'>above,</span><span class='token pointer' id='tok-70-620'>this</span><span class='token pointer' id='tok-70-621'>has</span><span class='token pointer' id='tok-70-622'>got</span><span class='token pointer' id='tok-70-623'>lesser</span><span class='token pointer' id='tok-70-624'>detection</span><span class='token pointer' id='tok-70-625'>compared</span><span class='token pointer' id='tok-70-626'>to</span><span class='token pointer' id='tok-70-627'>the</span><span class='token pointer' id='tok-70-628'>unencrypted</span><span class='token pointer' id='tok-70-629'>binary.</span></p><p id=p654><span class='token pointer' id='tok-70-630' style='color:red'>Veil-EvasionVeil-Evasion</span><span class='token pointer' id='tok-70-631'>is</span><span class='token pointer' id='tok-70-632'>another</span><span class='token pointer' id='tok-70-633'>popular</span><span class='token pointer' id='tok-70-634' style='color:red'>framework</span><span class='token pointer' id='tok-70-635'>written</span><span class='token pointer' id='tok-70-636'>in</span><span class='token pointer' id='tok-70-637' style='color:red'>python.</span><span class='token pointer' id='tok-70-638'>We</span><span class='token pointer' id='tok-70-639'>can</span><span class='token pointer' id='tok-70-640'>use</span><span class='token pointer' id='tok-70-641'>this</span><span class='token pointer' id='tok-70-642'>framework</span><span class='token pointer' id='tok-70-643'>to</span><span class='token pointer' id='tok-70-644'>generate</span><span class='token pointer' id='tok-70-645' style='color:red'>payloads</span><span class='token pointer' id='tok-70-646'>that</span><span class='token pointer' id='tok-70-647'>can</span><span class='token pointer' id='tok-70-648' style='color:red'>evade</span><span class='token pointer' id='tok-70-649'>majority</span><span class='token pointer' id='tok-70-650'>of</span><span class='token pointer' id='tok-70-651'>AVs.</span></p><p id=p676><span class='token pointer' id='tok-70-652'>First</span><span class='token pointer' id='tok-70-653' style='color:red'>download</span><span class='token pointer' id='tok-70-654'>and</span><span class='token pointer' id='tok-70-655' style='color:red'>install</span><span class='token pointer' id='tok-70-656' style='color:red'>Veil-Evasion</span><span class='token pointer' id='tok-70-657'>and</span><span class='token pointer' id='tok-70-658'>run</span><span class='token pointer' id='tok-70-659'>it</span><span class='token pointer' id='tok-70-660'>using</span><span class='token pointer' id='tok-70-661'>the</span><span class='token pointer' id='tok-70-662'>following</span><span class='token pointer' id='tok-70-663' style='color:red'>command</span></p><p id=p688><span class='token pointer' id='tok-70-664' style='color:red'>"veil-evasion"</span></p><p id=p689><span class='token pointer' id='tok-70-665'>As</span><span class='token pointer' id='tok-70-666'>we</span><span class='token pointer' id='tok-70-667'>can</span><span class='token pointer' id='tok-70-668'>see,</span><span class='token pointer' id='tok-70-669'>46</span><span class='token pointer' id='tok-70-670'>payloads</span><span class='token pointer' id='tok-70-671'>have</span><span class='token pointer' id='tok-70-672'>been</span><span class='token pointer' id='tok-70-673'>loaded.</span><span class='token pointer' id='tok-70-674'>To</span><span class='token pointer' id='tok-70-675'>use</span><span class='token pointer' id='tok-70-676'>a</span><span class='token pointer' id='tok-70-677'>specific</span><span class='token pointer' id='tok-70-678'>payload,</span><span class='token pointer' id='tok-70-679'>we</span><span class='token pointer' id='tok-70-680'>can</span><span class='token pointer' id='tok-70-681'>type</span><span class='token pointer' id='tok-70-682'>"use"</span><span class='token pointer' id='tok-70-683'>command.</span></p><p id=p708><span class='token pointer' id='tok-70-684'>I</span><span class='token pointer' id='tok-70-685'>am</span><span class='token pointer' id='tok-70-686'>going</span><span class='token pointer' id='tok-70-687'>to</span><span class='token pointer' id='tok-70-688'>choose</span><span class='token pointer' id='tok-70-689'>option</span><span class='token pointer' id='tok-70-690'>31</span><span class='token pointer' id='tok-70-691'>to</span><span class='token pointer' id='tok-70-692'>create</span><span class='token pointer' id='tok-70-693'>the</span><span class='token pointer' id='tok-70-694' style='color:red'>executable</span><span class='token pointer' id='tok-70-695'>payload</span><span class='token pointer' id='tok-70-696' style='color:red'>python/meterpreter/rev_tcp.</span><span class='token pointer' id='tok-70-697'>Infact,</span><span class='token pointer' id='tok-70-698'>it</span><span class='token pointer' id='tok-70-699'>creates</span><span class='token pointer' id='tok-70-700'>a</span><span class='token pointer' id='tok-70-701'>python</span><span class='token pointer' id='tok-70-702' style='color:red'>script,</span><span class='token pointer' id='tok-70-703'>which</span><span class='token pointer' id='tok-70-704'>in</span><span class='token pointer' id='tok-70-705'>turn</span><span class='token pointer' id='tok-70-706'>will</span><span class='token pointer' id='tok-70-707'>be</span><span class='token pointer' id='tok-70-708'>converted</span><span class='token pointer' id='tok-70-709'>into</span><span class='token pointer' id='tok-70-710'>an</span><span class='token pointer' id='tok-70-711'>executable</span><span class='token pointer' id='tok-70-712'>using</span><span class='token pointer' id='tok-70-713'>tools</span><span class='token pointer' id='tok-70-714'>like</span><span class='token pointer' id='tok-70-715' style='color:red'>pyinstaller.</span></p><p id=p740><span class='token pointer' id='tok-70-716'>In</span><span class='token pointer' id='tok-70-717'>the</span><span class='token pointer' id='tok-70-718'>above</span><span class='token pointer' id='tok-70-719'>figure,</span><span class='token pointer' id='tok-70-720'>we</span><span class='token pointer' id='tok-70-721'>have</span><span class='token pointer' id='tok-70-722'>set</span><span class='token pointer' id='tok-70-723'>the</span><span class='token pointer' id='tok-70-724' style='color:red'>LHOST</span><span class='token pointer' id='tok-70-725'>to</span><span class='token pointer' id='tok-70-726'>192.168.56.101</span><span class='token pointer' id='tok-70-727'>and</span><span class='token pointer' id='tok-70-728'>typed</span><span class='token pointer' id='tok-70-729'>"generate"</span><span class='token pointer' id='tok-70-730'>command</span><span class='token pointer' id='tok-70-731'>to</span><span class='token pointer' id='tok-70-732'>generate</span><span class='token pointer' id='tok-70-733'>the</span><span class='token pointer' id='tok-70-734'>payload.</span></p><p id=p759><span class='token pointer' id='tok-70-735'>Next,</span><span class='token pointer' id='tok-70-736'>it</span><span class='token pointer' id='tok-70-737'>will</span><span class='token pointer' id='tok-70-738'>ask</span><span class='token pointer' id='tok-70-739'>us</span><span class='token pointer' id='tok-70-740'>to</span><span class='token pointer' id='tok-70-741'>enter</span><span class='token pointer' id='tok-70-742'>a</span><span class='token pointer' id='tok-70-743'>name</span><span class='token pointer' id='tok-70-744'>for</span><span class='token pointer' id='tok-70-745'>the</span><span class='token pointer' id='tok-70-746'>payload.</span><span class='token pointer' id='tok-70-747'>I</span><span class='token pointer' id='tok-70-748'>named</span><span class='token pointer' id='tok-70-749'>it</span><span class='token pointer' id='tok-70-750'>"backdoor".</span><span class='token pointer' id='tok-70-751'>As</span><span class='token pointer' id='tok-70-752'>mentioned</span><span class='token pointer' id='tok-70-753'>earlier,</span><span class='token pointer' id='tok-70-754' style='color:red'>Veil</span><span class='token pointer' id='tok-70-755' style='color:red'>converts</span><span class='token pointer' id='tok-70-756'>python</span><span class='token pointer' id='tok-70-757'>files</span><span class='token pointer' id='tok-70-758'>to</span><span class='token pointer' id='tok-70-759'>exe.</span><span class='token pointer' id='tok-70-760'>It</span><span class='token pointer' id='tok-70-761'>asks</span><span class='token pointer' id='tok-70-762'>us</span><span class='token pointer' id='tok-70-763'>to</span><span class='token pointer' id='tok-70-764'>choose</span><span class='token pointer' id='tok-70-765'>which</span><span class='token pointer' id='tok-70-766'>tool</span><span class='token pointer' id='tok-70-767'>we</span><span class='token pointer' id='tok-70-768'>want</span><span class='token pointer' id='tok-70-769'>to</span><span class='token pointer' id='tok-70-770'>use</span><span class='token pointer' id='tok-70-771'>for</span><span class='token pointer' id='tok-70-772'>this</span><span class='token pointer' id='tok-70-773'>process.</span><span class='token pointer' id='tok-70-774'>Personally,</span><span class='token pointer' id='tok-70-775'>I</span><span class='token pointer' id='tok-70-776'>like</span><span class='token pointer' id='tok-70-777' style='color:red'>Pyinstaller</span><span class='token pointer' id='tok-70-778'>and</span><span class='token pointer' id='tok-70-779'>I</span><span class='token pointer' id='tok-70-780'>am</span><span class='token pointer' id='tok-70-781'>going</span><span class='token pointer' id='tok-70-782'>for</span><span class='token pointer' id='tok-70-783'>it</span><span class='token pointer' id='tok-70-784'>with</span><span class='token pointer' id='tok-70-785'>option</span><span class='token pointer' id='tok-70-786'>1.</span><span class='token pointer' id='tok-70-787'>These</span><span class='token pointer' id='tok-70-788'>two</span><span class='token pointer' id='tok-70-789'>steps</span><span class='token pointer' id='tok-70-790'>are</span><span class='token pointer' id='tok-70-791'>shown</span><span class='token pointer' id='tok-70-792'>below.</span></p><p id=p817><span class='token pointer' id='tok-70-793'>Once</span><span class='token pointer' id='tok-70-794'>done,</span><span class='token pointer' id='tok-70-795'>it</span><span class='token pointer' id='tok-70-796'>will</span><span class='token pointer' id='tok-70-797'>create</span><span class='token pointer' id='tok-70-798'>our</span><span class='token pointer' id='tok-70-799'>final</span><span class='token pointer' id='tok-70-800'>payload</span><span class='token pointer' id='tok-70-801'>and</span><span class='token pointer' id='tok-70-802'>gives</span><span class='token pointer' id='tok-70-803'>us</span><span class='token pointer' id='tok-70-804'>the</span><span class='token pointer' id='tok-70-805'>location</span><span class='token pointer' id='tok-70-806'>of</span><span class='token pointer' id='tok-70-807'>it</span><span class='token pointer' id='tok-70-808'>as</span><span class='token pointer' id='tok-70-809'>shown</span><span class='token pointer' id='tok-70-810'>below.</span></p><p id=p835><span class='token pointer' id='tok-70-811'>As</span><span class='token pointer' id='tok-70-812'>we</span><span class='token pointer' id='tok-70-813'>can</span><span class='token pointer' id='tok-70-814'>see</span><span class='token pointer' id='tok-70-815'>in</span><span class='token pointer' id='tok-70-816'>the</span><span class='token pointer' id='tok-70-817'>figure</span><span class='token pointer' id='tok-70-818'>above,</span><span class='token pointer' id='tok-70-819'>the</span><span class='token pointer' id='tok-70-820'>authors</span><span class='token pointer' id='tok-70-821'>of</span><span class='token pointer' id='tok-70-822'>this</span><span class='token pointer' id='tok-70-823'>framework</span><span class='token pointer' id='tok-70-824'>are</span><span class='token pointer' id='tok-70-825'>suggesting</span><span class='token pointer' id='tok-70-826'>not</span><span class='token pointer' id='tok-70-827'>to</span><span class='token pointer' id='tok-70-828'>submit</span><span class='token pointer' id='tok-70-829'>these</span><span class='token pointer' id='tok-70-830'>samples</span><span class='token pointer' id='tok-70-831' style='color:red'>online.</span><span class='token pointer' id='tok-70-832'>Therefore,</span><span class='token pointer' id='tok-70-833'>I</span><span class='token pointer' id='tok-70-834'>have</span><span class='token pointer' id='tok-70-835'>checked</span><span class='token pointer' id='tok-70-836'>this</span><span class='token pointer' id='tok-70-837'>payload</span><span class='token pointer' id='tok-70-838'>in</span><span class='token pointer' id='tok-70-839' style='color:red'>sandboxed</span><span class='token pointer' id='tok-70-840'>environment</span><span class='token pointer' id='tok-70-841'>with</span><span class='token pointer' id='tok-70-842' style='color:red'>Avast Antivirus</span><span class='token pointer' id='tok-70-843'>it</span><span class='token pointer' id='tok-70-844'>is</span><span class='token pointer' id='tok-70-845'>not</span><span class='token pointer' id='tok-70-846'>detected.</span></p><p id=p873><span class='token pointer' id='tok-70-847' style='color:red'>Ethical Hacking Training</span><span class='token pointer' id='tok-70-848'>Resources</span><span class='token pointer' id='tok-70-849' style='color:red'>(InfoSec)</span></p><p id=p879><span class='token pointer' id='tok-70-850'>These</span><span class='token pointer' id='tok-70-851'>payloads</span><span class='token pointer' id='tok-70-852'>also</span><span class='token pointer' id='tok-70-853'>work</span><span class='token pointer' id='tok-70-854'>fine</span><span class='token pointer' id='tok-70-855'>when</span><span class='token pointer' id='tok-70-856'>they</span><span class='token pointer' id='tok-70-857'>are</span><span class='token pointer' id='tok-70-858'>executed</span><span class='token pointer' id='tok-70-859'>on</span><span class='token pointer' id='tok-70-860'>Victim's</span><span class='token pointer' id='tok-70-861'>machines.</span></p><p id=p891><span class='token pointer' id='tok-70-862'>Following</span><span class='token pointer' id='tok-70-863'>figure</span><span class='token pointer' id='tok-70-864'>shows</span><span class='token pointer' id='tok-70-865'>a</span><span class='token pointer' id='tok-70-866'>meterpreter</span><span class='token pointer' id='tok-70-867'>shell</span><span class='token pointer' id='tok-70-868'>obtained</span><span class='token pointer' id='tok-70-869'>using</span><span class='token pointer' id='tok-70-870'>the</span><span class='token pointer' id='tok-70-871'>payload</span><span class='token pointer' id='tok-70-872'>created</span><span class='token pointer' id='tok-70-873'>above.</span></p><p id=p903><span class='token pointer' id='tok-70-874'>Try</span><span class='token pointer' id='tok-70-875'>with</span><span class='token pointer' id='tok-70-876'>other</span><span class='token pointer' id='tok-70-877'>payloads</span><span class='token pointer' id='tok-70-878'>that</span><span class='token pointer' id='tok-70-879'>use</span><span class='token pointer' id='tok-70-880' style='color:red'>encryption</span><span class='token pointer' id='tok-70-881'>to</span><span class='token pointer' id='tok-70-882'>get</span><span class='token pointer' id='tok-70-883'>better</span><span class='token pointer' id='tok-70-884'>output.</span></p><p id=p914><span class='token pointer' id='tok-70-885'>This</span><span class='token pointer' id='tok-70-886'>script</span><span class='token pointer' id='tok-70-887' style='color:red'>automates</span><span class='token pointer' id='tok-70-888'>multiple</span><span class='token pointer' id='tok-70-889'>tricks</span><span class='token pointer' id='tok-70-890'>to</span><span class='token pointer' id='tok-70-891'>evade</span><span class='token pointer' id='tok-70-892'>AVs.</span><span class='token pointer' id='tok-70-893'>The</span><span class='token pointer' id='tok-70-894'>author</span><span class='token pointer' id='tok-70-895'>has</span><span class='token pointer' id='tok-70-896'>written</span><span class='token pointer' id='tok-70-897'>this</span><span class='token pointer' id='tok-70-898'>for</span><span class='token pointer' id='tok-70-899'>his</span><span class='token pointer' id='tok-70-900'>own</span><span class='token pointer' id='tok-70-901'>purposes</span><span class='token pointer' id='tok-70-902'>and</span><span class='token pointer' id='tok-70-903'>he</span><span class='token pointer' id='tok-70-904'>released</span><span class='token pointer' id='tok-70-905'>it</span><span class='token pointer' id='tok-70-906'>publicly</span><span class='token pointer' id='tok-70-907'>as</span><span class='token pointer' id='tok-70-908'>a</span><span class='token pointer' id='tok-70-909' style='color:red'>beta</span><span class='token pointer' id='tok-70-910'>version.</span><span class='token pointer' id='tok-70-911'>This</span><span class='token pointer' id='tok-70-912'>script</span><span class='token pointer' id='tok-70-913'>gives</span><span class='token pointer' id='tok-70-914'>us</span><span class='token pointer' id='tok-70-915'>an</span><span class='token pointer' id='tok-70-916'>idea</span><span class='token pointer' id='tok-70-917'>of</span><span class='token pointer' id='tok-70-918'>how</span><span class='token pointer' id='tok-70-919'>we</span><span class='token pointer' id='tok-70-920'>can</span><span class='token pointer' id='tok-70-921'>write</span><span class='token pointer' id='tok-70-922'>our</span><span class='token pointer' id='tok-70-923'>own</span><span class='token pointer' id='tok-70-924' style='color:red'>scripts</span><span class='token pointer' id='tok-70-925'>to</span><span class='token pointer' id='tok-70-926'>evade</span><span class='token pointer' id='tok-70-927' style='color:red'>Antiviruses.</span></p><p id=p957><span class='token pointer' id='tok-70-928'>Let's</span><span class='token pointer' id='tok-70-929'>see</span><span class='token pointer' id='tok-70-930'>this</span><span class='token pointer' id='tok-70-931'>in</span><span class='token pointer' id='tok-70-932'>action.</span></p><p id=p962><span class='token pointer' id='tok-70-933'>I</span><span class='token pointer' id='tok-70-934'>am</span><span class='token pointer' id='tok-70-935'>going</span><span class='token pointer' id='tok-70-936'>to</span><span class='token pointer' id='tok-70-937'>create</span><span class='token pointer' id='tok-70-938'>a</span><span class='token pointer' id='tok-70-939'>meterpreter</span><span class='token pointer' id='tok-70-940'>payload</span><span class='token pointer' id='tok-70-941'>using</span><span class='token pointer' id='tok-70-942'>msfvenom</span><span class='token pointer' id='tok-70-943'>for</span><span class='token pointer' id='tok-70-944'>this</span><span class='token pointer' id='tok-70-945'>purpose.</span><span class='token pointer' id='tok-70-946'>This</span><span class='token pointer' id='tok-70-947'>is</span><span class='token pointer' id='tok-70-948'>shown</span><span class='token pointer' id='tok-70-949'>below.</span></p><p id=p979><span class='token pointer' id='tok-70-950'>Let</span><span class='token pointer' id='tok-70-951'>us</span><span class='token pointer' id='tok-70-952'>scan</span><span class='token pointer' id='tok-70-953'>the</span><span class='token pointer' id='tok-70-954'>payload</span><span class='token pointer' id='tok-70-955'>"test.exe"</span><span class='token pointer' id='tok-70-956'>through</span><span class='token pointer' id='tok-70-957'>virustotal.com</span><span class='token pointer' id='tok-70-958'>as</span><span class='token pointer' id='tok-70-959'>shown</span><span class='token pointer' id='tok-70-960'>below.</span></p><p id=p990><span class='token pointer' id='tok-70-961'>36</span><span class='token pointer' id='tok-70-962'>out</span><span class='token pointer' id='tok-70-963'>of</span><span class='token pointer' id='tok-70-964'>56</span><span class='token pointer' id='tok-70-965'>antivirus</span><span class='token pointer' id='tok-70-966'>engines</span><span class='token pointer' id='tok-70-967'>have</span><span class='token pointer' id='tok-70-968'>flagged</span><span class='token pointer' id='tok-70-969'>this</span><span class='token pointer' id='tok-70-970'>as</span><span class='token pointer' id='tok-70-971'>malicious.</span></p><p id=p1001><span class='token pointer' id='tok-70-972'>Now,</span><span class='token pointer' id='tok-70-973'>lets</span><span class='token pointer' id='tok-70-974'>run</span><span class='token pointer' id='tok-70-975'>this</span><span class='token pointer' id='tok-70-976'>using</span><span class='token pointer' id='tok-70-977'>peCloak.py</span><span class='token pointer' id='tok-70-978'>script.</span></p><p id=p1008><span class='token pointer' id='tok-70-979'>I</span><span class='token pointer' id='tok-70-980'>am</span><span class='token pointer' id='tok-70-981'>using</span><span class='token pointer' id='tok-70-982'>the</span><span class='token pointer' id='tok-70-983'>script</span><span class='token pointer' id='tok-70-984'>with</span><span class='token pointer' id='tok-70-985'>the</span><span class='token pointer' id='tok-70-986' style='color:red'>default</span><span class='token pointer' id='tok-70-987'>options.</span></p><p id=p1017><span class='token pointer' id='tok-70-988'>It</span><span class='token pointer' id='tok-70-989'>creates</span><span class='token pointer' id='tok-70-990'>a</span><span class='token pointer' id='tok-70-991'>file</span><span class='token pointer' id='tok-70-992'>called</span><span class='token pointer' id='tok-70-993'>"cloaked.exe".</span></p><p id=p1023><span class='token pointer' id='tok-70-994'>Let's</span><span class='token pointer' id='tok-70-995'>scan</span><span class='token pointer' id='tok-70-996'>this</span><span class='token pointer' id='tok-70-997'>new</span><span class='token pointer' id='tok-70-998'>payload</span><span class='token pointer' id='tok-70-999'>and</span><span class='token pointer' id='tok-70-1000'>see</span><span class='token pointer' id='tok-70-1001'>how</span><span class='token pointer' id='tok-70-1002'>many</span><span class='token pointer' id='tok-70-1003'>antivirus</span><span class='token pointer' id='tok-70-1004'>engines</span><span class='token pointer' id='tok-70-1005' style='color:red'>detect</span><span class='token pointer' id='tok-70-1006'>is</span><span class='token pointer' id='tok-70-1007'>as</span><span class='token pointer' id='tok-70-1008'>malicious.</span></p><p id=p1038><span class='token pointer' id='tok-70-1009'>Only</span><span class='token pointer' id='tok-70-1010'>26</span><span class='token pointer' id='tok-70-1011'>out</span><span class='token pointer' id='tok-70-1012'>of</span><span class='token pointer' id='tok-70-1013'>56</span><span class='token pointer' id='tok-70-1014'>have</span><span class='token pointer' id='tok-70-1015'>flagged</span><span class='token pointer' id='tok-70-1016'>it</span><span class='token pointer' id='tok-70-1017'>as</span><span class='token pointer' id='tok-70-1018'>malicious.</span></p><p id=p1048><span class='token pointer' id='tok-70-1019'>Conclusion:</span><span class='token pointer' id='tok-70-1020'>Apart</span><span class='token pointer' id='tok-70-1021'>from</span><span class='token pointer' id='tok-70-1022'>the</span><span class='token pointer' id='tok-70-1023'>tools</span><span class='token pointer' id='tok-70-1024'>mentioned</span><span class='token pointer' id='tok-70-1025'>in</span><span class='token pointer' id='tok-70-1026'>this</span><span class='token pointer' id='tok-70-1027'>article,</span><span class='token pointer' id='tok-70-1028'>there</span><span class='token pointer' id='tok-70-1029'>are</span><span class='token pointer' id='tok-70-1030'>a</span><span class='token pointer' id='tok-70-1031'>couple</span><span class='token pointer' id='tok-70-1032'>of</span><span class='token pointer' id='tok-70-1033'>other</span><span class='token pointer' id='tok-70-1034'>tools</span><span class='token pointer' id='tok-70-1035'>out</span><span class='token pointer' id='tok-70-1036'>there</span><span class='token pointer' id='tok-70-1037'>such</span><span class='token pointer' id='tok-70-1038'>as</span><span class='token pointer' id='tok-70-1039'>Metasploit's</span><span class='token pointer' id='tok-70-1040' style='color:red'>encoders.</span><span class='token pointer' id='tok-70-1041'>It</span><span class='token pointer' id='tok-70-1042'>is</span><span class='token pointer' id='tok-70-1043'>better</span><span class='token pointer' id='tok-70-1044'>to</span><span class='token pointer' id='tok-70-1045'>write</span><span class='token pointer' id='tok-70-1046'>custom</span><span class='token pointer' id='tok-70-1047'>payloads</span><span class='token pointer' id='tok-70-1048'>and</span><span class='token pointer' id='tok-70-1049'>keep</span><span class='token pointer' id='tok-70-1050'>them</span><span class='token pointer' id='tok-70-1051'>simple</span><span class='token pointer' id='tok-70-1052'>to</span><span class='token pointer' id='tok-70-1053'>be</span><span class='token pointer' id='tok-70-1054'>away</span><span class='token pointer' id='tok-70-1055'>from</span><span class='token pointer' id='tok-70-1056'>Antivirus</span><span class='token pointer' id='tok-70-1057'>detection</span><span class='token pointer' id='tok-70-1058'>rather</span><span class='token pointer' id='tok-70-1059'>than</span><span class='token pointer' id='tok-70-1060'>creating</span><span class='token pointer' id='tok-70-1061'>payloads</span><span class='token pointer' id='tok-70-1062'>using</span><span class='token pointer' id='tok-70-1063'>popular</span><span class='token pointer' id='tok-70-1064' style='color:red'>frameworks.</span><span class='token pointer' id='tok-70-1065'>A</span><span class='token pointer' id='tok-70-1066'>side</span><span class='token pointer' id='tok-70-1067'>note:</span><span class='token pointer' id='tok-70-1068'>The</span><span class='token pointer' id='tok-70-1069'>results</span><span class='token pointer' id='tok-70-1070'>shown</span><span class='token pointer' id='tok-70-1071'>in</span><span class='token pointer' id='tok-70-1072'>this</span><span class='token pointer' id='tok-70-1073'>article</span><span class='token pointer' id='tok-70-1074'>may</span><span class='token pointer' id='tok-70-1075'>change</span><span class='token pointer' id='tok-70-1076'>when</span><span class='token pointer' id='tok-70-1077'>you</span><span class='token pointer' id='tok-70-1078'>read</span><span class='token pointer' id='tok-70-1079'>this</span><span class='token pointer' id='tok-70-1080'>article</span><span class='token pointer' id='tok-70-1081'>as</span><span class='token pointer' id='tok-70-1082'>Antivirus</span><span class='token pointer' id='tok-70-1083'></span><span class='token pointer' id='tok-70-1084'></span><span class='token pointer' id='tok-70-1085'></span><span class='token pointer' id='tok-70-1086'></span></p>