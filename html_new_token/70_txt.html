<p id=p0><span class='token pointer' id='tok-70-0'>Often</span><span class='token pointer' id='tok-70-1'>during</span><span class='token pointer' id='tok-70-2'>our</span><span class='token pointer' id='tok-70-3' style='color:red'>penetration</span><span class='token pointer' id='tok-70-4'>testing</span><span class='token pointer' id='tok-70-5'>engagements,</span><span class='token pointer' id='tok-70-6'>we</span><span class='token pointer' id='tok-70-7'>may</span><span class='token pointer' id='tok-70-8'>have</span><span class='token pointer' id='tok-70-9'>to</span><span class='token pointer' id='tok-70-12' style='color:red'>applications</span><span class='token pointer' id='tok-70-13' style='color:red'>antivirus</span><span class='token pointer' id='tok-70-14'>especially</span><span class='token pointer' id='tok-70-15'>during</span><span class='token pointer' id='tok-70-16'>the</span><span class='token pointer' id='tok-70-17'>post</span><span class='token pointer' id='tok-70-18' style='color:red'>exploitation</span><span class='token pointer' id='tok-70-19'>phase</span><span class='token pointer' id='tok-70-20'>to</span><span class='token pointer' id='tok-70-21'>execute</span><span class='token pointer' id='tok-70-22'>certain</span><span class='token pointer' id='tok-70-23' style='color:red'>files</span><span class='token pointer' id='tok-70-24'>on</span><span class='token pointer' id='tok-70-25'>the</span><span class='token pointer' id='tok-70-26'>target</span><span class='token pointer' id='tok-70-27' style='color:red'>machines.</span><span class='token pointer' id='tok-70-28'>Sometimes</span><span class='token pointer' id='tok-70-29' style='color:red'>it</span><span class='token pointer' id='tok-70-30'>is</span><span class='token pointer' id='tok-70-31'>challenging</span><span class='token pointer' id='tok-70-32'>to</span><span class='token pointer' id='tok-70-33' style='color:red'>bypass</span><span class='token pointer' id='tok-70-34'>certain</span><span class='token pointer' id='tok-70-35' style='color:red'>antivirus</span><span class='token pointer' id='tok-70-36'>applications,</span><span class='token pointer' id='tok-70-37'>as</span><span class='token pointer' id='tok-70-38'>there</span><span class='token pointer' id='tok-70-39'>is</span><span class='token pointer' id='tok-70-40'>no</span><span class='token pointer' id='tok-70-41'>standard</span><span class='token pointer' id='tok-70-42' style='color:red'>method/technique</span><span class='token pointer' id='tok-70-43'>available</span><span class='token pointer' id='tok-70-44'>to</span><span class='token pointer' id='tok-70-45'>bypass</span><span class='token pointer' id='tok-70-46'>all</span><span class='token pointer' id='tok-70-47'>the</span><span class='token pointer' id='tok-70-48'>antivirus</span><span class='token pointer' id='tok-70-49' style='color:red'>software.</span><span class='token pointer' id='tok-70-50'>Thus,</span><span class='token pointer' id='tok-70-51'>we</span><span class='token pointer' id='tok-70-52'>need</span><span class='token pointer' id='tok-70-53'>to</span><span class='token pointer' id='tok-70-54'>try</span><span class='token pointer' id='tok-70-55'>out</span><span class='token pointer' id='tok-70-56'>different</span><span class='token pointer' id='tok-70-57'>methods</span><span class='token pointer' id='tok-70-58'>to</span><span class='token pointer' id='tok-70-59'>bypass</span><span class='token pointer' id='tok-70-60'>them.</span><span class='token pointer' id='tok-70-61'>This</span><span class='token pointer' id='tok-70-62'>article</span><span class='token pointer' id='tok-70-63'>walks</span><span class='token pointer' id='tok-70-64'>the</span><span class='token pointer' id='tok-70-65'>reader</span><span class='token pointer' id='tok-70-66'>through</span><span class='token pointer' id='tok-70-67'>some</span><span class='token pointer' id='tok-70-68'>of</span><span class='token pointer' id='tok-70-69'>the</span><span class='token pointer' id='tok-70-70'>popular</span><span class='token pointer' id='tok-70-71' style='color:red'>tools</span><span class='token pointer' id='tok-70-72'>available</span><span class='token pointer' id='tok-70-73'>to</span><span class='token pointer' id='tok-70-74'>play</span><span class='token pointer' id='tok-70-75'>with</span><span class='token pointer' id='tok-70-76' style='color:red'>Antivirus</span><span class='token pointer' id='tok-70-77'>evasion.</span></p><p id=p78><span class='token pointer' id='tok-70-79' style='color:red'>File Splitters</span><span class='token pointer' id='tok-70-80'>Hex</span><span class='token pointer' id='tok-70-82' style='color:red'>The</span><span class='token pointer' id='tok-70-83' style='color:red'>editors</span><span class='token pointer' id='tok-70-84'>technique</span><span class='token pointer' id='tok-70-85'>that</span><span class='token pointer' id='tok-70-86'>we</span><span class='token pointer' id='tok-70-87'>are</span><span class='token pointer' id='tok-70-88'>going</span><span class='token pointer' id='tok-70-89'>to</span><span class='token pointer' id='tok-70-90'>discuss</span><span class='token pointer' id='tok-70-91'>is</span><span class='token pointer' id='tok-70-92'>using</span><span class='token pointer' id='tok-70-93'>file</span><span class='token pointer' id='tok-70-95' style='color:red'>splitting tools</span><span class='token pointer' id='tok-70-96'>identify</span><span class='token pointer' id='tok-70-97'>the</span><span class='token pointer' id='tok-70-98'>exact</span><span class='token pointer' id='tok-70-99'>signature</span><span class='token pointer' id='tok-70-100'>that</span><span class='token pointer' id='tok-70-101'>is</span><span class='token pointer' id='tok-70-102'>being</span><span class='token pointer' id='tok-70-103'>detected</span><span class='token pointer' id='tok-70-104'>by</span><span class='token pointer' id='tok-70-105' style='color:red'>the</span><span class='token pointer' id='tok-70-106'>antivirus</span><span class='token pointer' id='tok-70-107'>application</span><span class='token pointer' id='tok-70-108'>and</span><span class='token pointer' id='tok-70-109' style='color:red'>modify</span><span class='token pointer' id='tok-70-110'>it.</span><span class='token pointer' id='tok-70-111' style='color:red'>This</span><span class='token pointer' id='tok-70-112'>is</span><span class='token pointer' id='tok-70-113'>one</span><span class='token pointer' id='tok-70-114'>of</span><span class='token pointer' id='tok-70-115'>the</span><span class='token pointer' id='tok-70-116'>oldest</span><span class='token pointer' id='tok-70-117'>ways</span><span class='token pointer' id='tok-70-118'>to</span><span class='token pointer' id='tok-70-119'>bypass</span><span class='token pointer' id='tok-70-120'>AV</span><span class='token pointer' id='tok-70-121'>tools.</span><span class='token pointer' id='tok-70-122'>This</span><span class='token pointer' id='tok-70-123'>technique</span><span class='token pointer' id='tok-70-124'>is</span><span class='token pointer' id='tok-70-125'>efficient</span><span class='token pointer' id='tok-70-126'>if</span><span class='token pointer' id='tok-70-127'>we</span><span class='token pointer' id='tok-70-128'>can</span><span class='token pointer' id='tok-70-129'>locate</span><span class='token pointer' id='tok-70-130'>the</span><span class='token pointer' id='tok-70-131'>exact</span><span class='token pointer' id='tok-70-132'>signature</span><span class='token pointer' id='tok-70-133'>that</span><span class='token pointer' id='tok-70-134'>is</span><span class='token pointer' id='tok-70-135'>being</span><span class='token pointer' id='tok-70-136'>detected.</span><span class='token pointer' id='tok-70-137'>However,</span><span class='token pointer' id='tok-70-138'>there</span><span class='token pointer' id='tok-70-139'>is</span><span class='token pointer' id='tok-70-140'>a</span><span class='token pointer' id='tok-70-141'>limitation</span><span class='token pointer' id='tok-70-142'>with</span><span class='token pointer' id='tok-70-143'>this</span><span class='token pointer' id='tok-70-144'>technique.</span><span class='token pointer' id='tok-70-145'>If</span><span class='token pointer' id='tok-70-146'>we</span><span class='token pointer' id='tok-70-147'>mess</span><span class='token pointer' id='tok-70-148'>the</span><span class='token pointer' id='tok-70-149'>functionality</span><span class='token pointer' id='tok-70-150'>of</span><span class='token pointer' id='tok-70-151'>the</span><span class='token pointer' id='tok-70-152'>application,</span><span class='token pointer' id='tok-70-153'>it</span><span class='token pointer' id='tok-70-154'>becomes</span><span class='token pointer' id='tok-70-155'>useless</span><span class='token pointer' id='tok-70-156'>even</span><span class='token pointer' id='tok-70-157'>if</span><span class='token pointer' id='tok-70-158'>we</span><span class='token pointer' id='tok-70-159'>bypass</span><span class='token pointer' id='tok-70-160'>antivirus.</span><span class='token pointer' id='tok-70-161'>So,</span><span class='token pointer' id='tok-70-162'>as</span><span class='token pointer' id='tok-70-163'>long</span><span class='token pointer' id='tok-70-164'>as</span><span class='token pointer' id='tok-70-165'>the</span><span class='token pointer' id='tok-70-166'>functionality</span><span class='token pointer' id='tok-70-167'>is</span><span class='token pointer' id='tok-70-168'>not</span><span class='token pointer' id='tok-70-169'>modified</span><span class='token pointer' id='tok-70-170'>while</span><span class='token pointer' id='tok-70-171'>we</span><span class='token pointer' id='tok-70-172'>are</span><span class='token pointer' id='tok-70-173'>changing</span><span class='token pointer' id='tok-70-174'>the</span><span class='token pointer' id='tok-70-175'>signatures,</span><span class='token pointer' id='tok-70-176'>we</span><span class='token pointer' id='tok-70-177'>are</span><span class='token pointer' id='tok-70-178'>good</span><span class='token pointer' id='tok-70-179'>to</span><span class='token pointer' id='tok-70-180'>go.</span></p><p id=p181><span class='token pointer' id='tok-70-181'>This</span><span class='token pointer' id='tok-70-182'>can</span><span class='token pointer' id='tok-70-183'>be</span><span class='token pointer' id='tok-70-184'>achieved</span><span class='token pointer' id='tok-70-185'>by</span><span class='token pointer' id='tok-70-186'>using</span><span class='token pointer' id='tok-70-187'>a</span><span class='token pointer' id='tok-70-188'>file-splitting</span><span class='token pointer' id='tok-70-191' style='color:red'>split</span><span class='token pointer' id='tok-70-192' style='color:red'>to</span><span class='token pointer' id='tok-70-193' style='color:red'>binary</span><span class='token pointer' id='tok-70-194'>into</span><span class='token pointer' id='tok-70-195' style='color:red'>many</span><span class='token pointer' id='tok-70-196'>parts.</span><span class='token pointer' id='tok-70-197'>This</span><span class='token pointer' id='tok-70-198'>splitting</span><span class='token pointer' id='tok-70-199'>should</span><span class='token pointer' id='tok-70-200' style='color:red'>be</span><span class='token pointer' id='tok-70-201'>done</span><span class='token pointer' id='tok-70-202'>in</span><span class='token pointer' id='tok-70-203'>such</span><span class='token pointer' id='tok-70-204'>a</span><span class='token pointer' id='tok-70-205'>way</span><span class='token pointer' id='tok-70-206'>that</span><span class='token pointer' id='tok-70-207'>each</span><span class='token pointer' id='tok-70-208'>part</span><span class='token pointer' id='tok-70-209'>is</span><span class='token pointer' id='tok-70-210'>larger</span><span class='token pointer' id='tok-70-211'>than</span><span class='token pointer' id='tok-70-212'>the</span><span class='token pointer' id='tok-70-213'>previous</span><span class='token pointer' id='tok-70-214'>one</span><span class='token pointer' id='tok-70-215'>by</span><span class='token pointer' id='tok-70-216'>a</span><span class='token pointer' id='tok-70-217'>fixed</span><span class='token pointer' id='tok-70-218'>amount.</span><span class='token pointer' id='tok-70-219'>Then</span><span class='token pointer' id='tok-70-220'>we</span><span class='token pointer' id='tok-70-221'>need</span><span class='token pointer' id='tok-70-222'>to</span><span class='token pointer' id='tok-70-223'>run</span><span class='token pointer' id='tok-70-224'>the</span><span class='token pointer' id='tok-70-225' style='color:red'>Antivirus</span><span class='token pointer' id='tok-70-226'>scan</span><span class='token pointer' id='tok-70-227'>on</span><span class='token pointer' id='tok-70-228' style='color:red'>these</span><span class='token pointer' id='tok-70-229'>parts</span><span class='token pointer' id='tok-70-230'>to</span><span class='token pointer' id='tok-70-231'>identify</span><span class='token pointer' id='tok-70-232'>which</span><span class='token pointer' id='tok-70-233'>part</span><span class='token pointer' id='tok-70-234'>is</span><span class='token pointer' id='tok-70-235'>flagged</span><span class='token pointer' id='tok-70-236'>first</span><span class='token pointer' id='tok-70-237' style='color:red'>as</span><span class='token pointer' id='tok-70-238'>malicious.</span><span class='token pointer' id='tok-70-239'>We</span><span class='token pointer' id='tok-70-240' style='color:red'>need</span><span class='token pointer' id='tok-70-241'>to</span><span class='token pointer' id='tok-70-242'>do</span><span class='token pointer' id='tok-70-243'>this</span><span class='token pointer' id='tok-70-244'>process</span><span class='token pointer' id='tok-70-245'>repeatedly</span><span class='token pointer' id='tok-70-246'>until</span><span class='token pointer' id='tok-70-247'>the</span><span class='token pointer' id='tok-70-248'>actual</span><span class='token pointer' id='tok-70-249'>signature</span><span class='token pointer' id='tok-70-250'>is</span><span class='token pointer' id='tok-70-251'>located.</span><span class='token pointer' id='tok-70-252'>Tools</span><span class='token pointer' id='tok-70-253'>such</span><span class='token pointer' id='tok-70-254'>as</span><span class='token pointer' id='tok-70-255'>"Dsplit"</span><span class='token pointer' id='tok-70-256'>and</span><span class='token pointer' id='tok-70-257' style='color:red'>"Evade"</span><span class='token pointer' id='tok-70-258'>can</span><span class='token pointer' id='tok-70-259' style='color:red'>be</span><span class='token pointer' id='tok-70-260'>used</span><span class='token pointer' id='tok-70-261'>for</span><span class='token pointer' id='tok-70-262'>file</span><span class='token pointer' id='tok-70-263'>splitting.</span><span class='token pointer' id='tok-70-264'>Once</span><span class='token pointer' id='tok-70-265'>the</span><span class='token pointer' id='tok-70-266'>signature</span><span class='token pointer' id='tok-70-267'>is</span><span class='token pointer' id='tok-70-268'>located,</span><span class='token pointer' id='tok-70-269'>we</span><span class='token pointer' id='tok-70-270'>need</span><span class='token pointer' id='tok-70-271'>to</span><span class='token pointer' id='tok-70-272'>modify</span><span class='token pointer' id='tok-70-273'>it</span><span class='token pointer' id='tok-70-274'>and</span><span class='token pointer' id='tok-70-275'>save</span><span class='token pointer' id='tok-70-276'>the</span><span class='token pointer' id='tok-70-277'>modified</span><span class='token pointer' id='tok-70-278'>binary.</span></p><p id=p279><span class='token pointer' id='tok-70-279'>Let's</span><span class='token pointer' id='tok-70-280'>have</span><span class='token pointer' id='tok-70-281'>a</span><span class='token pointer' id='tok-70-282'>look</span><span class='token pointer' id='tok-70-283'>at</span><span class='token pointer' id='tok-70-284'>an</span><span class='token pointer' id='tok-70-285'>example</span><span class='token pointer' id='tok-70-286'>of</span><span class='token pointer' id='tok-70-287'>how</span><span class='token pointer' id='tok-70-288'>this</span><span class='token pointer' id='tok-70-289'>really</span><span class='token pointer' id='tok-70-290'>works</span><span class='token pointer' id='tok-70-291'>against</span><span class='token pointer' id='tok-70-292'>Antivirus</span><span class='token pointer' id='tok-70-293'>tools.</span></p><p id=p294><span class='token pointer' id='tok-70-294'>I</span><span class='token pointer' id='tok-70-295'>have</span><span class='token pointer' id='tok-70-296'>downloaded</span><span class='token pointer' id='tok-70-298' style='color:red'>wce.exe from</span><span class='token pointer' id='tok-70-299'>link</span><span class='token pointer' id='tok-70-300'>given</span><span class='token pointer' id='tok-70-301'>below.</span><span class='token pointer' id='tok-70-302'>This</span><span class='token pointer' id='tok-70-303'>is</span><span class='token pointer' id='tok-70-304'>one</span><span class='token pointer' id='tok-70-305'>of</span><span class='token pointer' id='tok-70-306'>the</span><span class='token pointer' id='tok-70-307'>commonly</span><span class='token pointer' id='tok-70-308'>used</span><span class='token pointer' id='tok-70-309'>tool</span><span class='token pointer' id='tok-70-310'>during</span><span class='token pointer' id='tok-70-311'>post</span><span class='token pointer' id='tok-70-312'>exploitation</span><span class='token pointer' id='tok-70-313'>for</span><span class='token pointer' id='tok-70-314'>dumping</span><span class='token pointer' id='tok-70-315'>passwords</span><span class='token pointer' id='tok-70-316'>in</span><span class='token pointer' id='tok-70-317'>clear</span><span class='token pointer' id='tok-70-318' style='color:red'>text.</span></p><p id=p319><span class='token pointer' id='tok-70-319'>When</span><span class='token pointer' id='tok-70-320'>we</span><span class='token pointer' id='tok-70-321'>scan</span><span class='token pointer' id='tok-70-322'>this</span><span class='token pointer' id='tok-70-323'>tool</span><span class='token pointer' id='tok-70-324'>through</span><span class='token pointer' id='tok-70-325'>virustotal.com,</span><span class='token pointer' id='tok-70-326'>it</span><span class='token pointer' id='tok-70-327'>is</span><span class='token pointer' id='tok-70-328'>flagged</span><span class='token pointer' id='tok-70-329'>as</span><span class='token pointer' id='tok-70-330'>malicious</span><span class='token pointer' id='tok-70-331'>by</span><span class='token pointer' id='tok-70-332'>47</span><span class='token pointer' id='tok-70-333'>Antivirus</span><span class='token pointer' id='tok-70-334'>softwares</span><span class='token pointer' id='tok-70-335'>out</span></p><p id=p337><span class='token pointer' id='tok-70-337'>By</span><span class='token pointer' id='tok-70-338'>using</span><span class='token pointer' id='tok-70-339'>Dsplit,</span><span class='token pointer' id='tok-70-340'>I</span><span class='token pointer' id='tok-70-341'>have</span><span class='token pointer' id='tok-70-342'>noticed</span><span class='token pointer' id='tok-70-343'>that</span><span class='token pointer' id='tok-70-344'>some</span><span class='token pointer' id='tok-70-345'>antivirus</span><span class='token pointer' id='tok-70-346'>software</span><span class='token pointer' id='tok-70-347'>is</span><span class='token pointer' id='tok-70-348'>detecting</span><span class='token pointer' id='tok-70-349'>it</span><span class='token pointer' id='tok-70-350'>as</span><span class='token pointer' id='tok-70-351'>malicious</span><span class='token pointer' id='tok-70-352'>using</span><span class='token pointer' id='tok-70-353'>its</span><span class='token pointer' id='tok-70-354'>welcome</span><span class='token pointer' id='tok-70-355'>text,</span><span class='token pointer' id='tok-70-356'>which</span><span class='token pointer' id='tok-70-357'>is</span><span class='token pointer' id='tok-70-358'>displayed</span><span class='token pointer' id='tok-70-359'>when</span><span class='token pointer' id='tok-70-360'>we</span><span class='token pointer' id='tok-70-361'>run</span><span class='token pointer' id='tok-70-362'>this</span><span class='token pointer' id='tok-70-363'>tool.</span><span class='token pointer' id='tok-70-364'>Therefore,</span><span class='token pointer' id='tok-70-365'>I</span><span class='token pointer' id='tok-70-366'>opened</span><span class='token pointer' id='tok-70-367'>wce.exe</span><span class='token pointer' id='tok-70-368'>in</span><span class='token pointer' id='tok-70-369'>a</span><span class='token pointer' id='tok-70-370'>hex</span><span class='token pointer' id='tok-70-371'>editor</span><span class='token pointer' id='tok-70-372'>and</span><span class='token pointer' id='tok-70-373'>changed</span><span class='token pointer' id='tok-70-375' style='color:red'>this signature</span><span class='token pointer' id='tok-70-376'>uppercase</span><span class='token pointer' id='tok-70-377'>to</span><span class='token pointer' id='tok-70-378'>lowercase</span><span class='token pointer' id='tok-70-379'>and</span><span class='token pointer' id='tok-70-380'>vice</span><span class='token pointer' id='tok-70-381'>versa.</span><span class='token pointer' id='tok-70-382'>This</span><span class='token pointer' id='tok-70-383'>is</span><span class='token pointer' id='tok-70-384'>shown</span><span class='token pointer' id='tok-70-385'>below.</span></p><p id=p386><span class='token pointer' id='tok-70-386'>After</span><span class='token pointer' id='tok-70-387'>making</span><span class='token pointer' id='tok-70-388'>the</span><span class='token pointer' id='tok-70-389'>above</span><span class='token pointer' id='tok-70-390'>shown</span><span class='token pointer' id='tok-70-391'>modifications</span><span class='token pointer' id='tok-70-392'>to</span><span class='token pointer' id='tok-70-393'>the</span><span class='token pointer' id='tok-70-394'>binary,</span><span class='token pointer' id='tok-70-395'>I</span><span class='token pointer' id='tok-70-396'>have</span><span class='token pointer' id='tok-70-397'>scanned</span><span class='token pointer' id='tok-70-398'>through</span><span class='token pointer' id='tok-70-399'>virustotal.com</span><span class='token pointer' id='tok-70-400'>once</span><span class='token pointer' id='tok-70-401'>again</span><span class='token pointer' id='tok-70-402' style='color:red'>and</span><span class='token pointer' id='tok-70-403'>noticed</span><span class='token pointer' id='tok-70-404'>that</span><span class='token pointer' id='tok-70-405'>42</span><span class='token pointer' id='tok-70-406'>antivirus</span><span class='token pointer' id='tok-70-407'>engines</span><span class='token pointer' id='tok-70-408'>out</span><span class='token pointer' id='tok-70-409'>of</span><span class='token pointer' id='tok-70-410'>56</span><span class='token pointer' id='tok-70-411'>have</span><span class='token pointer' id='tok-70-412' style='color:red'>flagged</span><span class='token pointer' id='tok-70-413'>it</span><span class='token pointer' id='tok-70-414'>as</span><span class='token pointer' id='tok-70-415'>malicious</span><span class='token pointer' id='tok-70-416'>this</span><span class='token pointer' id='tok-70-417'>time.</span></p><p id=p418><span class='token pointer' id='tok-70-418'>However,</span><span class='token pointer' id='tok-70-419'>this</span><span class='token pointer' id='tok-70-420'>didn't</span><span class='token pointer' id='tok-70-421'>bypass</span><span class='token pointer' id='tok-70-422'>most</span><span class='token pointer' id='tok-70-423'>of</span><span class='token pointer' id='tok-70-424'>the</span><span class='token pointer' id='tok-70-425'>antivirus</span><span class='token pointer' id='tok-70-426'>applications;</span><span class='token pointer' id='tok-70-427'>it</span><span class='token pointer' id='tok-70-428'>is</span><span class='token pointer' id='tok-70-429'>possible</span><span class='token pointer' id='tok-70-430'>to</span><span class='token pointer' id='tok-70-431'>do</span><span class='token pointer' id='tok-70-432'>that</span><span class='token pointer' id='tok-70-433'>if</span><span class='token pointer' id='tok-70-434'>we</span><span class='token pointer' id='tok-70-435'>can</span><span class='token pointer' id='tok-70-436'>locate</span><span class='token pointer' id='tok-70-437'>the</span><span class='token pointer' id='tok-70-438'>exact</span><span class='token pointer' id='tok-70-439'>signature</span><span class='token pointer' id='tok-70-440'>that</span><span class='token pointer' id='tok-70-441'>is</span><span class='token pointer' id='tok-70-442'>being</span><span class='token pointer' id='tok-70-443'>detected</span><span class='token pointer' id='tok-70-444'>by</span><span class='token pointer' id='tok-70-445'>those</span><span class='token pointer' id='tok-70-446'>AVs.</span></p><p id=p447><span class='token pointer' id='tok-70-447'>When</span><span class='token pointer' id='tok-70-448'>we</span><span class='token pointer' id='tok-70-449'>use</span><span class='token pointer' id='tok-70-450'>the</span><span class='token pointer' id='tok-70-451'>above-mentioned</span><span class='token pointer' id='tok-70-452'>technique,</span><span class='token pointer' id='tok-70-453'>we</span><span class='token pointer' id='tok-70-454'>should</span><span class='token pointer' id='tok-70-455'>not</span><span class='token pointer' id='tok-70-456'>forget</span><span class='token pointer' id='tok-70-457'>about</span><span class='token pointer' id='tok-70-458'>the</span><span class='token pointer' id='tok-70-459'>functionality</span><span class='token pointer' id='tok-70-460'>of</span><span class='token pointer' id='tok-70-461'>the</span><span class='token pointer' id='tok-70-462'>binary</span><span class='token pointer' id='tok-70-463'>while</span><span class='token pointer' id='tok-70-464'>making</span><span class='token pointer' id='tok-70-465'>changes.</span></p><p id=p466><span class='token pointer' id='tok-70-466'>As</span><span class='token pointer' id='tok-70-467'>an</span><span class='token pointer' id='tok-70-468'>example,</span><span class='token pointer' id='tok-70-469'>here</span><span class='token pointer' id='tok-70-470'>is</span><span class='token pointer' id='tok-70-471'>the</span><span class='token pointer' id='tok-70-472'>output</span><span class='token pointer' id='tok-70-473'>of</span><span class='token pointer' id='tok-70-474'>original</span><span class='token pointer' id='tok-70-475'>wce.exe</span><span class='token pointer' id='tok-70-476'>dumping</span><span class='token pointer' id='tok-70-477' style='color:red'>the</span><span class='token pointer' id='tok-70-478'>password</span><span class='token pointer' id='tok-70-479'>from</span><span class='token pointer' id='tok-70-480'>memory.</span></p><p id=p481><span class='token pointer' id='tok-70-481'>The</span><span class='token pointer' id='tok-70-482'>functionality</span><span class='token pointer' id='tok-70-483' style='color:red'>remained</span><span class='token pointer' id='tok-70-484'>the</span><span class='token pointer' id='tok-70-485' style='color:red'>same</span><span class='token pointer' id='tok-70-486'>even</span><span class='token pointer' id='tok-70-487'>after</span><span class='token pointer' id='tok-70-488'>making</span><span class='token pointer' id='tok-70-489'>changes</span><span class='token pointer' id='tok-70-490'>to</span><span class='token pointer' id='tok-70-491'>the</span><span class='token pointer' id='tok-70-492'>binary.</span><span class='token pointer' id='tok-70-493'>It</span><span class='token pointer' id='tok-70-494'>is</span><span class='token pointer' id='tok-70-495'>still</span><span class='token pointer' id='tok-70-496'>able</span><span class='token pointer' id='tok-70-497'>to</span><span class='token pointer' id='tok-70-498'>get</span><span class='token pointer' id='tok-70-499'>the</span><span class='token pointer' id='tok-70-500'>password</span><span class='token pointer' id='tok-70-501'>from</span><span class='token pointer' id='tok-70-502'>the</span><span class='token pointer' id='tok-70-503'>memory</span><span class='token pointer' id='tok-70-504'>as</span><span class='token pointer' id='tok-70-505'>shown</span><span class='token pointer' id='tok-70-506'>below.</span></p><p id=p507><span class='token pointer' id='tok-70-507'>HyperionEncrypting</span><span class='token pointer' id='tok-70-508'>the</span><span class='token pointer' id='tok-70-509'>binary</span><span class='token pointer' id='tok-70-510'>is</span><span class='token pointer' id='tok-70-511'>one</span><span class='token pointer' id='tok-70-512' style='color:red'>of</span><span class='token pointer' id='tok-70-513'>the</span><span class='token pointer' id='tok-70-514'>common</span><span class='token pointer' id='tok-70-515'>ways</span><span class='token pointer' id='tok-70-516'>to</span><span class='token pointer' id='tok-70-517'>bypass</span><span class='token pointer' id='tok-70-518'>antivirus</span><span class='token pointer' id='tok-70-519'>detection.</span><span class='token pointer' id='tok-70-520'>The</span><span class='token pointer' id='tok-70-522' style='color:red'>logic behind</span><span class='token pointer' id='tok-70-523'>encrypters</span><span class='token pointer' id='tok-70-524' style='color:red'>is</span><span class='token pointer' id='tok-70-525'>to</span><span class='token pointer' id='tok-70-526'>obfuscate</span><span class='token pointer' id='tok-70-527'>the</span><span class='token pointer' id='tok-70-528'>binary</span><span class='token pointer' id='tok-70-529' style='color:red'>from</span><span class='token pointer' id='tok-70-530'>antivirus</span><span class='token pointer' id='tok-70-531'>tools</span><span class='token pointer' id='tok-70-532' style='color:red'>by</span><span class='token pointer' id='tok-70-533'>encrypting</span><span class='token pointer' id='tok-70-534'>it.</span><span class='token pointer' id='tok-70-535'>This</span><span class='token pointer' id='tok-70-536'>will</span><span class='token pointer' id='tok-70-537'>be</span><span class='token pointer' id='tok-70-538'>decrypted</span><span class='token pointer' id='tok-70-539'>back</span><span class='token pointer' id='tok-70-540'>when</span><span class='token pointer' id='tok-70-541'>the</span><span class='token pointer' id='tok-70-542'>binary</span><span class='token pointer' id='tok-70-543'>is</span><span class='token pointer' id='tok-70-544'>run.</span><span class='token pointer' id='tok-70-545'>Kali</span><span class='token pointer' id='tok-70-546'>Linux</span><span class='token pointer' id='tok-70-547'>has</span><span class='token pointer' id='tok-70-548'>got</span><span class='token pointer' id='tok-70-549'>an</span><span class='token pointer' id='tok-70-550'>open</span><span class='token pointer' id='tok-70-552' style='color:red'>source encrypter</span><span class='token pointer' id='tok-70-553'>Hyperion</span><span class='token pointer' id='tok-70-554'>available</span><span class='token pointer' id='tok-70-555'>in</span></p><p id=p557><span class='token pointer' id='tok-70-557'>I</span><span class='token pointer' id='tok-70-558' style='color:red'>am</span><span class='token pointer' id='tok-70-559'>using</span><span class='token pointer' id='tok-70-560' style='color:red'>the</span><span class='token pointer' id='tok-70-561'>one</span><span class='token pointer' id='tok-70-562'>I</span><span class='token pointer' id='tok-70-563'>have</span><span class='token pointer' id='tok-70-564'>downloaded</span><span class='token pointer' id='tok-70-565'>from</span><span class='token pointer' id='tok-70-566'>the</span><span class='token pointer' id='tok-70-567'>above</span><span class='token pointer' id='tok-70-568'>link.</span><span class='token pointer' id='tok-70-569'>Let</span><span class='token pointer' id='tok-70-570'>us</span><span class='token pointer' id='tok-70-571'>see</span><span class='token pointer' id='tok-70-572'>how</span><span class='token pointer' id='tok-70-573'>we</span><span class='token pointer' id='tok-70-574'>can</span><span class='token pointer' id='tok-70-575'>use</span><span class='token pointer' id='tok-70-576'>this</span><span class='token pointer' id='tok-70-577'>tool.</span></p><p id=p578><span class='token pointer' id='tok-70-578'>Before</span><span class='token pointer' id='tok-70-579'>we</span><span class='token pointer' id='tok-70-580'>use</span><span class='token pointer' id='tok-70-581'>Hyperion,</span><span class='token pointer' id='tok-70-582'>let's</span><span class='token pointer' id='tok-70-583'>scan</span><span class='token pointer' id='tok-70-584'>the</span><span class='token pointer' id='tok-70-585'>32</span><span class='token pointer' id='tok-70-586'>bit</span><span class='token pointer' id='tok-70-587'>version</span><span class='token pointer' id='tok-70-588'>of</span><span class='token pointer' id='tok-70-589'>wce.exe</span><span class='token pointer' id='tok-70-590'>file</span><span class='token pointer' id='tok-70-591'>through</span><span class='token pointer' id='tok-70-592'>virustotal.com</span></p><p id=p594><span class='token pointer' id='tok-70-594'>As</span><span class='token pointer' id='tok-70-595' style='color:red'>we</span><span class='token pointer' id='tok-70-596'>can</span><span class='token pointer' id='tok-70-597'>notice,</span><span class='token pointer' id='tok-70-598' style='color:red'>44</span><span class='token pointer' id='tok-70-599'>antivirus</span><span class='token pointer' id='tok-70-600'>applications</span><span class='token pointer' id='tok-70-601'>have</span><span class='token pointer' id='tok-70-602'>flagged</span><span class='token pointer' id='tok-70-603'>this</span><span class='token pointer' id='tok-70-604'>as</span><span class='token pointer' id='tok-70-605'>malicious.</span></p><p id=p606><span class='token pointer' id='tok-70-606'>Let's</span><span class='token pointer' id='tok-70-607'>encrypt</span><span class='token pointer' id='tok-70-608'>this</span><span class='token pointer' id='tok-70-609'>file</span><span class='token pointer' id='tok-70-610'>with</span><span class='token pointer' id='tok-70-611'>Hyperion</span><span class='token pointer' id='tok-70-612'>as</span><span class='token pointer' id='tok-70-613'>shown</span><span class='token pointer' id='tok-70-614'>below.</span></p><p id=p615><span class='token pointer' id='tok-70-615' style='color:red'>Let's</span><span class='token pointer' id='tok-70-616'>scan</span><span class='token pointer' id='tok-70-617'>this</span><span class='token pointer' id='tok-70-618'>newly</span><span class='token pointer' id='tok-70-619'>generated</span><span class='token pointer' id='tok-70-620'>file</span><span class='token pointer' id='tok-70-621'>once</span><span class='token pointer' id='tok-70-622'>again</span><span class='token pointer' id='tok-70-623'>and</span><span class='token pointer' id='tok-70-624'>see</span><span class='token pointer' id='tok-70-625'>the</span><span class='token pointer' id='tok-70-626'>detection</span><span class='token pointer' id='tok-70-627'>ratio.</span></p><p id=p628><span class='token pointer' id='tok-70-628'>As</span><span class='token pointer' id='tok-70-629'>we</span><span class='token pointer' id='tok-70-630'>can</span><span class='token pointer' id='tok-70-631'>see</span><span class='token pointer' id='tok-70-632'>in</span><span class='token pointer' id='tok-70-633'>the</span><span class='token pointer' id='tok-70-634'>figure</span><span class='token pointer' id='tok-70-635'>above,</span><span class='token pointer' id='tok-70-636'>this</span><span class='token pointer' id='tok-70-637'>has</span><span class='token pointer' id='tok-70-638'>got</span><span class='token pointer' id='tok-70-639'>lesser</span><span class='token pointer' id='tok-70-640'>detection</span><span class='token pointer' id='tok-70-641'>compared</span><span class='token pointer' id='tok-70-642'>to</span><span class='token pointer' id='tok-70-643'>the</span><span class='token pointer' id='tok-70-644'>unencrypted</span><span class='token pointer' id='tok-70-645'>binary.</span></p><p id=p646><span class='token pointer' id='tok-70-646'>Veil-EvasionVeil-Evasion</span><span class='token pointer' id='tok-70-647'>is</span><span class='token pointer' id='tok-70-648'>another</span><span class='token pointer' id='tok-70-649'>popular</span><span class='token pointer' id='tok-70-650'>framework</span><span class='token pointer' id='tok-70-651'>written</span><span class='token pointer' id='tok-70-652'>in</span><span class='token pointer' id='tok-70-653'>python.</span><span class='token pointer' id='tok-70-654' style='color:red'>We</span><span class='token pointer' id='tok-70-655'>can</span><span class='token pointer' id='tok-70-656'>use</span><span class='token pointer' id='tok-70-657'>this</span><span class='token pointer' id='tok-70-658' style='color:red'>framework</span><span class='token pointer' id='tok-70-659'>to</span><span class='token pointer' id='tok-70-660'>generate</span><span class='token pointer' id='tok-70-661' style='color:red'>payloads</span><span class='token pointer' id='tok-70-662'>that</span><span class='token pointer' id='tok-70-663'>can</span><span class='token pointer' id='tok-70-664'>evade</span><span class='token pointer' id='tok-70-665'>majority</span><span class='token pointer' id='tok-70-666'>of</span><span class='token pointer' id='tok-70-667'>AVs.</span></p><p id=p668><span class='token pointer' id='tok-70-668'>First</span><span class='token pointer' id='tok-70-669' style='color:red'>download</span><span class='token pointer' id='tok-70-670'>and</span><span class='token pointer' id='tok-70-671'>install</span><span class='token pointer' id='tok-70-672' style='color:red'>Veil-Evasion</span><span class='token pointer' id='tok-70-673'>and</span><span class='token pointer' id='tok-70-674'>run</span><span class='token pointer' id='tok-70-675'>it</span><span class='token pointer' id='tok-70-676'>using</span><span class='token pointer' id='tok-70-677' style='color:red'>the</span><span class='token pointer' id='tok-70-678'>following</span><span class='token pointer' id='tok-70-679' style='color:red'>command</span></p><p id=p680><span class='token pointer' id='tok-70-680' style='color:red'>"veil-evasion"</span></p><p id=p681><span class='token pointer' id='tok-70-681'>As</span><span class='token pointer' id='tok-70-682'>we</span><span class='token pointer' id='tok-70-683'>can</span><span class='token pointer' id='tok-70-684'>see,</span><span class='token pointer' id='tok-70-685'>46</span><span class='token pointer' id='tok-70-686'>payloads</span><span class='token pointer' id='tok-70-687' style='color:red'>have</span><span class='token pointer' id='tok-70-688' style='color:red'>been</span><span class='token pointer' id='tok-70-689'>loaded.</span><span class='token pointer' id='tok-70-690'>To</span><span class='token pointer' id='tok-70-691'>use</span><span class='token pointer' id='tok-70-692'>a</span><span class='token pointer' id='tok-70-693'>specific</span><span class='token pointer' id='tok-70-694'>payload,</span><span class='token pointer' id='tok-70-695'>we</span><span class='token pointer' id='tok-70-696'>can</span><span class='token pointer' id='tok-70-697'>type</span><span class='token pointer' id='tok-70-698'>"use"</span><span class='token pointer' id='tok-70-699'>command.</span></p><p id=p700><span class='token pointer' id='tok-70-700'>I</span><span class='token pointer' id='tok-70-701'>am</span><span class='token pointer' id='tok-70-702'>going</span><span class='token pointer' id='tok-70-703'>to</span><span class='token pointer' id='tok-70-704'>choose</span><span class='token pointer' id='tok-70-705'>option</span><span class='token pointer' id='tok-70-706'>31</span><span class='token pointer' id='tok-70-707'>to</span><span class='token pointer' id='tok-70-708'>create</span><span class='token pointer' id='tok-70-709'>the</span><span class='token pointer' id='tok-70-710'>executable</span><span class='token pointer' id='tok-70-711'>payload</span><span class='token pointer' id='tok-70-712'>python/meterpreter/rev_tcp.</span><span class='token pointer' id='tok-70-713'>Infact,</span><span class='token pointer' id='tok-70-714'>it</span><span class='token pointer' id='tok-70-715'>creates</span><span class='token pointer' id='tok-70-716'>a</span><span class='token pointer' id='tok-70-717'>python</span><span class='token pointer' id='tok-70-718' style='color:red'>script,</span><span class='token pointer' id='tok-70-719'>which</span><span class='token pointer' id='tok-70-720' style='color:red'>in</span><span class='token pointer' id='tok-70-721'>turn</span><span class='token pointer' id='tok-70-722'>will</span><span class='token pointer' id='tok-70-723'>be</span><span class='token pointer' id='tok-70-724'>converted</span><span class='token pointer' id='tok-70-725'>into</span><span class='token pointer' id='tok-70-726' style='color:red'>an</span><span class='token pointer' id='tok-70-727'>executable</span><span class='token pointer' id='tok-70-728'>using</span><span class='token pointer' id='tok-70-729'>tools</span><span class='token pointer' id='tok-70-730'>like</span><span class='token pointer' id='tok-70-731'>pyinstaller.</span></p><p id=p732><span class='token pointer' id='tok-70-732'>In</span><span class='token pointer' id='tok-70-733'>the</span><span class='token pointer' id='tok-70-734'>above</span><span class='token pointer' id='tok-70-735'>figure,</span><span class='token pointer' id='tok-70-736'>we</span><span class='token pointer' id='tok-70-737'>have</span><span class='token pointer' id='tok-70-738'>set</span><span class='token pointer' id='tok-70-739' style='color:red'>the</span><span class='token pointer' id='tok-70-740'>LHOST</span><span class='token pointer' id='tok-70-741'>to</span><span class='token pointer' id='tok-70-742'>192.168.56.101</span><span class='token pointer' id='tok-70-743'>and</span><span class='token pointer' id='tok-70-744'>typed</span><span class='token pointer' id='tok-70-745'>"generate"</span><span class='token pointer' id='tok-70-746'>command</span><span class='token pointer' id='tok-70-747'>to</span><span class='token pointer' id='tok-70-748' style='color:red'>generate</span><span class='token pointer' id='tok-70-749'>the</span><span class='token pointer' id='tok-70-750'>payload.</span></p><p id=p751><span class='token pointer' id='tok-70-751'>Next,</span><span class='token pointer' id='tok-70-752'>it</span><span class='token pointer' id='tok-70-753'>will</span><span class='token pointer' id='tok-70-754'>ask</span><span class='token pointer' id='tok-70-755'>us</span><span class='token pointer' id='tok-70-756'>to</span><span class='token pointer' id='tok-70-757'>enter</span><span class='token pointer' id='tok-70-758'>a</span><span class='token pointer' id='tok-70-759'>name</span><span class='token pointer' id='tok-70-760'>for</span><span class='token pointer' id='tok-70-761'>the</span><span class='token pointer' id='tok-70-762'>payload.</span><span class='token pointer' id='tok-70-763'>I</span><span class='token pointer' id='tok-70-764'>named</span><span class='token pointer' id='tok-70-765'>it</span><span class='token pointer' id='tok-70-766'>"backdoor".</span><span class='token pointer' id='tok-70-767'>As</span><span class='token pointer' id='tok-70-768'>mentioned</span><span class='token pointer' id='tok-70-769'>earlier,</span><span class='token pointer' id='tok-70-770'>Veil</span><span class='token pointer' id='tok-70-771'>converts</span><span class='token pointer' id='tok-70-772'>python</span><span class='token pointer' id='tok-70-773'>files</span><span class='token pointer' id='tok-70-774'>to</span><span class='token pointer' id='tok-70-775'>exe.</span><span class='token pointer' id='tok-70-776'>It</span><span class='token pointer' id='tok-70-777'>asks</span><span class='token pointer' id='tok-70-778' style='color:red'>us</span><span class='token pointer' id='tok-70-779' style='color:red'>to</span><span class='token pointer' id='tok-70-780'>choose</span><span class='token pointer' id='tok-70-781'>which</span><span class='token pointer' id='tok-70-782'>tool</span><span class='token pointer' id='tok-70-783'>we</span><span class='token pointer' id='tok-70-784'>want</span><span class='token pointer' id='tok-70-785'>to</span><span class='token pointer' id='tok-70-786'>use</span><span class='token pointer' id='tok-70-787'>for</span><span class='token pointer' id='tok-70-788'>this</span><span class='token pointer' id='tok-70-789'>process.</span><span class='token pointer' id='tok-70-790'>Personally,</span><span class='token pointer' id='tok-70-791'>I</span><span class='token pointer' id='tok-70-792'>like</span><span class='token pointer' id='tok-70-793'>Pyinstaller</span><span class='token pointer' id='tok-70-794'>and</span><span class='token pointer' id='tok-70-795'>I</span><span class='token pointer' id='tok-70-796'>am</span><span class='token pointer' id='tok-70-797'>going</span><span class='token pointer' id='tok-70-798'>for</span><span class='token pointer' id='tok-70-799'>it</span><span class='token pointer' id='tok-70-800'>with</span><span class='token pointer' id='tok-70-801' style='color:red'>option</span><span class='token pointer' id='tok-70-802'>1.</span><span class='token pointer' id='tok-70-803'>These</span><span class='token pointer' id='tok-70-804'>two</span><span class='token pointer' id='tok-70-805'>steps</span><span class='token pointer' id='tok-70-806'>are</span><span class='token pointer' id='tok-70-807'>shown</span><span class='token pointer' id='tok-70-808'>below.</span></p><p id=p809><span class='token pointer' id='tok-70-809'>Once</span><span class='token pointer' id='tok-70-810'>done,</span><span class='token pointer' id='tok-70-811'>it</span><span class='token pointer' id='tok-70-812'>will</span><span class='token pointer' id='tok-70-813'>create</span><span class='token pointer' id='tok-70-814'>our</span><span class='token pointer' id='tok-70-815'>final</span><span class='token pointer' id='tok-70-816'>payload</span><span class='token pointer' id='tok-70-817'>and</span><span class='token pointer' id='tok-70-818'>gives</span><span class='token pointer' id='tok-70-819'>us</span><span class='token pointer' id='tok-70-820'>the</span><span class='token pointer' id='tok-70-821'>location</span><span class='token pointer' id='tok-70-822'>of</span><span class='token pointer' id='tok-70-823'>it</span><span class='token pointer' id='tok-70-824'>as</span><span class='token pointer' id='tok-70-825'>shown</span><span class='token pointer' id='tok-70-826'>below.</span></p><p id=p827><span class='token pointer' id='tok-70-827'>As</span><span class='token pointer' id='tok-70-828'>we</span><span class='token pointer' id='tok-70-829'>can</span><span class='token pointer' id='tok-70-830'>see</span><span class='token pointer' id='tok-70-831'>in</span><span class='token pointer' id='tok-70-832'>the</span><span class='token pointer' id='tok-70-833'>figure</span><span class='token pointer' id='tok-70-834'>above,</span><span class='token pointer' id='tok-70-835'>the</span><span class='token pointer' id='tok-70-836'>authors</span><span class='token pointer' id='tok-70-837'>of</span><span class='token pointer' id='tok-70-838'>this</span><span class='token pointer' id='tok-70-839'>framework</span><span class='token pointer' id='tok-70-840'>are</span><span class='token pointer' id='tok-70-841'>suggesting</span><span class='token pointer' id='tok-70-842'>not</span><span class='token pointer' id='tok-70-843'>to</span><span class='token pointer' id='tok-70-844'>submit</span><span class='token pointer' id='tok-70-845'>these</span><span class='token pointer' id='tok-70-846'>samples</span><span class='token pointer' id='tok-70-847'>online.</span><span class='token pointer' id='tok-70-848'>Therefore,</span><span class='token pointer' id='tok-70-849'>I</span><span class='token pointer' id='tok-70-850'>have</span><span class='token pointer' id='tok-70-851'>checked</span><span class='token pointer' id='tok-70-852'>this</span><span class='token pointer' id='tok-70-853'>payload</span><span class='token pointer' id='tok-70-854'>in</span><span class='token pointer' id='tok-70-855' style='color:red'>sandboxed</span><span class='token pointer' id='tok-70-856'>environment</span><span class='token pointer' id='tok-70-857'>with</span><span class='token pointer' id='tok-70-858'>Avast</span><span class='token pointer' id='tok-70-859'>Antivirus</span><span class='token pointer' id='tok-70-860'>and</span><span class='token pointer' id='tok-70-861'>it</span><span class='token pointer' id='tok-70-862'>is</span><span class='token pointer' id='tok-70-863' style='color:red'>not</span><span class='token pointer' id='tok-70-864'>detected.</span></p><p id=p865><span class='token pointer' id='tok-70-865'>Ethical</span><span class='token pointer' id='tok-70-867' style='color:red'>Hacking Training</span><span class='token pointer' id='tok-70-868'>Resources</span><span class='token pointer' id='tok-70-869'>(InfoSec)</span></p><p id=p870><span class='token pointer' id='tok-70-870'>These</span><span class='token pointer' id='tok-70-871'>payloads</span><span class='token pointer' id='tok-70-872'>also</span><span class='token pointer' id='tok-70-874' style='color:red'>work fine when</span><span class='token pointer' id='tok-70-875'>are</span><span class='token pointer' id='tok-70-876'>executed</span><span class='token pointer' id='tok-70-877'>on</span><span class='token pointer' id='tok-70-878' style='color:red'>Victim's</span><span class='token pointer' id='tok-70-879'>machines.</span></p><p id=p880><span class='token pointer' id='tok-70-880'>Following</span><span class='token pointer' id='tok-70-881'>figure</span><span class='token pointer' id='tok-70-882'>shows</span><span class='token pointer' id='tok-70-883'>a</span><span class='token pointer' id='tok-70-884'>meterpreter</span><span class='token pointer' id='tok-70-885'>shell</span><span class='token pointer' id='tok-70-886'>obtained</span><span class='token pointer' id='tok-70-887'>using</span><span class='token pointer' id='tok-70-888'>the</span><span class='token pointer' id='tok-70-889'>payload</span><span class='token pointer' id='tok-70-890'>created</span><span class='token pointer' id='tok-70-891'>above.</span></p><p id=p892><span class='token pointer' id='tok-70-892'>Try</span><span class='token pointer' id='tok-70-893'>with</span><span class='token pointer' id='tok-70-894'>other</span><span class='token pointer' id='tok-70-895'>payloads</span><span class='token pointer' id='tok-70-896'>that</span><span class='token pointer' id='tok-70-897'>use</span><span class='token pointer' id='tok-70-898'>encryption</span><span class='token pointer' id='tok-70-899'>to</span><span class='token pointer' id='tok-70-900'>get</span><span class='token pointer' id='tok-70-901'>better</span><span class='token pointer' id='tok-70-902'>output.</span></p><p id=p903><span class='token pointer' id='tok-70-903'>This</span><span class='token pointer' id='tok-70-904'>script</span><span class='token pointer' id='tok-70-905'>automates</span><span class='token pointer' id='tok-70-906'>multiple</span><span class='token pointer' id='tok-70-907'>tricks</span><span class='token pointer' id='tok-70-908'>to</span><span class='token pointer' id='tok-70-909' style='color:red'>evade</span><span class='token pointer' id='tok-70-910'>AVs.</span><span class='token pointer' id='tok-70-911'>The</span><span class='token pointer' id='tok-70-912'>author</span><span class='token pointer' id='tok-70-913'>has</span><span class='token pointer' id='tok-70-914'>written</span><span class='token pointer' id='tok-70-915'>this</span><span class='token pointer' id='tok-70-916' style='color:red'>for</span><span class='token pointer' id='tok-70-917'>his</span><span class='token pointer' id='tok-70-918'>own</span><span class='token pointer' id='tok-70-919'>purposes</span><span class='token pointer' id='tok-70-920'>and</span><span class='token pointer' id='tok-70-921'>he</span><span class='token pointer' id='tok-70-922'>released</span><span class='token pointer' id='tok-70-923'>it</span><span class='token pointer' id='tok-70-924'>publicly</span><span class='token pointer' id='tok-70-925'>as</span><span class='token pointer' id='tok-70-926'>a</span><span class='token pointer' id='tok-70-927'>beta</span><span class='token pointer' id='tok-70-928'>version.</span><span class='token pointer' id='tok-70-929'>This</span><span class='token pointer' id='tok-70-930'>script</span><span class='token pointer' id='tok-70-931'>gives</span><span class='token pointer' id='tok-70-932'>us</span><span class='token pointer' id='tok-70-933'>an</span><span class='token pointer' id='tok-70-934'>idea</span><span class='token pointer' id='tok-70-935'>of</span><span class='token pointer' id='tok-70-936'>how</span><span class='token pointer' id='tok-70-937'>we</span><span class='token pointer' id='tok-70-938' style='color:red'>can</span><span class='token pointer' id='tok-70-939'>write</span><span class='token pointer' id='tok-70-940'>our</span><span class='token pointer' id='tok-70-941'>own</span><span class='token pointer' id='tok-70-942'>scripts</span><span class='token pointer' id='tok-70-943'>to</span><span class='token pointer' id='tok-70-944'>evade</span><span class='token pointer' id='tok-70-945'>Antiviruses.</span></p><p id=p946><span class='token pointer' id='tok-70-946'>Let's</span><span class='token pointer' id='tok-70-947'>see</span><span class='token pointer' id='tok-70-948'>this</span><span class='token pointer' id='tok-70-949'>in</span><span class='token pointer' id='tok-70-950'>action.</span></p><p id=p951><span class='token pointer' id='tok-70-951'>I</span><span class='token pointer' id='tok-70-952'>am</span><span class='token pointer' id='tok-70-953' style='color:red'>going</span><span class='token pointer' id='tok-70-954'>to</span><span class='token pointer' id='tok-70-955'>create</span><span class='token pointer' id='tok-70-956' style='color:red'>a</span><span class='token pointer' id='tok-70-957'>meterpreter</span><span class='token pointer' id='tok-70-958'>payload</span><span class='token pointer' id='tok-70-959'>using</span><span class='token pointer' id='tok-70-960'>msfvenom</span><span class='token pointer' id='tok-70-961'>for</span><span class='token pointer' id='tok-70-962'>this</span><span class='token pointer' id='tok-70-963'>purpose.</span><span class='token pointer' id='tok-70-964'>This</span><span class='token pointer' id='tok-70-965'>is</span><span class='token pointer' id='tok-70-966'>shown</span><span class='token pointer' id='tok-70-967'>below.</span></p><p id=p968><span class='token pointer' id='tok-70-968'>Let</span><span class='token pointer' id='tok-70-969'>us</span><span class='token pointer' id='tok-70-970'>scan</span><span class='token pointer' id='tok-70-971'>the</span><span class='token pointer' id='tok-70-972'>payload</span><span class='token pointer' id='tok-70-973'>"test.exe"</span><span class='token pointer' id='tok-70-974'>through</span><span class='token pointer' id='tok-70-975'>virustotal.com</span><span class='token pointer' id='tok-70-976'>as</span><span class='token pointer' id='tok-70-977'>shown</span><span class='token pointer' id='tok-70-978'>below.</span></p><p id=p979><span class='token pointer' id='tok-70-979'>36</span><span class='token pointer' id='tok-70-980'>out</span><span class='token pointer' id='tok-70-981'>of</span><span class='token pointer' id='tok-70-982'>56</span><span class='token pointer' id='tok-70-983'>antivirus</span><span class='token pointer' id='tok-70-984'>engines</span><span class='token pointer' id='tok-70-985'>have</span><span class='token pointer' id='tok-70-986'>flagged</span><span class='token pointer' id='tok-70-987'>this</span><span class='token pointer' id='tok-70-988'>as</span><span class='token pointer' id='tok-70-989'>malicious.</span></p><p id=p990><span class='token pointer' id='tok-70-990'>Now,</span><span class='token pointer' id='tok-70-991'>lets</span><span class='token pointer' id='tok-70-992'>run</span><span class='token pointer' id='tok-70-993'>this</span><span class='token pointer' id='tok-70-994'>using</span><span class='token pointer' id='tok-70-995'>peCloak.py</span><span class='token pointer' id='tok-70-996'>script.</span></p><p id=p997><span class='token pointer' id='tok-70-997'>I</span><span class='token pointer' id='tok-70-998'>am</span><span class='token pointer' id='tok-70-999'>using</span><span class='token pointer' id='tok-70-1000'>the</span><span class='token pointer' id='tok-70-1001'>script</span><span class='token pointer' id='tok-70-1002'>with</span><span class='token pointer' id='tok-70-1003'>the</span><span class='token pointer' id='tok-70-1004'>default</span><span class='token pointer' id='tok-70-1005'>options.</span></p><p id=p1006><span class='token pointer' id='tok-70-1006'>It</span><span class='token pointer' id='tok-70-1007'>creates</span><span class='token pointer' id='tok-70-1008'>a</span><span class='token pointer' id='tok-70-1009'>file</span><span class='token pointer' id='tok-70-1010'>called</span><span class='token pointer' id='tok-70-1011'>"cloaked.exe".</span></p><p id=p1012><span class='token pointer' id='tok-70-1012'>Let's</span><span class='token pointer' id='tok-70-1013'>scan</span><span class='token pointer' id='tok-70-1014'>this</span><span class='token pointer' id='tok-70-1015' style='color:red'>new</span><span class='token pointer' id='tok-70-1016'>payload</span><span class='token pointer' id='tok-70-1017'>and</span><span class='token pointer' id='tok-70-1018'>see</span><span class='token pointer' id='tok-70-1019'>how</span><span class='token pointer' id='tok-70-1020'>many</span><span class='token pointer' id='tok-70-1021'>antivirus</span><span class='token pointer' id='tok-70-1022'>engines</span><span class='token pointer' id='tok-70-1023'>detect</span><span class='token pointer' id='tok-70-1024'>is</span><span class='token pointer' id='tok-70-1025'>as</span><span class='token pointer' id='tok-70-1026'>malicious.</span></p><p id=p1027><span class='token pointer' id='tok-70-1027'>Only</span><span class='token pointer' id='tok-70-1028'>26</span><span class='token pointer' id='tok-70-1029'>out</span><span class='token pointer' id='tok-70-1030'>of</span><span class='token pointer' id='tok-70-1031'>56</span><span class='token pointer' id='tok-70-1032'>have</span><span class='token pointer' id='tok-70-1033'>flagged</span><span class='token pointer' id='tok-70-1034' style='color:red'>it</span><span class='token pointer' id='tok-70-1035'>as</span><span class='token pointer' id='tok-70-1036'>malicious.</span></p><p id=p1037><span class='token pointer' id='tok-70-1037'>Conclusion:</span><span class='token pointer' id='tok-70-1038'>Apart</span><span class='token pointer' id='tok-70-1039'>from</span><span class='token pointer' id='tok-70-1040'>the</span><span class='token pointer' id='tok-70-1041'>tools</span><span class='token pointer' id='tok-70-1042'>mentioned</span><span class='token pointer' id='tok-70-1043'>in</span><span class='token pointer' id='tok-70-1044'>this</span><span class='token pointer' id='tok-70-1045'>article,</span><span class='token pointer' id='tok-70-1046'>there</span><span class='token pointer' id='tok-70-1047'>are</span><span class='token pointer' id='tok-70-1048'>a</span><span class='token pointer' id='tok-70-1049'>couple</span><span class='token pointer' id='tok-70-1050'>of</span><span class='token pointer' id='tok-70-1051'>other</span><span class='token pointer' id='tok-70-1052'>tools</span><span class='token pointer' id='tok-70-1053'>out</span><span class='token pointer' id='tok-70-1054'>there</span><span class='token pointer' id='tok-70-1055'>such</span><span class='token pointer' id='tok-70-1056'>as</span><span class='token pointer' id='tok-70-1057'>Metasploit's</span><span class='token pointer' id='tok-70-1058'>encoders.</span><span class='token pointer' id='tok-70-1059'>It</span><span class='token pointer' id='tok-70-1060'>is</span><span class='token pointer' id='tok-70-1061'>better</span><span class='token pointer' id='tok-70-1062'>to</span><span class='token pointer' id='tok-70-1063'>write</span><span class='token pointer' id='tok-70-1064'>custom</span><span class='token pointer' id='tok-70-1065'>payloads</span><span class='token pointer' id='tok-70-1066'>and</span><span class='token pointer' id='tok-70-1067'>keep</span><span class='token pointer' id='tok-70-1068'>them</span><span class='token pointer' id='tok-70-1069' style='color:red'>simple</span><span class='token pointer' id='tok-70-1070'>to</span><span class='token pointer' id='tok-70-1071'>be</span><span class='token pointer' id='tok-70-1072'>away</span><span class='token pointer' id='tok-70-1073'>from</span><span class='token pointer' id='tok-70-1074'>Antivirus</span><span class='token pointer' id='tok-70-1075'>detection</span><span class='token pointer' id='tok-70-1076'>rather</span><span class='token pointer' id='tok-70-1077'>than</span><span class='token pointer' id='tok-70-1078'>creating</span><span class='token pointer' id='tok-70-1079'>payloads</span><span class='token pointer' id='tok-70-1080'>using</span><span class='token pointer' id='tok-70-1081'>popular</span><span class='token pointer' id='tok-70-1082'>frameworks.</span><span class='token pointer' id='tok-70-1083'>A</span><span class='token pointer' id='tok-70-1084'>side</span><span class='token pointer' id='tok-70-1085'>note:</span><span class='token pointer' id='tok-70-1086'>The</span><span class='token pointer' id='tok-70-1087'>results</span><span class='token pointer' id='tok-70-1088'>shown</span><span class='token pointer' id='tok-70-1089'>in</span><span class='token pointer' id='tok-70-1090'>this</span><span class='token pointer' id='tok-70-1091'>article</span><span class='token pointer' id='tok-70-1092'>may</span><span class='token pointer' id='tok-70-1093' style='color:red'>change</span><span class='token pointer' id='tok-70-1094'>when</span><span class='token pointer' id='tok-70-1095'>you</span><span class='token pointer' id='tok-70-1096'>read</span><span class='token pointer' id='tok-70-1097'>this</span><span class='token pointer' id='tok-70-1098'>article</span><span class='token pointer' id='tok-70-1099'>as</span><span class='token pointer' id='tok-70-1100'>Antivirus</span><span class='token pointer' id='tok-70-1101'></span><span class='token pointer' id='tok-70-1102'></span><span class='token pointer' id='tok-70-1103'></span><span class='token pointer' id='tok-70-1104'></span></p>