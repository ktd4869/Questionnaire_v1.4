<p id=p0>We hosted the <span class='token pointer' id='tok-78-0' style='color:red'>VM</span>in <span class='token pointer' id='tok-78-1' style='color:red'>box</span><span class='token pointer' id='tok-78-2' style='color:red'>virtual</span>opened the system's IP from our browser, and we found a <span class='token pointer' id='tok-78-3' style='color:red'>application</span><span class='token pointer' id='tok-78-4' style='color:red'>web</span>on it. </p><p id=p24>This web application is running on a <span class='token pointer' id='tok-78-5' style='color:red'>machine;</span><span class='token pointer' id='tok-78-6' style='color:red'>virtual</span>designed to simulate a simple E-Commerce style website which is purposely vulnerable to some well know security issues commonly seen in <span class='token pointer' id='tok-78-7' style='color:red'>web applications.</span>this <span class='token pointer' id='tok-78-8' style='color:red'>web app</span>vulnerable to the following vulnerabilities: </p><p id=p67><span class='token pointer' id='tok-78-9' style='color:red'>Injection</span><span class='token pointer' id='tok-78-10' style='color:red'>(Error-based)SQL Injection</span><span class='token pointer' id='tok-78-11' style='color:red'>phpinfo()Exposed</span><span class='token pointer' id='tok-78-12' style='color:red'>Direct-Object ReferenceWe</span>look for more issues apart from the listed ones. </p><p id=p95><span class='token pointer' id='tok-78-13' style='color:red'>Injection(Error-based):</span><span class='token pointer' id='tok-78-14' style='color:red'>SQL</span>looking <span class='token pointer' id='tok-78-15' style='color:red'>injection</span><span class='token pointer' id='tok-78-16' style='color:red'>SQL</span>start from very basic discovery by adding single quotes in every parameter. We noticed that in the login page if we are adding a single quote in username parameter it throws a SQL error message which was a very obvious sign of error based SQL injection. </p><p id=p148>We took this post request and sent it to <span class='token pointer' id='tok-78-17' style='color:red'>SQLmap</span>for dumping the <span class='token pointer' id='tok-78-18' style='color:red'>database</span>by using the following <span class='token pointer' id='tok-78-19' style='color:red'>command:</span><span class='token pointer' id='tok-78-20' style='color:red'>Sqlmap.py</span>–r r.txt –dbs –dbms=Mysql </p><p id=p172>As can be seen above SQLmap has identified 4 databases. </p><p id=p182>After running SQLmap, we successfully dumped the tblMembers table from seattle database. </p><p id=p194>As can be seen above the Admin password is not hashed, and we were able to login into the application by using this password. </p><p id=p218>SQL Injection (Blind): The blind SQL injection was actually time-based injection. We found this <span class='token pointer' id='tok-78-21' style='color:red'>vulnerability</span>on the same login post request where we found the <span class='token pointer' id='tok-78-22' style='color:red'>error based injection.</span>password parameter was not throwing any SQL error messages in the response, but it was reacting when we were sending <span class='token pointer' id='tok-78-23' style='color:red'>SLEEP queries</span>the server. By crafting a <span class='token pointer' id='tok-78-24' style='color:red'>SLEEP based payload,</span>were able to bypass the login screen which means it was vulnerable to SQL injection. </p><p id=p294>We ran SQLmap by using the following command: <span class='token pointer' id='tok-78-25' style='color:red'>sqlmap.py</span>-r r.txt –dbs –dbms=Mysql –level=5 –user-agent="random" </p><p id=p309>As can be seen above SQLmap was able to detect the time-based SQL injection. </p><p id=p323><span class='token pointer' id='tok-78-26' style='color:red'>Cross-SiteScripting:</span><span class='token pointer' id='tok-78-27' style='color:red'>Reflected</span>looking <span class='token pointer' id='tok-78-28' style='color:red'>XSS</span>issues, we have first to find out the areas in the application where it takes inputs values or parameter values which reflect in the <span class='token pointer' id='tok-78-29' style='color:red'>HTML</span>response. After logging into the application we found a blog page where it was showing all <span class='token pointer' id='tok-78-30' style='color:red'>blog posts</span>by Admin user in the URL there was an author parameter which holds an integer value of 1 that id value is associated with Admin username we just simply added an <span class='token pointer' id='tok-78-31' style='color:red'>XSS script</span>the author parameter and it <span class='token pointer' id='tok-78-32' style='color:red'>executed</span>in the browser. </p><p id=p415>Thus the script is not getting saved in the database so it will execute only once. </p><p id=p431><span class='token pointer' id='tok-78-33' style='color:red'>Stored Cross-SiteScripting:</span>looking stored XSS the concept is same as reflected XSS we have to look for areas where application is accepting user input values, and then it's showing the values in response, but in the stored XSS it could happen that application asks for user input in different page and the saved results are showing on different pages. In this application in the <span class='token pointer' id='tok-78-34' style='color:red'>blog area,</span>is an option of the <span class='token pointer' id='tok-78-35' style='color:red'>blog post</span>we added our same <span class='token pointer' id='tok-78-36' style='color:red'>JavaScript</span>in the blog post area and submitted the form. </p><p id=p521>When we submitted the blog post, the script doesn't get executed on the same page because the blog post was published on a different page, so when we visited the post area our submitted script executed on that page. </p><p id=p560><span class='token pointer' id='tok-78-37' style='color:red'>Enumeration:</span><span class='token pointer' id='tok-78-38' style='color:red'>User</span>use of user <span class='token pointer' id='tok-78-39' style='color:red'>enumeration</span>is to find out the correct usernames from the application database by analyzing the correct and incorrect error messages on the login page. </p><p id=p590>As can be seen in below image when we supplied a wrong username and password the application throws a message that <span class='token pointer' id='tok-78-40' style='color:red'>"invalid</span>username." </p><p id=p613>The error message is too obvious that it's indicating clearly that this username is wrong and it doesn't exist in the database. While browsing the application in blog area, we found the admin username. </p><p id=p647>We tried login by using the admin username now this time the application throws a different message that "invalid password" it means this username is valid and it </p><p id=p679><span class='token pointer' id='tok-78-41' style='color:red'>Traversal:</span><span class='token pointer' id='tok-78-42' style='color:red'>Path</span><span class='token pointer' id='tok-78-43' style='color:red'>path traversal vulnerability</span>an attacker to access files on your web server to which they should not have access. They do this by tricking either the web server or the web application running on it into returning files that exist outside of the web root folder. The application has a functionality of downloading pdf brochure from the site. </p><p id=p741>By sending the ../ characters in item parameter has caused include() to traverse to the root directory, and then include the <span class='token pointer' id='tok-78-44' style='color:red'>Unix</span>password file /etc/passwd. </p><p id=p766><span class='token pointer' id='tok-78-45' style='color:red'>phpinfo:</span><span class='token pointer' id='tok-78-46' style='color:red'>Exposed</span>official PHP documentation makes a recommendation to create a file that calls the phpinfo() function to test that the PHP installation was successful; it is a common mistake to forget to remove this file. The information leaked by the phpinfo() function includes <span class='token pointer' id='tok-78-47' style='color:red'>environment variables,</span>the full PHP configuration settings. For finding this file we <span class='token pointer' id='tok-78-48' style='color:red'>Dirbuster tool</span>is a </p><p id=p833><span class='token pointer' id='tok-78-49' style='color:red'>Ethical Hacking Training</span>Resources <span class='token pointer' id='tok-78-50' style='color:red'>(InfoSec)</span></p><p id=p839>We found a file called info.php we opened the file, and we found the <span class='token pointer' id='tok-78-51' style='color:red'>PHPinfo</span>page. </p><p id=p855>Exposed Administrative Interface: In some application, we found that admin section is accessible without login or by using a normal user session. In this application also we found the admin directory from the dirbuster tool but when we tried to access <span class='token pointer' id='tok-78-52' style='color:red'>admin.phpfile</span>it was redirecting to login page. </p><p id=p903>We <span class='token pointer' id='tok-78-53' style='color:red'>logged</span>into the application and then tried to open the admin.php file, and we were able to view the <span class='token pointer' id='tok-78-54' style='color:red'>admin functionalities</span>that page. </p><p id=p928><span class='token pointer' id='tok-78-55' style='color:red'>Weak Admin Credentials:</span>have already found the admin credential by exploiting the SQL injection the password Assassin1 which is a dictionary based password, and it can be brute forced. </p><p id=p958><span class='token pointer' id='tok-78-56' style='color:red'>Insecure Direct Object References:</span>Direct Object References occur when an application provides direct access to objects based on user-supplied input. As a result of this vulnerability, attackers can bypass authorization and access resources in the system directly, for example, <span class='token pointer' id='tok-78-57' style='color:red'>database records</span>files. In this application, the impact of this vulnerability is not severe because it's leaking only usernames. In the blog post are when we are fuzzing the author parameter it will reveal all usernames which exist in the database since there is only one user Admin is available on the application so it's showing only admin's username. </p><p id=p1057>Apart from the listed vulnerability there are some other medium, and low-risk vulnerabilities are there such as user login credential is transmitted in <span class='token pointer' id='tok-78-58' style='color:red'>plain text</span><span class='token pointer' id='tok-78-59' style='color:red'>HTTP</span>request which will result to <span class='token pointer' id='tok-78-60' style='color:red'>MITM</span>attack, <span class='token pointer' id='tok-78-61' style='color:red'>user session cookie</span>static which can lead to <span class='token pointer' id='tok-78-62' style='color:red'>CAPTCHA</span><span class='token pointer' id='tok-78-63' style='color:red'>account hijack,</span><span class='token pointer' id='tok-78-64' style='color:red'>rate limiting</span>not implemented on login page which will results in <span class='token pointer' id='tok-78-65' style='color:red'>Bruteforce attack,</span>directory is browsable, session cookie is not protected from HttpOnly flag. </p><p id=p1130>      </p>