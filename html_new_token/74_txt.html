<p id=p0><span class='token pointer' id='tok-74-0'>In</span><span class='token pointer' id='tok-74-1'>this</span><span class='token pointer' id='tok-74-2'>article,</span><span class='token pointer' id='tok-74-3'>we</span><span class='token pointer' id='tok-74-4'>will</span><span class='token pointer' id='tok-74-5'>a</span><span class='token pointer' id='tok-74-6'>have</span><span class='token pointer' id='tok-74-7'>a</span><span class='token pointer' id='tok-74-8'>look</span><span class='token pointer' id='tok-74-9'>at</span><span class='token pointer' id='tok-74-10' style='color:red'>automating</span><span class='token pointer' id='tok-74-11'>certain</span><span class='token pointer' id='tok-74-12'>tasks</span><span class='token pointer' id='tok-74-13'>on</span><span class='token pointer' id='tok-74-14'>windows</span><span class='token pointer' id='tok-74-15'>to</span><span class='token pointer' id='tok-74-16' style='color:red'>escalate</span><span class='token pointer' id='tok-74-17'>our</span><span class='token pointer' id='tok-74-18' style='color:red'>privileges</span><span class='token pointer' id='tok-74-19'>and</span><span class='token pointer' id='tok-74-20'>gain</span><span class='token pointer' id='tok-74-21' style='color:red'>access</span><span class='token pointer' id='tok-74-22'>to</span><span class='token pointer' id='tok-74-23'>the</span><span class='token pointer' id='tok-74-24' style='color:red'>system.</span></p><p id=p25><span class='token pointer' id='tok-74-25'>Introduction:</span><span class='token pointer' id='tok-74-26' style='color:red'>Privilege</span><span class='token pointer' id='tok-74-27' style='color:red'>Escalation</span><span class='token pointer' id='tok-74-28'>on</span><span class='token pointer' id='tok-74-29'>any</span><span class='token pointer' id='tok-74-30'>system</span><span class='token pointer' id='tok-74-31'>mainly</span><span class='token pointer' id='tok-74-32'>involves</span><span class='token pointer' id='tok-74-33'>a</span><span class='token pointer' id='tok-74-34'>lot</span><span class='token pointer' id='tok-74-35'>of</span><span class='token pointer' id='tok-74-36'>information</span><span class='token pointer' id='tok-74-37'>gathering</span><span class='token pointer' id='tok-74-38'>about</span><span class='token pointer' id='tok-74-39'>the</span><span class='token pointer' id='tok-74-40' style='color:red'>target host</span><span class='token pointer' id='tok-74-41' style='color:red'>further</span><span class='token pointer' id='tok-74-42'>includes</span><span class='token pointer' id='tok-74-43'>some</span><span class='token pointer' id='tok-74-44'>of</span><span class='token pointer' id='tok-74-45'>the</span><span class='token pointer' id='tok-74-46'>following</span><span class='token pointer' id='tok-74-47'>set</span><span class='token pointer' id='tok-74-48'>of</span><span class='token pointer' id='tok-74-49'>questions</span><span class='token pointer' id='tok-74-50'>that</span><span class='token pointer' id='tok-74-51'>a</span><span class='token pointer' id='tok-74-52' style='color:red'>penetration</span><span class='token pointer' id='tok-74-53' style='color:red'>tester</span><span class='token pointer' id='tok-74-54'>needs</span><span class='token pointer' id='tok-74-55'>to</span><span class='token pointer' id='tok-74-56'>cover:</span></p><p id=p57><span class='token pointer' id='tok-74-57'>What</span><span class='token pointer' id='tok-74-58' style='color:red'>version</span><span class='token pointer' id='tok-74-59'>of</span><span class='token pointer' id='tok-74-60' style='color:red'>operating</span><span class='token pointer' id='tok-74-61'>system</span><span class='token pointer' id='tok-74-62'>is</span><span class='token pointer' id='tok-74-63'>being</span><span class='token pointer' id='tok-74-64' style='color:red'>installed</span><span class='token pointer' id='tok-74-65'>on</span><span class='token pointer' id='tok-74-66'>the</span><span class='token pointer' id='tok-74-67' style='color:red'>host?Is</span><span class='token pointer' id='tok-74-68'>there</span><span class='token pointer' id='tok-74-69'>any</span><span class='token pointer' id='tok-74-70' style='color:red'>vulnerable</span><span class='token pointer' id='tok-74-71' style='color:red'>package</span><span class='token pointer' id='tok-74-72'>installed</span><span class='token pointer' id='tok-74-73'>or</span><span class='token pointer' id='tok-74-74' style='color:red'>running?</span><span class='token pointer' id='tok-74-75'>What</span><span class='token pointer' id='tok-74-76'>type</span><span class='token pointer' id='tok-74-77'>of</span><span class='token pointer' id='tok-74-78' style='color:red'>services</span><span class='token pointer' id='tok-74-79'>are</span><span class='token pointer' id='tok-74-80'>running</span><span class='token pointer' id='tok-74-81'>on</span><span class='token pointer' id='tok-74-82'>the</span><span class='token pointer' id='tok-74-83'>system</span><span class='token pointer' id='tok-74-84'>and</span><span class='token pointer' id='tok-74-85'>whether</span><span class='token pointer' id='tok-74-86'>they</span><span class='token pointer' id='tok-74-87'>are</span><span class='token pointer' id='tok-74-88' style='color:red'>configured</span><span class='token pointer' id='tok-74-89'>properly</span><span class='token pointer' id='tok-74-90'>or</span><span class='token pointer' id='tok-74-91'>not</span><span class='token pointer' id='tok-74-92'>from</span><span class='token pointer' id='tok-74-93'>the</span><span class='token pointer' id='tok-74-94' style='color:red'>security</span><span class='token pointer' id='tok-74-95'>point</span><span class='token pointer' id='tok-74-96'>of</span><span class='token pointer' id='tok-74-97'>view?</span><span class='token pointer' id='tok-74-98'>How</span><span class='token pointer' id='tok-74-99'>the</span><span class='token pointer' id='tok-74-100' style='color:red'>user</span><span class='token pointer' id='tok-74-101'>roles</span><span class='token pointer' id='tok-74-102'>are</span><span class='token pointer' id='tok-74-103'>being</span><span class='token pointer' id='tok-74-104' style='color:red'>segregated?How</span><span class='token pointer' id='tok-74-105'>the</span><span class='token pointer' id='tok-74-106' style='color:red'>permissions</span><span class='token pointer' id='tok-74-107' style='color:red'>file system</span><span class='token pointer' id='tok-74-108'>being</span><span class='token pointer' id='tok-74-109'>assigned</span><span class='token pointer' id='tok-74-110'>to</span><span class='token pointer' id='tok-74-111'>different</span><span class='token pointer' id='tok-74-112' style='color:red'>user roles?Is</span><span class='token pointer' id='tok-74-113'>is</span><span class='token pointer' id='tok-74-114'>any</span><span class='token pointer' id='tok-74-115' style='color:red'>configuration/password</span><span class='token pointer' id='tok-74-116'>files</span><span class='token pointer' id='tok-74-117'>stored</span><span class='token pointer' id='tok-74-118'>on</span><span class='token pointer' id='tok-74-119'>the</span><span class='token pointer' id='tok-74-120'>system?</span><span class='token pointer' id='tok-74-121'>Is</span><span class='token pointer' id='tok-74-122'>there</span><span class='token pointer' id='tok-74-123'>any</span><span class='token pointer' id='tok-74-124' style='color:red'>misconfigured</span><span class='token pointer' id='tok-74-125' style='color:red'>CRON</span><span class='token pointer' id='tok-74-126'>jobs/Scheduled</span><span class='token pointer' id='tok-74-127'>Tasks</span><span class='token pointer' id='tok-74-128'>running</span><span class='token pointer' id='tok-74-129'>on</span><span class='token pointer' id='tok-74-130'>the</span><span class='token pointer' id='tok-74-131' style='color:red'>system?By</span><span class='token pointer' id='tok-74-132'>answering</span><span class='token pointer' id='tok-74-133'>above</span><span class='token pointer' id='tok-74-134'>and</span><span class='token pointer' id='tok-74-135'>many</span><span class='token pointer' id='tok-74-136'>other</span><span class='token pointer' id='tok-74-137'>questions</span><span class='token pointer' id='tok-74-138'>depending</span><span class='token pointer' id='tok-74-139'>on</span><span class='token pointer' id='tok-74-140'>the</span><span class='token pointer' id='tok-74-141'>situations</span><span class='token pointer' id='tok-74-142'>and</span><span class='token pointer' id='tok-74-143'>availability</span><span class='token pointer' id='tok-74-144'>one</span><span class='token pointer' id='tok-74-145'>can</span><span class='token pointer' id='tok-74-146'>certainly</span><span class='token pointer' id='tok-74-147'>escalate</span><span class='token pointer' id='tok-74-148'>his/her</span><span class='token pointer' id='tok-74-149'>privileges</span><span class='token pointer' id='tok-74-150'>from</span><span class='token pointer' id='tok-74-151'>a</span><span class='token pointer' id='tok-74-152' style='color:red'>normal user</span><span class='token pointer' id='tok-74-153' style='color:red'>high privileged user.</span><span class='token pointer' id='tok-74-154'>we</span><span class='token pointer' id='tok-74-155'>can</span><span class='token pointer' id='tok-74-156'>see,</span><span class='token pointer' id='tok-74-157'>there</span><span class='token pointer' id='tok-74-158'>is</span><span class='token pointer' id='tok-74-159'>a</span><span class='token pointer' id='tok-74-160'>lot</span><span class='token pointer' id='tok-74-161'>of</span><span class='token pointer' id='tok-74-162'>information</span><span class='token pointer' id='tok-74-163'>one</span><span class='token pointer' id='tok-74-164'>needs</span><span class='token pointer' id='tok-74-165'>to</span><span class='token pointer' id='tok-74-166'>gather</span><span class='token pointer' id='tok-74-167'>which</span><span class='token pointer' id='tok-74-168'>directly</span><span class='token pointer' id='tok-74-169'>means</span><span class='token pointer' id='tok-74-170'>there</span><span class='token pointer' id='tok-74-171'>are</span><span class='token pointer' id='tok-74-172'>a</span><span class='token pointer' id='tok-74-173'>lot</span><span class='token pointer' id='tok-74-174'>of</span><span class='token pointer' id='tok-74-175'>manual</span><span class='token pointer' id='tok-74-176'>checks</span><span class='token pointer' id='tok-74-177'>we</span><span class='token pointer' id='tok-74-178'>need</span><span class='token pointer' id='tok-74-179'>to</span><span class='token pointer' id='tok-74-180'>perform</span><span class='token pointer' id='tok-74-181'>to</span><span class='token pointer' id='tok-74-182'>escalate</span><span class='token pointer' id='tok-74-183'>our</span><span class='token pointer' id='tok-74-184'>privileges</span><span class='token pointer' id='tok-74-185'>successfully.</span><span class='token pointer' id='tok-74-186'>So,</span><span class='token pointer' id='tok-74-187'>automating</span><span class='token pointer' id='tok-74-188'>certain</span><span class='token pointer' id='tok-74-189'>tasks</span><span class='token pointer' id='tok-74-190'>will</span><span class='token pointer' id='tok-74-191'>save</span><span class='token pointer' id='tok-74-192'>some</span><span class='token pointer' id='tok-74-193'>time</span><span class='token pointer' id='tok-74-194'>and</span><span class='token pointer' id='tok-74-195'>give</span><span class='token pointer' id='tok-74-196'>an</span><span class='token pointer' id='tok-74-197'>added</span><span class='token pointer' id='tok-74-198'>advantage</span><span class='token pointer' id='tok-74-199'>to</span><span class='token pointer' id='tok-74-200'>any</span><span class='token pointer' id='tok-74-201'>penetration</span><span class='token pointer' id='tok-74-202'>tester.</span></p><p id=p203><span class='token pointer' id='tok-74-203'>The</span><span class='token pointer' id='tok-74-204' style='color:red'>test bed/software</span><span class='token pointer' id='tok-74-205'>to</span><span class='token pointer' id='tok-74-206'>test</span><span class='token pointer' id='tok-74-207'>our</span><span class='token pointer' id='tok-74-208' style='color:red'>tool</span><span class='token pointer' id='tok-74-209'>can</span><span class='token pointer' id='tok-74-210'>be</span><span class='token pointer' id='tok-74-211' style='color:red'>downloaded</span><span class='token pointer' id='tok-74-212'>from</span><span class='token pointer' id='tok-74-213'>here.</span><span class='token pointer' id='tok-74-214'>Also,</span><span class='token pointer' id='tok-74-215'>the</span><span class='token pointer' id='tok-74-216'>required</span><span class='token pointer' id='tok-74-217'>package</span><span class='token pointer' id='tok-74-218'>for</span><span class='token pointer' id='tok-74-219' style='color:red'>python</span><span class='token pointer' id='tok-74-220'>can</span><span class='token pointer' id='tok-74-221'>be</span><span class='token pointer' id='tok-74-222'>installed</span><span class='token pointer' id='tok-74-223'>using</span><span class='token pointer' id='tok-74-224'>the</span><span class='token pointer' id='tok-74-225'>following</span><span class='token pointer' id='tok-74-226'>command:</span></p><p id=p227><span class='token pointer' id='tok-74-227' style='color:red'>pip</span><span class='token pointer' id='tok-74-228' style='color:red'>install</span><span class='token pointer' id='tok-74-229' style='color:red'>wmi</span></p><p id=p230><span class='token pointer' id='tok-74-230' style='color:red'>We</span><span class='token pointer' id='tok-74-231'>will</span><span class='token pointer' id='tok-74-232'>be</span><span class='token pointer' id='tok-74-233'>automating</span><span class='token pointer' id='tok-74-234'>following</span><span class='token pointer' id='tok-74-235'>tasks</span><span class='token pointer' id='tok-74-236'>using</span><span class='token pointer' id='tok-74-237' style='color:red'>Python</span></p><p id=p238><span class='token pointer' id='tok-74-238'>Unquoted</span><span class='token pointer' id='tok-74-239'>Service</span><span class='token pointer' id='tok-74-240' style='color:red'>Paths.Misconfigured</span><span class='token pointer' id='tok-74-241' style='color:red'>Permission</span><span class='token pointer' id='tok-74-242'>for</span><span class='token pointer' id='tok-74-243'>Service</span><span class='token pointer' id='tok-74-244' style='color:red'>Executables.Misconfigured</span><span class='token pointer' id='tok-74-245' style='color:red'>MSI</span><span class='token pointer' id='tok-74-246' style='color:red'>registry</span><span class='token pointer' id='tok-74-247'>entries.Unquoted</span><span class='token pointer' id='tok-74-248'>Service</span><span class='token pointer' id='tok-74-249'>Paths:Before</span><span class='token pointer' id='tok-74-250'>proceeding</span><span class='token pointer' id='tok-74-251'>with</span><span class='token pointer' id='tok-74-252'>understanding</span><span class='token pointer' id='tok-74-253'>the</span><span class='token pointer' id='tok-74-254' style='color:red'>code</span><span class='token pointer' id='tok-74-255'>use</span><span class='token pointer' id='tok-74-256'>to</span><span class='token pointer' id='tok-74-257'>automate</span><span class='token pointer' id='tok-74-258'>this</span><span class='token pointer' id='tok-74-259'>task,</span><span class='token pointer' id='tok-74-260'>we</span><span class='token pointer' id='tok-74-261'>need</span><span class='token pointer' id='tok-74-262'>to</span><span class='token pointer' id='tok-74-263'>understand</span><span class='token pointer' id='tok-74-264'>how</span><span class='token pointer' id='tok-74-265'>we</span><span class='token pointer' id='tok-74-266'>can</span><span class='token pointer' id='tok-74-267' style='color:red'>exploit</span><span class='token pointer' id='tok-74-268' style='color:red'>unquoted</span><span class='token pointer' id='tok-74-269' style='color:red'>service</span><span class='token pointer' id='tok-74-270' style='color:red'>path</span><span class='token pointer' id='tok-74-271' style='color:red'>vulnerabilities.</span><span class='token pointer' id='tok-74-272'>This</span><span class='token pointer' id='tok-74-273'>mainly</span><span class='token pointer' id='tok-74-274'>involves</span><span class='token pointer' id='tok-74-275'>how</span><span class='token pointer' id='tok-74-276' style='color:red'>Windows</span><span class='token pointer' id='tok-74-277' style='color:red'>interpret</span><span class='token pointer' id='tok-74-278'>the</span><span class='token pointer' id='tok-74-279' style='color:red'>executable</span><span class='token pointer' id='tok-74-280'>path</span><span class='token pointer' id='tok-74-281'>of</span><span class='token pointer' id='tok-74-282'>service</span><span class='token pointer' id='tok-74-283'>before</span><span class='token pointer' id='tok-74-284'>starting</span><span class='token pointer' id='tok-74-285'>it.</span><span class='token pointer' id='tok-74-286'>For</span><span class='token pointer' id='tok-74-287'>example:</span></p><p id=p288><span class='token pointer' id='tok-74-288'>Let</span><span class='token pointer' id='tok-74-289'>us</span><span class='token pointer' id='tok-74-290' style='color:red'>execute</span><span class='token pointer' id='tok-74-291'>a</span><span class='token pointer' id='tok-74-292'>test</span><span class='token pointer' id='tok-74-293' style='color:red'>program/script</span><span class='token pointer' id='tok-74-294'>using</span><span class='token pointer' id='tok-74-295'>command</span><span class='token pointer' id='tok-74-296'>prompt</span><span class='token pointer' id='tok-74-297'>by</span><span class='token pointer' id='tok-74-298'>providing</span><span class='token pointer' id='tok-74-299'>a</span><span class='token pointer' id='tok-74-300'>path</span><span class='token pointer' id='tok-74-301'>to</span><span class='token pointer' id='tok-74-302'>the</span><span class='token pointer' id='tok-74-303'>executable.</span></p><p id=p304><span class='token pointer' id='tok-74-304'>As</span><span class='token pointer' id='tok-74-305'>we</span><span class='token pointer' id='tok-74-306'>can</span><span class='token pointer' id='tok-74-307'>see</span><span class='token pointer' id='tok-74-308'>that</span><span class='token pointer' id='tok-74-309'>our</span><span class='token pointer' id='tok-74-310' style='color:red'>helloworld</span><span class='token pointer' id='tok-74-311' style='color:red'>program</span><span class='token pointer' id='tok-74-312'>executes</span><span class='token pointer' id='tok-74-313'>successfully</span><span class='token pointer' id='tok-74-314'>when</span><span class='token pointer' id='tok-74-315'>placed</span><span class='token pointer' id='tok-74-316'>in</span><span class='token pointer' id='tok-74-317'>a</span><span class='token pointer' id='tok-74-318'>folder</span><span class='token pointer' id='tok-74-319'>without</span><span class='token pointer' id='tok-74-320'>space.</span><span class='token pointer' id='tok-74-321'>So,</span><span class='token pointer' id='tok-74-322'>what</span><span class='token pointer' id='tok-74-323'>happen</span><span class='token pointer' id='tok-74-324'>with</span><span class='token pointer' id='tok-74-325'>a</span><span class='token pointer' id='tok-74-326'>folder</span><span class='token pointer' id='tok-74-327'>with</span><span class='token pointer' id='tok-74-328'>space?</span></p><p id=p329><span class='token pointer' id='tok-74-329'>As</span><span class='token pointer' id='tok-74-330'>can</span><span class='token pointer' id='tok-74-331'>be</span><span class='token pointer' id='tok-74-332'>seen,</span><span class='token pointer' id='tok-74-333'>there</span><span class='token pointer' id='tok-74-334'>is</span><span class='token pointer' id='tok-74-335'>a</span><span class='token pointer' id='tok-74-336' style='color:red'>helloworld.exe</span><span class='token pointer' id='tok-74-337'>file</span><span class='token pointer' id='tok-74-338'>in</span><span class='token pointer' id='tok-74-339'>the</span><span class='token pointer' id='tok-74-340'>folder</span><span class='token pointer' id='tok-74-341'>with</span><span class='token pointer' id='tok-74-342'>space.</span><span class='token pointer' id='tok-74-343'>So,</span><span class='token pointer' id='tok-74-344'>to</span><span class='token pointer' id='tok-74-345'>execute</span><span class='token pointer' id='tok-74-346'>that</span><span class='token pointer' id='tok-74-347'>we</span><span class='token pointer' id='tok-74-348'>simply</span><span class='token pointer' id='tok-74-349'>change</span><span class='token pointer' id='tok-74-350'>our</span><span class='token pointer' id='tok-74-351'>directory</span><span class='token pointer' id='tok-74-352'>by</span><span class='token pointer' id='tok-74-353'>providing</span><span class='token pointer' id='tok-74-354'>quotes</span><span class='token pointer' id='tok-74-355'>around</span><span class='token pointer' id='tok-74-356'>folder</span><span class='token pointer' id='tok-74-357'>name.</span><span class='token pointer' id='tok-74-358'>Now</span><span class='token pointer' id='tok-74-359'>the</span><span class='token pointer' id='tok-74-360'>question</span><span class='token pointer' id='tok-74-361'>arises</span><span class='token pointer' id='tok-74-362'>how</span><span class='token pointer' id='tok-74-363'>we</span><span class='token pointer' id='tok-74-364'>can</span><span class='token pointer' id='tok-74-365'>exploit</span><span class='token pointer' id='tok-74-366'>this</span><span class='token pointer' id='tok-74-367'>behavior</span><span class='token pointer' id='tok-74-368'>of</span><span class='token pointer' id='tok-74-369'>Windows.</span></p><p id=p370><span class='token pointer' id='tok-74-370'>As</span><span class='token pointer' id='tok-74-371'>can</span><span class='token pointer' id='tok-74-372'>be</span><span class='token pointer' id='tok-74-373'>seen,</span><span class='token pointer' id='tok-74-374'>in</span><span class='token pointer' id='tok-74-375'>first</span><span class='token pointer' id='tok-74-376'>image</span><span class='token pointer' id='tok-74-377'>window</span><span class='token pointer' id='tok-74-378'>treats</span><span class='token pointer' id='tok-74-379'>the</span><span class='token pointer' id='tok-74-380'>folder</span><span class='token pointer' id='tok-74-381'>name</span><span class='token pointer' id='tok-74-382'>with</span><span class='token pointer' id='tok-74-383'>space</span><span class='token pointer' id='tok-74-384'>as</span><span class='token pointer' id='tok-74-385'>an</span><span class='token pointer' id='tok-74-386'>executable</span><span class='token pointer' id='tok-74-387'>and</span><span class='token pointer' id='tok-74-388'>throws</span><span class='token pointer' id='tok-74-389'>us</span><span class='token pointer' id='tok-74-390'>an</span><span class='token pointer' id='tok-74-391'>error</span><span class='token pointer' id='tok-74-392'>saying</span><span class='token pointer' id='tok-74-393'>"folder</span><span class='token pointer' id='tok-74-394'>is</span><span class='token pointer' id='tok-74-395'>not</span><span class='token pointer' id='tok-74-396' style='color:red'>recognized</span><span class='token pointer' id='tok-74-397'>as</span><span class='token pointer' id='tok-74-398'>internal</span><span class='token pointer' id='tok-74-399'>or</span><span class='token pointer' id='tok-74-400'>external</span><span class='token pointer' id='tok-74-401' style='color:red'>command/executable/batch</span><span class='token pointer' id='tok-74-402'>file."</span><span class='token pointer' id='tok-74-403'>So,</span><span class='token pointer' id='tok-74-404'>this</span><span class='token pointer' id='tok-74-405'>means</span><span class='token pointer' id='tok-74-406'>if</span><span class='token pointer' id='tok-74-407'>we</span><span class='token pointer' id='tok-74-408'>put</span><span class='token pointer' id='tok-74-409'>an</span><span class='token pointer' id='tok-74-410'>executable</span><span class='token pointer' id='tok-74-411'>with</span><span class='token pointer' id='tok-74-412'>the</span><span class='token pointer' id='tok-74-413'>name</span><span class='token pointer' id='tok-74-414'>as</span><span class='token pointer' id='tok-74-415' style='color:red'>folder.exe</span><span class='token pointer' id='tok-74-416'>it</span><span class='token pointer' id='tok-74-417'>should</span><span class='token pointer' id='tok-74-418'>get</span><span class='token pointer' id='tok-74-419'>execute</span><span class='token pointer' id='tok-74-420'>when</span><span class='token pointer' id='tok-74-421'>the</span><span class='token pointer' id='tok-74-422'>user</span><span class='token pointer' id='tok-74-423'>calls</span><span class='token pointer' id='tok-74-424'>the</span><span class='token pointer' id='tok-74-425'>program</span><span class='token pointer' id='tok-74-426'>path</span><span class='token pointer' id='tok-74-427'>without</span><span class='token pointer' id='tok-74-428'>spaces.</span></p><p id=p429><span class='token pointer' id='tok-74-429'>We</span><span class='token pointer' id='tok-74-430'>first</span><span class='token pointer' id='tok-74-431'>tried</span><span class='token pointer' id='tok-74-432'>to</span><span class='token pointer' id='tok-74-433'>execute</span><span class='token pointer' id='tok-74-434'>our</span><span class='token pointer' id='tok-74-435'>program</span><span class='token pointer' id='tok-74-436'>without</span><span class='token pointer' id='tok-74-437'>space.</span><span class='token pointer' id='tok-74-438'>Further,</span><span class='token pointer' id='tok-74-439'>we</span><span class='token pointer' id='tok-74-440'>copied</span><span class='token pointer' id='tok-74-441'>the</span><span class='token pointer' id='tok-74-442'>same</span><span class='token pointer' id='tok-74-443'>program</span><span class='token pointer' id='tok-74-444'>to</span><span class='token pointer' id='tok-74-445'>desktop</span><span class='token pointer' id='tok-74-446'>folder</span><span class='token pointer' id='tok-74-447'>with</span><span class='token pointer' id='tok-74-448'>name</span><span class='token pointer' id='tok-74-449'>folder.exe</span><span class='token pointer' id='tok-74-450'>and</span><span class='token pointer' id='tok-74-451'>deleted</span><span class='token pointer' id='tok-74-452'>our</span><span class='token pointer' id='tok-74-453'>program</span><span class='token pointer' id='tok-74-454'>from</span><span class='token pointer' id='tok-74-455'>the</span><span class='token pointer' id='tok-74-456'>older</span><span class='token pointer' id='tok-74-457'>path</span><span class='token pointer' id='tok-74-458'>to</span><span class='token pointer' id='tok-74-459'>be</span><span class='token pointer' id='tok-74-460'>sure</span><span class='token pointer' id='tok-74-461'>only</span><span class='token pointer' id='tok-74-462'>planted</span><span class='token pointer' id='tok-74-463'>binary</span><span class='token pointer' id='tok-74-464'>gets</span><span class='token pointer' id='tok-74-465'>executed.</span></p><p id=p466><span class='token pointer' id='tok-74-466'>Windows</span><span class='token pointer' id='tok-74-467' style='color:red'>now</span><span class='token pointer' id='tok-74-468'>execute</span><span class='token pointer' id='tok-74-469'>our</span><span class='token pointer' id='tok-74-470'>binary</span><span class='token pointer' id='tok-74-471'>planted</span><span class='token pointer' id='tok-74-472'>with</span><span class='token pointer' id='tok-74-473'>the</span><span class='token pointer' id='tok-74-474'>name</span><span class='token pointer' id='tok-74-475'>of</span><span class='token pointer' id='tok-74-476'>folder.exe.</span></p><p id=p477><span class='token pointer' id='tok-74-477'>So,</span><span class='token pointer' id='tok-74-478'>we</span><span class='token pointer' id='tok-74-479'>will</span><span class='token pointer' id='tok-74-480'>be</span><span class='token pointer' id='tok-74-481'>automating</span><span class='token pointer' id='tok-74-482'>this</span><span class='token pointer' id='tok-74-483'>process</span><span class='token pointer' id='tok-74-484'>by</span><span class='token pointer' id='tok-74-485'>telling</span><span class='token pointer' id='tok-74-486'>our</span><span class='token pointer' id='tok-74-487'>program</span><span class='token pointer' id='tok-74-488'>to</span><span class='token pointer' id='tok-74-489' style='color:red'>iterate</span><span class='token pointer' id='tok-74-490'>over</span><span class='token pointer' id='tok-74-491'>the</span><span class='token pointer' id='tok-74-492' style='color:red'>service paths</span><span class='token pointer' id='tok-74-493'>show</span><span class='token pointer' id='tok-74-494'>us</span><span class='token pointer' id='tok-74-495'>which</span><span class='token pointer' id='tok-74-496'>service</span><span class='token pointer' id='tok-74-497'>paths</span><span class='token pointer' id='tok-74-498'>are</span><span class='token pointer' id='tok-74-499'>unquoted.</span></p><p id=p500><span class='token pointer' id='tok-74-500'>In</span><span class='token pointer' id='tok-74-501'>our</span><span class='token pointer' id='tok-74-502'>code,</span><span class='token pointer' id='tok-74-503'>we</span><span class='token pointer' id='tok-74-504'>first</span><span class='token pointer' id='tok-74-505'>defined</span><span class='token pointer' id='tok-74-506'>a</span><span class='token pointer' id='tok-74-507'>WMI</span><span class='token pointer' id='tok-74-508'>object,</span><span class='token pointer' id='tok-74-509'>select</span><span class='token pointer' id='tok-74-510'>everything</span><span class='token pointer' id='tok-74-511'>from</span><span class='token pointer' id='tok-74-512' style='color:red'>Win32_Service</span><span class='token pointer' id='tok-74-513'>class</span><span class='token pointer' id='tok-74-514'>and</span><span class='token pointer' id='tok-74-515'>iterate</span><span class='token pointer' id='tok-74-516'>over</span><span class='token pointer' id='tok-74-517'>it</span><span class='token pointer' id='tok-74-518'>to</span><span class='token pointer' id='tok-74-519'>get</span><span class='token pointer' id='tok-74-520'>all</span><span class='token pointer' id='tok-74-521'>service</span><span class='token pointer' id='tok-74-522'>paths.</span><span class='token pointer' id='tok-74-523'>We</span><span class='token pointer' id='tok-74-524'>further</span><span class='token pointer' id='tok-74-525'>check</span><span class='token pointer' id='tok-74-526'>if</span><span class='token pointer' id='tok-74-527'>the</span><span class='token pointer' id='tok-74-528'>path</span><span class='token pointer' id='tok-74-529'>does</span><span class='token pointer' id='tok-74-530'>not</span><span class='token pointer' id='tok-74-531'>contain</span><span class='token pointer' id='tok-74-532'>any</span><span class='token pointer' id='tok-74-533'>quotes</span><span class='token pointer' id='tok-74-534'>if</span><span class='token pointer' id='tok-74-535'>our</span><span class='token pointer' id='tok-74-536'>condition</span><span class='token pointer' id='tok-74-537'>satisfies</span><span class='token pointer' id='tok-74-538'>we</span><span class='token pointer' id='tok-74-539'>add</span><span class='token pointer' id='tok-74-540'>that</span><span class='token pointer' id='tok-74-541'>path</span><span class='token pointer' id='tok-74-542'>to</span><span class='token pointer' id='tok-74-543'>our</span><span class='token pointer' id='tok-74-544'>dictionary</span><span class='token pointer' id='tok-74-545'>by</span><span class='token pointer' id='tok-74-546'>keeping</span><span class='token pointer' id='tok-74-547'>service</span><span class='token pointer' id='tok-74-548'>name</span><span class='token pointer' id='tok-74-549'>as</span><span class='token pointer' id='tok-74-550'>a</span><span class='token pointer' id='tok-74-551'>key</span><span class='token pointer' id='tok-74-552'>name.</span></p><p id=p553><span class='token pointer' id='tok-74-553'>We</span><span class='token pointer' id='tok-74-554'>further</span><span class='token pointer' id='tok-74-555'>check</span><span class='token pointer' id='tok-74-556'>if</span><span class='token pointer' id='tok-74-557'>there</span><span class='token pointer' id='tok-74-558'>are</span><span class='token pointer' id='tok-74-559'>any</span><span class='token pointer' id='tok-74-560'>service</span><span class='token pointer' id='tok-74-561'>paths</span><span class='token pointer' id='tok-74-562'>identified</span><span class='token pointer' id='tok-74-563'>and</span><span class='token pointer' id='tok-74-564'>iterate</span><span class='token pointer' id='tok-74-565'>over</span><span class='token pointer' id='tok-74-566'>our</span><span class='token pointer' id='tok-74-567'>dictionary</span><span class='token pointer' id='tok-74-568'>to</span><span class='token pointer' id='tok-74-569' style='color:red'>display</span><span class='token pointer' id='tok-74-570'>the</span><span class='token pointer' id='tok-74-571' style='color:red'>values.</span></p><p id=p572><span class='token pointer' id='tok-74-572'>We</span><span class='token pointer' id='tok-74-573'>will</span><span class='token pointer' id='tok-74-574'>be</span><span class='token pointer' id='tok-74-575'>adding</span><span class='token pointer' id='tok-74-576'>the</span><span class='token pointer' id='tok-74-577'>above</span><span class='token pointer' id='tok-74-578'>code</span><span class='token pointer' id='tok-74-579' style='color:red'>snippets</span><span class='token pointer' id='tok-74-580'>to</span><span class='token pointer' id='tok-74-581'>our</span><span class='token pointer' id='tok-74-582'>final</span><span class='token pointer' id='tok-74-583'>program.</span></p><p id=p584><span class='token pointer' id='tok-74-584' style='color:red'>Misconfigured</span><span class='token pointer' id='tok-74-585'>Permission</span><span class='token pointer' id='tok-74-586'>for</span><span class='token pointer' id='tok-74-587'>Service</span><span class='token pointer' id='tok-74-588'>ExecutablesThe</span><span class='token pointer' id='tok-74-589'>second</span><span class='token pointer' id='tok-74-590'>part</span><span class='token pointer' id='tok-74-591'>of</span><span class='token pointer' id='tok-74-592'>the</span><span class='token pointer' id='tok-74-593'>program</span><span class='token pointer' id='tok-74-594'>includes</span><span class='token pointer' id='tok-74-595'>checking</span><span class='token pointer' id='tok-74-596'>the</span><span class='token pointer' id='tok-74-597'>permission</span><span class='token pointer' id='tok-74-598'>of</span><span class='token pointer' id='tok-74-599' style='color:red'>service executables.</span><span class='token pointer' id='tok-74-600'>means</span><span class='token pointer' id='tok-74-601'>if</span><span class='token pointer' id='tok-74-602'>any</span><span class='token pointer' id='tok-74-603'>low</span><span class='token pointer' id='tok-74-604'>privileged</span><span class='token pointer' id='tok-74-605'>user</span><span class='token pointer' id='tok-74-606'>can</span><span class='token pointer' id='tok-74-607'>modify/write/replace</span><span class='token pointer' id='tok-74-608'>the</span><span class='token pointer' id='tok-74-609'>executable</span><span class='token pointer' id='tok-74-610'>with</span><span class='token pointer' id='tok-74-611'>his</span><span class='token pointer' id='tok-74-612' style='color:red'>code/executable.</span><span class='token pointer' id='tok-74-613'>Next</span><span class='token pointer' id='tok-74-614'>time</span><span class='token pointer' id='tok-74-615'>when</span><span class='token pointer' id='tok-74-616'>the</span><span class='token pointer' id='tok-74-617'>service</span><span class='token pointer' id='tok-74-618'>starts</span><span class='token pointer' id='tok-74-619' style='color:red'>malicious</span><span class='token pointer' id='tok-74-620'>code</span><span class='token pointer' id='tok-74-621'>will</span><span class='token pointer' id='tok-74-622'>get</span><span class='token pointer' id='tok-74-623'>executed</span><span class='token pointer' id='tok-74-624'>as</span><span class='token pointer' id='tok-74-625'>a</span><span class='token pointer' id='tok-74-626'>system.</span></p><p id=p627><span class='token pointer' id='tok-74-627'>In</span><span class='token pointer' id='tok-74-628'>this</span><span class='token pointer' id='tok-74-629'>case,</span><span class='token pointer' id='tok-74-630'>we</span><span class='token pointer' id='tok-74-631'>will</span><span class='token pointer' id='tok-74-632'>be</span><span class='token pointer' id='tok-74-633'>using</span><span class='token pointer' id='tok-74-634' style='color:red'>"icacls"</span><span class='token pointer' id='tok-74-635' style='color:red'>utility</span><span class='token pointer' id='tok-74-636'>of</span><span class='token pointer' id='tok-74-637'>windows</span><span class='token pointer' id='tok-74-638'>to</span><span class='token pointer' id='tok-74-639'>find</span><span class='token pointer' id='tok-74-640'>out</span><span class='token pointer' id='tok-74-641'>permission</span><span class='token pointer' id='tok-74-642'>of</span><span class='token pointer' id='tok-74-643'>all</span><span class='token pointer' id='tok-74-644'>service</span><span class='token pointer' id='tok-74-645'>executables.</span><span class='token pointer' id='tok-74-646'>Moreover,</span><span class='token pointer' id='tok-74-647'>list</span><span class='token pointer' id='tok-74-648'>down</span><span class='token pointer' id='tok-74-649'>the</span><span class='token pointer' id='tok-74-650'>ones</span><span class='token pointer' id='tok-74-651'>in</span><span class='token pointer' id='tok-74-652'>which</span><span class='token pointer' id='tok-74-653'>any</span><span class='token pointer' id='tok-74-654'>user</span><span class='token pointer' id='tok-74-655'>has</span><span class='token pointer' id='tok-74-656'>full</span><span class='token pointer' id='tok-74-657'>access</span><span class='token pointer' id='tok-74-658'>to</span><span class='token pointer' id='tok-74-659'>the</span><span class='token pointer' id='tok-74-660'>executable.</span></p><p id=p661><span class='token pointer' id='tok-74-661'>As</span><span class='token pointer' id='tok-74-662'>can</span><span class='token pointer' id='tok-74-663'>be</span><span class='token pointer' id='tok-74-664'>seen,</span><span class='token pointer' id='tok-74-665'>we</span><span class='token pointer' id='tok-74-666'>have</span><span class='token pointer' id='tok-74-667'>used</span><span class='token pointer' id='tok-74-668'>the</span><span class='token pointer' id='tok-74-669' style='color:red'>output</span><span class='token pointer' id='tok-74-670'>of</span><span class='token pointer' id='tok-74-671' style='color:red'>wmi query</span><span class='token pointer' id='tok-74-672'>our</span><span class='token pointer' id='tok-74-673'>previous</span><span class='token pointer' id='tok-74-674'>section</span><span class='token pointer' id='tok-74-675'>of</span><span class='token pointer' id='tok-74-676'>code</span><span class='token pointer' id='tok-74-677'>and</span><span class='token pointer' id='tok-74-678'>added</span><span class='token pointer' id='tok-74-679'>found</span><span class='token pointer' id='tok-74-680'>executable</span><span class='token pointer' id='tok-74-681'>files</span><span class='token pointer' id='tok-74-682'>in</span><span class='token pointer' id='tok-74-683'>a</span><span class='token pointer' id='tok-74-684'>Python</span><span class='token pointer' id='tok-74-685'>list.</span></p><p id=p686><span class='token pointer' id='tok-74-686'>We</span><span class='token pointer' id='tok-74-687'>will</span><span class='token pointer' id='tok-74-688'>now</span><span class='token pointer' id='tok-74-689'>feed</span><span class='token pointer' id='tok-74-690'>the</span><span class='token pointer' id='tok-74-691'>executable</span><span class='token pointer' id='tok-74-692'>path</span><span class='token pointer' id='tok-74-693'>to</span><span class='token pointer' id='tok-74-694'>icacls</span><span class='token pointer' id='tok-74-695'>utility</span><span class='token pointer' id='tok-74-696'>to</span><span class='token pointer' id='tok-74-697'>get</span><span class='token pointer' id='tok-74-698'>the</span><span class='token pointer' id='tok-74-699'>permission</span><span class='token pointer' id='tok-74-700'>info</span><span class='token pointer' id='tok-74-701'>of</span><span class='token pointer' id='tok-74-702'>executable</span><span class='token pointer' id='tok-74-703'>and</span><span class='token pointer' id='tok-74-704'>parse</span><span class='token pointer' id='tok-74-705'>the</span><span class='token pointer' id='tok-74-706'>output</span><span class='token pointer' id='tok-74-707'>using</span><span class='token pointer' id='tok-74-708'>the</span><span class='token pointer' id='tok-74-709' style='color:red'>find_paths</span><span class='token pointer' id='tok-74-710'>function.</span></p><p id=p711><span class='token pointer' id='tok-74-711'>Ethical</span><span class='token pointer' id='tok-74-712'>Hacking</span><span class='token pointer' id='tok-74-713'>Training</span><span class='token pointer' id='tok-74-714'>â€“</span><span class='token pointer' id='tok-74-715'>Resources</span><span class='token pointer' id='tok-74-716'>(InfoSec)</span></p><p id=p717><span class='token pointer' id='tok-74-717'>The</span><span class='token pointer' id='tok-74-718'>find_paths</span><span class='token pointer' id='tok-74-719'>function</span><span class='token pointer' id='tok-74-720'>match</span><span class='token pointer' id='tok-74-721'>the</span><span class='token pointer' id='tok-74-722'>permission</span><span class='token pointer' id='tok-74-723'>info</span><span class='token pointer' id='tok-74-724'>of</span><span class='token pointer' id='tok-74-725'>executable</span><span class='token pointer' id='tok-74-726'>with</span><span class='token pointer' id='tok-74-727' style='color:red'>predefined</span><span class='token pointer' id='tok-74-728'>values</span><span class='token pointer' id='tok-74-729'>and</span><span class='token pointer' id='tok-74-730'>prints</span><span class='token pointer' id='tok-74-731'>out</span><span class='token pointer' id='tok-74-732'>if</span><span class='token pointer' id='tok-74-733'>any</span><span class='token pointer' id='tok-74-734'>match</span><span class='token pointer' id='tok-74-735'>is</span><span class='token pointer' id='tok-74-736'>found.</span></p><p id=p737><span class='token pointer' id='tok-74-737'>Misconfigured</span><span class='token pointer' id='tok-74-738'>MSI</span><span class='token pointer' id='tok-74-739'>registry</span><span class='token pointer' id='tok-74-740'>entriesWindows</span><span class='token pointer' id='tok-74-741'>has</span><span class='token pointer' id='tok-74-742'>this</span><span class='token pointer' id='tok-74-743' style='color:red'>configuration</span><span class='token pointer' id='tok-74-744'>which</span><span class='token pointer' id='tok-74-745'>if</span><span class='token pointer' id='tok-74-746'>set</span><span class='token pointer' id='tok-74-747'>allows</span><span class='token pointer' id='tok-74-748'>any</span><span class='token pointer' id='tok-74-749'>user</span><span class='token pointer' id='tok-74-750'>to</span><span class='token pointer' id='tok-74-751'>run</span><span class='token pointer' id='tok-74-752'>MSI</span><span class='token pointer' id='tok-74-753'>(Microsoft</span><span class='token pointer' id='tok-74-754' style='color:red'>Installers)</span><span class='token pointer' id='tok-74-755'>with</span><span class='token pointer' id='tok-74-756'>SYSTEM</span><span class='token pointer' id='tok-74-757'>privileges.</span><span class='token pointer' id='tok-74-758'>This</span><span class='token pointer' id='tok-74-759'>involves</span><span class='token pointer' id='tok-74-760'>checking</span><span class='token pointer' id='tok-74-761'>the</span><span class='token pointer' id='tok-74-762' style='color:red'>true</span><span class='token pointer' id='tok-74-763'>value</span><span class='token pointer' id='tok-74-764'>for</span><span class='token pointer' id='tok-74-765'>a</span><span class='token pointer' id='tok-74-766' style='color:red'>32-bit</span><span class='token pointer' id='tok-74-767' style='color:red'>dword</span><span class='token pointer' id='tok-74-768'>named</span><span class='token pointer' id='tok-74-769'>"AlwaysInstallElevated".</span></p><p id=p770><span class='token pointer' id='tok-74-770'>This</span><span class='token pointer' id='tok-74-771'>will</span><span class='token pointer' id='tok-74-772'>be</span><span class='token pointer' id='tok-74-773'>our</span><span class='token pointer' id='tok-74-774'>last</span><span class='token pointer' id='tok-74-775'>addition</span><span class='token pointer' id='tok-74-776'>to</span><span class='token pointer' id='tok-74-777'>the</span><span class='token pointer' id='tok-74-778'>program,</span><span class='token pointer' id='tok-74-779'>in</span><span class='token pointer' id='tok-74-780'>this</span><span class='token pointer' id='tok-74-781'>case,</span><span class='token pointer' id='tok-74-782'>we</span><span class='token pointer' id='tok-74-783'>will</span><span class='token pointer' id='tok-74-784'>be</span><span class='token pointer' id='tok-74-785'>using</span><span class='token pointer' id='tok-74-786'>inbuilt</span><span class='token pointer' id='tok-74-787' style='color:red'>python's</span><span class='token pointer' id='tok-74-788'>module</span><span class='token pointer' id='tok-74-789'>named</span><span class='token pointer' id='tok-74-790' style='color:red'>"_winreg"</span><span class='token pointer' id='tok-74-791'>to</span><span class='token pointer' id='tok-74-792'>fetch</span><span class='token pointer' id='tok-74-793'>out</span><span class='token pointer' id='tok-74-794'>the</span><span class='token pointer' id='tok-74-795'>registry</span><span class='token pointer' id='tok-74-796'>entries.</span></p><p id=p797><span class='token pointer' id='tok-74-797'>We</span><span class='token pointer' id='tok-74-798'>open</span><span class='token pointer' id='tok-74-799'>the</span><span class='token pointer' id='tok-74-800'>registry</span><span class='token pointer' id='tok-74-801'>keys</span><span class='token pointer' id='tok-74-802'>using</span><span class='token pointer' id='tok-74-803' style='color:red'>OpenKey</span><span class='token pointer' id='tok-74-804'>function</span><span class='token pointer' id='tok-74-805'>and</span><span class='token pointer' id='tok-74-806'>enum</span><span class='token pointer' id='tok-74-807'>the</span><span class='token pointer' id='tok-74-808'>first</span><span class='token pointer' id='tok-74-809'>dword</span><span class='token pointer' id='tok-74-810'>value.</span><span class='token pointer' id='tok-74-811'>We</span><span class='token pointer' id='tok-74-812'>further</span><span class='token pointer' id='tok-74-813'>verify</span><span class='token pointer' id='tok-74-814'>whether</span><span class='token pointer' id='tok-74-815'>both</span><span class='token pointer' id='tok-74-816'>registry</span><span class='token pointer' id='tok-74-817'>keys</span><span class='token pointer' id='tok-74-818'>are</span><span class='token pointer' id='tok-74-819'>set</span><span class='token pointer' id='tok-74-820'>to</span><span class='token pointer' id='tok-74-821'>true.</span></p><p id=p822><span class='token pointer' id='tok-74-822'>If</span><span class='token pointer' id='tok-74-823'>both</span><span class='token pointer' id='tok-74-824'>registry</span><span class='token pointer' id='tok-74-825'>keys</span><span class='token pointer' id='tok-74-826'>exist</span><span class='token pointer' id='tok-74-827'>and</span><span class='token pointer' id='tok-74-828'>dword</span><span class='token pointer' id='tok-74-829'>values</span><span class='token pointer' id='tok-74-830'>are</span><span class='token pointer' id='tok-74-831'>set,</span><span class='token pointer' id='tok-74-832'>we</span><span class='token pointer' id='tok-74-833'>display</span><span class='token pointer' id='tok-74-834'>the</span><span class='token pointer' id='tok-74-835'>following</span><span class='token pointer' id='tok-74-836'>message</span><span class='token pointer' id='tok-74-837'>to</span><span class='token pointer' id='tok-74-838'>the</span><span class='token pointer' id='tok-74-839'>user.</span></p><p id=p840><span class='token pointer' id='tok-74-840'>Let's</span><span class='token pointer' id='tok-74-841'>execute</span><span class='token pointer' id='tok-74-842'>our</span><span class='token pointer' id='tok-74-843'>complete</span><span class='token pointer' id='tok-74-844'>script</span><span class='token pointer' id='tok-74-845'>on</span><span class='token pointer' id='tok-74-846'>a</span><span class='token pointer' id='tok-74-847'>vulnerable</span><span class='token pointer' id='tok-74-848'>machine.</span><span class='token pointer' id='tok-74-849'>As</span><span class='token pointer' id='tok-74-850'>can</span><span class='token pointer' id='tok-74-851'>be</span><span class='token pointer' id='tok-74-852'>seen,</span><span class='token pointer' id='tok-74-853'>our</span><span class='token pointer' id='tok-74-854'>script</span><span class='token pointer' id='tok-74-855'>is</span><span class='token pointer' id='tok-74-856'>successfully</span><span class='token pointer' id='tok-74-857'>able</span><span class='token pointer' id='tok-74-858'>to</span><span class='token pointer' id='tok-74-859'>determine</span><span class='token pointer' id='tok-74-860'>the</span><span class='token pointer' id='tok-74-861'>mentioned</span><span class='token pointer' id='tok-74-862'>issues.</span><span class='token pointer' id='tok-74-863'>As</span><span class='token pointer' id='tok-74-864'>our</span><span class='token pointer' id='tok-74-865'>machine</span><span class='token pointer' id='tok-74-866'>is</span><span class='token pointer' id='tok-74-867'>not</span><span class='token pointer' id='tok-74-868'>vulnerable</span><span class='token pointer' id='tok-74-869'>to</span><span class='token pointer' id='tok-74-870'>the</span><span class='token pointer' id='tok-74-871'>third</span><span class='token pointer' id='tok-74-872'>issue,</span><span class='token pointer' id='tok-74-873'>I</span><span class='token pointer' id='tok-74-874'>encourage</span><span class='token pointer' id='tok-74-875'>a</span><span class='token pointer' id='tok-74-876'>diligent</span><span class='token pointer' id='tok-74-877'>reader</span><span class='token pointer' id='tok-74-878'>to</span><span class='token pointer' id='tok-74-879'>manually</span><span class='token pointer' id='tok-74-880'>create</span><span class='token pointer' id='tok-74-881'>those</span><span class='token pointer' id='tok-74-882'>registry</span><span class='token pointer' id='tok-74-883'>entries</span><span class='token pointer' id='tok-74-884'>and</span><span class='token pointer' id='tok-74-885'>execute</span><span class='token pointer' id='tok-74-886'>their</span><span class='token pointer' id='tok-74-887'>own</span><span class='token pointer' id='tok-74-888'>MSI</span><span class='token pointer' id='tok-74-889'>executable</span><span class='token pointer' id='tok-74-890'>using</span><span class='token pointer' id='tok-74-891' style='color:red'>msiexec</span><span class='token pointer' id='tok-74-892'>utility.</span></p><p id=p893><span class='token pointer' id='tok-74-893'>Hint:</span><span class='token pointer' id='tok-74-894'>We</span><span class='token pointer' id='tok-74-895'>can</span><span class='token pointer' id='tok-74-896'>generate</span><span class='token pointer' id='tok-74-897' style='color:red'>msi</span><span class='token pointer' id='tok-74-898'>files</span><span class='token pointer' id='tok-74-899'>using</span><span class='token pointer' id='tok-74-900' style='color:red'>msfvenom.
</span></p>