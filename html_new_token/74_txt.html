<p id=p0><span class='token pointer' id='tok-74-0'>In</span><span class='token pointer' id='tok-74-1'>this</span><span class='token pointer' id='tok-74-2'>article,</span><span class='token pointer' id='tok-74-3'>we</span><span class='token pointer' id='tok-74-4'>will</span><span class='token pointer' id='tok-74-5'>a</span><span class='token pointer' id='tok-74-6'>have</span><span class='token pointer' id='tok-74-7'>a</span><span class='token pointer' id='tok-74-8'>look</span><span class='token pointer' id='tok-74-9'>at</span><span class='token pointer' id='tok-74-10' style='color:red'>automating</span><span class='token pointer' id='tok-74-11'>certain</span><span class='token pointer' id='tok-74-12'>tasks</span><span class='token pointer' id='tok-74-13'>on</span><span class='token pointer' id='tok-74-14'>windows</span><span class='token pointer' id='tok-74-15'>to</span><span class='token pointer' id='tok-74-16' style='color:red'>escalate</span><span class='token pointer' id='tok-74-17'>our</span><span class='token pointer' id='tok-74-18' style='color:red'>privileges</span><span class='token pointer' id='tok-74-19'>and</span><span class='token pointer' id='tok-74-20'>gain</span><span class='token pointer' id='tok-74-21' style='color:red'>access</span><span class='token pointer' id='tok-74-22'>to</span><span class='token pointer' id='tok-74-23'>the</span><span class='token pointer' id='tok-74-24' style='color:red'>system.</span></p><p id=p25><span class='token pointer' id='tok-74-25'>Introduction:</span><span class='token pointer' id='tok-74-26' style='color:red'>Privilege</span><span class='token pointer' id='tok-74-27' style='color:red'>Escalation</span><span class='token pointer' id='tok-74-28'>on</span><span class='token pointer' id='tok-74-29'>any</span><span class='token pointer' id='tok-74-30'>system</span><span class='token pointer' id='tok-74-31'>mainly</span><span class='token pointer' id='tok-74-32'>involves</span><span class='token pointer' id='tok-74-33'>a</span><span class='token pointer' id='tok-74-34'>lot</span><span class='token pointer' id='tok-74-35'>of</span><span class='token pointer' id='tok-74-36'>information</span><span class='token pointer' id='tok-74-37'>gathering</span><span class='token pointer' id='tok-74-38'>about</span><span class='token pointer' id='tok-74-39'>the</span><span class='token pointer' id='tok-74-41' style='color:red'>host</span><span class='token pointer' id='tok-74-42' style='color:red'>target</span><span class='token pointer' id='tok-74-43' style='color:red'>further</span><span class='token pointer' id='tok-74-44'>includes</span><span class='token pointer' id='tok-74-45'>some</span><span class='token pointer' id='tok-74-46'>of</span><span class='token pointer' id='tok-74-47'>the</span><span class='token pointer' id='tok-74-48'>following</span><span class='token pointer' id='tok-74-49'>set</span><span class='token pointer' id='tok-74-50'>of</span><span class='token pointer' id='tok-74-51'>questions</span><span class='token pointer' id='tok-74-52'>that</span><span class='token pointer' id='tok-74-53'>a</span><span class='token pointer' id='tok-74-54' style='color:red'>penetration</span><span class='token pointer' id='tok-74-55' style='color:red'>tester</span><span class='token pointer' id='tok-74-56'>needs</span><span class='token pointer' id='tok-74-57'>to</span><span class='token pointer' id='tok-74-58'>cover:</span></p><p id=p59><span class='token pointer' id='tok-74-59'>What</span><span class='token pointer' id='tok-74-60' style='color:red'>version</span><span class='token pointer' id='tok-74-61'>of</span><span class='token pointer' id='tok-74-62' style='color:red'>operating</span><span class='token pointer' id='tok-74-63'>system</span><span class='token pointer' id='tok-74-64'>is</span><span class='token pointer' id='tok-74-65'>being</span><span class='token pointer' id='tok-74-66' style='color:red'>installed</span><span class='token pointer' id='tok-74-67'>on</span><span class='token pointer' id='tok-74-68'>the</span><span class='token pointer' id='tok-74-69' style='color:red'>host?Is</span><span class='token pointer' id='tok-74-70'>there</span><span class='token pointer' id='tok-74-71'>any</span><span class='token pointer' id='tok-74-72' style='color:red'>vulnerable</span><span class='token pointer' id='tok-74-73' style='color:red'>package</span><span class='token pointer' id='tok-74-74'>installed</span><span class='token pointer' id='tok-74-75'>or</span><span class='token pointer' id='tok-74-76' style='color:red'>running?</span><span class='token pointer' id='tok-74-77'>What</span><span class='token pointer' id='tok-74-78'>type</span><span class='token pointer' id='tok-74-79'>of</span><span class='token pointer' id='tok-74-80' style='color:red'>services</span><span class='token pointer' id='tok-74-81'>are</span><span class='token pointer' id='tok-74-82'>running</span><span class='token pointer' id='tok-74-83'>on</span><span class='token pointer' id='tok-74-84'>the</span><span class='token pointer' id='tok-74-85'>system</span><span class='token pointer' id='tok-74-86'>and</span><span class='token pointer' id='tok-74-87'>whether</span><span class='token pointer' id='tok-74-88'>they</span><span class='token pointer' id='tok-74-89'>are</span><span class='token pointer' id='tok-74-90' style='color:red'>configured</span><span class='token pointer' id='tok-74-91'>properly</span><span class='token pointer' id='tok-74-92'>or</span><span class='token pointer' id='tok-74-93'>not</span><span class='token pointer' id='tok-74-94'>from</span><span class='token pointer' id='tok-74-95'>the</span><span class='token pointer' id='tok-74-96' style='color:red'>security</span><span class='token pointer' id='tok-74-97'>point</span><span class='token pointer' id='tok-74-98'>of</span><span class='token pointer' id='tok-74-99'>view?</span><span class='token pointer' id='tok-74-100'>How</span><span class='token pointer' id='tok-74-101'>the</span><span class='token pointer' id='tok-74-102' style='color:red'>user</span><span class='token pointer' id='tok-74-103'>roles</span><span class='token pointer' id='tok-74-104'>are</span><span class='token pointer' id='tok-74-105'>being</span><span class='token pointer' id='tok-74-106' style='color:red'>segregated?How</span><span class='token pointer' id='tok-74-107'>the</span><span class='token pointer' id='tok-74-109' style='color:red'>file system</span><span class='token pointer' id='tok-74-110' style='color:red'>are</span><span class='token pointer' id='tok-74-111'>being</span><span class='token pointer' id='tok-74-112'>assigned</span><span class='token pointer' id='tok-74-113'>to</span><span class='token pointer' id='tok-74-114'>different</span><span class='token pointer' id='tok-74-115'>user</span><span class='token pointer' id='tok-74-117' style='color:red'>roles?Is there</span><span class='token pointer' id='tok-74-118'>any</span><span class='token pointer' id='tok-74-119'>configuration/password</span><span class='token pointer' id='tok-74-120'>files</span><span class='token pointer' id='tok-74-121' style='color:red'>stored</span><span class='token pointer' id='tok-74-122'>on</span><span class='token pointer' id='tok-74-123'>the</span><span class='token pointer' id='tok-74-124'>system?</span><span class='token pointer' id='tok-74-125'>Is</span><span class='token pointer' id='tok-74-126'>there</span><span class='token pointer' id='tok-74-127'>any</span><span class='token pointer' id='tok-74-128'>misconfigured</span><span class='token pointer' id='tok-74-129'>CRON</span><span class='token pointer' id='tok-74-130' style='color:red'>jobs/Scheduled</span><span class='token pointer' id='tok-74-131' style='color:red'>Tasks</span><span class='token pointer' id='tok-74-132'>running</span><span class='token pointer' id='tok-74-133'>on</span><span class='token pointer' id='tok-74-134'>the</span><span class='token pointer' id='tok-74-135'>system?By</span><span class='token pointer' id='tok-74-136'>answering</span><span class='token pointer' id='tok-74-137' style='color:red'>above</span><span class='token pointer' id='tok-74-138'>and</span><span class='token pointer' id='tok-74-139'>many</span><span class='token pointer' id='tok-74-140'>other</span><span class='token pointer' id='tok-74-141'>questions</span><span class='token pointer' id='tok-74-142'>depending</span><span class='token pointer' id='tok-74-143'>on</span><span class='token pointer' id='tok-74-144'>the</span><span class='token pointer' id='tok-74-145'>situations</span><span class='token pointer' id='tok-74-146'>and</span><span class='token pointer' id='tok-74-147'>availability</span><span class='token pointer' id='tok-74-148'>one</span><span class='token pointer' id='tok-74-149'>can</span><span class='token pointer' id='tok-74-150'>certainly</span><span class='token pointer' id='tok-74-151'>escalate</span><span class='token pointer' id='tok-74-152'>his/her</span><span class='token pointer' id='tok-74-153'>privileges</span><span class='token pointer' id='tok-74-154'>from</span><span class='token pointer' id='tok-74-155'>a</span><span class='token pointer' id='tok-74-156'>normal</span><span class='token pointer' id='tok-74-157'>user</span><span class='token pointer' id='tok-74-159' style='color:red'>to high</span><span class='token pointer' id='tok-74-160'>user.</span><span class='token pointer' id='tok-74-162' style='color:red'>we</span><span class='token pointer' id='tok-74-163' style='color:red'>As</span><span class='token pointer' id='tok-74-164'>see,</span><span class='token pointer' id='tok-74-165'>there</span><span class='token pointer' id='tok-74-166'>is</span><span class='token pointer' id='tok-74-167'>a</span><span class='token pointer' id='tok-74-168'>lot</span><span class='token pointer' id='tok-74-169'>of</span><span class='token pointer' id='tok-74-170'>information</span><span class='token pointer' id='tok-74-171'>one</span><span class='token pointer' id='tok-74-172'>needs</span><span class='token pointer' id='tok-74-173'>to</span><span class='token pointer' id='tok-74-174'>gather</span><span class='token pointer' id='tok-74-175'>which</span><span class='token pointer' id='tok-74-176'>directly</span><span class='token pointer' id='tok-74-177'>means</span><span class='token pointer' id='tok-74-178'>there</span><span class='token pointer' id='tok-74-179'>are</span><span class='token pointer' id='tok-74-180'>a</span><span class='token pointer' id='tok-74-181'>lot</span><span class='token pointer' id='tok-74-182'>of</span><span class='token pointer' id='tok-74-183'>manual</span><span class='token pointer' id='tok-74-184'>checks</span><span class='token pointer' id='tok-74-185'>we</span><span class='token pointer' id='tok-74-186'>need</span><span class='token pointer' id='tok-74-187'>to</span><span class='token pointer' id='tok-74-188'>perform</span><span class='token pointer' id='tok-74-189'>to</span><span class='token pointer' id='tok-74-190'>escalate</span><span class='token pointer' id='tok-74-191'>our</span><span class='token pointer' id='tok-74-192'>privileges</span><span class='token pointer' id='tok-74-193'>successfully.</span><span class='token pointer' id='tok-74-194'>So,</span><span class='token pointer' id='tok-74-195'>automating</span><span class='token pointer' id='tok-74-196'>certain</span><span class='token pointer' id='tok-74-197'>tasks</span><span class='token pointer' id='tok-74-198'>will</span><span class='token pointer' id='tok-74-199'>save</span><span class='token pointer' id='tok-74-200'>some</span><span class='token pointer' id='tok-74-201'>time</span><span class='token pointer' id='tok-74-202'>and</span><span class='token pointer' id='tok-74-203'>give</span><span class='token pointer' id='tok-74-204'>an</span><span class='token pointer' id='tok-74-205'>added</span><span class='token pointer' id='tok-74-206'>advantage</span><span class='token pointer' id='tok-74-207'>to</span><span class='token pointer' id='tok-74-208'>any</span><span class='token pointer' id='tok-74-209'>penetration</span><span class='token pointer' id='tok-74-210'>tester.</span></p><p id=p211><span class='token pointer' id='tok-74-211'>The</span><span class='token pointer' id='tok-74-212'>test</span><span class='token pointer' id='tok-74-213'>bed/software</span><span class='token pointer' id='tok-74-214'>use</span><span class='token pointer' id='tok-74-216' style='color:red'>to test</span><span class='token pointer' id='tok-74-217'>tool</span><span class='token pointer' id='tok-74-218'>can</span><span class='token pointer' id='tok-74-219'>be</span><span class='token pointer' id='tok-74-220'>downloaded</span><span class='token pointer' id='tok-74-221' style='color:red'>from</span><span class='token pointer' id='tok-74-222'>here.</span><span class='token pointer' id='tok-74-223'>Also,</span><span class='token pointer' id='tok-74-224' style='color:red'>the</span><span class='token pointer' id='tok-74-225'>required</span><span class='token pointer' id='tok-74-226'>package</span><span class='token pointer' id='tok-74-227'>for</span><span class='token pointer' id='tok-74-228'>python</span><span class='token pointer' id='tok-74-229'>can</span><span class='token pointer' id='tok-74-230'>be</span><span class='token pointer' id='tok-74-231'>installed</span><span class='token pointer' id='tok-74-232' style='color:red'>using</span><span class='token pointer' id='tok-74-233'>the</span><span class='token pointer' id='tok-74-234'>following</span><span class='token pointer' id='tok-74-235'>command:</span></p><p id=p236><span class='token pointer' id='tok-74-236'>pip</span><span class='token pointer' id='tok-74-237'>install</span><span class='token pointer' id='tok-74-238'>wmi</span></p><p id=p239><span class='token pointer' id='tok-74-239'>We</span><span class='token pointer' id='tok-74-240' style='color:red'>will</span><span class='token pointer' id='tok-74-241' style='color:red'>be</span><span class='token pointer' id='tok-74-242' style='color:red'>automating</span><span class='token pointer' id='tok-74-243' style='color:red'>following</span><span class='token pointer' id='tok-74-244'>tasks</span><span class='token pointer' id='tok-74-245'>using</span><span class='token pointer' id='tok-74-246'>Python</span><span class='token pointer' id='tok-74-247'>programming</span><span class='token pointer' id='tok-74-248'>language.</span></p><p id=p249><span class='token pointer' id='tok-74-249'>Unquoted</span><span class='token pointer' id='tok-74-250' style='color:red'>Service</span><span class='token pointer' id='tok-74-252' style='color:red'>Paths.Misconfigured Permission</span><span class='token pointer' id='tok-74-253'>Service</span><span class='token pointer' id='tok-74-254'>Executables.Misconfigured</span><span class='token pointer' id='tok-74-255' style='color:red'>MSI</span><span class='token pointer' id='tok-74-256' style='color:red'>registry</span><span class='token pointer' id='tok-74-257'>entries.Unquoted</span><span class='token pointer' id='tok-74-258'>Service</span><span class='token pointer' id='tok-74-259' style='color:red'>Paths:Before</span><span class='token pointer' id='tok-74-260' style='color:red'>proceeding</span><span class='token pointer' id='tok-74-261' style='color:red'>with</span><span class='token pointer' id='tok-74-262'>understanding</span><span class='token pointer' id='tok-74-263'>the</span><span class='token pointer' id='tok-74-264'>code</span><span class='token pointer' id='tok-74-265'>use</span><span class='token pointer' id='tok-74-266'>to</span><span class='token pointer' id='tok-74-267'>automate</span><span class='token pointer' id='tok-74-268'>this</span><span class='token pointer' id='tok-74-269' style='color:red'>task,</span><span class='token pointer' id='tok-74-270'>we</span><span class='token pointer' id='tok-74-271'>need</span><span class='token pointer' id='tok-74-272'>to</span><span class='token pointer' id='tok-74-273'>understand</span><span class='token pointer' id='tok-74-274'>how</span><span class='token pointer' id='tok-74-275'>we</span><span class='token pointer' id='tok-74-276'>can</span><span class='token pointer' id='tok-74-277'>exploit</span><span class='token pointer' id='tok-74-278'>unquoted</span><span class='token pointer' id='tok-74-279'>service</span><span class='token pointer' id='tok-74-280'>path</span><span class='token pointer' id='tok-74-281'>vulnerabilities.</span><span class='token pointer' id='tok-74-282' style='color:red'>This</span><span class='token pointer' id='tok-74-283' style='color:red'>mainly</span><span class='token pointer' id='tok-74-284' style='color:red'>involves</span><span class='token pointer' id='tok-74-285' style='color:red'>how</span><span class='token pointer' id='tok-74-286' style='color:red'>Windows</span><span class='token pointer' id='tok-74-287'>interpret</span><span class='token pointer' id='tok-74-288'>the</span><span class='token pointer' id='tok-74-289'>executable</span><span class='token pointer' id='tok-74-290'>path</span><span class='token pointer' id='tok-74-291' style='color:red'>of</span><span class='token pointer' id='tok-74-292' style='color:red'>service</span><span class='token pointer' id='tok-74-293'>before</span><span class='token pointer' id='tok-74-294' style='color:red'>starting</span><span class='token pointer' id='tok-74-295'>it.</span><span class='token pointer' id='tok-74-296'>For</span><span class='token pointer' id='tok-74-297'>example:</span></p><p id=p298><span class='token pointer' id='tok-74-298'>Let</span><span class='token pointer' id='tok-74-299'>us</span><span class='token pointer' id='tok-74-300'>execute</span><span class='token pointer' id='tok-74-301'>a</span><span class='token pointer' id='tok-74-302'>test</span><span class='token pointer' id='tok-74-303'>program/script</span><span class='token pointer' id='tok-74-304'>using</span><span class='token pointer' id='tok-74-305' style='color:red'>command</span><span class='token pointer' id='tok-74-306'>prompt</span><span class='token pointer' id='tok-74-307'>by</span><span class='token pointer' id='tok-74-308' style='color:red'>providing</span><span class='token pointer' id='tok-74-309'>a</span><span class='token pointer' id='tok-74-310'>path</span><span class='token pointer' id='tok-74-311'>to</span><span class='token pointer' id='tok-74-312'>the</span><span class='token pointer' id='tok-74-313'>executable.</span></p><p id=p314><span class='token pointer' id='tok-74-314'>As</span><span class='token pointer' id='tok-74-315'>we</span><span class='token pointer' id='tok-74-316'>can</span><span class='token pointer' id='tok-74-317'>see</span><span class='token pointer' id='tok-74-318'>that</span><span class='token pointer' id='tok-74-319'>our</span><span class='token pointer' id='tok-74-320'>helloworld</span><span class='token pointer' id='tok-74-321'>program</span><span class='token pointer' id='tok-74-322'>executes</span><span class='token pointer' id='tok-74-323'>successfully</span><span class='token pointer' id='tok-74-324'>when</span><span class='token pointer' id='tok-74-325' style='color:red'>placed</span><span class='token pointer' id='tok-74-326' style='color:red'>in</span><span class='token pointer' id='tok-74-327'>a</span><span class='token pointer' id='tok-74-328'>folder</span><span class='token pointer' id='tok-74-329'>without</span><span class='token pointer' id='tok-74-330'>space.</span><span class='token pointer' id='tok-74-331'>So,</span><span class='token pointer' id='tok-74-332'>what</span><span class='token pointer' id='tok-74-333'>happen</span><span class='token pointer' id='tok-74-334'>with</span><span class='token pointer' id='tok-74-335'>a</span><span class='token pointer' id='tok-74-336'>folder</span><span class='token pointer' id='tok-74-337'>with</span><span class='token pointer' id='tok-74-338'>space?</span></p><p id=p339><span class='token pointer' id='tok-74-339'>As</span><span class='token pointer' id='tok-74-340'>can</span><span class='token pointer' id='tok-74-341'>be</span><span class='token pointer' id='tok-74-342'>seen,</span><span class='token pointer' id='tok-74-343'>there</span><span class='token pointer' id='tok-74-344'>is</span><span class='token pointer' id='tok-74-345'>a</span><span class='token pointer' id='tok-74-346'>helloworld.exe</span><span class='token pointer' id='tok-74-347'>file</span><span class='token pointer' id='tok-74-348'>in</span><span class='token pointer' id='tok-74-349'>the</span><span class='token pointer' id='tok-74-350'>folder</span><span class='token pointer' id='tok-74-351' style='color:red'>with</span><span class='token pointer' id='tok-74-352'>space.</span><span class='token pointer' id='tok-74-353'>So,</span><span class='token pointer' id='tok-74-354'>to</span><span class='token pointer' id='tok-74-355'>execute</span><span class='token pointer' id='tok-74-356'>that</span><span class='token pointer' id='tok-74-357'>we</span><span class='token pointer' id='tok-74-358'>simply</span><span class='token pointer' id='tok-74-359'>change</span><span class='token pointer' id='tok-74-360'>our</span><span class='token pointer' id='tok-74-361'>directory</span><span class='token pointer' id='tok-74-362'>by</span><span class='token pointer' id='tok-74-363'>providing</span><span class='token pointer' id='tok-74-364'>quotes</span><span class='token pointer' id='tok-74-365'>around</span><span class='token pointer' id='tok-74-366'>folder</span><span class='token pointer' id='tok-74-367'>name.</span><span class='token pointer' id='tok-74-368'>Now</span><span class='token pointer' id='tok-74-369'>the</span><span class='token pointer' id='tok-74-370'>question</span><span class='token pointer' id='tok-74-371'>arises</span><span class='token pointer' id='tok-74-372'>how</span><span class='token pointer' id='tok-74-373'>we</span><span class='token pointer' id='tok-74-374'>can</span><span class='token pointer' id='tok-74-375'>exploit</span><span class='token pointer' id='tok-74-376'>this</span><span class='token pointer' id='tok-74-377'>behavior</span><span class='token pointer' id='tok-74-378'>of</span><span class='token pointer' id='tok-74-379'>Windows.</span></p><p id=p380><span class='token pointer' id='tok-74-380'>As</span><span class='token pointer' id='tok-74-381'>can</span><span class='token pointer' id='tok-74-382'>be</span><span class='token pointer' id='tok-74-383'>seen,</span><span class='token pointer' id='tok-74-384'>in</span><span class='token pointer' id='tok-74-385'>first</span><span class='token pointer' id='tok-74-386'>image</span><span class='token pointer' id='tok-74-387'>window</span><span class='token pointer' id='tok-74-388'>treats</span><span class='token pointer' id='tok-74-389'>the</span><span class='token pointer' id='tok-74-390'>folder</span><span class='token pointer' id='tok-74-391'>name</span><span class='token pointer' id='tok-74-392'>with</span><span class='token pointer' id='tok-74-393'>space</span><span class='token pointer' id='tok-74-394'>as</span><span class='token pointer' id='tok-74-395'>an</span><span class='token pointer' id='tok-74-396'>executable</span><span class='token pointer' id='tok-74-397'>and</span><span class='token pointer' id='tok-74-398'>throws</span><span class='token pointer' id='tok-74-399'>us</span><span class='token pointer' id='tok-74-400'>an</span><span class='token pointer' id='tok-74-401'>error</span><span class='token pointer' id='tok-74-402'>saying</span><span class='token pointer' id='tok-74-403'>"folder</span><span class='token pointer' id='tok-74-404'>is</span><span class='token pointer' id='tok-74-405'>not</span><span class='token pointer' id='tok-74-406'>recognized</span><span class='token pointer' id='tok-74-407'>as</span><span class='token pointer' id='tok-74-408'>internal</span><span class='token pointer' id='tok-74-409'>or</span><span class='token pointer' id='tok-74-410'>external</span><span class='token pointer' id='tok-74-411' style='color:red'>command/executable/batch</span><span class='token pointer' id='tok-74-412'>file."</span><span class='token pointer' id='tok-74-413'>So,</span><span class='token pointer' id='tok-74-414'>this</span><span class='token pointer' id='tok-74-415'>means</span><span class='token pointer' id='tok-74-416' style='color:red'>if</span><span class='token pointer' id='tok-74-417'>we</span><span class='token pointer' id='tok-74-418'>put</span><span class='token pointer' id='tok-74-419'>an</span><span class='token pointer' id='tok-74-420'>executable</span><span class='token pointer' id='tok-74-421'>with</span><span class='token pointer' id='tok-74-422'>the</span><span class='token pointer' id='tok-74-423'>name</span><span class='token pointer' id='tok-74-424'>as</span><span class='token pointer' id='tok-74-425'>folder.exe</span><span class='token pointer' id='tok-74-426'>it</span><span class='token pointer' id='tok-74-427'>should</span><span class='token pointer' id='tok-74-428'>get</span><span class='token pointer' id='tok-74-429'>execute</span><span class='token pointer' id='tok-74-430' style='color:red'>when</span><span class='token pointer' id='tok-74-431'>the</span><span class='token pointer' id='tok-74-432'>user</span><span class='token pointer' id='tok-74-433'>calls</span><span class='token pointer' id='tok-74-434'>the</span><span class='token pointer' id='tok-74-435'>program</span><span class='token pointer' id='tok-74-436'>path</span><span class='token pointer' id='tok-74-437'>without</span><span class='token pointer' id='tok-74-438'>spaces.</span></p><p id=p439><span class='token pointer' id='tok-74-439'>We</span><span class='token pointer' id='tok-74-440'>first</span><span class='token pointer' id='tok-74-441'>tried</span><span class='token pointer' id='tok-74-442'>to</span><span class='token pointer' id='tok-74-443'>execute</span><span class='token pointer' id='tok-74-444'>our</span><span class='token pointer' id='tok-74-445'>program</span><span class='token pointer' id='tok-74-446'>without</span><span class='token pointer' id='tok-74-447'>space.</span><span class='token pointer' id='tok-74-448'>Further,</span><span class='token pointer' id='tok-74-449'>we</span><span class='token pointer' id='tok-74-450'>copied</span><span class='token pointer' id='tok-74-451'>the</span><span class='token pointer' id='tok-74-452'>same</span><span class='token pointer' id='tok-74-453'>program</span><span class='token pointer' id='tok-74-454'>to</span><span class='token pointer' id='tok-74-455'>desktop</span><span class='token pointer' id='tok-74-456'>folder</span><span class='token pointer' id='tok-74-457'>with</span><span class='token pointer' id='tok-74-458'>name</span><span class='token pointer' id='tok-74-459'>folder.exe</span><span class='token pointer' id='tok-74-460'>and</span><span class='token pointer' id='tok-74-461'>deleted</span><span class='token pointer' id='tok-74-462'>our</span><span class='token pointer' id='tok-74-463'>program</span><span class='token pointer' id='tok-74-464'>from</span><span class='token pointer' id='tok-74-465'>the</span><span class='token pointer' id='tok-74-466'>older</span><span class='token pointer' id='tok-74-467'>path</span><span class='token pointer' id='tok-74-468'>to</span><span class='token pointer' id='tok-74-469'>be</span><span class='token pointer' id='tok-74-470'>sure</span><span class='token pointer' id='tok-74-471'>only</span><span class='token pointer' id='tok-74-472'>planted</span><span class='token pointer' id='tok-74-473'>binary</span><span class='token pointer' id='tok-74-474'>gets</span><span class='token pointer' id='tok-74-475'>executed.</span></p><p id=p476><span class='token pointer' id='tok-74-476'>Windows</span><span class='token pointer' id='tok-74-477'>now</span><span class='token pointer' id='tok-74-478'>execute</span><span class='token pointer' id='tok-74-479'>our</span><span class='token pointer' id='tok-74-480'>binary</span><span class='token pointer' id='tok-74-481'>planted</span><span class='token pointer' id='tok-74-482' style='color:red'>with</span><span class='token pointer' id='tok-74-483'>the</span><span class='token pointer' id='tok-74-484'>name</span><span class='token pointer' id='tok-74-485'>of</span><span class='token pointer' id='tok-74-486'>folder.exe.</span></p><p id=p487><span class='token pointer' id='tok-74-487'>So,</span><span class='token pointer' id='tok-74-488'>we</span><span class='token pointer' id='tok-74-489'>will</span><span class='token pointer' id='tok-74-490'>be</span><span class='token pointer' id='tok-74-491'>automating</span><span class='token pointer' id='tok-74-492'>this</span><span class='token pointer' id='tok-74-493'>process</span><span class='token pointer' id='tok-74-494'>by</span><span class='token pointer' id='tok-74-495'>telling</span><span class='token pointer' id='tok-74-496'>our</span><span class='token pointer' id='tok-74-497'>program</span><span class='token pointer' id='tok-74-498'>to</span><span class='token pointer' id='tok-74-499'>iterate</span><span class='token pointer' id='tok-74-500'>over</span><span class='token pointer' id='tok-74-501'>the</span><span class='token pointer' id='tok-74-502'>service</span><span class='token pointer' id='tok-74-503'>paths</span><span class='token pointer' id='tok-74-504' style='color:red'>and</span><span class='token pointer' id='tok-74-505'>show</span><span class='token pointer' id='tok-74-506'>us</span><span class='token pointer' id='tok-74-508' style='color:red'>which service</span><span class='token pointer' id='tok-74-509'>are</span><span class='token pointer' id='tok-74-510'>unquoted.</span></p><p id=p511><span class='token pointer' id='tok-74-511'>In</span><span class='token pointer' id='tok-74-512'>our</span><span class='token pointer' id='tok-74-513'>code,</span><span class='token pointer' id='tok-74-514'>we</span><span class='token pointer' id='tok-74-515'>first</span><span class='token pointer' id='tok-74-516'>defined</span><span class='token pointer' id='tok-74-517'>a</span><span class='token pointer' id='tok-74-518'>WMI</span><span class='token pointer' id='tok-74-519'>object,</span><span class='token pointer' id='tok-74-520'>select</span><span class='token pointer' id='tok-74-521'>everything</span><span class='token pointer' id='tok-74-522'>from</span><span class='token pointer' id='tok-74-523'>Win32_Service</span><span class='token pointer' id='tok-74-524'>class</span><span class='token pointer' id='tok-74-525'>and</span><span class='token pointer' id='tok-74-526'>iterate</span><span class='token pointer' id='tok-74-527'>over</span><span class='token pointer' id='tok-74-528'>it</span><span class='token pointer' id='tok-74-529' style='color:red'>to</span><span class='token pointer' id='tok-74-530'>get</span><span class='token pointer' id='tok-74-531'>all</span><span class='token pointer' id='tok-74-532'>service</span><span class='token pointer' id='tok-74-533'>paths.</span><span class='token pointer' id='tok-74-534'>We</span><span class='token pointer' id='tok-74-535'>further</span><span class='token pointer' id='tok-74-536'>check</span><span class='token pointer' id='tok-74-537'>if</span><span class='token pointer' id='tok-74-538'>the</span><span class='token pointer' id='tok-74-539'>path</span><span class='token pointer' id='tok-74-540'>does</span><span class='token pointer' id='tok-74-541'>not</span><span class='token pointer' id='tok-74-542'>contain</span><span class='token pointer' id='tok-74-543'>any</span><span class='token pointer' id='tok-74-544'>quotes</span><span class='token pointer' id='tok-74-545'>if</span><span class='token pointer' id='tok-74-546'>our</span><span class='token pointer' id='tok-74-547'>condition</span><span class='token pointer' id='tok-74-548'>satisfies</span><span class='token pointer' id='tok-74-549'>we</span><span class='token pointer' id='tok-74-550'>add</span><span class='token pointer' id='tok-74-551'>that</span><span class='token pointer' id='tok-74-552'>path</span><span class='token pointer' id='tok-74-553'>to</span><span class='token pointer' id='tok-74-554'>our</span><span class='token pointer' id='tok-74-555'>dictionary</span><span class='token pointer' id='tok-74-556'>by</span><span class='token pointer' id='tok-74-557'>keeping</span><span class='token pointer' id='tok-74-558'>service</span><span class='token pointer' id='tok-74-559'>name</span><span class='token pointer' id='tok-74-560'>as</span><span class='token pointer' id='tok-74-561'>a</span><span class='token pointer' id='tok-74-562'>key</span><span class='token pointer' id='tok-74-563'>name.</span></p><p id=p564><span class='token pointer' id='tok-74-564'>We</span><span class='token pointer' id='tok-74-565'>further</span><span class='token pointer' id='tok-74-566'>check</span><span class='token pointer' id='tok-74-567'>if</span><span class='token pointer' id='tok-74-568'>there</span><span class='token pointer' id='tok-74-569'>are</span><span class='token pointer' id='tok-74-570'>any</span><span class='token pointer' id='tok-74-571'>service</span><span class='token pointer' id='tok-74-572'>paths</span><span class='token pointer' id='tok-74-573'>identified</span><span class='token pointer' id='tok-74-574'>and</span><span class='token pointer' id='tok-74-575'>iterate</span><span class='token pointer' id='tok-74-576'>over</span><span class='token pointer' id='tok-74-577'>our</span><span class='token pointer' id='tok-74-578'>dictionary</span><span class='token pointer' id='tok-74-579'>to</span><span class='token pointer' id='tok-74-580'>display</span><span class='token pointer' id='tok-74-581'>the</span><span class='token pointer' id='tok-74-582'>values.</span></p><p id=p583><span class='token pointer' id='tok-74-583'>We</span><span class='token pointer' id='tok-74-584'>will</span><span class='token pointer' id='tok-74-585'>be</span><span class='token pointer' id='tok-74-586' style='color:red'>adding</span><span class='token pointer' id='tok-74-587'>the</span><span class='token pointer' id='tok-74-588' style='color:red'>above</span><span class='token pointer' id='tok-74-589'>code</span><span class='token pointer' id='tok-74-590'>snippets</span><span class='token pointer' id='tok-74-591'>to</span><span class='token pointer' id='tok-74-592'>our</span><span class='token pointer' id='tok-74-593'>final</span><span class='token pointer' id='tok-74-594'>program.</span></p><p id=p595><span class='token pointer' id='tok-74-595'>Misconfigured</span><span class='token pointer' id='tok-74-596' style='color:red'>Permission</span><span class='token pointer' id='tok-74-597'>for</span><span class='token pointer' id='tok-74-598'>Service</span><span class='token pointer' id='tok-74-599'>ExecutablesThe</span><span class='token pointer' id='tok-74-600'>second</span><span class='token pointer' id='tok-74-601' style='color:red'>part</span><span class='token pointer' id='tok-74-602'>of</span><span class='token pointer' id='tok-74-603'>the</span><span class='token pointer' id='tok-74-604'>program</span><span class='token pointer' id='tok-74-605'>includes</span><span class='token pointer' id='tok-74-606'>checking</span><span class='token pointer' id='tok-74-607'>the</span><span class='token pointer' id='tok-74-608'>permission</span><span class='token pointer' id='tok-74-609'>of</span><span class='token pointer' id='tok-74-610'>service</span><span class='token pointer' id='tok-74-611'>executables.</span><span class='token pointer' id='tok-74-612'>Which</span><span class='token pointer' id='tok-74-613'>means</span><span class='token pointer' id='tok-74-614'>if</span><span class='token pointer' id='tok-74-615'>any</span><span class='token pointer' id='tok-74-617' style='color:red'>privileged</span><span class='token pointer' id='tok-74-618' style='color:red'>low</span><span class='token pointer' id='tok-74-619'>can</span><span class='token pointer' id='tok-74-620'>modify/write/replace</span><span class='token pointer' id='tok-74-621'>the</span><span class='token pointer' id='tok-74-622'>executable</span><span class='token pointer' id='tok-74-623'>with</span><span class='token pointer' id='tok-74-624'>his</span><span class='token pointer' id='tok-74-625'>code/executable.</span><span class='token pointer' id='tok-74-626'>Next</span><span class='token pointer' id='tok-74-627'>time</span><span class='token pointer' id='tok-74-628'>when</span><span class='token pointer' id='tok-74-629'>the</span><span class='token pointer' id='tok-74-630'>service</span><span class='token pointer' id='tok-74-631' style='color:red'>starts</span><span class='token pointer' id='tok-74-632'>malicious</span><span class='token pointer' id='tok-74-633'>code</span><span class='token pointer' id='tok-74-634'>will</span><span class='token pointer' id='tok-74-635'>get</span><span class='token pointer' id='tok-74-636'>executed</span><span class='token pointer' id='tok-74-637'>as</span><span class='token pointer' id='tok-74-638' style='color:red'>a</span><span class='token pointer' id='tok-74-639'>system.</span></p><p id=p640><span class='token pointer' id='tok-74-640'>In</span><span class='token pointer' id='tok-74-641'>this</span><span class='token pointer' id='tok-74-642'>case,</span><span class='token pointer' id='tok-74-643'>we</span><span class='token pointer' id='tok-74-644'>will</span><span class='token pointer' id='tok-74-645'>be</span><span class='token pointer' id='tok-74-646'>using</span><span class='token pointer' id='tok-74-647'>"icacls"</span><span class='token pointer' id='tok-74-648'>utility</span><span class='token pointer' id='tok-74-649'>of</span><span class='token pointer' id='tok-74-650'>windows</span><span class='token pointer' id='tok-74-651'>to</span><span class='token pointer' id='tok-74-652'>find</span><span class='token pointer' id='tok-74-653' style='color:red'>out</span><span class='token pointer' id='tok-74-654' style='color:red'>permission</span><span class='token pointer' id='tok-74-655'>of</span><span class='token pointer' id='tok-74-656'>all</span><span class='token pointer' id='tok-74-657'>service</span><span class='token pointer' id='tok-74-658'>executables.</span><span class='token pointer' id='tok-74-659'>Moreover,</span><span class='token pointer' id='tok-74-660'>list</span><span class='token pointer' id='tok-74-661'>down</span><span class='token pointer' id='tok-74-662'>the</span><span class='token pointer' id='tok-74-663'>ones</span><span class='token pointer' id='tok-74-664'>in</span><span class='token pointer' id='tok-74-665'>which</span><span class='token pointer' id='tok-74-666'>any</span><span class='token pointer' id='tok-74-667'>user</span><span class='token pointer' id='tok-74-668'>has</span><span class='token pointer' id='tok-74-669'>full</span><span class='token pointer' id='tok-74-670'>access</span><span class='token pointer' id='tok-74-671'>to</span><span class='token pointer' id='tok-74-672'>the</span><span class='token pointer' id='tok-74-673'>executable.</span></p><p id=p674><span class='token pointer' id='tok-74-674'>As</span><span class='token pointer' id='tok-74-675'>can</span><span class='token pointer' id='tok-74-676'>be</span><span class='token pointer' id='tok-74-677'>seen,</span><span class='token pointer' id='tok-74-678'>we</span><span class='token pointer' id='tok-74-679'>have</span><span class='token pointer' id='tok-74-680'>used</span><span class='token pointer' id='tok-74-681'>the</span><span class='token pointer' id='tok-74-682'>output</span><span class='token pointer' id='tok-74-683'>of</span><span class='token pointer' id='tok-74-684'>wmi</span><span class='token pointer' id='tok-74-685'>query</span><span class='token pointer' id='tok-74-686'>from</span><span class='token pointer' id='tok-74-687'>our</span><span class='token pointer' id='tok-74-688' style='color:red'>previous</span><span class='token pointer' id='tok-74-689'>section</span><span class='token pointer' id='tok-74-691' style='color:red'>of code</span><span class='token pointer' id='tok-74-692'>added</span><span class='token pointer' id='tok-74-693'>found</span><span class='token pointer' id='tok-74-694'>executable</span><span class='token pointer' id='tok-74-695'>files</span><span class='token pointer' id='tok-74-696'>in</span><span class='token pointer' id='tok-74-697'>a</span><span class='token pointer' id='tok-74-698'>Python</span><span class='token pointer' id='tok-74-699'>list.</span></p><p id=p700><span class='token pointer' id='tok-74-700'>We</span><span class='token pointer' id='tok-74-701'>will</span><span class='token pointer' id='tok-74-702'>now</span><span class='token pointer' id='tok-74-703'>feed</span><span class='token pointer' id='tok-74-704'>the</span><span class='token pointer' id='tok-74-705'>executable</span><span class='token pointer' id='tok-74-706'>path</span><span class='token pointer' id='tok-74-707'>to</span><span class='token pointer' id='tok-74-708'>icacls</span><span class='token pointer' id='tok-74-709'>utility</span><span class='token pointer' id='tok-74-710'>to</span><span class='token pointer' id='tok-74-711'>get</span><span class='token pointer' id='tok-74-712'>the</span><span class='token pointer' id='tok-74-713'>permission</span><span class='token pointer' id='tok-74-714'>info</span><span class='token pointer' id='tok-74-715'>of</span><span class='token pointer' id='tok-74-716'>executable</span><span class='token pointer' id='tok-74-717'>and</span><span class='token pointer' id='tok-74-718'>parse</span><span class='token pointer' id='tok-74-719'>the</span><span class='token pointer' id='tok-74-720'>output</span><span class='token pointer' id='tok-74-721'>using</span><span class='token pointer' id='tok-74-722'>the</span><span class='token pointer' id='tok-74-723'>find_paths</span><span class='token pointer' id='tok-74-724'>function.</span></p><p id=p725><span class='token pointer' id='tok-74-725'>Ethical</span><span class='token pointer' id='tok-74-726'>Hacking</span><span class='token pointer' id='tok-74-727'>Training</span><span class='token pointer' id='tok-74-728'>–</span><span class='token pointer' id='tok-74-729'>Resources</span><span class='token pointer' id='tok-74-730' style='color:red'>(InfoSec)</span></p><p id=p731><span class='token pointer' id='tok-74-731'>The</span><span class='token pointer' id='tok-74-732'>find_paths</span><span class='token pointer' id='tok-74-733'>function</span><span class='token pointer' id='tok-74-734'>match</span><span class='token pointer' id='tok-74-735'>the</span><span class='token pointer' id='tok-74-736'>permission</span><span class='token pointer' id='tok-74-737'>info</span><span class='token pointer' id='tok-74-738'>of</span><span class='token pointer' id='tok-74-739'>executable</span><span class='token pointer' id='tok-74-740'>with</span><span class='token pointer' id='tok-74-741'>predefined</span><span class='token pointer' id='tok-74-742'>values</span><span class='token pointer' id='tok-74-743'>and</span><span class='token pointer' id='tok-74-744'>prints</span><span class='token pointer' id='tok-74-745'>out</span><span class='token pointer' id='tok-74-746'>if</span><span class='token pointer' id='tok-74-747'>any</span><span class='token pointer' id='tok-74-748' style='color:red'>match</span><span class='token pointer' id='tok-74-749'>is</span><span class='token pointer' id='tok-74-750'>found.</span></p><p id=p751><span class='token pointer' id='tok-74-751'>Misconfigured</span><span class='token pointer' id='tok-74-752'>MSI</span><span class='token pointer' id='tok-74-753'>registry</span><span class='token pointer' id='tok-74-754'>entriesWindows</span><span class='token pointer' id='tok-74-755'>has</span><span class='token pointer' id='tok-74-756'>this</span><span class='token pointer' id='tok-74-757'>configuration</span><span class='token pointer' id='tok-74-758'>which</span><span class='token pointer' id='tok-74-759'>if</span><span class='token pointer' id='tok-74-760'>set</span><span class='token pointer' id='tok-74-761'>allows</span><span class='token pointer' id='tok-74-762'>any</span><span class='token pointer' id='tok-74-763'>user</span><span class='token pointer' id='tok-74-764' style='color:red'>to</span><span class='token pointer' id='tok-74-765'>run</span><span class='token pointer' id='tok-74-766'>MSI</span><span class='token pointer' id='tok-74-767'>(Microsoft</span><span class='token pointer' id='tok-74-768'>Installers)</span><span class='token pointer' id='tok-74-769'>with</span><span class='token pointer' id='tok-74-770'>SYSTEM</span><span class='token pointer' id='tok-74-771'>privileges.</span><span class='token pointer' id='tok-74-772'>This</span><span class='token pointer' id='tok-74-773'>involves</span><span class='token pointer' id='tok-74-774'>checking</span><span class='token pointer' id='tok-74-775' style='color:red'>the</span><span class='token pointer' id='tok-74-776'>true</span><span class='token pointer' id='tok-74-777'>value</span><span class='token pointer' id='tok-74-778'>for</span><span class='token pointer' id='tok-74-779'>a</span><span class='token pointer' id='tok-74-780'>32-bit</span><span class='token pointer' id='tok-74-781'>dword</span><span class='token pointer' id='tok-74-782'>named</span><span class='token pointer' id='tok-74-783' style='color:red'>"AlwaysInstallElevated".</span></p><p id=p784><span class='token pointer' id='tok-74-784'>This</span><span class='token pointer' id='tok-74-785'>will</span><span class='token pointer' id='tok-74-786'>be</span><span class='token pointer' id='tok-74-787' style='color:red'>our</span><span class='token pointer' id='tok-74-788' style='color:red'>last</span><span class='token pointer' id='tok-74-789'>addition</span><span class='token pointer' id='tok-74-790'>to</span><span class='token pointer' id='tok-74-791'>the</span><span class='token pointer' id='tok-74-792'>program,</span><span class='token pointer' id='tok-74-793'>in</span><span class='token pointer' id='tok-74-794'>this</span><span class='token pointer' id='tok-74-795'>case,</span><span class='token pointer' id='tok-74-796'>we</span><span class='token pointer' id='tok-74-797'>will</span><span class='token pointer' id='tok-74-798'>be</span><span class='token pointer' id='tok-74-799'>using</span><span class='token pointer' id='tok-74-800'>inbuilt</span><span class='token pointer' id='tok-74-801'>python's</span><span class='token pointer' id='tok-74-802'>module</span><span class='token pointer' id='tok-74-803'>named</span><span class='token pointer' id='tok-74-804'>"_winreg"</span><span class='token pointer' id='tok-74-805'>to</span><span class='token pointer' id='tok-74-806'>fetch</span><span class='token pointer' id='tok-74-807'>out</span><span class='token pointer' id='tok-74-808' style='color:red'>the</span><span class='token pointer' id='tok-74-809'>registry</span><span class='token pointer' id='tok-74-810'>entries.</span></p><p id=p811><span class='token pointer' id='tok-74-811' style='color:red'>We</span><span class='token pointer' id='tok-74-812'>open</span><span class='token pointer' id='tok-74-813'>the</span><span class='token pointer' id='tok-74-814'>registry</span><span class='token pointer' id='tok-74-815'>keys</span><span class='token pointer' id='tok-74-816'>using</span><span class='token pointer' id='tok-74-817'>OpenKey</span><span class='token pointer' id='tok-74-818'>function</span><span class='token pointer' id='tok-74-819'>and</span><span class='token pointer' id='tok-74-820'>enum</span><span class='token pointer' id='tok-74-821'>the</span><span class='token pointer' id='tok-74-822'>first</span><span class='token pointer' id='tok-74-823'>dword</span><span class='token pointer' id='tok-74-824' style='color:red'>value.</span><span class='token pointer' id='tok-74-825'>We</span><span class='token pointer' id='tok-74-826'>further</span><span class='token pointer' id='tok-74-827'>verify</span><span class='token pointer' id='tok-74-828'>whether</span><span class='token pointer' id='tok-74-829'>both</span><span class='token pointer' id='tok-74-830'>registry</span><span class='token pointer' id='tok-74-831'>keys</span><span class='token pointer' id='tok-74-832'>are</span><span class='token pointer' id='tok-74-833'>set</span><span class='token pointer' id='tok-74-834'>to</span><span class='token pointer' id='tok-74-835'>true.</span></p><p id=p836><span class='token pointer' id='tok-74-836'>If</span><span class='token pointer' id='tok-74-837'>both</span><span class='token pointer' id='tok-74-838'>registry</span><span class='token pointer' id='tok-74-839'>keys</span><span class='token pointer' id='tok-74-840'>exist</span><span class='token pointer' id='tok-74-841'>and</span><span class='token pointer' id='tok-74-842'>dword</span><span class='token pointer' id='tok-74-843'>values</span><span class='token pointer' id='tok-74-844'>are</span><span class='token pointer' id='tok-74-845'>set,</span><span class='token pointer' id='tok-74-846'>we</span><span class='token pointer' id='tok-74-847'>display</span><span class='token pointer' id='tok-74-848'>the</span><span class='token pointer' id='tok-74-849'>following</span><span class='token pointer' id='tok-74-850'>message</span><span class='token pointer' id='tok-74-851'>to</span><span class='token pointer' id='tok-74-852'>the</span><span class='token pointer' id='tok-74-853'>user.</span></p><p id=p854><span class='token pointer' id='tok-74-854'>Let's</span><span class='token pointer' id='tok-74-855'>execute</span><span class='token pointer' id='tok-74-856'>our</span><span class='token pointer' id='tok-74-857'>complete</span><span class='token pointer' id='tok-74-858'>script</span><span class='token pointer' id='tok-74-859'>on</span><span class='token pointer' id='tok-74-860'>a</span><span class='token pointer' id='tok-74-861'>vulnerable</span><span class='token pointer' id='tok-74-862'>machine.</span><span class='token pointer' id='tok-74-863'>As</span><span class='token pointer' id='tok-74-864'>can</span><span class='token pointer' id='tok-74-865'>be</span><span class='token pointer' id='tok-74-866'>seen,</span><span class='token pointer' id='tok-74-867'>our</span><span class='token pointer' id='tok-74-868'>script</span><span class='token pointer' id='tok-74-869'>is</span><span class='token pointer' id='tok-74-870'>successfully</span><span class='token pointer' id='tok-74-871'>able</span><span class='token pointer' id='tok-74-872'>to</span><span class='token pointer' id='tok-74-873'>determine</span><span class='token pointer' id='tok-74-874'>the</span><span class='token pointer' id='tok-74-875'>mentioned</span><span class='token pointer' id='tok-74-876'>issues.</span><span class='token pointer' id='tok-74-877'>As</span><span class='token pointer' id='tok-74-878'>our</span><span class='token pointer' id='tok-74-879'>machine</span><span class='token pointer' id='tok-74-880'>is</span><span class='token pointer' id='tok-74-881'>not</span><span class='token pointer' id='tok-74-882'>vulnerable</span><span class='token pointer' id='tok-74-883'>to</span><span class='token pointer' id='tok-74-884'>the</span><span class='token pointer' id='tok-74-885'>third</span><span class='token pointer' id='tok-74-886'>issue,</span><span class='token pointer' id='tok-74-887'>I</span><span class='token pointer' id='tok-74-888'>encourage</span><span class='token pointer' id='tok-74-889'>a</span><span class='token pointer' id='tok-74-890'>diligent</span><span class='token pointer' id='tok-74-891'>reader</span><span class='token pointer' id='tok-74-892'>to</span><span class='token pointer' id='tok-74-893'>manually</span><span class='token pointer' id='tok-74-894'>create</span><span class='token pointer' id='tok-74-895'>those</span><span class='token pointer' id='tok-74-896'>registry</span><span class='token pointer' id='tok-74-897'>entries</span><span class='token pointer' id='tok-74-898'>and</span><span class='token pointer' id='tok-74-899'>execute</span><span class='token pointer' id='tok-74-900'>their</span><span class='token pointer' id='tok-74-901'>own</span><span class='token pointer' id='tok-74-902'>MSI</span><span class='token pointer' id='tok-74-903'>executable</span><span class='token pointer' id='tok-74-904'>using</span><span class='token pointer' id='tok-74-905'>msiexec</span><span class='token pointer' id='tok-74-906'>utility.</span></p><p id=p907><span class='token pointer' id='tok-74-907'>Hint:</span><span class='token pointer' id='tok-74-908'>We</span><span class='token pointer' id='tok-74-909'>can</span><span class='token pointer' id='tok-74-910'>generate</span><span class='token pointer' id='tok-74-911'>msi</span><span class='token pointer' id='tok-74-912' style='color:red'>files</span><span class='token pointer' id='tok-74-913'>using</span><span class='token pointer' id='tok-74-914'>msfvenom.
</span></p>