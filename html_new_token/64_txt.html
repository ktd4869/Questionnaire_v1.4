<p id=p0>In this article, we will learn to solve the "Toppo: 1" Capture-the-Flag <span class='token pointer' id='tok-64-0' style='color:red'>(CTF)</span>challenge <span class='token pointer' id='tok-64-1' style='color:red'>which</span>was posted on <span class='token pointer' id='tok-64-2' style='color:red'>VulnHub</span>by Hadi Mene. According to the information given in description by the author of the challenge, this CTF is not very hard and does not require <span class='token pointer' id='tok-64-3' style='color:red'>advanced</span>exploitation. You can use this link to download the <span class='token pointer' id='tok-64-4' style='color:red'>VM</span>and <span class='token pointer' id='tok-64-5' style='color:red'>launch</span>it on <span class='token pointer' id='tok-64-6' style='color:red'>Virtual</span>Box. The <span class='token pointer' id='tok-64-7' style='color:red'>torrent</span><span class='token pointer' id='tok-64-8' style='color:red'>downloadable</span>URL is also available for this VM; the link is in the sources section at the end of this article. </p><p id=p85>For those who are new to CTF challenges and are not aware of this platform, VulnHub is a well-known website for security researchers which provide users with a method to learn and practice their <span class='token pointer' id='tok-64-9' style='color:red'>hacking</span>skills through a series of challenges in a safe and legal environment. </p><p id=p132>Please Note: For all of these machines, I have used Oracle Virtual Box to run the downloaded machine. I will be using <span class='token pointer' id='tok-64-10' style='color:red'>Kali</span><span class='token pointer' id='tok-64-11' style='color:red'>Linux</span>as an attacker machine for solving this CTF. The techniques used are solely for educational purposes, and I am not responsible if the listed techniques are used against any other <span class='token pointer' id='tok-64-12' style='color:red'>targets.</span></p><p id=p187>Toppo: 1 WalkthroughAfter downloading and running this machine in Virtual Box, we start by running the <span class='token pointer' id='tok-64-13' style='color:red'>Netdiscover</span>command to obtain the <span class='token pointer' id='tok-64-14' style='color:red'>IP</span>address of the <span class='token pointer' id='tok-64-15' style='color:red'>target</span>machine. The command and its output can be seen in the screenshot given below: </p><p id=p227><span class='token pointer' id='tok-64-16' style='color:red'>Command</span>Used: Netdiscover </p><p id=p230>As shown in the highlighted area in the above screenshot, we have obtained the Virtual Machine IP address, i.e., 192.168.1.7 (the target machine IP address). </p><p id=p255>We will be using 192.168.1.11 as the attacker IP address. </p><p id=p265>Please Note: the target and the attacker IP addresses may be different depending on your <span class='token pointer' id='tok-64-17' style='color:red'>network</span><span class='token pointer' id='tok-64-18' style='color:red'>configuration.</span></p><p id=p282>So we have the target machine IP; the first step is to find out the <span class='token pointer' id='tok-64-19' style='color:red'>ports</span>and services that are available on the target machine. An <span class='token pointer' id='tok-64-20' style='color:red'>Nmap</span>full port scan is used for this purpose. This is <span class='token pointer' id='tok-64-21' style='color:red'>illustrated</span>in the screenshot given below: </p><p id=p325>Command Used: nmap 192.168.1.7 -v -Pn </p><p id=p331>After the completion of the scan, we get four open ports on the target machine. I decided to start with the <span class='token pointer' id='tok-64-22' style='color:red'>HTTP</span>port. When we open it on the browser, it shows a very nice website which can be seen in the following screenshot. </p><p id=p375><span class='token pointer' id='tok-64-23' style='color:red'>Unfortunately,</span>I couldn't get any hints from its homepage. I also <span class='token pointer' id='tok-64-24' style='color:red'>explored</span>other web pages too for any interesting information but didn't find anything. So I decided to run the <span class='token pointer' id='tok-64-25' style='color:red'>Dirb</span>utility, which is by default available in Kali Linux. The screenshot of the tool output can be seen below. </p><p id=p425>Command Used: dirb http://192.168.1.7/ </p><p id=p429>As can be seen in the above screenshot, we get a few directories as output. Some of the directories which caught my <span class='token pointer' id='tok-64-26' style='color:red'>attention</span>are given below. </p><p id=p455><span class='token pointer' id='tok-64-27' style='color:red'>Admin/Mail/Vendor/I</span>started further exploration with the admin directory, which had directory listing enabled. That can be seen in the screenshot given below. </p><p id=p477>As you can see, this directory contains a text file called notes.txt. Let's open this file. There was an interesting note left about the application, which can be seen in the below screenshot. </p><p id=p510>A note is written which says the current password is "12345ted123," which needs to be changed. So at this time I thought there might be a login page in this application where we can log in with this password. I explored other directories to find the login page but didn't find anything. </p><p id=p562>Since the <span class='token pointer' id='tok-64-28' style='color:red'>SSH</span>port was identified as open in the Nmap scan, so I thought the default user could be root and the password we already got from the notes. I tried to login via SSH with user "root" and the above password. But the <span class='token pointer' id='tok-64-29' style='color:red'>credentials</span>were not valid, which can be seen in the following screenshot. </p><p id=p619>After that I decided to try the hit-and-trial method to guess the username and used the following credentials to login via SSH. </p><p id=p641><span class='token pointer' id='tok-64-30' style='color:red'>Username:</span>ted </p><p id=p643>Password: 12345ted123 </p><p id=p645>These credentials allowed us to log into the target machine. The successful SSH login can be seen in the following screenshot. </p><p id=p666>After that I used the "id" command to check whether ted is a root user or not. It shows that ted is not a root user in the target machine. Now we need to escalate the <span class='token pointer' id='tok-64-31' style='color:red'>privilege</span>to get to the root. </p><p id=p708>I stared <span class='token pointer' id='tok-64-32' style='color:red'>exploring</span>the target machine. The basic thing is to check the OS version and the <span class='token pointer' id='tok-64-33' style='color:red'>Kernel</span>version of the target machine, because there are lots of <span class='token pointer' id='tok-64-34' style='color:red'>privilege-escalation</span>exploits available over the Internet. The target machine OS and Kernel version can be seen in the following screenshot. </p><p id=p756>Command Used : uname –a, cat /etc/issue </p><p id=p763>As you can see, we have the version details of the target machine's OS, but there was no exploit available for this version of the OS. </p><p id=p789>After spending some time and exploring the target machine with limited access user, I found few <span class='token pointer' id='tok-64-35' style='color:red'>binaries</span>which had SUID permissions. </p><p id=p810>Command Used : find / -perm -u=s -type f 2>/dev/null </p><p id=p820>Ethical Hacking Training – Resources (InfoSec) </p><p id=p826>One of the interesting binaries which we found was Python, which can also be seen in the highlighted area of the above screenshot. So now we can use this to escalate the privilege of the user to get the root access of the target machine. </p><p id=p871>Command Used : /usr/bin/python2.7 -c 'import pty;pty.spawn("/bin/sh")' </p><p id=p878>As you can see, we have successfully escalated the privilege of the user and gotten the root access. So let's find the flag, which should be available in the root folder. It can be seen in the following screenshot. </p><p id=p917>As you can see in the above screenshot, we've got the flag! There was only one file in the root folder, and that was the flag file. </p><p id=p944>This completes this CTF. I hope you liked this article and enjoyed learning this machine. If you have any questions, I would love to answer them, so please leave them in the comments. </p><p id=p977>SourcesToppo: 1, <span class='token pointer' id='tok-64-36' style='color:red'>Vulnhub</span></p><p id=p980>Download Toppo.zip, Vulnhub </p><p id=p983>Download Toppo.zip (Torrent), Vulnhub
 </p>