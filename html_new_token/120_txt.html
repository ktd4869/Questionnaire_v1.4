<p id=p0><span id='tok'>When</span><span id='tok'>building</span><span id='tok'>a</span><span class='token pointer' id='tok-120-0' style='color:red'>DDoS</span><span class='token pointer' id='tok-120-1' style='color:red'>mitigation</span><span id='tok'>service</span><span id='tok'>it's</span><span id='tok'>incredibly</span><span id='tok'>tempting</span><span id='tok'>to</span><span id='tok'>think</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>solution</span><span id='tok'>is</span><span class='token pointer' id='tok-120-2' style='color:red'>scrubbing</span><span id='tok'>centers</span><span id='tok'>or</span><span class='token pointer' id='tok-120-3' style='color:red'>scrubbing servers.</span><span id='tok'>too,</span><span id='tok'>thought</span><span id='tok'>that</span><span id='tok'>was</span><span id='tok'>a</span><span id='tok'>good</span><span id='tok'>idea</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>beginning,</span><span id='tok'>but</span><span id='tok'>experience</span><span id='tok'>has</span><span id='tok'>shown</span><span id='tok'>that</span><span id='tok'>there</span><span id='tok'>are</span><span id='tok'>serious</span><span id='tok'>pitfalls</span><span id='tok'>to</span><span id='tok'>this</span><span id='tok'>approach.</span></p><p id=p43><span id='tok'>A</span><span id='tok'>scrubbing</span><span id='tok'>server</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>dedicated</span><span id='tok'>machine</span><span id='tok'>that</span><span id='tok'>receives</span><span id='tok'>all</span><span class='token pointer' id='tok-120-4' style='color:red'>network traffic</span><span id='tok'>for</span><span id='tok'>an</span><span class='token pointer' id='tok-120-5' style='color:red'>IP</span><span id='tok'>address</span><span id='tok'>and</span><span id='tok'>attempts</span><span id='tok'>to</span><span id='tok'>filter</span><span id='tok'>good</span><span id='tok'>traffic</span><span id='tok'>from</span><span id='tok'>bad.</span><span id='tok'>Ideally,</span><span id='tok'>the</span><span id='tok'>scrubbing</span><span id='tok'>server</span><span id='tok'>will</span><span id='tok'>only</span><span id='tok'>forward</span><span class='token pointer' id='tok-120-6' style='color:red'>non-DDoS</span><span id='tok'>packets</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>Internet</span><span id='tok'>application</span><span id='tok'>being</span><span id='tok'>attacked.</span><span id='tok'>A</span><span id='tok'>scrubbing</span><span id='tok'>center</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>dedicated</span><span id='tok'>location</span><span id='tok'>filled</span><span id='tok'>with</span><span id='tok'>scrubbing</span><span id='tok'>servers.</span></p><p id=p94><span id='tok'>Three</span><span id='tok'>Problems</span><span id='tok'>With</span><span id='tok'>ScrubbersThe</span><span id='tok'>three</span><span id='tok'>most</span><span id='tok'>pressing</span><span id='tok'>problems</span><span id='tok'>with</span><span id='tok'>scrubbing</span><span id='tok'>are:</span><span class='token pointer' id='tok-120-7' style='color:red'>bandwidth,</span><span id='tok'>cost,</span><span class='token pointer' id='tok-120-8' style='color:red'>knowledge.</span></p><p id=p108><span id='tok'>The</span><span id='tok'>bandwidth</span><span id='tok'>problem</span><span id='tok'>is</span><span id='tok'>easy</span><span id='tok'>to</span><span id='tok'>see.</span><span id='tok'>As</span><span id='tok'>DDoS</span><span id='tok'>attacks</span><span id='tok'>have</span><span id='tok'>scaled</span><span id='tok'>to</span><span id='tok'>>1Tbps</span><span id='tok'>having</span><span id='tok'>that</span><span id='tok'>much</span><span id='tok'>network</span><span id='tok'>capacity</span><span id='tok'>available</span><span id='tok'>is</span><span id='tok'>problematic.</span><span id='tok'>Provisioning</span><span id='tok'>and</span><span id='tok'>maintaining</span><span id='tok'>multiple-Tbps</span><span id='tok'>of</span><span id='tok'>bandwidth</span><span id='tok'>for</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>is</span><span id='tok'>expensive</span><span id='tok'>and</span><span id='tok'>complicated.</span><span id='tok'>And</span><span id='tok'>it</span><span id='tok'>needs</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>located</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>right</span><span id='tok'>place</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>Internet</span><span id='tok'>to</span><span id='tok'>receive</span><span id='tok'>and</span><span id='tok'>absorb</span><span id='tok'>an</span><span id='tok'>attack.</span><span id='tok'>If</span><span id='tok'>it's</span><span id='tok'>not</span><span id='tok'>then</span><span id='tok'>attack</span><span id='tok'>traffic</span><span id='tok'>will</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>received</span><span id='tok'>at</span><span id='tok'>one</span><span id='tok'>location,</span><span id='tok'>scrubbed,</span><span id='tok'>and</span><span id='tok'>then</span><span id='tok'>clean</span><span id='tok'>traffic</span><span id='tok'>forwarded</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>real</span><span id='tok'>server:</span><span id='tok'>that</span><span id='tok'>can</span><span id='tok'>introduce</span><span id='tok'>enormous</span><span id='tok'>delays</span><span id='tok'>with</span><span id='tok'>a</span><span id='tok'>limited</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>locations.</span></p><p id=p197><span id='tok'>Imagine</span><span id='tok'>for</span><span id='tok'>a</span><span id='tok'>moment</span><span id='tok'>you've</span><span id='tok'>built</span><span id='tok'>a</span><span id='tok'>small</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>scrubbing</span><span id='tok'>centers,</span><span id='tok'>and</span><span id='tok'>each</span><span id='tok'>center</span><span id='tok'>is</span><span id='tok'>connected</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>Internet</span><span id='tok'>with</span><span id='tok'>many</span><span class='token pointer' id='tok-120-9' style='color:red'>Gbps</span><span id='tok'>of</span><span id='tok'>connectivity.</span><span id='tok'>When</span><span id='tok'>a</span><span id='tok'>DDoS</span><span id='tok'>attack</span><span id='tok'>occurs</span><span id='tok'>that</span><span id='tok'>center</span><span id='tok'>needs</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>handle</span><span id='tok'>potentially</span><span id='tok'>100s</span><span id='tok'>of</span><span id='tok'>Gbps</span><span id='tok'>of</span><span id='tok'>attack</span><span id='tok'>traffic</span><span id='tok'>at</span><span id='tok'>line</span><span id='tok'>rate.</span><span id='tok'>That</span><span id='tok'>means</span><span id='tok'>exotic</span><span id='tok'>network</span><span id='tok'>and</span><span id='tok'>server</span><span id='tok'>hardware.</span><span id='tok'>Everything</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>line</span><span id='tok'>cards</span><span id='tok'>in</span><span id='tok'>routers,</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>network</span><span id='tok'>adapter</span><span id='tok'>cards</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>servers,</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>servers</span><span id='tok'>themselves</span><span id='tok'>is</span><span id='tok'>going</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>very</span><span id='tok'>expensive.</span></p><p id=p277><span id='tok'>This</span><span id='tok'>(and</span><span id='tok'>bandwidth</span><span id='tok'>above)</span><span id='tok'>is</span><span id='tok'>one</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>reasons</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>has</span><span id='tok'>traditionally</span><span id='tok'>cost</span><span id='tok'>so</span><span id='tok'>much</span><span id='tok'>and</span><span id='tok'>been</span><span id='tok'>billed</span><span id='tok'>by</span><span id='tok'>attack</span><span id='tok'>size.</span></p><p id=p299><span id='tok'>The</span><span id='tok'>final</span><span id='tok'>problem,</span><span id='tok'>knowledge,</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>most</span><span id='tok'>easily</span><span id='tok'>overlooked.</span><span id='tok'>When</span><span id='tok'>you</span><span id='tok'>set</span><span id='tok'>out</span><span id='tok'>to</span><span id='tok'>build</span><span id='tok'>a</span><span id='tok'>scrubbing</span><span id='tok'>server</span><span id='tok'>you</span><span id='tok'>are</span><span id='tok'>building</span><span id='tok'>something</span><span id='tok'>that</span><span id='tok'>has</span><span id='tok'>to</span><span id='tok'>separate</span><span id='tok'>good</span><span id='tok'>packets</span><span id='tok'>from</span><span id='tok'>bad.</span></p><p id=p329><span id='tok'>At</span><span id='tok'>first</span><span id='tok'>this</span><span id='tok'>seems</span><span id='tok'>easy</span><span id='tok'>(let's</span><span id='tok'>filter</span><span id='tok'>out</span><span id='tok'>all</span><span id='tok'>TCP</span><span id='tok'>ACK</span><span id='tok'>packets</span><span id='tok'>for</span><span id='tok'>non-established</span><span id='tok'>connections,</span><span id='tok'>for</span><span id='tok'>example),</span><span id='tok'>and</span><span id='tok'>low</span><span id='tok'>level</span><span id='tok'>engineers</span><span id='tok'>are</span><span id='tok'>easy</span><span id='tok'>to</span><span id='tok'>excite</span><span id='tok'>about</span><span id='tok'>writing</span><span id='tok'>high-performance</span><span id='tok'>code</span><span id='tok'>to</span><span id='tok'>do</span><span id='tok'>that.</span><span id='tok'>But</span><span id='tok'>attackers</span><span id='tok'>are</span><span id='tok'>not</span><span id='tok'>stupid</span><span id='tok'>and</span><span id='tok'>they'll</span><span id='tok'>throw</span><span class='token pointer' id='tok-120-10' style='color:red'>legitimate</span><span id='tok'>looking</span><span id='tok'>traffic</span><span id='tok'>at</span><span id='tok'>a</span><span id='tok'>scrubbing</span><span id='tok'>server</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>gets</span><span id='tok'>harder</span><span id='tok'>and</span><span id='tok'>harder</span><span id='tok'>to</span><span id='tok'>distinguish</span><span id='tok'>good</span><span id='tok'>from</span><span id='tok'>bad.</span></p><p id=p387><span id='tok'>At</span><span id='tok'>that</span><span id='tok'>point,</span><span id='tok'>scrubbing</span><span id='tok'>engineers</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>become</span><span id='tok'>protocol</span><span id='tok'>experts</span><span id='tok'>at</span><span id='tok'>all</span><span id='tok'>levels</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>stack.</span><span id='tok'>That</span><span id='tok'>means</span><span id='tok'>you</span><span id='tok'>have</span><span id='tok'>to</span><span id='tok'>build</span><span id='tok'>a</span><span class='token pointer' id='tok-120-11' style='color:red'>competency</span><span id='tok'>in</span><span id='tok'>all</span><span id='tok'>levels</span><span id='tok'>of</span><span class='token pointer' id='tok-120-12' style='color:red'>TCP/IP,</span><span id='tok'>DNS,</span><span id='tok'>HTTP,</span><span id='tok'>TLS,</span><span id='tok'>etc.</span><span id='tok'>And</span><span id='tok'>that's</span><span id='tok'>hard.</span></p><p id=p423><span id='tok'>CC</span><span id='tok'>BY-SA</span><span id='tok'>2.0</span><span id='tok'>image</span><span id='tok'>by</span><span id='tok'>Lisa</span><span id='tok'>Stevens</span></p><p id=p430><span id='tok'>The</span><span id='tok'>bottom</span><span id='tok'>line</span><span id='tok'>is</span><span id='tok'>scrubbing</span><span id='tok'>centers</span><span id='tok'>and</span><span id='tok'>exotic</span><span id='tok'>hardware</span><span id='tok'>are</span><span id='tok'>great</span><span id='tok'>marketing.</span><span id='tok'>But,</span><span id='tok'>like</span><span class='token pointer' id='tok-120-13' style='color:red'>citadels of medieval times,</span><span id='tok'>are</span><span class='token pointer' id='tok-120-14' style='color:red'>monumentally</span><span id='tok'>expensive</span><span id='tok'>and</span><span id='tok'>outdated,</span><span id='tok'>overwhelmed</span><span id='tok'>by</span><span id='tok'>better</span><span id='tok'>weapons</span><span id='tok'>and</span><span id='tok'>warfighting</span><span id='tok'>techniques.</span></p><p id=p461><span id='tok'>And</span><span id='tok'>many</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>services</span><span id='tok'>that</span><span id='tok'>use</span><span id='tok'>scrubbing</span><span id='tok'>centers</span><span id='tok'>operate</span><span id='tok'>in</span><span id='tok'>an</span><span id='tok'>offline</span><span id='tok'>mode.</span><span id='tok'>They</span><span id='tok'>are</span><span id='tok'>only</span><span id='tok'>enabled</span><span id='tok'>when</span><span id='tok'>a</span><span id='tok'>DDoS</span><span id='tok'>occurs.</span><span id='tok'>This</span><span id='tok'>typically</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>an</span><span id='tok'>Internet</span><span id='tok'>application</span><span id='tok'>will</span><span id='tok'>succumb</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>DDoS</span><span id='tok'>attack</span><span id='tok'>before</span><span id='tok'>its</span><span id='tok'>traffic</span><span id='tok'>is</span><span id='tok'>diverted</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>scrubbing</span><span id='tok'>center.</span></p><p id=p505><span id='tok'>Just</span><span id='tok'>imagine</span><span id='tok'>citizens</span><span id='tok'>fleeing</span><span id='tok'>to</span><span id='tok'>hide</span><span id='tok'>behind</span><span id='tok'>the</span><span id='tok'>walls</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>citadel</span><span id='tok'>under</span><span id='tok'>fire</span><span id='tok'>from</span><span id='tok'>an</span><span id='tok'>approaching</span><span id='tok'>army.</span></p><p id=p523><span id='tok'>Better,</span><span id='tok'>Cheaper,</span><span id='tok'>SmarterThere's</span><span id='tok'>a</span><span id='tok'>subtler</span><span id='tok'>point</span><span id='tok'>about</span><span id='tok'>not</span><span id='tok'>having</span><span id='tok'>dedicated</span><span id='tok'>scrubbers:</span><span id='tok'>it</span><span id='tok'>forces</span><span id='tok'>us</span><span id='tok'>to</span><span id='tok'>build</span><span id='tok'>better</span><span id='tok'>software.</span><span id='tok'>If</span><span id='tok'>a</span><span id='tok'>scrubbing</span><span id='tok'>server</span><span id='tok'>becomes</span><span id='tok'>overwhelmed</span><span id='tok'>or</span><span id='tok'>fails</span><span id='tok'>then</span><span id='tok'>only</span><span id='tok'>the</span><span id='tok'>customer</span><span id='tok'>being</span><span id='tok'>scrubbed</span><span id='tok'>is</span><span id='tok'>affected,</span><span id='tok'>but</span><span id='tok'>when</span><span id='tok'>the</span><span id='tok'>mitigation</span><span id='tok'>happens</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>very</span><span id='tok'>servers</span><span id='tok'>running</span><span id='tok'>the</span><span id='tok'>core</span><span id='tok'>service</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>to</span><span id='tok'>work</span><span id='tok'>and</span><span id='tok'>be</span><span id='tok'>effective.</span></p><p id=p577><span id='tok'>I</span><span id='tok'>spoke</span><span id='tok'>above</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>'knowledge</span><span id='tok'>gap'</span><span id='tok'>that</span><span id='tok'>comes</span><span id='tok'>about</span><span id='tok'>with</span><span id='tok'>dedicated</span><span id='tok'>DDoS</span><span id='tok'>scrubbing.</span><span id='tok'>The</span><span class='token pointer' id='tok-120-15' style='color:red'>Cloudflare</span><span id='tok'>approach</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>if</span><span id='tok'>bad</span><span id='tok'>traffic</span><span id='tok'>gets</span><span id='tok'>through,</span><span id='tok'>say</span><span id='tok'>a</span><span id='tok'>flood</span><span id='tok'>of</span><span id='tok'>bad</span><span id='tok'>DNS</span><span id='tok'>packets,</span><span id='tok'>then</span><span id='tok'>it</span><span id='tok'>reaches</span><span id='tok'>a</span><span id='tok'>service</span><span id='tok'>owned</span><span id='tok'>and</span><span id='tok'>operated</span><span id='tok'>by</span><span id='tok'>people</span><span id='tok'>who</span><span id='tok'>are</span><span id='tok'>experts</span><span id='tok'>in</span><span id='tok'>that</span><span id='tok'>domain.</span><span id='tok'>If</span><span id='tok'>a</span><span id='tok'>DNS</span><span id='tok'>flood</span><span id='tok'>gets</span><span id='tok'>through</span><span id='tok'>our</span><span id='tok'>DDoS</span><span id='tok'>protection</span><span id='tok'>it</span><span id='tok'>hits</span><span id='tok'>our</span><span id='tok'>custom</span><span id='tok'>DNS</span><span id='tok'>server,</span><span id='tok'>RRDNS,</span><span id='tok'>the</span><span id='tok'>engineers</span><span id='tok'>who</span><span id='tok'>work</span><span id='tok'>on</span><span id='tok'>it</span><span id='tok'>can</span><span id='tok'>bring</span><span id='tok'>their</span><span id='tok'>expertise</span><span id='tok'>to</span><span id='tok'>bear.</span></p><p id=p652><span id='tok'>This</span><span id='tok'>makes</span><span id='tok'>an</span><span id='tok'>enormous</span><span id='tok'>difference</span><span id='tok'>because</span><span id='tok'>the</span><span id='tok'>result</span><span id='tok'>is</span><span id='tok'>either</span><span id='tok'>improved</span><span id='tok'>DDoS</span><span id='tok'>scrubbing</span><span id='tok'>or</span><span id='tok'>a</span><span id='tok'>change</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>software</span><span id='tok'>(e.g.</span><span id='tok'>the</span><span id='tok'>DNS</span><span id='tok'>stack)</span><span id='tok'>that</span><span id='tok'>improves</span><span id='tok'>its</span><span id='tok'>performance</span><span id='tok'>under</span><span id='tok'>load.</span><span id='tok'>We've</span><span id='tok'>lived</span><span id='tok'>that</span><span id='tok'>story</span><span id='tok'>many,</span><span id='tok'>many</span><span id='tok'>times</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>entire</span><span id='tok'>software</span><span id='tok'>stack</span><span id='tok'>has</span><span id='tok'>improved</span><span id='tok'>because</span><span id='tok'>of</span><span id='tok'>it.</span></p><p id=p698><span id='tok'>The</span><span id='tok'>approach</span><span id='tok'>Cloudflare</span><span id='tok'>took</span><span id='tok'>to</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>is</span><span id='tok'>rather</span><span id='tok'>simple:</span><span id='tok'>make</span><span id='tok'>every</span><span id='tok'>single</span><span id='tok'>server</span><span id='tok'>in</span><span id='tok'>Cloudflare</span><span id='tok'>participate</span><span id='tok'>in</span><span id='tok'>mitigation,</span><span id='tok'>load</span><span id='tok'>balance</span><span id='tok'>DDoS</span><span id='tok'>attacks</span><span id='tok'>across</span><span id='tok'>the</span><span id='tok'>data</span><span id='tok'>centers</span><span id='tok'>and</span><span id='tok'>servers</span><span id='tok'>within</span><span id='tok'>them</span><span id='tok'>and</span><span id='tok'>then</span><span id='tok'>apply</span><span id='tok'>smarts</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>handling</span><span id='tok'>of</span><span id='tok'>packets.</span><span id='tok'>These</span><span id='tok'>are</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>servers,</span><span id='tok'>processors</span><span id='tok'>and</span><span id='tok'>cores</span><span id='tok'>handling</span><span id='tok'>our</span><span id='tok'>entire</span><span id='tok'>service.</span></p><p id=p750><span id='tok'>Eliminating</span><span id='tok'>scrubbing</span><span id='tok'>centers</span><span id='tok'>and</span><span id='tok'>hardware</span><span id='tok'>completely</span><span id='tok'>changes</span><span id='tok'>the</span><span id='tok'>cost</span><span id='tok'>of</span><span id='tok'>building</span><span id='tok'>a</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>service.</span></p><p id=p765><span id='tok'>We</span><span id='tok'>currently</span><span id='tok'>have</span><span id='tok'>around</span><span id='tok'>15</span><span id='tok'>Tbps</span><span id='tok'>of</span><span id='tok'>network</span><span id='tok'>capacity</span><span id='tok'>worldwide</span><span id='tok'>but</span><span id='tok'>this</span><span id='tok'>capacity</span><span id='tok'>doesn't</span><span id='tok'>require</span><span id='tok'>exotic</span><span id='tok'>network</span><span id='tok'>hardware.</span><span id='tok'>We</span><span id='tok'>are</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>use</span><span id='tok'>low</span><span id='tok'>cost</span><span id='tok'>or</span><span class='token pointer' id='tok-120-16' style='color:red'>commodity</span><span id='tok'>networking</span><span id='tok'>equipment</span><span id='tok'>bound</span><span id='tok'>together</span><span id='tok'>using</span><span id='tok'>network</span><span id='tok'>automation</span><span id='tok'>to</span><span id='tok'>handle</span><span id='tok'>normal</span><span id='tok'>and</span><span id='tok'>DDoS</span><span id='tok'>traffic.</span><span id='tok'>Just</span><span id='tok'>as</span><span id='tok'>Google</span><span id='tok'>originally</span><span id='tok'>built</span><span id='tok'>its</span><span id='tok'>service</span><span id='tok'>by</span><span id='tok'>writing</span><span id='tok'>software</span><span id='tok'>that</span><span id='tok'>tied</span><span id='tok'>together</span><span id='tok'>commodity</span><span id='tok'>servers</span><span id='tok'>into</span><span id='tok'>a</span><span id='tok'>super</span><span id='tok'>(search)</span><span id='tok'>computer;</span><span id='tok'>our</span><span id='tok'>architecture</span><span id='tok'>binds</span><span id='tok'>commodity</span><span id='tok'>servers</span><span id='tok'>together</span><span id='tok'>into</span><span id='tok'>one</span><span id='tok'>giant</span><span id='tok'>network</span><span id='tok'>device.</span></p><p id=p836><span id='tok'>By</span><span id='tok'>building</span><span id='tok'>the</span><span id='tok'>world's</span><span id='tok'>most</span><span id='tok'>peered</span><span id='tok'>network</span><span id='tok'>we've</span><span id='tok'>built</span><span id='tok'>this</span><span id='tok'>capacity</span><span id='tok'>at</span><span id='tok'>reasonable</span><span id='tok'>cost</span><span id='tok'>and</span><span id='tok'>more</span><span id='tok'>importantly</span><span id='tok'>are</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>handle</span><span id='tok'>attack</span><span id='tok'>traffic</span><span id='tok'>globally</span><span id='tok'>wherever</span><span id='tok'>it</span><span id='tok'>originates</span><span id='tok'>with</span><span id='tok'>low</span><span id='tok'>latency</span><span id='tok'>links.</span><span id='tok'>No</span><span id='tok'>scrubbing</span><span id='tok'>solution</span><span id='tok'>is</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>say</span><span id='tok'>the</span><span id='tok'>same.</span></p><p id=p876><span id='tok'>And</span><span id='tok'>because</span><span id='tok'>Cloudflare</span><span id='tok'>manages</span><span id='tok'>DNS</span><span id='tok'>for</span><span id='tok'>our</span><span id='tok'>customers</span><span id='tok'>and</span><span id='tok'>uses</span><span id='tok'>an</span><span id='tok'>Anycasted</span><span id='tok'>network</span><span id='tok'>attack</span><span id='tok'>traffic</span><span id='tok'>originating</span><span id='tok'>from</span><span id='tok'>botnets</span><span id='tok'>is</span><span id='tok'>automatically</span><span id='tok'>distributed</span><span id='tok'>across</span><span id='tok'>our</span><span id='tok'>global</span><span id='tok'>network.</span><span id='tok'>Each</span><span id='tok'>data</span><span id='tok'>center</span><span id='tok'>deals</span><span id='tok'>with</span><span id='tok'>a</span><span id='tok'>portion</span><span id='tok'>of</span><span id='tok'>DDoS</span><span id='tok'>traffic.</span></p><p id=p911><span id='tok'>Within</span><span id='tok'>each</span><span id='tok'>data</span><span id='tok'>center</span><span id='tok'>DDoS</span><span id='tok'>traffic</span><span id='tok'>is</span><span id='tok'>load</span><span id='tok'>balanced</span><span id='tok'>across</span><span id='tok'>multiple</span><span id='tok'>servers</span><span id='tok'>running</span><span id='tok'>our</span><span id='tok'>service.</span><span id='tok'>Each</span><span id='tok'>server</span><span id='tok'>handles</span><span id='tok'>a</span><span id='tok'>portion</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>DDoS</span><span id='tok'>traffic.</span><span id='tok'>This</span><span id='tok'>spreading</span><span id='tok'>of</span><span id='tok'>DDoS</span><span id='tok'>traffic</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>a</span><span id='tok'>single</span><span id='tok'>DDoS</span><span id='tok'>attack</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>handled</span><span id='tok'>by</span><span id='tok'>a</span><span id='tok'>large</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>individual</span><span id='tok'>servers</span><span id='tok'>across</span><span id='tok'>the</span><span id='tok'>world.</span></p><p id=p959><span id='tok'>And</span><span id='tok'>as</span><span id='tok'>Cloudflare</span><span id='tok'>grows</span><span id='tok'>our</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>capacity</span><span id='tok'>grows</span><span id='tok'>automatically,</span><span id='tok'>and</span><span id='tok'>because</span><span id='tok'>our</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>is</span><span id='tok'>built</span><span id='tok'>into</span><span id='tok'>our</span><span id='tok'>stack</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>always</span><span id='tok'>on.</span><span id='tok'>We</span><span id='tok'>mitigate</span><span id='tok'>a</span><span id='tok'>new</span><span id='tok'>DDoS</span><span id='tok'>attack</span><span id='tok'>every</span><span id='tok'>three</span><span id='tok'>minutes</span><span id='tok'>with</span><span id='tok'>no</span><span id='tok'>downtime</span><span id='tok'>for</span><span id='tok'>Internet</span><span id='tok'>applications</span><span id='tok'>and</span><span id='tok'>have</span><span id='tok'>no</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>'switch</span><span id='tok'>over'</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>scrubbing</span><span id='tok'>center.</span></p><p id=p1009><span id='tok'>Inside</span><span id='tok'>a</span><span id='tok'>ServerOnce</span><span id='tok'>all</span><span id='tok'>this</span><span id='tok'>global</span><span id='tok'>and</span><span id='tok'>local</span><span id='tok'>load</span><span id='tok'>balancing</span><span id='tok'>has</span><span id='tok'>occurred</span><span id='tok'>packets</span><span id='tok'>do</span><span id='tok'>finally</span><span id='tok'>hit</span><span id='tok'>a</span><span id='tok'>network</span><span id='tok'>adapter</span><span id='tok'>card</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>server.</span><span id='tok'>It's</span><span id='tok'>here</span><span id='tok'>that</span><span class='token pointer' id='tok-120-17' style='color:red'>Cloudflare's</span><span id='tok'>custom</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>stack</span><span id='tok'>comes</span><span id='tok'>into</span><span id='tok'>play.</span></p><p id=p1043><span id='tok'>Over</span><span id='tok'>the</span><span id='tok'>years</span><span id='tok'>we've</span><span id='tok'>learned</span><span id='tok'>how</span><span id='tok'>to</span><span id='tok'>automatically</span><span id='tok'>detect</span><span id='tok'>and</span><span id='tok'>mitigate</span><span id='tok'>anything</span><span id='tok'>the</span><span id='tok'>internet</span><span id='tok'>can</span><span id='tok'>throw</span><span id='tok'>at</span><span id='tok'>us.</span><span id='tok'>For</span><span id='tok'>most</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>attacks,</span><span id='tok'>we</span><span id='tok'>rely</span><span id='tok'>on</span><span id='tok'>dynamically</span><span id='tok'>managing</span><span class='token pointer' id='tok-120-18' style='color:red'>iptables:</span><span id='tok'>the</span><span id='tok'>standard</span><span id='tok'>Linux</span><span id='tok'>firewall.</span><span id='tok'>We've</span><span id='tok'>spoken</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>most</span><span id='tok'>effective</span><span id='tok'>techniques</span><span id='tok'>in</span><span id='tok'>past.</span><span id='tok'>iptables</span><span id='tok'>has</span><span id='tok'>a</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>very</span><span id='tok'>powerful</span><span id='tok'>features</span><span id='tok'>which</span><span id='tok'>we</span><span id='tok'>select</span><span id='tok'>depending</span><span id='tok'>on</span><span id='tok'>specific</span><span id='tok'>attack</span><span id='tok'>vector.</span><span id='tok'>From</span><span id='tok'>our</span><span id='tok'>experience</span><span class='token pointer' id='tok-120-19' style='color:red'>xt_bpf,</span><span id='tok'>ipset,</span><span id='tok'>hashlimits</span><span id='tok'>and</span><span id='tok'>connlimits</span><span id='tok'>are</span><span id='tok'>the</span><span id='tok'>most</span><span id='tok'>useful</span><span id='tok'>iptables</span><span id='tok'>modules.</span></p><p id=p1115><span id='tok'>For</span><span id='tok'>very</span><span id='tok'>large</span><span id='tok'>attacks</span><span id='tok'>the</span><span id='tok'>Linux</span><span id='tok'>Kernel</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>fast</span><span id='tok'>enough</span><span id='tok'>though.</span><span id='tok'>To</span><span id='tok'>relieve</span><span id='tok'>the</span><span class='token pointer' id='tok-120-20' style='color:red'>kernel</span><span id='tok'>from</span><span id='tok'>processing</span><span id='tok'>excessive</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>packets,</span><span id='tok'>we</span><span id='tok'>experimented</span><span id='tok'>with</span><span id='tok'>various</span><span id='tok'>kernel</span><span id='tok'>bypass</span><span id='tok'>techniques.</span><span id='tok'>We've</span><span id='tok'>settled</span><span id='tok'>on</span><span id='tok'>a</span><span id='tok'>partial</span><span id='tok'>kernel</span><span id='tok'>bypass</span><span id='tok'>interface</span><span id='tok'>-</span><span class='token pointer' id='tok-120-21' style='color:red'>Solarflare</span><span id='tok'>specific</span><span id='tok'>EFVI.</span></p><p id=p1156><span id='tok'>Conclusion:</span><span id='tok'>Cloudflare's</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>architecture</span><span id='tok'>and</span><span id='tok'>custom</span><span id='tok'>software</span><span id='tok'>makes</span><span id='tok'>Unmetered</span><span id='tok'>Mitigation</span><span id='tok'>possible.</span><span id='tok'>With</span><span id='tok'>it</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>withstand</span><span id='tok'>the</span><span id='tok'>largest</span><span id='tok'>DDoS</span><span id='tok'>attacks</span><span id='tok'>and</span><span id='tok'>as</span><span id='tok'>our</span><span id='tok'>network</span><span id='tok'>grows</span><span id='tok'>our</span><span id='tok'>DDoS</span><span id='tok'>mitigation</span><span id='tok'>capability</span><span id='tok'>grows</span><span id='tok'>with</span><span id='tok'>it.
</span></p>