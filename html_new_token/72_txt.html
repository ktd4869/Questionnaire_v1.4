<p id=p0>The biggest fear of any developer has always been that their site may get hacked and occasionally it does end up being hacked. For a very long time, the most popular stack being used for the development of website has been the <span class='token pointer' id='tok-72-0' style='color:red'>MySQL,</span><span class='token pointer' id='tok-72-1' style='color:red'>PHP/Perl/Python).</span><span class='token pointer' id='tok-72-2' style='color:red'>LAMP Stack (Linux,</span>of which, the most frequently used language was <span class='token pointer' id='tok-72-3' style='color:red'>PHP.</span>Many major websites such as Facebook (early version), Wikipedia, Yahoo, MailChimp, WordPress, etc. have been built on PHP. </p><p id=p75>Although, many measures have been taken by various developers to make their PHP application as secure as possible. However, PHP when used raw, can be vulnerable. Considering that these mistakes cannot always be avoided, come <span class='token pointer' id='tok-72-4' style='color:red'>RIPS</span>to our rescue. </p><p id=p114>RIPS is a <span class='token pointer' id='tok-72-5' style='color:red'>source code</span>that detects possible vulnerabilities in a PHP code. RIPS tokenizes and <span class='token pointer' id='tok-72-6' style='color:red'>parses</span>the entire source code by transforming the PHP code into programs models and detects the possible vulnerable functions that can be compromised by a user input. It also offers an integrated code audit framework for further manual analysis. </p><p id=p170>RIPS covers a vast range of vulnerabilities, such <span class='token pointer' id='tok-72-7' style='color:red'>(XSS)</span><span class='token pointer' id='tok-72-8' style='color:red'>InclusionFile ManipulationLDAP InjectionSQL InjectionXPath InjectionUnserialize</span><span class='token pointer' id='tok-72-9' style='color:red'>POPA</span>Few details about the Code Audit Interface:Scan and <span class='token pointer' id='tok-72-10' style='color:red'>vulnerability</span>StatsGrouped vulnerable code lines (bottom up or top down)Vulnerability description with example code, <span class='token pointer' id='tok-72-11' style='color:red'>PoC,</span><span class='token pointer' id='tok-72-12' style='color:red'>patchExploit creatorFile list</span><span class='token pointer' id='tok-72-13' style='color:red'>graphFunction list</span><span class='token pointer' id='tok-72-14' style='color:red'>graphUser Input listSource code</span>with highlightingActive jumping between function callsSearching via <span class='token pointer' id='tok-72-15' style='color:red'>Regular Expression (regex)Eight</span>highlighting designsA Few details about its static code analysis: It is fastTokenizing with PHP tokenizer extension Taint analysis for 232 sensitive sinksInter- and Intra-Procedural analysisHandles very <span class='token pointer' id='tok-72-16' style='color:red'>PHP-specific</span>behaviorHandles user-defined securingReconstruct file inclusionsDetecting blind/non-blind exploitationDetecting Backdoors. </p><p id=p275>Note: You will require a local web <span class='token pointer' id='tok-72-17' style='color:red'>server,</span>such as MAMP/WAMP/XWAMP (depending on your Operating System), installed on the system you want to run RIPS on. Once downloaded, extract the file to your web server. Usually, the path is /var/www/rips or in the htdocs folder. </p><p id=p320>Once done, you can access at http://localhost/rips/ </p><p id=p327>This is what RIPS looks like when started: </p><p id=p335>RIPS gives us the ability to scan a single PHP file or a complete PHP application folder. We start by entering the path of our project or file (marked in red) and select if we enter the path of a folder, the subdirs checkbox (marked in yellow) if we want RIPS to scan the sub-directories of that folder as well. </p><p id=p395>Next, we start to select the vulnerability we want to scan for (marked in green). In this case, RIPS gives us a few options: </p><p id=p419>All the vulnerabilities present in RIPSAll Server-Side vulnerabilitiesAll Client-Side VulnerabilitiesA particular vulnerabilityNote: More vulnerabilities we select and bigger the application we are scanning; the more time RIPS will take to do its job. </p><p id=p452>Next, we select the <span class='token pointer' id='tok-72-18' style='color:red'>verbosity</span>level (marked in purple). RIPS gives us five different levels: </p><p id=p467>User tainted – It scans only for PVF calls which are tainted with user input.File/DB tainted +1 – This also factors file and database content as potentially malicious user input.Show Secured +1,2 – It will also output secured PVF calls. This is important to detect insufficient securing's which are sometimes hard to detect by a static code analyzer automatically.Untainted +1,2,3 – It shows additional information RIPS collected during the scan such as exists, notes about the success of analyzing, included files and calls of functions.Debug Mode – It shows all PVF calls and its traces whether to not tainted by user input. However, this level can lead to a lot of false positives. </p><p id=p580>I have written a small PHP file which is vulnerable to XSS. Let's see if RIPS can figure that out or not: </p><p id=p602>We can see that RIPS tells us that our code in "test.php" is vulnerable to XSS. Let's see if this is actually the case or if it is a false positive: </p><p id=p633>As we can see, the code is vulnerable to XSS. By pressing the small help icon (marked in black) on the left-hand side will show us more information on XSS: </p><p id=p663>So as we can see, the concept of XSS in that if we use a $_GET source and directly print it using echo, it results in XSS. Let's see if this is what our code looks like or not: </p><p id=p702>Yep, that is exactly what our code looks like. Hence, the vulnerability. We can also see that RIPS has marked our user input as tainted: </p><p id=p727>For a further test, we will be using Damn Vulnerable Web Application (DVWA). It is an <span class='token pointer' id='tok-72-19' style='color:red'>open source</span>on which we can practice various security tests at various levels. Installation instructions and setup is present with it. </p><p id=p765>Let's try a different vulnerability, say File <span class='token pointer' id='tok-72-20' style='color:red'>Inclusion:</span></p><p id=p773>First, we will search the file to see if that vulnerability exists or not: </p><p id=p787>As we can see, it shows that this is vulnerable to <span class='token pointer' id='tok-72-21' style='color:red'>File Inclusion.</span>the graph generated by RIPS, we can also see the source of the vulnerability: </p><p id=p815>Ethical Hacking Training – Resources (InfoSec) </p><p id=p821>In the code viewer, we can also the highlighted vulnerable piece of code: </p><p id=p834>We can also use its exploit creator to create a PoC: </p><p id=p845>Now that we have so much information, let's see if it is actually vulnerable or not: </p><p id=p861>Yes, this confirms that the code is vulnerable to File Inclusion. </p><p id=p872>The same way, we can test for various other vulnerabilities as listed above. </p><p id=p885>Conclusion: There are various other open source web application scanners that are used to find vulnerabilities in a black box testing. However, a source code review in a white box case can lead to much better results, but only a handful of open source PHP source code analyzers are out there. Due to the limitations of a static code analyzer, some false positives can occur, and a manual review of the result is recommended. Overall, RIPS is a good analyzing tool, but you cannot solely rely on it. </p><p id=p973>     </p>