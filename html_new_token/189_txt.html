<p id=p0><span id='tok'>Situation</span><span id='tok'>Summary</span><span id='tok'>This</span><span id='tok'>Unit</span><span id='tok'>42</span><span id='tok'>blog</span><span id='tok'>provides</span><span id='tok'>an</span><span id='tok'>update</span><span id='tok'>on</span><span id='tok'>the</span><span class='token pointer' id='tok-189-0' style='color:red'>threat</span><span id='tok'>situation</span><span id='tok'>surrounding</span><span id='tok'>attacks</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-189-1' style='color:red'>Ransomware</span><span class='token pointer' id='tok-189-2' style='color:red'>Petya</span><span id='tok'>are</span><span id='tok'>impacting</span><span id='tok'>organizations</span><span id='tok'>in</span><span class='token pointer' id='tok-189-3' style='color:red'>Ukraine,</span><span id='tok'>Russia</span><span id='tok'>and</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>lesser</span><span id='tok'>extent</span><span id='tok'>around</span><span id='tok'>the</span><span id='tok'>world.</span></p><p id=p34><span id='tok'>On</span><span id='tok'>June</span><span id='tok'>27th,</span><span id='tok'>2017</span><span id='tok'>we</span><span id='tok'>became</span><span id='tok'>aware</span><span id='tok'>of</span><span id='tok'>a</span><span id='tok'>new</span><span id='tok'>variant</span><span id='tok'>of</span><span id='tok'>the</span><span class='token pointer' id='tok-189-4' style='color:red'>Petya</span><span class='token pointer' id='tok-189-5' style='color:red'>malware</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>spreading</span><span id='tok'>through</span><span id='tok'>multiple</span><span class='token pointer' id='tok-189-6' style='color:red'>lateral movement techniques.</span><span id='tok'>technique</span><span id='tok'>includes</span><span class='token pointer' id='tok-189-7' style='color:red'> the ETERNALBLUE exploit</span><span id='tok'>tool.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>exploit</span><span class='token pointer' id='tok-189-8' style='color:red'>the WanaCrypt0r/WannaCry</span><span id='tok'>malware</span><span id='tok'>exploited</span><span id='tok'>to</span><span id='tok'>spread</span><span id='tok'>globally</span><span id='tok'>in</span><span id='tok'>May,</span><span id='tok'>2017.</span><span id='tok'>At</span><span id='tok'>least</span><span id='tok'>50</span><span id='tok'>organizations</span><span id='tok'>have</span><span id='tok'>reported</span><span id='tok'>impacts</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>malware,</span><span id='tok'>including</span><span id='tok'>government</span><span id='tok'>and</span><span id='tok'>critical</span><span id='tok'>infrastructure</span><span id='tok'>operators.</span><span id='tok'>Most</span><span class='token pointer' id='tok-189-9' style='color:red'>impacted</span><span id='tok'>organizations</span><span id='tok'>are</span><span id='tok'>located</span><span id='tok'>in</span><span id='tok'>Ukraine,</span><span id='tok'>but</span><span id='tok'>global</span><span id='tok'>organizations</span><span id='tok'>with</span><span id='tok'>offices</span><span id='tok'>in</span><span id='tok'>Ukraine</span><span id='tok'>have</span><span id='tok'>seen</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>spread</span><span id='tok'>within</span><span id='tok'>their</span><span id='tok'>network</span><span id='tok'>across</span><span id='tok'>national</span><span id='tok'>borders.</span></p><p id=p117><span id='tok'>Palo</span><span id='tok'>Alto</span><span class='token pointer' id='tok-189-10' style='color:red'>Networks</span><span id='tok'>is</span><span id='tok'>documenting</span><span id='tok'>our</span><span id='tok'>prevention</span><span id='tok'>capabilities</span><span id='tok'>with</span><span id='tok'>regard</span><span id='tok'>to</span><span id='tok'>this</span><span id='tok'>threat</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>Palo</span><span id='tok'>Alto</span><span id='tok'>Networks</span><span id='tok'>Protections</span><span id='tok'>for</span><span id='tok'>Petya</span><span id='tok'>Ransomware</span><span id='tok'>blog</span><span id='tok'>post.</span><span id='tok'>Windows</span><span id='tok'>users</span><span id='tok'>should</span><span id='tok'>take</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>general</span><span id='tok'>steps</span><span id='tok'>to</span><span id='tok'>protect</span><span id='tok'>themselves:</span></p><p id=p152><span id='tok'>Apply</span><span id='tok'>security</span><span id='tok'>updates</span><span id='tok'>in</span><span class='token pointer' id='tok-189-11' style='color:red'>MS17-010Block</span><span id='tok'>inbound</span><span id='tok'>connections</span><span id='tok'>on</span><span class='token pointer' id='tok-189-12' style='color:red'>Port</span><span class='token pointer' id='tok-189-13' style='color:red'>445Create</span><span class='token pointer' id='tok-189-14' style='color:red'>TCP</span><span id='tok'>maintain</span><span id='tok'>good</span><span id='tok'>back-ups</span><span id='tok'>so</span><span id='tok'>that</span><span id='tok'>if</span><span id='tok'>an</span><span id='tok'>infection</span><span id='tok'>occurs,</span><span id='tok'>you</span><span id='tok'>can</span><span id='tok'>restore</span><span id='tok'>your</span><span id='tok'>data.This</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>developing</span><span id='tok'>situation,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>update</span><span id='tok'>this</span><span id='tok'>blog</span><span id='tok'>as</span><span id='tok'>new</span><span id='tok'>information</span><span id='tok'>becomes</span><span id='tok'>available.</span><span class='token pointer' id='tok-189-15' style='color:red'>AutoFocus</span><span id='tok'>users</span><span id='tok'>view</span><span id='tok'>samples</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>Petya</span><span id='tok'>tag.</span></p><p id=p200><span id='tok'>Attack</span><span id='tok'>OverviewPetya</span><span id='tok'>is</span><span id='tok'>a</span><span class='token pointer' id='tok-189-16' style='color:red'>ransomware</span><span id='tok'>family</span><span id='tok'>that</span><span id='tok'>works</span><span id='tok'>by</span><span class='token pointer' id='tok-189-17' style='color:red'>modifying</span><span id='tok'>the</span><span id='tok'>Window's</span><span id='tok'>system's</span><span class='token pointer' id='tok-189-18' style='color:red'>Boot</span><span class='token pointer' id='tok-189-19' style='color:red'>Record</span><span class='token pointer' id='tok-189-20' style='color:red'>Master</span><span id='tok'>causing</span><span id='tok'>the</span><span id='tok'>system</span><span id='tok'>to</span><span id='tok'>crash.</span><span id='tok'>When</span><span id='tok'>the</span><span id='tok'>user</span><span class='token pointer' id='tok-189-21' style='color:red'>reboots</span><span id='tok'>their</span><span id='tok'>PC,</span><span id='tok'>the</span><span class='token pointer' id='tok-189-22' style='color:red'>modified</span><span id='tok'>MBR</span><span id='tok'>prevents</span><span id='tok'>Windows</span><span id='tok'>from</span><span id='tok'>loading</span><span id='tok'>and</span><span id='tok'>displays</span><span id='tok'>a</span><span id='tok'>fake</span><span class='token pointer' id='tok-189-23' style='color:red'>"chkdisk"</span><span id='tok'>screen</span><span id='tok'>which</span><span id='tok'>indicates</span><span id='tok'>the</span><span id='tok'>computer's</span><span id='tok'>hard</span><span id='tok'>drive</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>repaired,</span><span id='tok'>but</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>is</span><span id='tok'>actually</span><span id='tok'>encrypting</span><span id='tok'>the</span><span id='tok'>user's</span><span id='tok'>files.</span><span id='tok'> When</span><span id='tok'>this</span><span id='tok'>process</span><span id='tok'>completes,</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>displays</span><span id='tok'>an</span><span class='token pointer' id='tok-189-24' style='color:red'>ASCII</span><span id='tok'>Ransom</span><span id='tok'>note</span><span id='tok'>demanding</span><span id='tok'>payment</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>.</span></p><p id=p276><span id='tok'>The</span><span id='tok'>latest</span><span id='tok'>version</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>Petya</span><span id='tok'>ransomware</span><span id='tok'>is</span><span id='tok'>spreading</span><span id='tok'>over</span><span id='tok'>Windows</span><span id='tok'>SMB</span><span id='tok'>and</span><span id='tok'>is</span><span id='tok'>reportedly</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-189-25' style='color:red'>ETERNALBLUE exploit</span><span id='tok'>tool,</span><span id='tok'>which</span><span id='tok'>exploits</span><span class='token pointer' id='tok-189-26' style='color:red'>CVE-2017-0144</span><span id='tok'>and</span><span id='tok'>was</span><span id='tok'>originally</span><span id='tok'>released</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>Shadow</span><span id='tok'>Brokers</span><span id='tok'>group</span><span id='tok'>in</span><span id='tok'>April</span><span id='tok'>2017.</span></p><p id=p310><span id='tok'>After</span><span id='tok'>the</span><span id='tok'>system</span><span id='tok'>is</span><span id='tok'>compromised</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>is</span><span id='tok'>asked</span><span id='tok'>to</span><span id='tok'>send</span><span id='tok'>US</span><span id='tok'>$300</span><span id='tok'>in</span><span class='token pointer' id='tok-189-27' style='color:red'>Bitcoin</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>specific</span><span id='tok'>Bitcoin</span><span id='tok'>address</span><span id='tok'>and</span><span id='tok'>then</span><span id='tok'>send</span><span id='tok'>an</span><span id='tok'>e-mail</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>victim's</span><span id='tok'>bitcoin</span><span id='tok'>wallet</span><span id='tok'>ID</span><span id='tok'>to</span><span id='tok'>wowsmith123456@posteo[.]net</span><span id='tok'>to</span><span id='tok'>retrieve</span><span id='tok'>their</span><span id='tok'>individual</span><span class='token pointer' id='tok-189-28' style='color:red'>decryption</span><span id='tok'>key.</span><span id='tok'> Posteo</span><span id='tok'>(a</span><span id='tok'>free</span><span id='tok'>e-mail</span><span id='tok'>provider)</span><span id='tok'>has</span><span id='tok'>already</span><span id='tok'>shut</span><span id='tok'>down</span><span id='tok'>this</span><span id='tok'>e-mail</span><span id='tok'>address,</span><span id='tok'>and</span><span id='tok'>as</span><span id='tok'>such</span><span id='tok'>victims</span><span id='tok'>should</span><span id='tok'>not</span><span id='tok'>even</span><span id='tok'>attempt</span><span id='tok'>to</span><span id='tok'>pay</span><span id='tok'>the</span><span id='tok'>ransom.</span><span id='tok'>As</span><span id='tok'>of</span><span id='tok'>13:00</span><span id='tok'>UTC</span><span id='tok'>on</span><span id='tok'>June</span><span id='tok'>28thth,</span><span class='token pointer' id='tok-189-29' style='color:red'>approximately</span><span id='tok'>4</span><span id='tok'>Bitcoin</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>transferred</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>attacker's</span><span id='tok'>wallet.</span></p><p id=p390><span id='tok'>Unit</span><span id='tok'>42</span><span id='tok'>is</span><span id='tok'>unaware</span><span id='tok'>of</span><span id='tok'>ANY</span><span id='tok'>successful</span><span id='tok'>recovery</span><span id='tok'>after</span><span id='tok'>paying</span><span id='tok'>the</span><span id='tok'>ransom.</span><span id='tok'>Additionally,</span><span id='tok'>ongoing</span><span id='tok'>research</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>industry</span><span id='tok'>is</span><span id='tok'>showing</span><span id='tok'>that</span><span id='tok'>specific</span><span id='tok'>actions</span><span id='tok'>this</span><span id='tok'>malware</span><span id='tok'>takes</span><span id='tok'>makes</span><span id='tok'>it</span><span id='tok'>technically</span><span id='tok'>infeasible,</span><span id='tok'>if</span><span id='tok'>not</span><span id='tok'>impossible,</span><span id='tok'>for</span><span id='tok'>recovery</span><span id='tok'>to</span><span id='tok'>occur.</span></p><p id=p427><span id='tok'>This</span><span id='tok'>means</span><span id='tok'>that</span><span id='tok'>even</span><span id='tok'>though</span><span id='tok'>this</span><span id='tok'>malware</span><span id='tok'>is</span><span class='token pointer' id='tok-189-30' style='color:red'>functionally</span><span id='tok'>ransomware,</span><span id='tok'>for</span><span id='tok'>threat</span><span class='token pointer' id='tok-189-31' style='color:red'>assessment</span><span id='tok'>purposes,</span><span id='tok'>it</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>functionally</span><span id='tok'>considered</span><span id='tok'>a</span><span class='token pointer' id='tok-189-32' style='color:red'>"wiper".</span></p><p id=p448><span id='tok'>Attack</span><span id='tok'>LifecycleWe</span><span id='tok'>are</span><span id='tok'>aware</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>how</span><span id='tok'>the</span><span id='tok'>Petya</span><span id='tok'>attack</span><span id='tok'>lifecycle</span><span id='tok'>works.</span></p><p id=p463><span id='tok'>Delivery/Exploitation</span></p><p id=p464><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>not</span><span id='tok'>yet</span><span id='tok'>confirmed</span><span id='tok'>the</span><span id='tok'>initial</span><span class='token pointer' id='tok-189-33' style='color:red'>vector</span><span class='token pointer' id='tok-189-34' style='color:red'>infection</span><span id='tok'>this</span><span id='tok'>new</span><span id='tok'>Petya</span><span id='tok'>variant.</span><span id='tok'>Previous</span><span id='tok'>variants</span><span id='tok'>were</span><span id='tok'>spread</span><span id='tok'>through</span><span id='tok'>e-mail,</span><span id='tok'>but</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>not</span><span id='tok'>identified</span><span id='tok'>this</span><span id='tok'>latest</span><span id='tok'>sample</span><span id='tok'>carried</span><span id='tok'>in</span><span id='tok'>any</span><span id='tok'>e-mail</span><span id='tok'>related</span><span id='tok'>attacks.</span></p><p id=p498><span id='tok'>While</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>not</span><span id='tok'>been</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>directly</span><span id='tok'>confirm</span><span id='tok'>the</span><span id='tok'>source,</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>seen</span><span id='tok'>evidence</span><span id='tok'>that</span><span id='tok'>a</span><span id='tok'>Ukrainian</span><span id='tok'>software</span><span id='tok'>application</span><span id='tok'>called</span><span id='tok'>MEDoc</span><span id='tok'>was</span><span id='tok'>used</span><span id='tok'>by</span><span id='tok'>attackers</span><span id='tok'>to</span><span id='tok'>deliver</span><span id='tok'>the</span><span id='tok'>Petya</span><span class='token pointer' id='tok-189-35' style='color:red'>DLL.</span><span id='tok'>The</span><span id='tok'>software</span><span id='tok'>is</span><span id='tok'>heavily</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>Ukraine</span><span id='tok'>it</span><span id='tok'>appears</span><span id='tok'>the</span><span id='tok'>company's</span><span id='tok'>systems</span><span id='tok'>may</span><span id='tok'>have</span><span id='tok'>been</span><span class='token pointer' id='tok-189-36' style='color:red'>compromised</span><span id='tok'>and</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>issue</span><span id='tok'>a</span><span id='tok'>malicious</span><span id='tok'>update</span><span id='tok'>to</span><span id='tok'>systems</span><span id='tok'>running</span><span id='tok'>the</span><span id='tok'>program</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>morning</span><span id='tok'>of</span><span id='tok'>Jun</span><span id='tok'>27th.</span><span id='tok'>This</span><span id='tok'>infection</span><span id='tok'>vector</span><span id='tok'>helps</span><span id='tok'>explain</span><span id='tok'>the</span><span id='tok'>high</span><span id='tok'>concentration</span><span id='tok'>of</span><span id='tok'>infections</span><span id='tok'>in</span><span id='tok'>Ukraine.</span></p><p id=p575><span id='tok'>Installation</span></p><p id=p576><span id='tok'>This</span><span id='tok'>variant</span><span id='tok'>of</span><span id='tok'>Petya</span><span id='tok'>is</span><span id='tok'>spread</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>DLL</span><span id='tok'>file,</span><span id='tok'>which</span><span id='tok'>must</span><span id='tok'>be</span><span id='tok'>executed</span><span id='tok'>by</span><span class='token pointer' id='tok-189-37' style='color:red'>another</span><span id='tok'>process</span><span id='tok'>before</span><span id='tok'>it</span><span id='tok'>takes</span><span id='tok'>action</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>system.</span><span id='tok'>Once</span><span id='tok'>executed,</span><span id='tok'>it</span><span id='tok'>overwrites</span><span id='tok'>the</span><span class='token pointer' id='tok-189-38' style='color:red'>Master</span><span id='tok'>Boot</span><span id='tok'>Record</span><span id='tok'>and</span><span id='tok'>creates</span><span id='tok'>a</span><span id='tok'>scheduled</span><span id='tok'>task</span><span id='tok'>to</span><span id='tok'>reboot</span><span id='tok'>the</span><span id='tok'>system.</span><span id='tok'>Once</span><span id='tok'>the</span><span id='tok'>system</span><span id='tok'>reboots,</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>displays</span><span id='tok'>a</span><span id='tok'>fake</span><span id='tok'>"chkdisk"</span><span id='tok'>scan</span><span id='tok'>which</span><span id='tok'>tricks</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>into</span><span id='tok'>believing</span><span id='tok'>the</span><span id='tok'>program</span><span id='tok'>is</span><span id='tok'>repairing</span><span id='tok'>their</span><span id='tok'>hard</span><span id='tok'>drive.</span><span id='tok'>In</span><span id='tok'>reality,</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>is</span><span id='tok'>encrypting</span><span id='tok'>the</span><span class='token pointer' id='tok-189-39' style='color:red'>NTFS</span><span id='tok'>Master</span><span id='tok'>File</span><span id='tok'>Table</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>background.</span><span id='tok'>Once</span><span id='tok'>the</span><span id='tok'>fake</span><span id='tok'>chkdisk</span><span id='tok'>completes,</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>displays</span><span id='tok'>a</span><span id='tok'>ransom</span><span id='tok'>note</span><span id='tok'>which</span><span id='tok'>demands</span><span id='tok'>a</span><span id='tok'>payment</span><span id='tok'>of</span><span id='tok'>$300</span><span id='tok'>in</span><span id='tok'>bitcoin.</span></p><p id=p674></p><p id=p677><span id='tok'>Petya</span><span id='tok'>contains</span><span id='tok'>no</span><span id='tok'>Command</span><span id='tok'>and</span><span id='tok'>Control</span><span class='token pointer' id='tok-189-40' style='color:red'>mechanisms</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>know</span><span id='tok'>of.</span><span id='tok'>After</span><span id='tok'>a</span><span id='tok'>host</span><span id='tok'>is</span><span id='tok'>infected,</span><span id='tok'>there</span><span id='tok'>is</span><span id='tok'>no</span><span id='tok'>communication</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>back</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>attacker.</span></p><p id=p704><span id='tok'>Lateral</span><span id='tok'>Movement</span></p><p id=p706><span id='tok'>Petya</span><span id='tok'>uses</span><span id='tok'>three</span><span id='tok'>mechanisms</span><span id='tok'>to</span><span id='tok'>spread</span><span id='tok'>to</span><span id='tok'>additional</span><span id='tok'>hosts.</span></p><p id=p715><span id='tok'>Petya</span><span id='tok'>scans</span><span id='tok'>the</span><span class='token pointer' id='tok-189-41' style='color:red'>local /24</span><span id='tok'>discover</span><span id='tok'>enumerate</span><span class='token pointer' id='tok-189-42' style='color:red'>ADMIN$</span><span id='tok'>shares</span><span id='tok'>on</span><span class='token pointer' id='tok-189-43' style='color:red'>other</span><span id='tok'>systems,</span><span id='tok'>then</span><span id='tok'>copies</span><span id='tok'>itself</span><span id='tok'>to</span><span id='tok'>those</span><span id='tok'>hosts</span><span id='tok'>and</span><span id='tok'>executes</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>using</span><span class='token pointer' id='tok-189-44' style='color:red'>PSEXEC.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>only</span><span id='tok'>possible</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>infected</span><span id='tok'>user</span><span id='tok'>has</span><span id='tok'>the</span><span id='tok'>rights</span><span id='tok'>to</span><span id='tok'>write</span><span id='tok'>files</span><span id='tok'>and</span><span id='tok'>execute</span><span id='tok'>them</span><span id='tok'>on</span><span id='tok'>system</span><span id='tok'>hosting</span><span id='tok'>the</span><span class='token pointer' id='tok-189-45' style='color:red'>share.Petya</span><span id='tok'>uses</span><span id='tok'>the</span><span class='token pointer' id='tok-189-46' style='color:red'>Windows Management Instrumentation Command-line</span><span id='tok'>tool</span><span id='tok'>to</span><span id='tok'>connect</span><span id='tok'>to</span><span id='tok'>hosts</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>local</span><span id='tok'>subnet</span><span id='tok'>and</span><span id='tok'>attempts</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>itself</span><span class='token pointer' id='tok-189-47' style='color:red'>remotely</span><span id='tok'>on</span><span id='tok'>those</span><span id='tok'>hosts.</span><span id='tok'>It</span><span id='tok'>can</span><span id='tok'>use</span><span class='token pointer' id='tok-189-48' style='color:red'>Mimikatz</span><span id='tok'>to</span><span id='tok'>extract</span><span id='tok'>credentials</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>infected</span><span id='tok'>system</span><span id='tok'>and</span><span id='tok'>use</span><span id='tok'>them</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>itself</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>targeted</span><span class='token pointer' id='tok-189-49' style='color:red'>host.Petya</span><span id='tok'>finally</span><span id='tok'>attempts</span><span id='tok'>to</span><span id='tok'>use</span><span id='tok'>the</span><span class='token pointer' id='tok-189-50' style='color:red'>ETERNALBLUE</span><span id='tok'>exploit</span><span id='tok'>tool</span><span id='tok'>against</span><span id='tok'>hosts</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>local</span><span id='tok'>subnet.</span><span id='tok'>This</span><span id='tok'>will</span><span id='tok'>only</span><span id='tok'>be</span><span id='tok'>successful</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>targeted</span><span id='tok'>host</span><span id='tok'>does</span><span id='tok'>not</span><span id='tok'>have</span><span id='tok'>the</span><span id='tok'>MS17-010</span><span class='token pointer' id='tok-189-51' style='color:red'>patches</span><span id='tok'>deployed.ConclusionRansomware</span><span id='tok'>attacks</span><span id='tok'>are</span><span id='tok'>very</span><span id='tok'>common,</span><span id='tok'>but</span><span id='tok'>they</span><span id='tok'>are</span><span id='tok'>rarely</span><span id='tok'>coupled</span><span id='tok'>with</span><span id='tok'>an</span><span id='tok'>exploit</span><span id='tok'>that</span><span id='tok'>allows</span><span id='tok'>the</span><span id='tok'>malware</span><span id='tok'>to</span><span id='tok'>spread</span><span id='tok'>as</span><span id='tok'>a</span><span id='tok'>network</span><span id='tok'>worm.</span><span id='tok'>The</span><span class='token pointer' id='tok-189-52' style='color:red'>WannaCry</span><span id='tok'>attacks</span><span id='tok'>in</span><span id='tok'>May,</span><span id='tok'>2017</span><span id='tok'>demonstrated</span><span id='tok'>that</span><span id='tok'>many</span><span id='tok'>Windows</span><span id='tok'>systems</span><span id='tok'>had</span><span id='tok'>not</span><span id='tok'>been</span><span id='tok'>patched</span><span id='tok'>for</span><span id='tok'>this</span><span class='token pointer' id='tok-189-53' style='color:red'>vulnerability.</span><span id='tok'>The</span><span id='tok'>spread</span><span id='tok'>of</span><span id='tok'>Petya</span><span id='tok'>using</span><span id='tok'>this</span><span id='tok'>vulnerability</span><span id='tok'>indicates</span><span id='tok'>that</span><span id='tok'>many</span><span id='tok'>organizations</span><span id='tok'>may</span><span id='tok'>still</span><span id='tok'>be</span><span class='token pointer' id='tok-189-54' style='color:red'>vulnerable,</span><span id='tok'>despite</span><span id='tok'>the</span><span id='tok'>attention</span><span id='tok'>WannaCry</span><span id='tok'>received.
</span></p>