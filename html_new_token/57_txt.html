<p id=p0><span id='tok'>A</span><span id='tok'>researcher</span><span id='tok'>has</span><span id='tok'>found</span><span id='tok'>a</span><span id='tok'>way</span><span id='tok'>to</span><span class='token pointer' id='tok-57-0' style='color:red'>execute</span><span id='tok'>arbitrary</span><span class='token pointer' id='tok-57-1' style='color:red'>JavaScript</span><span id='tok'>code</span><span id='tok'>on</span><span class='token pointer' id='tok-57-2' style='color:red'>WordPress</span><span id='tok'>websites</span><span id='tok'>by</span><span id='tok'>leveraging</span><span id='tok'>a</span><span class='token pointer' id='tok-57-3' style='color:red'>stored cross-site scripting (XSS) bug</span><span id='tok'>to</span><span id='tok'>how</span><span id='tok'>WordPress</span><span class='token pointer' id='tok-57-4' style='color:red'>truncates</span><span id='tok'>comments.</span></p><p id=p28><span id='tok'>Finland-based</span><span id='tok'>security</span><span id='tok'>researcher</span><span id='tok'>Jouko</span><span class='token pointer' id='tok-57-5' style='color:red'>Pynnönen</span><span id='tok'>of</span><span id='tok'>Klikki</span><span id='tok'>Oy</span><span id='tok'>says</span><span id='tok'>the</span><span class='token pointer' id='tok-57-6' style='color:red'>vulnerability</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>exploited</span><span id='tok'>by</span><span id='tok'>an</span><span class='token pointer' id='tok-57-7' style='color:red'>unauthenticated attacker</span><span class='token pointer' id='tok-57-8' style='color:red'>inject code</span><span id='tok'>comments.</span><span id='tok'>If</span><span id='tok'>the</span><span id='tok'>specially</span><span id='tok'>crafted</span><span id='tok'>comments</span><span id='tok'>are</span><span id='tok'>viewed</span><span id='tok'>by</span><span id='tok'>an</span><span id='tok'>administrator,</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>can</span><span id='tok'>take</span><span id='tok'>control</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>affected</span><span id='tok'>website.</span></p><p id=p70><span id='tok'>A</span><span id='tok'>similar</span><span id='tok'>vulnerability</span><span id='tok'>was</span><span id='tok'>reported</span><span id='tok'>to</span><span id='tok'>WordPress</span><span class='token pointer' id='tok-57-9' style='color:red'>developers</span><span id='tok'>in</span><span id='tok'>February</span><span id='tok'>2014</span><span id='tok'>by</span><span id='tok'>Belgian</span><span id='tok'>researcher</span><span id='tok'>Cedric</span><span id='tok'>Van</span><span id='tok'>Bockhaven.</span><span id='tok'>The</span><span class='token pointer' id='tok-57-10' style='color:red'>critical XSS flaw</span><span id='tok'>by</span><span id='tok'>Van</span><span id='tok'>Bockhaven,</span><span id='tok'>which</span><span id='tok'>leveraged</span><span id='tok'>special</span><span id='tok'>characters</span><span id='tok'>to</span><span class='token pointer' id='tok-57-11' style='color:red'>truncate</span><span id='tok'>crafted</span><span id='tok'>comments</span><span id='tok'>and</span><span id='tok'>achieve</span><span class='token pointer' id='tok-57-12' style='color:red'>arbitrary code execution,</span><span id='tok'>addressed</span><span id='tok'>by</span><span id='tok'>WordPress</span><span id='tok'>last</span><span id='tok'>week</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>release</span><span id='tok'>of</span><span id='tok'>WordPress</span><span id='tok'>4.1.2.</span></p><p id=p120><span id='tok'>The</span><span class='token pointer' id='tok-57-13' style='color:red'>stored XSS vulnerability</span><span id='tok'>by</span><span id='tok'>Pynnönen</span><span id='tok'>is</span><span id='tok'>similar,</span><span id='tok'>but</span><span id='tok'>instead</span><span id='tok'>of</span><span id='tok'>invalid</span><span id='tok'>characters</span><span id='tok'>it</span><span id='tok'>involves</span><span id='tok'>very</span><span id='tok'>long</span><span id='tok'>comments</span><span id='tok'>(roughly</span><span id='tok'>66,000</span><span id='tok'>characters).</span></p><p id=p142><span id='tok'>"If</span><span id='tok'>the</span><span id='tok'>comment</span><span id='tok'>text</span><span id='tok'>is</span><span id='tok'>long</span><span id='tok'>enough,</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>truncated</span><span id='tok'>when</span><span id='tok'>inserted</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>database.</span><span id='tok'>The</span><span class='token pointer' id='tok-57-14' style='color:red'>MySQL TEXT type size limit</span><span id='tok'>64</span><span id='tok'>kilobytes,</span><span id='tok'>so</span><span id='tok'>the</span><span id='tok'>comment</span><span id='tok'>has</span><span id='tok'>to</span><span id='tok'>be</span><span id='tok'>quite</span><span id='tok'>long,"</span><span id='tok'>the</span><span id='tok'>researcher</span><span id='tok'>explained</span><span id='tok'>in</span><span id='tok'>an</span><span id='tok'>advisory.</span><span id='tok'>"The</span><span id='tok'>truncation</span><span id='tok'>results</span><span id='tok'>in</span><span id='tok'>malformed</span><span id='tok'>HTML</span><span id='tok'>generated</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>page.</span><span id='tok'>The</span><span id='tok'>attacker</span><span id='tok'>can</span><span id='tok'>supply</span><span id='tok'>any</span><span id='tok'>attributes</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>allowed</span></p><p id=p202><span id='tok'>According</span><span id='tok'>to</span><span id='tok'>Pynnönen,</span><span id='tok'>the</span><span id='tok'>specially</span><span id='tok'>crafted</span><span id='tok'>code</span><span id='tok'>submitted</span><span id='tok'>via</span><span id='tok'>comments</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>executed</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>administrator</span><span id='tok'>dashboard.</span><span id='tok'>Instead,</span><span id='tok'>it</span><span id='tok'>gets</span><span id='tok'>executed</span><span id='tok'>when</span><span id='tok'>the</span><span id='tok'>victim</span><span id='tok'>views</span><span id='tok'>the</span><span id='tok'>post</span><span id='tok'>where</span><span id='tok'>the</span><span id='tok'>malicious</span><span id='tok'>comment</span><span id='tok'>was</span><span id='tok'>published.</span></p><p id=p235><span id='tok'>"If</span><span class='token pointer' id='tok-57-15' style='color:red'>comment moderation</span><span id='tok'>enabled</span><span id='tok'>(default)</span><span id='tok'>the</span><span id='tok'>comment</span><span id='tok'>won't</span><span id='tok'>appear</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>page</span><span id='tok'>until</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>been</span><span id='tok'>approved.</span><span id='tok'>Under</span><span id='tok'>default</span><span id='tok'>settings,</span><span id='tok'>after</span><span id='tok'>one</span><span id='tok'>'harmless'</span><span id='tok'>comment</span><span id='tok'>is</span><span id='tok'>approved,</span><span id='tok'>the</span><span id='tok'>attacker</span><span id='tok'>is</span><span id='tok'>free</span><span id='tok'>from</span><span id='tok'>subsequent</span><span id='tok'>moderation,</span><span id='tok'>and</span><span id='tok'>can</span><span id='tok'>inject</span><span id='tok'>the</span><span id='tok'>exploit</span><span id='tok'>to</span><span id='tok'>several</span><span id='tok'>pages</span><span id='tok'>and</span><span id='tok'>blog</span><span id='tok'>posts,"</span><span id='tok'>the</span><span id='tok'>researcher</span><span id='tok'>told</span><span id='tok'>SecurityWeek.</span></p><p id=p284><span id='tok'>In</span><span id='tok'>a</span><span id='tok'>proof-of-concept</span><span id='tok'>video,</span><span id='tok'>the</span><span id='tok'>researcher</span><span id='tok'>has</span><span id='tok'>shown</span><span id='tok'>how</span><span id='tok'>a</span><span id='tok'>malicious</span><span id='tok'>actor</span><span id='tok'>can</span><span class='token pointer' id='tok-57-16' style='color:red'>execute arbitrary code</span><span id='tok'>an</span><span class='token pointer' id='tok-57-17' style='color:red'>affected server</span><span class='token pointer' id='tok-57-18' style='color:red'>plugin and theme editors.</span><span id='tok'>attacker</span><span id='tok'>who</span><span id='tok'>tricks</span><span id='tok'>an</span><span id='tok'>administrator</span><span id='tok'>into</span><span id='tok'>viewing</span><span id='tok'>the</span><span id='tok'>malicious</span><span id='tok'>comment</span><span id='tok'>can</span><span id='tok'>carry</span><span id='tok'>out</span><span id='tok'>various</span><span id='tok'>tasks,</span><span id='tok'>including</span><span id='tok'>changing</span><span id='tok'>the</span><span id='tok'>admin</span><span id='tok'>password</span><span id='tok'>and</span><span id='tok'>creating</span><span id='tok'>new</span><span id='tok'>admin</span><span id='tok'>accounts,</span><span id='tok'>the</span><span id='tok'>expert</span><span id='tok'>said.</span></p><p id=p338><span id='tok'>The</span><span id='tok'>attack</span><span id='tok'>method</span><span id='tok'>disclosed</span><span id='tok'>by</span><span id='tok'>Pynnönen</span><span id='tok'>affects</span><span id='tok'>WordPress</span><span id='tok'>4.2</span><span id='tok'>(the</span><span id='tok'>latest</span><span id='tok'>version)</span><span id='tok'>and</span><span id='tok'>earlier,</span><span id='tok'>but</span><span id='tok'>the</span><span id='tok'>researcher</span><span id='tok'>has</span><span id='tok'>decided</span><span id='tok'>not</span><span id='tok'>to</span><span id='tok'>report</span><span id='tok'>his</span><span id='tok'>findings</span><span id='tok'>to</span><span id='tok'>WordPress</span><span id='tok'>developers</span><span id='tok'>because</span><span id='tok'>he</span><span id='tok'>is</span><span id='tok'>displeased</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>way</span><span id='tok'>they've</span><span id='tok'>handled</span><span id='tok'>his</span><span id='tok'>recent</span><span id='tok'>vulnerability</span><span id='tok'>reports.</span></p><p id=p378><span id='tok'>Van</span><span id='tok'>Bockhaven</span><span id='tok'>explained</span><span id='tok'>in</span><span id='tok'>a</span><span id='tok'>blog</span><span id='tok'>post</span><span id='tok'>that</span><span id='tok'>it</span><span id='tok'>took</span><span id='tok'>WordPress</span><span id='tok'>more</span><span id='tok'>than</span><span id='tok'>a</span><span id='tok'>year</span><span id='tok'>to</span><span id='tok'>fix</span><span id='tok'>the</span><span class='token pointer' id='tok-57-19' style='color:red'>XSS flaw he</span><span id='tok'>because</span><span id='tok'>it</span><span id='tok'>affected</span><span id='tok'>the</span><span id='tok'>WordPress</span><span id='tok'>core</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>database</span><span id='tok'>layer</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>developers</span><span id='tok'>had</span><span id='tok'>to</span><span id='tok'>conduct</span><span id='tok'>thorough</span><span id='tok'>tests</span><span id='tok'>to</span><span id='tok'>ensure</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>fix</span><span id='tok'>would</span><span id='tok'>not</span><span id='tok'>have</span><span id='tok'>a</span><span id='tok'>negative</span><span id='tok'>impact</span><span id='tok'>on</span><span id='tok'>certain</span><span id='tok'>websites.</span></p><p id=p432><span id='tok'>However,</span><span id='tok'>Pynnönen</span><span id='tok'>believes</span><span id='tok'>it</span><span id='tok'>shouldn't</span><span id='tok'>have</span><span id='tok'>taken</span><span id='tok'>so</span><span id='tok'>long</span><span id='tok'>to</span><span id='tok'>release</span><span id='tok'>the</span><span id='tok'>patch.</span></p><p id=p445><span id='tok'>"They</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>looking</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>comment</span><span id='tok'>truncation</span><span id='tok'>problem</span><span id='tok'>at</span><span id='tok'>least</span><span id='tok'>since</span><span id='tok'>February</span><span id='tok'>2014.</span><span id='tok'>According</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>timeline</span><span id='tok'>in</span><span id='tok'>Cedric</span><span id='tok'>van</span><span id='tok'>Bockhaven's</span><span id='tok'>blog,</span><span id='tok'>they</span><span id='tok'>took</span><span id='tok'>14</span><span id='tok'>months(!)</span><span id='tok'>to</span><span id='tok'>produce</span><span id='tok'>the</span><span id='tok'>code</span><span id='tok'>to</span><span class='token pointer' id='tok-57-20' style='color:red'>detect invalid characters</span><span id='tok'>comments.</span><span id='tok'>During</span><span id='tok'>this</span><span id='tok'>time</span><span id='tok'>all</span><span id='tok'>WordPress</span><span id='tok'>servers</span><span id='tok'>using</span><span id='tok'>default</span><span id='tok'>comment</span><span id='tok'>settings</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>relatively</span><span id='tok'>easily</span><span class='token pointer' id='tok-57-21' style='color:red'>'hackable'.</span><span id='tok'>Now</span><span id='tok'>it</span><span id='tok'>turns</span><span id='tok'>out</span><span id='tok'>they</span><span id='tok'>still</span><span id='tok'>didn't</span><span id='tok'>get</span><span id='tok'>it</span><span id='tok'>right,"</span><span id='tok'>Pynnönen</span><span id='tok'>said</span><span id='tok'>via</span><span id='tok'>email.</span></p><p id=p511><span id='tok'>"It</span><span id='tok'>looks</span><span id='tok'>like</span><span id='tok'>the</span><span id='tok'>risk</span><span id='tok'>for</span><span id='tok'>WordPress</span><span id='tok'>users</span><span id='tok'>may</span><span id='tok'>be</span><span id='tok'>smaller</span><span id='tok'>and</span><span id='tok'>patches</span><span id='tok'>faster</span><span id='tok'>with</span><span id='tok'>full</span><span id='tok'>disclosure.</span><span id='tok'>At</span><span id='tok'>least</span><span id='tok'>now</span><span id='tok'>they</span><span id='tok'>know</span><span id='tok'>how</span><span id='tok'>to</span><span id='tok'>prevent</span><span id='tok'>getting</span><span id='tok'>compromised</span><span id='tok'>-</span><span id='tok'>instead</span><span id='tok'>of</span><span id='tok'>another</span><span id='tok'>year</span><span id='tok'>of</span><span id='tok'>vulnerability</span><span id='tok'>and</span><span id='tok'>false</span><span id='tok'>sense</span><span id='tok'>of</span><span id='tok'>security,"</span><span id='tok'>the</span><span id='tok'>expert</span><span id='tok'>added.</span></p><p id=p553><span class='token pointer' id='tok-57-22' style='color:red'>Automattic,</span><span id='tok'>the</span><span id='tok'>company</span><span id='tok'>behind</span><span id='tok'>the</span><span class='token pointer' id='tok-57-23' style='color:red'>WordPress.com</span><span id='tok'>blogging</span><span id='tok'>service,</span><span id='tok'>told</span><span id='tok'>SecurityWeek</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>core</span><span id='tok'>security</span><span id='tok'>team</span><span id='tok'>is</span><span id='tok'>currently</span><span id='tok'>working</span><span id='tok'>on</span><span id='tok'>a</span><span id='tok'>fix</span><span id='tok'>for</span><span id='tok'>the</span><span class='token pointer' id='tok-57-24' style='color:red'>core software.</span><span id='tok'>a</span><span id='tok'>patch</span><span id='tok'>becomes</span><span id='tok'>available,</span><span id='tok'>website</span><span id='tok'>owners</span><span class='token pointer' id='tok-57-25' style='color:red'>running</span><span id='tok'>a</span><span id='tok'>self-hosted</span><span id='tok'>version</span><span id='tok'>of</span><span id='tok'>WordPress</span><span id='tok'>are</span><span id='tok'>advised</span><span id='tok'>to</span><span id='tok'>install</span><span id='tok'>the</span><span class='token pointer' id='tok-57-26' style='color:red'>Akismet anti-spam plugin,</span><span id='tok'>is</span><span id='tok'>currently</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>protect</span><span id='tok'>WordPress.com</span><span id='tok'>sites</span><span id='tok'>against</span><span id='tok'>potential</span><span id='tok'>attacks.</span></p><p id=p610><span id='tok'>"The</span><span id='tok'>WordPress</span><span id='tok'>team</span><span id='tok'>was</span><span id='tok'>made</span><span id='tok'>aware</span><span id='tok'>of</span><span id='tok'>a</span><span class='token pointer' id='tok-57-27' style='color:red'>XSS issue a</span><span id='tok'>hours</span><span id='tok'>ago</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>release</span><span id='tok'>an</span><span id='tok'>update</span><span id='tok'>for</span><span id='tok'>shortly.</span><span id='tok'>It</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>core</span><span id='tok'>issue,</span><span id='tok'>but</span><span id='tok'>the</span><span id='tok'>number</span><span id='tok'>of</span><span id='tok'>sites</span><span id='tok'>vulnerable</span><span id='tok'>is</span><span id='tok'>much</span><span id='tok'>smaller</span><span id='tok'>than</span><span id='tok'>you</span><span id='tok'>may</span><span id='tok'>think</span><span id='tok'>because</span><span id='tok'>the</span><span id='tok'>vast</span><span id='tok'>majority</span><span id='tok'>of</span><span class='token pointer' id='tok-57-28' style='color:red'>WordPress-powered</span><span id='tok'>sites</span><span class='token pointer' id='tok-57-29' style='color:red'>which blocks this attack.</span><span id='tok'>the</span><span id='tok'>fix</span><span id='tok'>is</span><span id='tok'>tested</span><span id='tok'>and</span><span id='tok'>ready</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>coming</span><span id='tok'>hours</span><span id='tok'>WordPress</span><span id='tok'>users</span><span id='tok'>will</span><span id='tok'>receive</span><span id='tok'>an</span><span class='token pointer' id='tok-57-30' style='color:red'>auto-update</span><span id='tok'>and</span><span id='tok'>should</span><span id='tok'>be</span><span id='tok'>safe</span><span id='tok'>and</span><span id='tok'>protected</span><span id='tok'>even</span><span id='tok'>if</span><span id='tok'>they</span><span id='tok'>don't</span><span id='tok'>use</span><span id='tok'>Akismet,"</span><span id='tok'>Automattic</span><span id='tok'>founder</span><span id='tok'>Matt</span><span id='tok'>Mullenweg</span><span id='tok'>said</span><span id='tok'>in</span><span id='tok'>an</span><span id='tok'>emailed</span><span id='tok'>statement.</span></p><p id=p701><span id='tok'>Pynnönen</span><span id='tok'>says</span><span id='tok'>he</span><span id='tok'>reported</span><span id='tok'>another</span><span id='tok'>stored</span><span id='tok'>XSS</span><span id='tok'>vulnerability</span><span id='tok'>to</span><span id='tok'>WordPress</span><span id='tok'>in</span><span id='tok'>November</span><span id='tok'>2014,</span><span id='tok'>but</span><span id='tok'>it</span><span id='tok'>still</span><span id='tok'>hasn't</span><span id='tok'>been</span><span id='tok'>fixed.</span></p><p id=p720><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>same</span><span id='tok'>month,</span><span id='tok'>WordPress</span><span id='tok'>credited</span><span id='tok'>the</span><span id='tok'>expert</span><span id='tok'>for</span><span id='tok'>reporting</span><span id='tok'>a</span><span id='tok'>critical</span><span id='tok'>XSS</span><span id='tok'>flaw</span><span id='tok'>that</span><span id='tok'>affected</span><span id='tok'>millions</span><span id='tok'>of</span><span id='tok'>websites</span><span class='token pointer' id='tok-57-31' style='color:red'>running versions prior to</span><span id='tok'>Pynnönen</span><span id='tok'>said</span><span id='tok'>he</span><span id='tok'>was</span><span id='tok'>promised</span><span id='tok'>a</span><span id='tok'>minimum</span><span id='tok'>bounty</span><span id='tok'>of</span><span id='tok'>$2,000</span><span id='tok'>for</span><span id='tok'>responsibly</span><span id='tok'>disclosing</span><span id='tok'>the</span><span class='token pointer' id='tok-57-32' style='color:red'>bug,</span><span id='tok'>but</span><span id='tok'>instead</span><span id='tok'>he</span><span id='tok'>only</span><span id='tok'>received</span><span id='tok'>a</span><span id='tok'>$100</span><span id='tok'>reward</span><span id='tok'>via</span><span id='tok'>HackerOne,</span><span id='tok'>which</span><span id='tok'>he</span><span id='tok'>plans</span><span id='tok'>on</span><span id='tok'>donating</span><span id='tok'>to</span><span id='tok'>a</span><span id='tok'>charity. 
</span></p>