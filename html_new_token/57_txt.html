<p id=p0>A researcher has found a way to <span class='token pointer' id='tok-57-0' style='color:red'>execute</span>arbitrary <span class='token pointer' id='tok-57-1' style='color:red'>JavaScript</span>code on <span class='token pointer' id='tok-57-2' style='color:red'>WordPress</span>websites by leveraging a <span class='token pointer' id='tok-57-3' style='color:red'>stored cross-site scripting (XSS) bug</span>to how WordPress <span class='token pointer' id='tok-57-4' style='color:red'>truncates</span>comments. </p><p id=p28>Finland-based security researcher Jouko <span class='token pointer' id='tok-57-5' style='color:red'>Pynnönen</span>of Klikki Oy says the <span class='token pointer' id='tok-57-6' style='color:red'>vulnerability</span>can be exploited by an <span class='token pointer' id='tok-57-7' style='color:red'>unauthenticated attacker</span><span class='token pointer' id='tok-57-8' style='color:red'>inject code</span>comments. If the specially crafted comments are viewed by an administrator, the attacker can take control of the affected website. </p><p id=p70>A similar vulnerability was reported to WordPress <span class='token pointer' id='tok-57-9' style='color:red'>developers</span>in February 2014 by Belgian researcher Cedric Van Bockhaven. The <span class='token pointer' id='tok-57-10' style='color:red'>critical XSS flaw</span>by Van Bockhaven, which leveraged special characters to <span class='token pointer' id='tok-57-11' style='color:red'>truncate</span>crafted comments and achieve <span class='token pointer' id='tok-57-12' style='color:red'>arbitrary code execution,</span>addressed by WordPress last week with the release of WordPress 4.1.2. </p><p id=p120>The <span class='token pointer' id='tok-57-13' style='color:red'>stored XSS vulnerability</span>by Pynnönen is similar, but instead of invalid characters it involves very long comments (roughly 66,000 characters). </p><p id=p142>"If the comment text is long enough, it will be truncated when inserted in the database. The <span class='token pointer' id='tok-57-14' style='color:red'>MySQL TEXT type size limit</span>64 kilobytes, so the comment has to be quite long," the researcher explained in an advisory. "The truncation results in malformed HTML generated on the page. The attacker can supply any attributes in the allowed </p><p id=p202>According to Pynnönen, the specially crafted code submitted via comments is not executed in the administrator dashboard. Instead, it gets executed when the victim views the post where the malicious comment was published. </p><p id=p235>"If <span class='token pointer' id='tok-57-15' style='color:red'>comment moderation</span>enabled (default) the comment won't appear on the page until it has been approved. Under default settings, after one 'harmless' comment is approved, the attacker is free from subsequent moderation, and can inject the exploit to several pages and blog posts," the researcher told SecurityWeek. </p><p id=p284>In a proof-of-concept video, the researcher has shown how a malicious actor can <span class='token pointer' id='tok-57-16' style='color:red'>execute arbitrary code</span>an <span class='token pointer' id='tok-57-17' style='color:red'>affected server</span><span class='token pointer' id='tok-57-18' style='color:red'>plugin and theme editors.</span>attacker who tricks an administrator into viewing the malicious comment can carry out various tasks, including changing the admin password and creating new admin accounts, the expert said. </p><p id=p338>The attack method disclosed by Pynnönen affects WordPress 4.2 (the latest version) and earlier, but the researcher has decided not to report his findings to WordPress developers because he is displeased with the way they've handled his recent vulnerability reports. </p><p id=p378>Van Bockhaven explained in a blog post that it took WordPress more than a year to fix the <span class='token pointer' id='tok-57-19' style='color:red'>XSS flaw he</span>because it affected the WordPress core at the database layer and the developers had to conduct thorough tests to ensure that the fix would not have a negative impact on certain websites. </p><p id=p432>However, Pynnönen believes it shouldn't have taken so long to release the patch. </p><p id=p445>"They have been looking at the comment truncation problem at least since February 2014. According to the timeline in Cedric van Bockhaven's blog, they took 14 months(!) to produce the code to <span class='token pointer' id='tok-57-20' style='color:red'>detect invalid characters</span>comments. During this time all WordPress servers using default comment settings have been relatively easily <span class='token pointer' id='tok-57-21' style='color:red'>'hackable'.</span>Now it turns out they still didn't get it right," Pynnönen said via email. </p><p id=p511>"It looks like the risk for WordPress users may be smaller and patches faster with full disclosure. At least now they know how to prevent getting compromised - instead of another year of vulnerability and false sense of security," the expert added. </p><p id=p553><span class='token pointer' id='tok-57-22' style='color:red'>Automattic,</span>the company behind the <span class='token pointer' id='tok-57-23' style='color:red'>WordPress.com</span>blogging service, told SecurityWeek that the core security team is currently working on a fix for the <span class='token pointer' id='tok-57-24' style='color:red'>core software.</span>a patch becomes available, website owners <span class='token pointer' id='tok-57-25' style='color:red'>running</span>a self-hosted version of WordPress are advised to install the <span class='token pointer' id='tok-57-26' style='color:red'>Akismet anti-spam plugin,</span>is currently used to protect WordPress.com sites against potential attacks. </p><p id=p610>"The WordPress team was made aware of a <span class='token pointer' id='tok-57-27' style='color:red'>XSS issue a</span>hours ago that we will release an update for shortly. It is a core issue, but the number of sites vulnerable is much smaller than you may think because the vast majority of <span class='token pointer' id='tok-57-28' style='color:red'>WordPress-powered</span>sites <span class='token pointer' id='tok-57-29' style='color:red'>which blocks this attack.</span>the fix is tested and ready in the coming hours WordPress users will receive an <span class='token pointer' id='tok-57-30' style='color:red'>auto-update</span>and should be safe and protected even if they don't use Akismet," Automattic founder Matt Mullenweg said in an emailed statement. </p><p id=p701>Pynnönen says he reported another stored XSS vulnerability to WordPress in November 2014, but it still hasn't been fixed. </p><p id=p720>In the same month, WordPress credited the expert for reporting a critical XSS flaw that affected millions of websites <span class='token pointer' id='tok-57-31' style='color:red'>running versions prior to</span>Pynnönen said he was promised a minimum bounty of $2,000 for responsibly disclosing the <span class='token pointer' id='tok-57-32' style='color:red'>bug,</span>but instead he only received a $100 reward via HackerOne, which he plans on donating to a charity. 
 </p>