<p id=p0>Beginning in November 2016, <span class='token pointer' id='tok-181-0' style='color:red'>Kaspersky Lab</span>a new wave of <span class='token pointer' id='tok-181-1' style='color:red'>wiper attacks</span>at multiple targets in the Middle East. The <span class='token pointer' id='tok-181-2' style='color:red'>malware</span>used in the new <span class='token pointer' id='tok-181-3' style='color:red'>attacks</span>was a variant of the infamous <span class='token pointer' id='tok-181-4' style='color:red'>Shamoon</span><span class='token pointer' id='tok-181-5' style='color:red'>worm</span>that targeted Saudi Aramco and Rasgas back in 2012.  </p><p id=p46>Dormant for four years, one of the most mysterious <span class='token pointer' id='tok-181-6' style='color:red'>wipers</span>in history has returned. </p><p id=p60>So far, we have observed three waves of attacks of the Shamoon <span class='token pointer' id='tok-181-7' style='color:red'>2.0</span>malware, activated on 17 November 2016, 29 November 2016 and 23 January 2017. </p><p id=p86>Also known as <span class='token pointer' id='tok-181-8' style='color:red'>Disttrack,</span>Shamoon is a highly <span class='token pointer' id='tok-181-9' style='color:red'>destructive</span>malware family that effectively wipes the <span class='token pointer' id='tok-181-10' style='color:red'>victim machine.</span>group known as the Cutting Sword of Justice took credit for the Saudi Aramco attack by posting a Pastebin message on the day of the attack (back in 2012), and justified the attack as a measure against the Saudi monarchy. </p><p id=p144>The Shamoon 2.0 attacks seen in November 2016 targeted organizations in various critical and economic sectors in Saudi Arabia. Just like the previous variant, the Shamoon 2.0 <span class='token pointer' id='tok-181-11' style='color:red'>wiper</span>aims for the mass destruction of systems inside compromised organizations.  </p><p id=p183>The new attacks share many similarities with the 2012 wave and now feature new tools and techniques. During the first stage, the attackers obtain administrator credentials for the victim's network. Next, they build a custom wiper (Shamoon 2.0) which leverages these credentials to spread widely inside the organization. Finally, on a predefined date, the wiper activates, rendering the infected machines completely inoperable. It should be noted that the final stages of the attacks are completely automated, without the need for communication with the command and control center. </p><p id=p270>While investigating the Shamoon 2.0 attacks, Kaspersky Lab also discovered a previously unknown wiper malware which appears to be targeting organizations in Saudi Arabia. We're calling this new wiper <span class='token pointer' id='tok-181-12' style='color:red'>StoneDrill.</span>StoneDrill has several "style" similarities to Shamoon, with multiple interesting factors and techniques to allow for the better <span class='token pointer' id='tok-181-13' style='color:red'>evasion</span>of <span class='token pointer' id='tok-181-14' style='color:red'>detection.</span>In addition to suspected Saudi targets, one victim of StoneDrill was observed on the <span class='token pointer' id='tok-181-15' style='color:red'>Network</span><span class='token pointer' id='tok-181-16' style='color:red'>Kaspersky Security</span>in Europe. This makes us believe the threat actor behind StoneDrill is expanding its <span class='token pointer' id='tok-181-17' style='color:red'>wiping</span>operations from the Middle East to Europe. </p><p id=p361>To summarize some of the characteristics of the new wiper attacks, for both Shamoon and StoneDrill: </p><p id=p377>Shamoon 2.0 includes a fully functional <span class='token pointer' id='tok-181-18' style='color:red'>ransomware</span>module, in addition to its common wiping <span class='token pointer' id='tok-181-19' style='color:red'>functionality.Shamoon</span>2.0 has both <span class='token pointer' id='tok-181-20' style='color:red'>32-bit</span>and <span class='token pointer' id='tok-181-21' style='color:red'>64-bit</span>components.The Shamoon samples we analyzed in January 2017 do not implement any command and control communication; previous ones included a basic <span class='token pointer' id='tok-181-22' style='color:red'>C&C functionality</span>referenced <span class='token pointer' id='tok-181-23' style='color:red'>local servers</span>the victim's <span class='token pointer' id='tok-181-24' style='color:red'>network.StoneDrill</span>makes heavy use of evasion techniques to avoid <span class='token pointer' id='tok-181-25' style='color:red'>sandbox</span>execution.While Shamoon embeds Arabic-Yemen resource language sections, StoneDrill embeds mostly Persian resource language sections. Of course, we do not exclude the possibility of false <span class='token pointer' id='tok-181-26' style='color:red'>flags.StoneDrill</span>does not use drivers during deployment (unlike Shamoon) but relies on <span class='token pointer' id='tok-181-27' style='color:red'>memory</span><span class='token pointer' id='tok-181-28' style='color:red'>injection</span>of the wiping module into the victim's preferred browser.Several similarities exist between Shamoon and <span class='token pointer' id='tok-181-29' style='color:red'>StoneDrill.Multiple</span>similarities were found between StoneDrill and previously analysed <span class='token pointer' id='tok-181-30' style='color:red'>NewsBeef</span><span class='token pointer' id='tok-181-31' style='color:red'>attacks.We</span>are releasing a full technical report that provides new insights into the Shamoon 2.0 and StoneDrill attacks, including:  </p><p id=p520>The discovery techniques and strategies we used for Shamoon and StoneDrill. Details on the ransomware functionality found in Shamoon 2.0. This functionality is currently inactive but could be used in future <span class='token pointer' id='tok-181-32' style='color:red'>attacks.Details</span>on the newly found StoneDrill functions, including its destructive capabilities (even with limited user privileges).Details on the similarities between malware styles and malware components' <span class='token pointer' id='tok-181-33' style='color:red'>source code</span>in Shamoon, StoneDrill and NewsBeef. Our discovery of StoneDrill provides another dimension to the existing wave of wiper attacks against Saudi organizations that started with Shamoon 2.0 in November 2016. Compared to the new Shamoon 2.0 variants, the most significant difference is the lack of a <span class='token pointer' id='tok-181-34' style='color:red'>disk driver</span>for direct access during the destructive step. Nevertheless, one does not necessarily need <span class='token pointer' id='tok-181-35' style='color:red'>raw disk access</span>perform destructive functions at file level, which the malware implements quite successfully. </p><p id=p657>Of course, one of the most important questions here is the connection between Shamoon and StoneDrill. Both wipers appear to have been used against Saudi organizations during a similar timeframe of October-November 2016. Several theories are possible here: </p><p id=p695>StoneDrill is a less-used wiper tool, deployed in certain situations by the same Shamoon group. StoneDrill and Shamoon are used by different groups which are aligned in their <span class='token pointer' id='tok-181-36' style='color:red'>interests.StoneDrill</span>and Shamoon are used by two different groups which have no connection to each other and just happen to target Saudi organizations at the same time.Taking all factors into account, our opinion is that the most likely theory is the second.  </p><p id=p766>Additionally, StoneDrill appears to be connected with previously reported NewsBeef activity, which continues to target Saudi organizations. From this point of view, NewsBeef and StoneDrill appear to be continuously focused on targeting Saudi interests, while Shamoon is a flashy, come-and-go high impact tool. </p><p id=p809>In terms of attribution, while Shamoon embeds Arabic-Yemen resource language sections, StoneDrill embeds mostly Persian resource language sections. <span class='token pointer' id='tok-181-37' style='color:red'>Geopolitical analysts</span>be quick to point out that Iran and Yemen are both players in the Iran-Saudi Arabia proxy conflict. Of course, we do not exclude the possibility of false flags.  </p><p id=p860>Finally, many unanswered question remain in regards to StoneDrill and NewsBeef. The discovery of the StoneDrill wiper in Europe is a significant sign that the group is expanding its destructive attacks outside the Middle East. The target for the attack appears to be a large corporation with a wide area of activity in the <span class='token pointer' id='tok-181-38' style='color:red'>petro-chemical</span>sector, with no apparent connection or interest in Saudi Arabia. </p><p id=p925>As usual, we will continue to monitor the Shamoon, StoneDrill and NewsBeef attacks.  </p><p id=p939>A presentation about StoneDrill will be given at the Kaspersky Security Analyst Summit Conference in April 2-6, 2017.
 </p>