<p id=p0>Millions <span class='token pointer' id='tok-36-0' style='color:red'>IoT devices</span>on the <span class='token pointer' id='tok-36-1' style='color:red'>Z-Wave wireless protocol</span>vulnerable to a <span class='token pointer' id='tok-36-2' style='color:red'>downgrade</span>attack during <span class='token pointer' id='tok-36-3' style='color:red'>pairing sessions.</span></p><p id=p20>The popular <span class='token pointer' id='tok-36-4' style='color:red'>home automation protocol Z-Wave,</span>by millions of IoT devices, is vulnerable to a downgrade attack that could allow an adversary to take <span class='token pointer' id='tok-36-5' style='color:red'>control</span>of <span class='token pointer' id='tok-36-6' style='color:red'>targeted devices,</span>to researchers. </p><p id=p52><span class='token pointer' id='tok-36-7' style='color:red'>Z-Wave</span>is a <span class='token pointer' id='tok-36-8' style='color:red'>wireless protocol</span>by 2,400 vendors; its <span class='token pointer' id='tok-36-9' style='color:red'>wireless chipsets are embedded in</span>estimated 100 million <span class='token pointer' id='tok-36-10' style='color:red'>devices</span><span class='token pointer' id='tok-36-11' style='color:red'>smart</span>from door locks, lighting, <span class='token pointer' id='tok-36-12' style='color:red'>heating systems</span>home alarms, according to Pen Test Partners, who released a report on the <span class='token pointer' id='tok-36-13' style='color:red'>vulnerability</span>on Wednesday. </p><p id=p97>According researchers, today's Z-Wave systems are <span class='token pointer' id='tok-36-14' style='color:red'>configured</span>to support a <span class='token pointer' id='tok-36-15' style='color:red'>"strong"</span><span class='token pointer' id='tok-36-16' style='color:red'>pairing</span><span class='token pointer' id='tok-36-17' style='color:red'>S2 Z-Wave</span>process. However, a <span class='token pointer' id='tok-36-18' style='color:red'>proof-of-concept (PoC) attack</span>how a <span class='token pointer' id='tok-36-19' style='color:red'>hacker could downgrade</span>higher S2 standard to a <span class='token pointer' id='tok-36-20' style='color:red'>weaker</span><span class='token pointer' id='tok-36-21' style='color:red'>S0 pairing standard,</span>allows an adversary to steal an <span class='token pointer' id='tok-36-22' style='color:red'>encryption key</span>expose a <span class='token pointer' id='tok-36-23' style='color:red'>device</span>to compromise. </p><p id=p149>The <span class='token pointer' id='tok-36-24' style='color:red'>PoC</span><span class='token pointer' id='tok-36-25' style='color:red'>attack</span>involved a hacker within <span class='token pointer' id='tok-36-26' style='color:red'>RF range at</span>time a <span class='token pointer' id='tok-36-27' style='color:red'>controller</span><span class='token pointer' id='tok-36-28' style='color:red'>pairs</span>with the </p><p id=p168>"Z-Wave uses a <span class='token pointer' id='tok-36-29' style='color:red'>traffic.</span><span class='token pointer' id='tok-36-30' style='color:red'>network key to secure</span>key is exchanged between the controller and the client devices <span class='token pointer' id='tok-36-31' style='color:red'>('nodes')</span>when the devices are paired. The keys are used to protect the communications and prevent attackers <span class='token pointer' id='tok-36-32' style='color:red'>exploiting joined devices,"</span>explained. </p><p id=p210>A nearly <span class='token pointer' id='tok-36-33' style='color:red'>pairing issue</span>identified by researchers at <span class='token pointer' id='tok-36-34' style='color:red'>SensePost in 2013 (PDF),</span>Z-Wave owner at the time <span class='token pointer' id='tok-36-35' style='color:red'>Sigma Designs</span>develop the <span class='token pointer' id='tok-36-36' style='color:red'>new pairing process</span>The problem with the old mechanism was "the <span class='token pointer' id='tok-36-37' style='color:red'>network key</span>transmitted between the nodes using <span class='token pointer' id='tok-36-38' style='color:red'>a key of all zeroes,</span>could be sniffed by an attacker within <span class='token pointer' id='tok-36-39' style='color:red'>RF range,"</span>said. </p><p id=p272>But since the introduction of S2, a similar <span class='token pointer' id='tok-36-40' style='color:red'>attack scenario</span>been devised by <span class='token pointer' id='tok-36-41' style='color:red'>Pen Test Partners.</span>have shown that the improved, more secure pairing process ('S2') can be <span class='token pointer' id='tok-36-42' style='color:red'>downgraded</span>back to <span class='token pointer' id='tok-36-43' style='color:red'>S0,</span>negating all improvements," researchers said. </p><p id=p311>Researchers noted that when a Z-Wave device is using the <span class='token pointer' id='tok-36-44' style='color:red'>weaker S0 security (and not</span>S2 flavor), the S2 controller will notify the user when <span class='token pointer' id='tok-36-45' style='color:red'>S0 security</span>being used, after the fact. "We feel this will be ignored or overlooked," researchers said. </p><p id=p355>On Wednesday, <span class='token pointer' id='tok-36-46' style='color:red'>Silicon Labs,</span>acquired Z-Wave <span class='token pointer' id='tok-36-47' style='color:red'>from Sigma Designs</span>this year, posted a <span class='token pointer' id='tok-36-48' style='color:red'>blog</span>addressing the Pen Test Partners research, stating the PoC took advantage of a <span class='token pointer' id='tok-36-49' style='color:red'>backwards-compatibility</span>feature that allowed S2 devices to work on <span class='token pointer' id='tok-36-50' style='color:red'>S0 networks.</span>also stated emphatically that this is not a vulnerability. </p><p id=p403>"It was a conscious choice of the Z-Wave Alliance to discount this <span class='token pointer' id='tok-36-51' style='color:red'>non-vulnerability in</span>to offer partners and customers backwards <span class='token pointer' id='tok-36-52' style='color:red'>compatibility</span>so that they didn't need to replace their gear," said Lars Lydersen, senior director of <span class='token pointer' id='tok-36-53' style='color:red'>product security</span>Silicon Labs, in an interview with Threatpost. </p><p id=p450>Lydersen said, an attack is extremely improbable given the requirements of <span class='token pointer' id='tok-36-54' style='color:red'>specialized equipment,</span>to the <span class='token pointer' id='tok-36-55' style='color:red'>RF network,</span>a <span class='token pointer' id='tok-36-56' style='color:red'>controller reset</span><span class='token pointer' id='tok-36-57' style='color:red'>hacking</span>the pairing session in the <span class='token pointer' id='tok-36-58' style='color:red'>20 milliseconds window</span>vulnerable to attack. </p><p id=p486>"The smart home controller or <span class='token pointer' id='tok-36-59' style='color:red'>gateway</span>will always notify the user if S2 is <span class='token pointer' id='tok-36-60' style='color:red'>reverted to S0</span>the <span class='token pointer' id='tok-36-61' style='color:red'>installation process,"</span>post states. </p><p id=p510>How The Attacks Work </p><p id=p514>The attack exploits the fact that devices supporting the stronger S2 pairing use a type of <span class='token pointer' id='tok-36-62' style='color:red'>programming</span><span class='token pointer' id='tok-36-63' style='color:red'>"command class" code. That</span>is used in the process of <span class='token pointer' id='tok-36-64' style='color:red'>communicating</span>between the controller and IoT </p><p id=p551>"The <span class='token pointer' id='tok-36-65' style='color:red'>node info command</span>entirely <span class='token pointer' id='tok-36-66' style='color:red'>unencrypted</span>and <span class='token pointer' id='tok-36-67' style='color:red'>unauthenticated.</span>This leads to us being able to spoof it, removing the <span class='token pointer' id='tok-36-68' style='color:red'>COMMAND_CLASS_SECURITY_2 command class.</span>controller then assumes that the <span class='token pointer' id='tok-36-69' style='color:red'>device does not support S2,</span><span class='token pointer' id='tok-36-70' style='color:red'>pairs using S0 security.</span>attacker can now intercept the key exchange, obtain the network key and then command the device," researchers described. </p><p id=p609>In one attack scenario against a <span class='token pointer' id='tok-36-71' style='color:red'>Yale Conexis L1 smart lock,</span>were able to use a controller and downgrade the device to the S0 pairing security. The PoC attack then allowed researchers to <span class='token pointer' id='tok-36-72' style='color:red'>lock and unlock</span>at will. </p><p id=p649>Another attack scenario involves triggering an IoT device to send pairing <span class='token pointer' id='tok-36-73' style='color:red'>data</span>by replacing a <span class='token pointer' id='tok-36-74' style='color:red'>battery</span>making it possible for an adversary to "to sniff, modify and then send the data on." </p><p id=p681>"The third method involves <span class='token pointer' id='tok-36-75' style='color:red'>active</span><span class='token pointer' id='tok-36-76' style='color:red'>jamming using an RFCat,"</span>wrote. <span class='token pointer' id='tok-36-77' style='color:red'>RFCat</span>is a <span class='token pointer' id='tok-36-78' style='color:red'>USB radio dongle</span>of <span class='token pointer' id='tok-36-79' style='color:red'>transmitting,</span><span class='token pointer' id='tok-36-80' style='color:red'>receiving</span>and snooping <span class='token pointer' id='tok-36-81' style='color:red'>frequencies.</span><span class='token pointer' id='tok-36-82' style='color:red'>radio</span>attacker can continuously listen for the <span class='token pointer' id='tok-36-83' style='color:red'>node</span>info from the genuine node. As soon as the <span class='token pointer' id='tok-36-84' style='color:red'>home ID</span>been obtained, they can actively <span class='token pointer' id='tok-36-85' style='color:red'>jam</span>the rest of the packet, preventing the node info from being received." </p><p id=p744>Pen Test Partners say the issue is a <span class='token pointer' id='tok-36-86' style='color:red'>standards and implementation concern,</span>are critical of what they say is Silicon Labs lethargic response to securing its <span class='token pointer' id='tok-36-87' style='color:red'>platform.</span>"We're not particularly happy that the Z-Wave Alliance appears to have been aware of the downgrade attack, but hasn't really addressed it," researchers wrote. </p><p id=p796>Despite the fact Silicon Labs doesn't consider the pairing issue <span class='token pointer' id='tok-36-88' style='color:red'>a vulnerability, the</span>said it plans on taking steps to further ensure its customers make informed decisions when <span class='token pointer' id='tok-36-89' style='color:red'>downgrading.</span>Johan Pedersen, product marketing manager, Z-Wave IoT, said it would soon change the way it notified customers that their device was going be <span class='token pointer' id='tok-36-90' style='color:red'>downgraded using the S0 pairing</span>"Instead of notifying customers that the pairing was going to take place after the fact, we will be notifying them of the pairing beforehand," he said.
 </p>