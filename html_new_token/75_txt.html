<p id=p0><span id='tok'>Introduction:</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>part</span><span id='tok'>5</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>series</span><span id='tok'>of</span><span id='tok'>articles</span><span id='tok'>on</span><span id='tok'>learning</span><span class='token pointer' id='tok-75-0' style='color:red'>pentesting</span><span id='tok'>with</span><span class='token pointer' id='tok-75-1' style='color:red'>Metasploitable3.</span><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>previous</span><span id='tok'>article,</span><span id='tok'>we</span><span id='tok'>discussed</span><span id='tok'>how</span><span class='token pointer' id='tok-75-2' style='color:red'>WebDAV</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>gain</span><span id='tok'>access</span><span id='tok'>to</span><span id='tok'>Metasploitable3.</span><span id='tok'>We</span><span id='tok'>used</span><span id='tok'>WebDAV</span><span class='token pointer' id='tok-75-3' style='color:red'>vulnerability</span><span id='tok'>to</span><span id='tok'>obtain</span><span id='tok'>a</span><span class='token pointer' id='tok-75-4' style='color:red'>shell</span><span id='tok'>both</span><span id='tok'>manually</span><span id='tok'>and</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-75-5' style='color:red'>Metasploit</span><span class='token pointer' id='tok-75-6' style='color:red'>framework.</span><span id='tok'>This</span><span id='tok'>article</span><span id='tok'>introduces</span><span id='tok'>another</span><span id='tok'>interesting</span><span id='tok'>vulnerability</span><span id='tok'>that</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>gain</span><span id='tok'>access</span><span id='tok'>to</span><span id='tok'>Metasploitable3.</span></p><p id=p61><span id='tok'>This</span><span id='tok'>article</span><span id='tok'>attempts</span><span id='tok'>to</span><span id='tok'>cover</span><span id='tok'>the</span><span id='tok'>fundamentals</span><span id='tok'>of</span><span id='tok'>pentesting</span><span id='tok'>a</span><span class='token pointer' id='tok-75-7' style='color:red'>WordPress</span><span class='token pointer' id='tok-75-8' style='color:red'>website</span><span id='tok'>and</span><span id='tok'>eventually</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>use</span><span id='tok'>those</span><span id='tok'>same</span><span id='tok'>techniques</span><span id='tok'>to</span><span id='tok'>gain</span><span id='tok'>access</span><span id='tok'>to</span><span id='tok'>Metasploitable3.</span></p><p id=p86><span id='tok'>Following</span><span id='tok'>is</span><span id='tok'>the</span><span class='token pointer' id='tok-75-9' style='color:red'>nmap</span><span id='tok'>output.</span></p><p id=p91><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>previous</span><span id='tok'>article,</span><span id='tok'>we</span><span id='tok'>noticed</span><span id='tok'>the</span><span id='tok'>presence</span><span id='tok'>of</span><span id='tok'>WordPress</span><span id='tok'>instance</span><span id='tok'>from</span><span id='tok'>the</span><span class='token pointer' id='tok-75-10' style='color:red'>preceding</span><span id='tok'>figure.</span></p><p id=p106><span id='tok'>Clicking</span><span id='tok'>on</span><span class='token pointer' id='tok-75-11' style='color:red'>wordpress</span><span id='tok'>button</span><span id='tok'>under</span><span id='tok'>Your</span></p><p id=p112><span id='tok'>Projects</span><span id='tok'>will</span><span id='tok'>show</span><span id='tok'>us</span><span id='tok'>the</span><span id='tok'>wordpress</span><span id='tok'>website</span><span id='tok'>running</span><span id='tok'>on</span><span id='tok'>the</span><span class='token pointer' id='tok-75-12' style='color:red'>target</span><span class='token pointer' id='tok-75-13' style='color:red'>server.</span></p><p id=p124><span id='tok'>Information</span><span id='tok'>Gathering:Let's</span><span id='tok'>begin</span><span id='tok'>with</span><span id='tok'>gathering</span><span id='tok'>some</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>wordpress</span><span class='token pointer' id='tok-75-14' style='color:red'>installation.</span></p><p id=p136><span id='tok'>Identifying</span><span id='tok'>WordPress</span><span class='token pointer' id='tok-75-15' style='color:red'>version:WordPress</span><span id='tok'>version</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>found</span><span id='tok'>from</span><span id='tok'>a</span><span class='token pointer' id='tok-75-16' style='color:red'>readme.html</span><span class='token pointer' id='tok-75-17' style='color:red'>file</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-75-18' style='color:red'>root</span><span id='tok'>of</span><span id='tok'>WordPress.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p159><span id='tok'>It</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>good</span><span id='tok'>idea</span><span id='tok'>to</span><span id='tok'>check</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>identified</span><span id='tok'>version</span><span id='tok'>has</span><span id='tok'>any</span><span id='tok'>known</span><span class='token pointer' id='tok-75-19' style='color:red'>vulnerabilities.</span></p><p id=p174><span class='token pointer' id='tok-75-20' style='color:red'>Directory</span><span id='tok'>Listing:As</span><span id='tok'>you</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure,</span><span id='tok'>some</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>directories</span><span id='tok'>are</span><span id='tok'>not</span><span id='tok'>protected</span><span id='tok'>from</span><span id='tok'>a</span><span class='token pointer' id='tok-75-21' style='color:red'>directory listing.</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>commonly</span><span id='tok'>seen</span><span id='tok'>issue</span><span id='tok'>with</span><span id='tok'>wordpress</span><span id='tok'>installations.</span></p><p id=p203><span id='tok'>If</span><span id='tok'>directory</span><span id='tok'>listing</span><span id='tok'>is</span><span id='tok'>enabled,</span><span id='tok'>it</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>useful</span><span id='tok'>for</span><span id='tok'>an</span><span class='token pointer' id='tok-75-22' style='color:red'>attacker</span><span id='tok'>if</span><span id='tok'>it</span><span id='tok'>contains</span><span id='tok'>any</span><span class='token pointer' id='tok-75-23' style='color:red'>sensitive</span><span id='tok'>files</span><span id='tok'>that</span><span id='tok'>are</span><span id='tok'>not</span><span id='tok'>normally</span><span class='token pointer' id='tok-75-24' style='color:red'>exposed</span><span id='tok'>through</span><span id='tok'>the</span><span id='tok'>links.</span></p><p id=p229><span id='tok'>Username</span><span class='token pointer' id='tok-75-25' style='color:red'>enumeration:</span><span id='tok'>Let's</span><span id='tok'>see</span><span id='tok'>if</span><span class='token pointer' id='tok-75-26' style='color:red'>username</span><span id='tok'>enumeration</span><span id='tok'>is</span><span id='tok'>possible.</span><span id='tok'>Username</span><span id='tok'>enumeration</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>technique</span><span id='tok'>in</span><span id='tok'>which</span><span id='tok'>an</span><span id='tok'>attacker</span><span id='tok'>attempts</span><span id='tok'>to</span><span id='tok'>provide</span><span id='tok'>some</span><span id='tok'>common</span><span class='token pointer' id='tok-75-27' style='color:red'>usernames</span><span id='tok'>and</span><span id='tok'>identifies</span><span id='tok'>valid</span><span id='tok'>usernames</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>based</span><span id='tok'>on</span><span id='tok'>the</span><span class='token pointer' id='tok-75-28' style='color:red'>responses/error messages</span><span id='tok'>back</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>server.</span></p><p id=p270><span id='tok'>Let's</span><span id='tok'>begin</span><span id='tok'>by</span><span id='tok'>entering</span><span class='token pointer' id='tok-75-29' style='color:red'>administrator</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>username</span><span id='tok'>field</span><span id='tok'>and</span><span id='tok'>some</span><span class='token pointer' id='tok-75-30' style='color:red'>password</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>password</span><span id='tok'>field.</span></p><p id=p286><span id='tok'>When</span><span id='tok'>we</span><span class='token pointer' id='tok-75-31' style='color:red'>click</span><span class='token pointer' id='tok-75-32' style='color:red'>Log In</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>is</span><span id='tok'>the</span><span class='token pointer' id='tok-75-33' style='color:red'>error message</span></p><p id=p299><span id='tok'>This</span><span id='tok'>error</span><span id='tok'>confirms</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>username</span><span id='tok'>administrator</span><span id='tok'>doesn't</span><span id='tok'>exist.</span></p><p id=p308><span id='tok'>Now,</span><span id='tok'>let's</span><span id='tok'>try</span><span class='token pointer' id='tok-75-34' style='color:red'>admin</span><span id='tok'>as</span><span id='tok'>username</span><span id='tok'>and</span><span id='tok'>any</span><span id='tok'>password.</span></p><p id=p317><span id='tok'>Clicking</span><span id='tok'>Log</span><span id='tok'>In</span><span id='tok'>this</span><span id='tok'>time</span><span id='tok'>has</span><span id='tok'>shown</span><span id='tok'>a</span><span id='tok'>different</span><span id='tok'>error</span><span id='tok'>message.</span></p><p id=p328><span id='tok'>From</span><span id='tok'>the</span><span id='tok'>error</span><span id='tok'>message,</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>clear</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>password</span><span id='tok'>entered</span><span id='tok'>is</span><span id='tok'>incorrect,</span><span id='tok'>but</span><span id='tok'>the</span><span id='tok'>username</span><span id='tok'>is</span><span id='tok'>valid.</span></p><p id=p346><span id='tok'>Similarly,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>try</span><span id='tok'>other</span><span id='tok'>commonly</span><span id='tok'>used</span><span id='tok'>usernames</span><span id='tok'>and</span><span id='tok'>gather</span><span id='tok'>as</span><span id='tok'>many</span><span id='tok'>valid</span><span id='tok'>usernames</span><span id='tok'>as</span><span id='tok'>we</span><span id='tok'>can.</span></p><p id=p363><span class='token pointer' id='tok-75-35' style='color:red'>Enumerating</span><span class='token pointer' id='tok-75-36' style='color:red'>Plugins:Enumerating</span><span id='tok'>installed</span><span class='token pointer' id='tok-75-37' style='color:red'>plugins</span><span id='tok'>is</span><span id='tok'>an</span><span id='tok'>important</span><span id='tok'>test</span><span id='tok'>case</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>when</span><span id='tok'>assessing</span><span id='tok'>the</span><span id='tok'>security</span><span id='tok'>of</span><span id='tok'>a</span><span id='tok'>WordPress</span><span id='tok'>website.</span><span id='tok'>The</span><span id='tok'>installed</span><span id='tok'>plugins</span><span id='tok'>may</span><span id='tok'>have</span><span id='tok'>publicly</span><span id='tok'>known</span><span id='tok'>vulnerabilities.</span><span id='tok'>Manually</span><span class='token pointer' id='tok-75-38' style='color:red'>enumerating</span><span id='tok'>plugins</span><span id='tok'>and</span><span id='tok'>identifying</span><span id='tok'>the</span><span class='token pointer' id='tok-75-39' style='color:red'>CVEs</span><span id='tok'>registered</span><span id='tok'>against</span><span id='tok'>those</span><span id='tok'>plugins</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>a</span><span class='token pointer' id='tok-75-40' style='color:red'>tedious</span><span id='tok'>job.</span><span id='tok'>So,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>use</span><span id='tok'>automated</span><span id='tok'>scanners</span><span id='tok'>like</span><span class='token pointer' id='tok-75-41' style='color:red'>WPScan</span><span id='tok'>for</span><span id='tok'>this.</span></p><p id=p416><span id='tok'>WPScan</span><span id='tok'>is</span><span id='tok'>available</span><span id='tok'>in</span><span class='token pointer' id='tok-75-42' style='color:red'>Kali</span><span class='token pointer' id='tok-75-43' style='color:red'>Linux.</span><span id='tok'>Launch</span><span id='tok'>a</span><span class='token pointer' id='tok-75-44' style='color:red'>terminal</span><span id='tok'>and</span><span id='tok'>update</span><span id='tok'>WPScan</span><span id='tok'>database</span><span id='tok'>by</span><span id='tok'>running</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-75-45' style='color:red'>command.</span></p><p id=p434><span id='tok'>wpscan</span><span class='token pointer' id='tok-75-46' style='color:red'>–update</span></p><p id=p436><span id='tok'>Run</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>command</span><span id='tok'>after</span><span id='tok'>the</span><span id='tok'>update</span><span id='tok'>is</span><span id='tok'>complete.</span><span id='tok'>This</span><span id='tok'>command</span><span id='tok'>will</span><span id='tok'>enumerate</span><span id='tok'>the</span><span id='tok'>installed</span><span id='tok'>plugins.</span><span id='tok'>Additionally,</span><span id='tok'>it</span><span id='tok'>will</span><span id='tok'>check</span><span id='tok'>if</span><span id='tok'>those</span><span id='tok'>plugins</span><span id='tok'>have</span><span id='tok'>any</span><span id='tok'>known</span><span id='tok'>vulnerabilities.</span></p><p id=p463><span id='tok'>We</span><span id='tok'>should</span><span id='tok'>see</span><span id='tok'>the</span><span id='tok'>details</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>installed</span><span id='tok'>plugins</span><span id='tok'>and</span><span id='tok'>vulnerabilities</span><span id='tok'>(if</span><span id='tok'>any)</span><span id='tok'>after</span><span id='tok'>the</span><span id='tok'>enumeration</span><span id='tok'>is</span><span id='tok'>complete.</span></p><p id=p481><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>figure,</span><span class='token pointer' id='tok-75-47' style='color:red'>Ninja</span></p><p id=p490><span class='token pointer' id='tok-75-48' style='color:red'>Forms plugin is</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>appears</span><span id='tok'>to</span><span id='tok'>have</span><span id='tok'>some</span><span id='tok'>critical</span><span id='tok'>vulnerabilities.</span><span id='tok'>Let's</span><span id='tok'>try</span><span id='tok'>to</span><span id='tok'>understand</span><span id='tok'>how</span><span id='tok'>WPScan</span><span id='tok'>is</span><span id='tok'>detecting</span><span id='tok'>the</span><span id='tok'>installed</span><span id='tok'>plugins</span><span id='tok'>before</span><span id='tok'>getting</span><span id='tok'>more</span><span id='tok'>details</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>Ninja</span></p><p id=p520><span id='tok'>Forms</span><span id='tok'>plugin</span><span id='tok'>vulnerabilities.</span></p><p id=p523><span id='tok'>I</span><span id='tok'>have</span><span id='tok'>captured</span><span id='tok'>the</span><span id='tok'>packets</span><span id='tok'>using</span><span class='token pointer' id='tok-75-49' style='color:red'>Wireshark</span><span id='tok'>while</span><span id='tok'>WPScan</span><span id='tok'>is</span><span id='tok'>running</span><span id='tok'>against</span><span id='tok'>Metasploitable3.</span><span id='tok'>The</span><span id='tok'>following</span><span id='tok'>figure</span><span id='tok'>shows</span><span id='tok'>an</span><span class='token pointer' id='tok-75-50' style='color:red'>HTTP request and response</span><span id='tok'>with</span><span id='tok'>a</span><span id='tok'>plugin</span><span id='tok'>that's</span><span id='tok'>not</span><span id='tok'>installed</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>website.</span></p><p id=p556><span id='tok'>As</span><span id='tok'>you</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>figure,</span><span id='tok'>WPScan</span><span id='tok'>has</span><span id='tok'>requested</span><span id='tok'>for</span><span class='token pointer' id='tok-75-51' style='color:red'>/timer-library/ plugin, and it got</span><span id='tok'>as</span><span id='tok'>it's</span><span id='tok'>response</span><span id='tok'>since</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>not</span><span id='tok'>installed.</span></p><p id=p582><span id='tok'>Similarly,</span><span id='tok'>a</span><span id='tok'>request</span><span id='tok'>for</span><span class='token pointer' id='tok-75-52' style='color:red'>ninja-forms plugin</span><span id='tok'>returned</span><span id='tok'>200</span><span id='tok'>OK</span><span id='tok'>since</span><span id='tok'>this</span><span id='tok'>plugin</span><span id='tok'>is</span><span id='tok'>installed.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p604><span id='tok'>Similarly,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>identify</span><span id='tok'>all</span><span id='tok'>the</span><span id='tok'>installed</span><span id='tok'>plugins.</span><span id='tok'>As</span><span id='tok'>mentioned</span><span id='tok'>earlier,</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>time-consuming</span><span id='tok'>to</span><span id='tok'>do</span><span id='tok'>manually,</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>recommended</span><span id='tok'>to</span><span id='tok'>use</span><span id='tok'>WPScan.</span></p><p id=p628><span id='tok'>Exploiting</span><span id='tok'>WordPress</span><span id='tok'>with</span><span id='tok'>Metasploit:</span><span id='tok'>Now</span><span id='tok'>that,</span><span id='tok'>WPScan</span><span id='tok'>reported</span><span id='tok'>a</span><span id='tok'>vulnerability</span><span id='tok'>in</span><span id='tok'>Ninja</span><span id='tok'>Forms,</span><span id='tok'>and</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>also</span><span id='tok'>provided</span><span id='tok'>some</span><span id='tok'>useful</span><span id='tok'>links.</span><span id='tok'>A</span><span id='tok'>quick</span><span id='tok'>Google</span><span id='tok'>search</span><span id='tok'>for</span><span id='tok'>Ninja</span><span class='token pointer' id='tok-75-53' style='color:red'>Forms exploits</span><span id='tok'>landed</span><span id='tok'>me</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-75-54' style='color:red'>Rapid7's</span><span id='tok'>page.</span><span id='tok'>Ninja</span><span id='tok'>Forms</span><span id='tok'>has</span><span class='token pointer' id='tok-75-55' style='color:red'>Unauthenticated</span><span id='tok'>File</span><span id='tok'>Upload</span><span id='tok'>vulnerability,</span><span id='tok'>and</span><span id='tok'>unsurprisingly,</span><span id='tok'>Metasploit</span><span id='tok'>has</span><span id='tok'>an</span><span id='tok'>exploit</span><span id='tok'>available</span><span id='tok'>for</span><span id='tok'>it.</span></p><p id=p681><span id='tok'>When</span><span id='tok'>checking</span><span id='tok'>the</span><span id='tok'>module</span><span id='tok'>options,</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>noticed</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>module</span><span class='token pointer' id='tok-75-56' style='color:red'>requires</span><span id='tok'>FORM_PATH</span><span id='tok'>as</span><span id='tok'>a</span><span class='token pointer' id='tok-75-57' style='color:red'>mandatory</span><span id='tok'>parameter.</span><span id='tok'>So,</span><span id='tok'>I</span><span id='tok'>browsed</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>a</span><span id='tok'>bit</span><span id='tok'>and</span><span id='tok'>found</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-75-58' style='color:red'>URL.</span></p><p id=p710><span class='token pointer' id='tok-75-59' style='color:red'>http://172.28.128.3:8585/wordpress/index.php/king-of-hearts/</span></p><p id=p711><span id='tok'>Now,</span><span id='tok'>let's</span><span id='tok'>launch</span><span id='tok'>Metasploit</span><span id='tok'>framework</span><span id='tok'>and</span><span id='tok'>run</span><span id='tok'>the</span><span id='tok'>commands</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p725><span id='tok'>And</span><span id='tok'>then,</span><span id='tok'>you</span><span id='tok'>got</span><span id='tok'>a</span><span id='tok'>Meterpreter</span><span id='tok'>shell!</span></p><p id=p732><span id='tok'>Exploiting</span><span id='tok'>WordPress</span><span id='tok'>without</span><span class='token pointer' id='tok-75-60' style='color:red'>Metasploit:Now,</span><span id='tok'>let's</span><span id='tok'>see</span><span id='tok'>another</span><span id='tok'>way</span><span id='tok'>to</span><span id='tok'>exploit</span><span id='tok'>wordpress</span><span id='tok'>on</span><span id='tok'>Metasploitable3</span><span id='tok'>and</span><span id='tok'>get</span><span id='tok'>a</span><span id='tok'>Meterpreter</span><span id='tok'>shell.</span></p><p id=p750><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>saw</span><span id='tok'>earlier,</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>is</span><span id='tok'>prone</span><span id='tok'>to</span><span id='tok'>username</span><span id='tok'>enumeration.</span><span id='tok'>Let's</span><span id='tok'>use</span><span id='tok'>WPScan</span><span id='tok'>and</span><span id='tok'>see</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>get</span><span id='tok'>few</span><span id='tok'>more</span><span id='tok'>usernames.</span><span id='tok'>Launch</span><span id='tok'>a</span><span id='tok'>terminal</span><span id='tok'>and</span><span id='tok'>run</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>command.</span></p><p id=p781><span id='tok'>Interestingly,</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>command</span><span id='tok'>has</span><span id='tok'>identified</span><span id='tok'>3</span><span id='tok'>more</span><span id='tok'>usernames.</span></p><p id=p790><span class='token pointer' id='tok-75-61' style='color:red'>Ethical Hacking Training</span><span id='tok'>Resources</span><span class='token pointer' id='tok-75-62' style='color:red'>(InfoSec)</span></p><p id=p796><span id='tok'>At</span><span id='tok'>this</span><span id='tok'>place,</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>start</span><span class='token pointer' id='tok-75-63' style='color:red'>brute forcing</span><span id='tok'>passwords</span><span id='tok'>using</span><span id='tok'>WPScan,</span><span id='tok'>but</span><span id='tok'>let's</span><span id='tok'>first</span><span id='tok'>manually</span><span id='tok'>see</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>has</span><span id='tok'>weak</span><span id='tok'>passwords.</span></p><p id=p819><span class='token pointer' id='tok-75-64' style='color:red'>admin:admin</span><span id='tok'>–</span><span id='tok'>didn't</span><span id='tok'>work</span></p><p id=p823><span id='tok'>vagrant:vagrant</span><span id='tok'>–</span><span id='tok'>worked</span></p><p id=p826><span id='tok'>user:user</span><span id='tok'>–</span><span id='tok'>didn't</span><span id='tok'>work</span></p><p id=p830><span id='tok'>manager:manager</span><span id='tok'>–</span><span id='tok'>worked</span></p><p id=p833><span class='token pointer' id='tok-75-65' style='color:red'>Logging in</span><span id='tok'>manager</span><span id='tok'>account</span><span id='tok'>has</span><span id='tok'>shown</span><span id='tok'>very</span><span id='tok'>few</span><span id='tok'>menus</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p849><span id='tok'>Logging</span><span id='tok'>in</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>vagrant</span><span id='tok'>account</span><span id='tok'>has</span><span id='tok'>more</span><span id='tok'>options</span><span id='tok'>than</span><span id='tok'>what</span><span id='tok'>we</span><span id='tok'>got</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>manager.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p872><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>logged</span><span id='tok'>in</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>website,</span><span id='tok'>how</span><span id='tok'>to</span><span id='tok'>get</span><span id='tok'>a</span><span id='tok'>shell</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>now?</span></p><p id=p888><span id='tok'>It</span><span id='tok'>is</span><span id='tok'>as</span><span id='tok'>simple</span><span id='tok'>as</span><span id='tok'>editing</span><span id='tok'>and</span></p><p id=p899><span id='tok'>Let's</span><span id='tok'>first</span><span id='tok'>generate</span><span id='tok'>code</span><span id='tok'>to</span><span id='tok'>get</span><span class='token pointer' id='tok-75-66' style='color:red'>PHP meterpreter</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>command.</span></p><p id=p912><span class='token pointer' id='tok-75-67' style='color:red'>shell.php</span></p><p id=p923><span id='tok'>Now,</span><span id='tok'>open</span><span id='tok'>up</span><span id='tok'>your</span><span id='tok'>WordPress</span><span class='token pointer' id='tok-75-68' style='color:red'>dashboard</span><span id='tok'>and</span><span id='tok'>navigate</span><span id='tok'>to</span></p><p id=p935><span id='tok'>On</span><span id='tok'>the</span><span id='tok'>right</span><span id='tok'>side,</span><span id='tok'>select</span><span id='tok'>a</span><span class='token pointer' id='tok-75-69' style='color:red'>PHP file preferably header.php.</span><span id='tok'>looks</span><span id='tok'>as</span><span id='tok'>follows.</span></p><p id=p949><span id='tok'>Now,</span><span id='tok'>copy</span><span id='tok'>the</span><span class='token pointer' id='tok-75-70' style='color:red'>Meterpreter code</span><span id='tok'>generated</span><span id='tok'>using</span><span class='token pointer' id='tok-75-71' style='color:red'>Msfvenom</span><span id='tok'>and</span><span id='tok'>paste</span><span id='tok'>it</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>top</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>header.php</span><span id='tok'>code</span><span id='tok'>editor.</span><span id='tok'>This</span><span id='tok'>looks</span><span id='tok'>as</span><span id='tok'>follows.</span></p><p id=p973><span id='tok'>The</span><span id='tok'>above</span><span id='tok'>code</span><span id='tok'>requires</span><span id='tok'>a</span><span id='tok'>minor</span><span id='tok'>modification.</span><span class='token pointer' id='tok-75-72' style='color:red'>Uncomment</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>beginning</span><span id='tok'>and</span><span id='tok'>add</span><span id='tok'>the</span><span class='token pointer' id='tok-75-73' style='color:red'>closing PHP tag</span><span id='tok'>the</span><span id='tok'>end</span><span id='tok'>of</span><span id='tok'>the</span><span class='token pointer' id='tok-75-74' style='color:red'>meterpreter code.</span><span id='tok'>is</span><span id='tok'>shown</span><span id='tok'>below.</span></p><p id=p1001><span id='tok'>After</span><span class='token pointer' id='tok-75-75' style='color:red'>uncommenting</span><span id='tok'>the</span><span id='tok'>beginning</span><span id='tok'>of</span><span id='tok'>your</span><span id='tok'>PHP</span><span id='tok'>code,</span><span id='tok'>it</span><span id='tok'>should</span><span id='tok'>look</span><span id='tok'>as</span><span id='tok'>follows.</span></p><p id=p1014><span id='tok'>Similarly,</span><span id='tok'>add</span><span id='tok'>the</span><span id='tok'>closing</span><span id='tok'>PHP</span><span id='tok'>tag</span><span id='tok'>before</span><span id='tok'>the</span><span id='tok'>original</span><span id='tok'>theme</span><span id='tok'>header</span><span id='tok'>code.</span><span id='tok'>This</span><span id='tok'>looks</span><span id='tok'>as</span><span id='tok'>follows.</span></p><p id=p1030><span id='tok'>Once</span><span id='tok'>these</span><span id='tok'>modifications</span><span id='tok'>are</span><span id='tok'>done,</span><span class='token pointer' id='tok-75-76' style='color:red'>save the header.php file</span><span id='tok'>clicking</span><span id='tok'>Update</span><span id='tok'>File</span><span id='tok'>button.</span></p><p id=p1044><span id='tok'>Now,</span><span id='tok'>launch</span><span id='tok'>Metasploit</span><span id='tok'>and</span><span id='tok'>start</span><span id='tok'>a</span><span class='token pointer' id='tok-75-77' style='color:red'>handler</span><span id='tok'>as</span><span id='tok'>shown</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>preceding</span><span id='tok'>figure.</span></p><p id=p1057><span id='tok'>Go</span><span id='tok'>back</span><span id='tok'>to</span><span id='tok'>your</span><span id='tok'>browser</span><span id='tok'>and</span><span id='tok'>reload</span><span id='tok'>WordPress</span><span id='tok'>home</span><span id='tok'>page.</span></p><p id=p1067><span id='tok'>Time</span><span id='tok'>to</span><span id='tok'>check</span><span id='tok'>your</span><span id='tok'>handler</span><span id='tok'>in</span><span id='tok'>Metasploit.</span></p><p id=p1074><span class='token pointer' id='tok-75-78' style='color:red'>Boom!</span><span id='tok'>We</span><span id='tok'>got</span><span id='tok'>a</span><span id='tok'>reverse</span><span id='tok'>shell.</span></p><p id=p1080><span id='tok'>Conclusion:</span><span id='tok'>In</span><span id='tok'>this</span><span id='tok'>article,</span><span id='tok'>we</span><span id='tok'>discussed</span><span id='tok'>how</span><span id='tok'>one</span><span id='tok'>could</span><span id='tok'>test</span><span id='tok'>WordPress</span><span id='tok'>websites</span><span id='tok'>for</span><span id='tok'>vulnerabilities.</span><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>used</span><span id='tok'>Metasploitable3</span><span id='tok'>as</span><span id='tok'>our</span><span id='tok'>target</span><span id='tok'>machine</span><span id='tok'>and</span><span class='token pointer' id='tok-75-79' style='color:red'>popped</span><span class='token pointer' id='tok-75-80' style='color:red'>shells</span><span id='tok'>using</span><span id='tok'>the</span><span id='tok'>vulnerabilities</span><span id='tok'>we</span><span id='tok'>found.</span><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>also</span><span id='tok'>seen</span><span id='tok'>multiple</span><span id='tok'>techniques</span><span id='tok'>that</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>against</span><span id='tok'>WordPress</span><span id='tok'>websites.</span><span id='tok'>These</span><span id='tok'>include</span><span id='tok'>WordPress</span><span id='tok'>version</span><span id='tok'>enumeration,</span><span id='tok'>plugin</span><span id='tok'>enumeration,</span><span id='tok'>username</span><span id='tok'>enumeration,</span><span id='tok'>etc.</span><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>next</span><span id='tok'>article,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>discuss</span><span id='tok'>another</span><span id='tok'>way</span><span id='tok'>to</span><span id='tok'>exploit</span><span class='token pointer' id='tok-75-81' style='color:red'>Metaploitable3.
</span></p>