<p id=p0><span id='tok'>In</span><span id='tok'>this</span><span id='tok'>article,</span><span id='tok'>we</span><span id='tok'>will</span><span id='tok'>solve</span><span id='tok'>a</span><span class='token pointer' id='tok-66-0' style='color:red'>Flag</span><span class='token pointer' id='tok-66-1' style='color:red'>(CTF)</span><span class='token pointer' id='tok-66-2' style='color:red'>Capture the</span><span id='tok'>which</span><span id='tok'>was</span><span id='tok'>posted</span><span id='tok'>on</span><span class='token pointer' id='tok-66-3' style='color:red'>VulnHub</span><span id='tok'>by</span><span id='tok'>"0katz."</span></p><p id=p19><span id='tok'>As</span><span id='tok'>you</span><span id='tok'>know</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>previous</span><span id='tok'>articles</span><span id='tok'>in</span><span id='tok'>this</span><span id='tok'>series,</span><span id='tok'>VulnHub</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>platform</span><span id='tok'>which</span><span id='tok'>provides</span><span class='token pointer' id='tok-66-4' style='color:red'>vulnerable</span><span id='tok'>applications/machines</span><span id='tok'>to</span><span id='tok'>gain</span><span id='tok'>practical</span><span id='tok'>hands-on</span><span id='tok'>experience</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>field</span><span id='tok'>of</span><span id='tok'>information</span><span id='tok'>security.</span><span id='tok'>You</span><span id='tok'>can</span><span id='tok'>check</span><span id='tok'>my</span><span id='tok'>previous</span><span id='tok'>articles</span><span id='tok'>for</span><span id='tok'>more</span><span id='tok'>CTF</span><span id='tok'>challenges.</span><span id='tok'>I</span><span id='tok'>have</span><span id='tok'>also</span><span id='tok'>provided</span><span id='tok'>a</span><span id='tok'>downloadable</span><span class='token pointer' id='tok-66-5' style='color:red'>URL</span><span id='tok'>for</span><span id='tok'>this</span><span id='tok'>CTF</span><span id='tok'>here,</span><span id='tok'>so</span><span id='tok'>you</span><span id='tok'>can</span><span id='tok'>download</span><span id='tok'>the</span><span id='tok'>machine</span><span id='tok'>and</span><span id='tok'>run</span><span id='tok'>it</span><span id='tok'>on</span><span class='token pointer' id='tok-66-6' style='color:red'>VirtualBox.</span></p><p id=p80><span id='tok'>The</span><span class='token pointer' id='tok-66-7' style='color:red'>torrent</span><span id='tok'>downloadable</span><span id='tok'>URL</span><span id='tok'>is</span><span id='tok'>also</span><span id='tok'>available</span><span id='tok'>for</span><span id='tok'>this</span><span class='token pointer' id='tok-66-8' style='color:red'>VM,</span><span id='tok'>which</span><span id='tok'>have</span><span id='tok'>been</span><span id='tok'>added</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>reference</span><span id='tok'>section</span><span id='tok'>of</span><span id='tok'>this</span><span id='tok'>article.</span></p><p id=p101><span id='tok'>Please</span><span id='tok'>Note:</span><span id='tok'>For</span><span id='tok'>all</span><span id='tok'>of</span><span id='tok'>these</span><span id='tok'>machines,</span><span id='tok'>I</span><span id='tok'>used</span><span class='token pointer' id='tok-66-9' style='color:red'>Virtual</span><span class='token pointer' id='tok-66-10' style='color:red'>Oracle</span><span id='tok'>to</span><span id='tok'>run</span><span id='tok'>the</span><span id='tok'>downloaded</span><span id='tok'>machine.</span><span id='tok'>I</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>using</span><span class='token pointer' id='tok-66-11' style='color:red'>Linux</span><span class='token pointer' id='tok-66-12' style='color:red'>Kali</span><span id='tok'>an</span><span class='token pointer' id='tok-66-13' style='color:red'>attacker machine</span><span id='tok'>solving</span><span id='tok'>this</span><span id='tok'>CTF.</span><span id='tok'>The</span><span id='tok'>techniques</span><span id='tok'>used</span><span id='tok'>are</span><span id='tok'>solely</span><span id='tok'>for</span><span id='tok'>educational</span><span id='tok'>purposes,</span><span id='tok'>and</span><span id='tok'>I</span><span id='tok'>am</span><span id='tok'>not</span><span id='tok'>responsible</span><span id='tok'>if</span><span id='tok'>the</span><span id='tok'>listed</span><span class='token pointer' id='tok-66-14' style='color:red'>techniques</span><span id='tok'>are</span><span id='tok'>used</span><span id='tok'>against</span><span id='tok'>any</span><span id='tok'>other</span><span id='tok'>targets.</span></p><p id=p155><span id='tok'>In</span><span id='tok'>this</span><span id='tok'>walkthrough,</span><span id='tok'>we</span><span id='tok'>don't</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>run</span><span id='tok'>the</span><span class='token pointer' id='tok-66-15' style='color:red'>Netdiscover</span><span class='token pointer' id='tok-66-16' style='color:red'>command</span><span id='tok'>to</span><span id='tok'>identify</span><span id='tok'>the</span><span class='token pointer' id='tok-66-17' style='color:red'>IP</span><span class='token pointer' id='tok-66-18' style='color:red'>target machine</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>because</span><span id='tok'>when</span><span id='tok'>we</span><span id='tok'>run</span><span id='tok'>the</span><span id='tok'>downloaded</span><span id='tok'>virtual</span><span id='tok'>machine</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>Oracle</span><span id='tok'>Virtual</span><span id='tok'>Box,</span><span id='tok'>it</span><span id='tok'>automatically</span><span id='tok'>assigns</span><span id='tok'>the</span><span id='tok'>IP</span><span id='tok'>address</span><span id='tok'>form</span><span class='token pointer' id='tok-66-19' style='color:red'>DHCP</span><span id='tok'>and</span><span id='tok'>shows</span><span id='tok'>it</span><span id='tok'>on</span><span id='tok'>the</span><span class='token pointer' id='tok-66-20' style='color:red'>terminal.</span><span id='tok'>This</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>following</span><span class='token pointer' id='tok-66-21' style='color:red'>screenshot.</span></p><p id=p210><span id='tok'>Temple</span><span id='tok'>of</span><span id='tok'>Doom</span><span id='tok'>Walkthrough,</span><span id='tok'>Part</span><span id='tok'>1</span></p><p id=p216><span id='tok'>So</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>found</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine</span><span id='tok'>IP</span><span id='tok'>address,</span><span id='tok'>which</span><span id='tok'>is</span><span class='token pointer' id='tok-66-22' style='color:red'>192.168.1.9.</span><span id='tok'>We</span><span id='tok'>will</span><span id='tok'>be</span><span id='tok'>using</span><span class='token pointer' id='tok-66-23' style='color:red'>192.168.1.45</span><span id='tok'>as</span><span id='tok'>an</span><span id='tok'>attacker</span><span id='tok'>machine</span><span id='tok'>in</span><span id='tok'>which</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>installed</span><span id='tok'>Kali</span><span id='tok'>Linux.</span></p><p id=p244><span id='tok'>Note:</span><span id='tok'>These</span><span id='tok'>IP</span><span id='tok'>addresses</span><span id='tok'>may</span><span id='tok'>be</span><span id='tok'>different</span><span id='tok'>as</span><span id='tok'>per</span><span id='tok'>your</span><span id='tok'>network</span><span id='tok'>configuration,</span><span id='tok'>as</span><span id='tok'>these</span><span id='tok'>are</span><span id='tok'>assigned</span><span id='tok'>by</span><span id='tok'>the</span><span id='tok'>DHCP.</span></p><p id=p263><span id='tok'>Let's</span><span id='tok'>move</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>next</span><span id='tok'>step</span><span id='tok'>which</span><span id='tok'>is</span><span class='token pointer' id='tok-66-24' style='color:red'>port scanning.</span><span id='tok'>am</span><span id='tok'>using</span><span class='token pointer' id='tok-66-25' style='color:red'>Nmap,</span><span id='tok'>which</span><span id='tok'>is</span><span id='tok'>the</span><span id='tok'>best</span><span id='tok'>tool</span><span id='tok'>for</span><span id='tok'>port</span><span id='tok'>scanning.</span><span id='tok'>The</span><span id='tok'>completed</span><span id='tok'>output</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>Nmap</span><span id='tok'>result</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>screenshot.</span></p><p id=p299><span class='token pointer' id='tok-66-26' style='color:red'>nmap</span><span class='token pointer' id='tok-66-27' style='color:red'>Command Used:</span><span id='tok'>-Pn</span><span id='tok'>192.168.1.9</span></p><p id=p305><span id='tok'>Explanation:</span></p><p id=p306><span id='tok'>-p-</span><span id='tok'>option</span><span id='tok'>is</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>complete</span><span class='token pointer' id='tok-66-28' style='color:red'>port scan-Pn</span><span id='tok'>is</span><span id='tok'>used</span><span id='tok'>for</span><span class='token pointer' id='tok-66-29' style='color:red'>no-ping</span><span id='tok'>scan-sV</span><span id='tok'>option</span><span id='tok'>is</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>service</span><span id='tok'>detectionAs</span><span id='tok'>observed</span><span id='tok'>in</span><span id='tok'>above</span><span id='tok'>screenshot,</span><span id='tok'>two</span><span id='tok'>ports</span><span id='tok'>were</span><span id='tok'>identified</span><span id='tok'>as</span><span id='tok'>open.</span><span id='tok'>And</span><span id='tok'>as</span><span id='tok'>we</span><span id='tok'>already</span><span id='tok'>know</span><span id='tok'>from</span><span id='tok'>our</span><span id='tok'>previous</span><span class='token pointer' id='tok-66-30' style='color:red'>CTF-solving</span><span id='tok'>experience</span><span id='tok'>that</span><span id='tok'>we</span><span id='tok'>can't</span><span id='tok'>find</span><span id='tok'>any</span><span id='tok'>interesting</span><span id='tok'>information</span><span id='tok'>service</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-66-31' style='color:red'>SSH port,</span><span id='tok'>decided</span><span id='tok'>to</span><span id='tok'>start</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>HTTP</span><span id='tok'>port.</span><span id='tok'>Here,</span><span id='tok'>the</span><span id='tok'>HTTP</span><span id='tok'>service</span><span id='tok'>is</span><span id='tok'>running</span><span id='tok'>on</span><span class='token pointer' id='tok-66-32' style='color:red'>Port 666.</span><span id='tok'>open</span><span id='tok'>it</span><span id='tok'>into</span><span id='tok'>the</span><span id='tok'>browser.</span></p><p id=p381><span id='tok'>As</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>screenshot,</span><span id='tok'>it</span><span id='tok'>shows</span><span id='tok'>an</span><span id='tok'>under-construction</span><span id='tok'>page.</span><span id='tok'>Now,</span><span id='tok'>for</span><span id='tok'>exploring</span><span id='tok'>further,</span><span id='tok'>it's</span><span id='tok'>time</span><span id='tok'>to</span><span id='tok'>run</span><span id='tok'>the</span><span class='token pointer' id='tok-66-33' style='color:red'>dirb</span><span id='tok'>tool</span><span id='tok'>to</span><span id='tok'>identify</span><span id='tok'>other</span><span id='tok'>entry</span><span id='tok'>points</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine.</span><span id='tok'>The</span><span id='tok'>output</span><span id='tok'>of</span><span id='tok'>dirb</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>screenshot</span><span id='tok'>given</span><span id='tok'>below.</span></p><p id=p426><span id='tok'>Command</span><span id='tok'>Used:</span></p><p id=p428><span id='tok'>dirb</span><span class='token pointer' id='tok-66-34' style='color:red'>http://192.168.1.9:666/</span></p><p id=p430><span id='tok'>As</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>screenshot,</span><span id='tok'>dirb</span><span id='tok'>does</span><span id='tok'>not</span><span id='tok'>give</span><span id='tok'>any</span><span id='tok'>result</span><span id='tok'>which</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>further</span><span id='tok'>explored.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>very</span><span id='tok'>strange,</span><span id='tok'>because</span><span id='tok'>we</span><span id='tok'>always</span><span id='tok'>get</span><span id='tok'>something</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>dirb</span><span id='tok'>tool.</span></p><p id=p462><span id='tok'>Now,</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>another</span><span id='tok'>tool</span><span id='tok'>to</span><span id='tok'>search</span><span id='tok'>for</span><span id='tok'>weakness</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-66-35' style='color:red'>target system.</span><span id='tok'>is</span><span class='token pointer' id='tok-66-36' style='color:red'>Nikto Scan.</span><span id='tok'>run</span><span id='tok'>this</span><span id='tok'>scan</span><span id='tok'>and</span><span id='tok'>see</span><span id='tok'>what</span><span id='tok'>we</span><span id='tok'>get.</span></p><p id=p488></p><p id=p490><span id='tok'>nikto</span><span id='tok'>–host</span><span id='tok'>http://192.168.1.9:666/</span></p><p id=p493><span id='tok'>We</span><span id='tok'>did</span><span id='tok'>not</span><span id='tok'>find</span><span id='tok'>anything</span><span id='tok'>useful</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>Nikto</span><span id='tok'>scan</span><span id='tok'>also.</span><span id='tok'>This</span><span id='tok'>is</span><span id='tok'>a</span><span id='tok'>little</span><span class='token pointer' id='tok-66-37' style='color:red'>suspicious.</span></p><p id=p509><span id='tok'>As</span><span id='tok'>all</span><span id='tok'>the</span><span id='tok'>exploration</span><span id='tok'>techniques</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>tried</span><span id='tok'>are</span><span id='tok'>not</span><span id='tok'>providing</span><span id='tok'>any</span><span id='tok'>useful</span><span id='tok'>data,</span><span id='tok'>let's</span><span id='tok'>check</span><span id='tok'>the</span><span id='tok'>under-construction</span><span id='tok'>web</span><span id='tok'>page</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine</span><span id='tok'>for</span><span id='tok'>any</span><span id='tok'>hidden</span><span id='tok'>clues.</span><span id='tok'>While</span><span id='tok'>checking</span><span id='tok'>this</span><span id='tok'>page</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-66-38' style='color:red'>Burp Suite proxy,</span><span id='tok'>was</span><span id='tok'>observed</span><span id='tok'>that</span><span id='tok'>a</span><span id='tok'>session</span><span id='tok'>cookie</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>sent</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-66-39' style='color:red'>response</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>end.</span><span id='tok'>It</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>below</span><span id='tok'>screenshot.</span></p><p id=p571><span id='tok'>You</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>a</span><span id='tok'>session</span><span id='tok'>cookie</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>response</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-66-40' style='color:red'>highlighted</span><span id='tok'>area.</span></p><p id=p585><span id='tok'>When</span><span id='tok'>I</span><span id='tok'>closely</span><span id='tok'>look</span><span id='tok'>at</span><span id='tok'>it,</span><span id='tok'>its</span><span id='tok'>looks</span><span id='tok'>like</span><span id='tok'>an</span><span id='tok'>URL</span><span id='tok'>encoding</span><span id='tok'>string,</span><span id='tok'>as</span><span id='tok'>it</span><span id='tok'>has</span><span id='tok'>the</span><span id='tok'>'%3d'</span><span id='tok'>characters</span><span id='tok'>at</span><span id='tok'>the</span><span id='tok'>end</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>string.</span><span id='tok'>I</span><span id='tok'>used</span><span class='token pointer' id='tok-66-41' style='color:red'>Burp Decoder</span><span id='tok'>decode</span><span id='tok'>the</span><span id='tok'>cookie</span><span id='tok'>value.</span><span id='tok'>After</span><span id='tok'>the</span><span id='tok'>URL</span><span id='tok'>decoding</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>string,</span><span id='tok'>we</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>decode</span><span id='tok'>it</span><span id='tok'>one</span><span id='tok'>more</span><span id='tok'>time</span><span id='tok'>with</span><span class='token pointer' id='tok-66-42' style='color:red'>base64 decoding</span><span id='tok'>view</span><span id='tok'>the</span><span id='tok'>actual</span><span id='tok'>data</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>cookie.</span><span id='tok'>It</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>screenshot.</span></p><p id=p653><span id='tok'>After</span><span id='tok'>decoding</span><span id='tok'>the</span><span id='tok'>session</span><span id='tok'>cookie,</span><span id='tok'>we</span><span id='tok'>have</span><span id='tok'>identified</span><span id='tok'>that</span><span id='tok'>the</span><span id='tok'>username</span><span class='token pointer' id='tok-66-43' style='color:red'>csrftoken</span><span id='tok'>and</span><span id='tok'>expires</span><span id='tok'>parameter</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>passed</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>session</span><span id='tok'>cookie.</span><span id='tok'>So,</span><span id='tok'>I</span><span id='tok'>created</span><span id='tok'>another</span><span class='token pointer' id='tok-66-44' style='color:red'>GET</span><span id='tok'>request</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>session</span><span id='tok'>cookie</span><span id='tok'>and</span><span id='tok'>sent</span><span id='tok'>it</span><span id='tok'>to</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>through</span><span class='token pointer' id='tok-66-45' style='color:red'>Burp Repeater.</span><span id='tok'>returned</span><span id='tok'>a</span><span id='tok'>500</span><span id='tok'>error</span><span id='tok'>code</span><span id='tok'>with</span><span id='tok'>some</span><span id='tok'>informational</span><span id='tok'>error</span><span id='tok'>messages</span><span id='tok'>that</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>screenshot</span><span id='tok'>given</span><span id='tok'>below.</span></p><p id=p715><span id='tok'>From</span><span id='tok'>the</span><span id='tok'>error</span><span id='tok'>messages</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>screenshot,</span><span id='tok'>we</span><span id='tok'>get</span><span id='tok'>some</span><span id='tok'>clue</span><span id='tok'>that</span><span class='token pointer' id='tok-66-46' style='color:red'>Nodeadmin</span><span id='tok'>and</span><span id='tok'>Node-Serialize</span><span id='tok'>are</span><span id='tok'>being</span><span id='tok'>used</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>application.</span></p><p id=p738><span id='tok'>After</span><span id='tok'>playing</span><span id='tok'>with</span><span id='tok'>the</span><span id='tok'>session</span><span id='tok'>cookie,</span><span id='tok'>I</span><span id='tok'>identified</span><span id='tok'>that</span><span class='token pointer' id='tok-66-47' style='color:red'>CSRF</span><span id='tok'>token</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>"expire"</span><span id='tok'>parameter</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>session</span><span id='tok'>cookie</span><span id='tok'>are</span><span id='tok'>not</span><span id='tok'>playing</span><span id='tok'>any</span><span id='tok'>role</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>session.</span><span id='tok'>So,</span><span id='tok'>I</span><span id='tok'>used</span><span id='tok'>the</span><span id='tok'>simple</span><span id='tok'>username</span><span id='tok'>"admin"</span><span id='tok'>and</span><span id='tok'>encode</span><span id='tok'>it</span><span id='tok'>into</span><span class='token pointer' id='tok-66-48' style='color:red'>base64</span><span id='tok'>by</span><span id='tok'>using</span><span id='tok'>Burp</span><span id='tok'>Decoder</span><span id='tok'>and</span><span id='tok'>pass</span><span id='tok'>it</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>cookie</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>repeater.</span><span id='tok'>We</span><span id='tok'>received</span><span id='tok'>the</span><span id='tok'>output</span><span id='tok'>"Hello</span><span id='tok'>Admin"</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>server.</span></p><p id=p799><span id='tok'>We</span><span id='tok'>already</span><span id='tok'>know</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>error</span><span id='tok'>message</span><span id='tok'>that</span><span class='token pointer' id='tok-66-49' style='color:red'>"Node-Serialize"</span><span id='tok'>is</span><span id='tok'>being</span><span id='tok'>used</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>application.</span><span id='tok'>So</span><span id='tok'>I</span><span id='tok'>searched</span><span id='tok'>for</span><span id='tok'>"Node-Serialize"</span><span class='token pointer' id='tok-66-50' style='color:red'>vulnerabilities</span><span id='tok'>on</span><span id='tok'>Google,</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>very</span><span id='tok'>first</span><span id='tok'>result</span><span id='tok'>shows</span><span id='tok'>that</span><span id='tok'>it</span><span id='tok'>is</span><span id='tok'>vulnerable</span><span id='tok'>to</span><span class='token pointer' id='tok-66-51' style='color:red'>(RCE).</span><span class='token pointer' id='tok-66-52' style='color:red'>Remote Code Execution</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>below</span><span id='tok'>screenshot.</span></p><p id=p846></p><p id=p850><span id='tok'>We</span><span id='tok'>have</span><span id='tok'>found</span><span class='token pointer' id='tok-66-53' style='color:red'>vulnerability.</span><span class='token pointer' id='tok-66-54' style='color:red'>Remote Code Execution (RCE)</span><span id='tok'>us</span><span id='tok'>see</span><span id='tok'>if</span><span id='tok'>we</span><span id='tok'>could</span><span id='tok'>use</span><span id='tok'>this</span><span id='tok'>exploit</span><span id='tok'>in</span><span id='tok'>our</span><span id='tok'>scenario</span><span id='tok'>to</span><span id='tok'>get</span><span id='tok'>the</span><span id='tok'>access</span><span id='tok'>of</span><span id='tok'>our</span><span id='tok'>target</span><span id='tok'>machine.</span><span id='tok'>After</span><span id='tok'>getting</span><span id='tok'>the</span><span id='tok'>information</span><span id='tok'>about</span><span id='tok'>the</span><span id='tok'>vulnerability</span><span id='tok'>and</span><span id='tok'>the</span><span id='tok'>exploit</span><span id='tok'>from</span><span id='tok'>google,</span><span id='tok'>I</span><span id='tok'>was</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>create</span><span id='tok'>a</span><span id='tok'>payload</span><span id='tok'>which</span><span id='tok'>could</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>to</span><span id='tok'>exploit</span><span id='tok'>the</span><span id='tok'>vulnerability.</span></p><p id=p906><span class='token pointer' id='tok-66-55' style='color:red'>Payload:</span></p><p id=p907><span class='token pointer' id='tok-66-56' style='color:red'>require('child_process').execSync('ls</span><span class='token pointer' id='tok-66-57' style='color:red'>{"username":"_$$ND_FUNC$$_function(){return</span><span class='token pointer' id='tok-66-58' style='color:red'>/',(e,out,err)=>{console.log(out);});</span><span id='tok'>}()"}</span></p><p id=p912><span id='tok'>In</span><span id='tok'>the</span><span id='tok'>highlighted</span><span id='tok'>area</span><span id='tok'>we</span><span id='tok'>can</span><span id='tok'>see</span><span id='tok'>the</span><span id='tok'>command</span><span id='tok'>which</span><span id='tok'>we</span><span id='tok'>wanted</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine.</span><span id='tok'>As</span><span id='tok'>the</span><span id='tok'>application</span><span id='tok'>is</span><span id='tok'>using</span><span id='tok'>a</span><span class='token pointer' id='tok-66-59' style='color:red'>base64-encoded</span><span id='tok'>cookie,</span><span id='tok'>we</span><span id='tok'>need</span><span id='tok'>to</span><span id='tok'>convert</span><span id='tok'>our</span><span id='tok'>payload</span><span id='tok'>into</span><span class='token pointer' id='tok-66-60' style='color:red'>base64 encoding.</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>easily</span><span id='tok'>done</span><span id='tok'>with</span><span id='tok'>the</span><span class='token pointer' id='tok-66-61' style='color:red'>Burp Suite Decoder.</span><span id='tok'>can</span><span id='tok'>also</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span class='token pointer' id='tok-66-62' style='color:red'>following</span><span id='tok'>screenshot.</span></p><p id=p966><span class='token pointer' id='tok-66-63' style='color:red'>encoded</span><span class='token pointer' id='tok-66-64' style='color:red'>Final Base 64</span><span id='tok'>is</span><span id='tok'>given</span><span id='tok'>below.</span></p><p id=p975><span class='token pointer' id='tok-66-65' style='color:red'>eyJ1c2VybmFtZSI6Il8kJE5EX0ZVTkMkJF9mdW5jdGlvbigpe3JldHVybiByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuZXhlY1N5bmMoJ2xzIC1sIC8nLChlLG91dCxlcnIpPT57Y29uc29sZS5sb2cob3V0KTt9KTsgfSgpIn0=</span></p><p id=p976><span id='tok'>Now</span><span id='tok'>let's</span><span id='tok'>add</span><span id='tok'>this</span><span id='tok'>payload</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>cookie</span><span id='tok'>and</span><span id='tok'>hit</span><span id='tok'>it</span><span id='tok'>by</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-66-66' style='color:red'>Burp Suite Repeater.</span><span id='tok'>server</span><span id='tok'>response</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>following</span><span id='tok'>screenshot.</span></p><p id=p1003><span id='tok'>Through</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>payload,</span><span id='tok'>we</span><span id='tok'>are</span><span id='tok'>successfully</span><span id='tok'>able</span><span id='tok'>to</span><span id='tok'>execute</span><span id='tok'>the</span><span id='tok'>command</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>system.</span><span id='tok'>So</span><span id='tok'>now</span><span id='tok'>let's</span><span id='tok'>take</span><span id='tok'>the</span><span class='token pointer' id='tok-66-67' style='color:red'>shell</span><span class='token pointer' id='tok-66-68' style='color:red'>reverse</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine.</span><span id='tok'>We</span><span id='tok'>would</span><span id='tok'>be</span><span id='tok'>using</span><span id='tok'>the</span><span class='token pointer' id='tok-66-69' style='color:red'>Netcat</span><span id='tok'>utility</span><span id='tok'>to</span><span id='tok'>take</span><span id='tok'>the</span><span id='tok'>reverse</span><span id='tok'>shell.</span></p><p id=p1042><span id='tok'>At</span><span id='tok'>first,</span><span id='tok'>let's</span><span id='tok'>verify</span><span id='tok'>whether</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine</span><span id='tok'>has</span><span id='tok'>the</span><span id='tok'>Netcat</span><span id='tok'>installed.</span><span id='tok'>We</span><span id='tok'>can</span><span id='tok'>verify</span><span id='tok'>this</span><span id='tok'>by</span><span id='tok'>running</span><span id='tok'>the</span><span class='token pointer' id='tok-66-70' style='color:red'>nc –help</span><span id='tok'>If</span><span id='tok'>the</span><span id='tok'>Netcat</span><span id='tok'>utility</span><span id='tok'>is</span><span id='tok'>available</span><span id='tok'>on</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>machine,</span><span id='tok'>it</span><span id='tok'>would</span><span id='tok'>give</span><span id='tok'>the</span><span id='tok'>help</span><span id='tok'>command</span><span id='tok'>output;</span><span id='tok'>otherwise,</span><span id='tok'>a</span><span id='tok'>blank</span><span id='tok'>page</span><span id='tok'>would</span><span id='tok'>be</span><span id='tok'>returned</span><span id='tok'>from</span><span id='tok'>the</span><span id='tok'>server.</span></p><p id=p1091><span id='tok'>As</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>seen</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>above</span><span id='tok'>screenshot,</span><span id='tok'>we</span><span id='tok'>got</span><span id='tok'>the</span><span id='tok'>help</span><span id='tok'>command</span><span id='tok'>details</span><span id='tok'>in</span><span id='tok'>the</span><span id='tok'>server</span><span id='tok'>response.</span><span id='tok'>It</span><span id='tok'>confirms</span><span id='tok'>that</span><span id='tok'>Netcat</span><span id='tok'>can</span><span id='tok'>be</span><span id='tok'>used</span><span id='tok'>for</span><span id='tok'>taking</span><span id='tok'>the</span><span id='tok'>reverse</span><span id='tok'>shell.</span><span id='tok'>So</span><span id='tok'>let's</span><span id='tok'>create</span><span id='tok'>a</span><span id='tok'>payload</span><span id='tok'>to</span><span id='tok'>take</span><span id='tok'>the</span><span id='tok'>reverse</span><span id='tok'>shell</span><span id='tok'>of</span><span id='tok'>the</span><span id='tok'>target</span><span id='tok'>system.
</span></p>