<p id=p0><span class='token pointer' id='tok-76-0'>The</span><span class='token pointer' id='tok-76-1'>document</span><span class='token pointer' id='tok-76-2'>below</span><span class='token pointer' id='tok-76-3'>is</span><span class='token pointer' id='tok-76-4'>an</span><span class='token pointer' id='tok-76-5'>initial</span><span class='token pointer' id='tok-76-6'>level</span><span class='token pointer' id='tok-76-7'>analysis</span><span class='token pointer' id='tok-76-8'>of</span><span class='token pointer' id='tok-76-9'>the</span><span class='token pointer' id='tok-76-10'>recent</span><span class='token pointer' id='tok-76-11'>Petya</span><span class='token pointer' id='tok-76-12'>Ransomware</span><span class='token pointer' id='tok-76-13'>(2017).</span><span class='token pointer' id='tok-76-14'>We</span><span class='token pointer' id='tok-76-15'>will</span><span class='token pointer' id='tok-76-16'>also</span><span class='token pointer' id='tok-76-17'>discuss</span><span class='token pointer' id='tok-76-18'>an</span><span class='token pointer' id='tok-76-19'>analysis</span><span class='token pointer' id='tok-76-20'>of</span><span class='token pointer' id='tok-76-21'>a</span><span class='token pointer' id='tok-76-22'>dll</span><span class='token pointer' id='tok-76-23'>variant</span><span class='token pointer' id='tok-76-24'>of</span><span class='token pointer' id='tok-76-25'>the</span><span class='token pointer' id='tok-76-26'>ransomware.</span></p>
<p id=p27><span class='token pointer' id='tok-76-27'>Ransomware</span><span class='token pointer' id='tok-76-28'>Objective:</span><span class='token pointer' id='tok-76-29'>Encrypt</span><span class='token pointer' id='tok-76-30'>the</span><span class='token pointer' id='tok-76-31'>target</span><span class='token pointer' id='tok-76-32'>machine</span><span class='token pointer' id='tok-76-33'>and</span><span class='token pointer' id='tok-76-34'>ask</span><span class='token pointer' id='tok-76-35'>for</span><span class='token pointer' id='tok-76-36'>ransom</span><span class='token pointer' id='tok-76-37'>(in</span><span class='token pointer' id='tok-76-38'>Bitcoins)</span><span class='token pointer' id='tok-76-39'>to</span><span class='token pointer' id='tok-76-40'>decrypt</span><span class='token pointer' id='tok-76-41'>it.</span></p>
<p id=p42><span class='token pointer' id='tok-76-42'>Analysis</span><span class='token pointer' id='tok-76-43'>Objective:</span><span class='token pointer' id='tok-76-44'>First,</span><span class='token pointer' id='tok-76-45'>this</span><span class='token pointer' id='tok-76-46'>document</span><span class='token pointer' id='tok-76-47'>does</span><span class='token pointer' id='tok-76-48'>not</span><span class='token pointer' id='tok-76-49'>contain</span><span class='token pointer' id='tok-76-50'>all</span><span class='token pointer' id='tok-76-51'>of</span><span class='token pointer' id='tok-76-52'>the</span><span class='token pointer' id='tok-76-53'>indicators</span><span class='token pointer' id='tok-76-54'>but</span><span class='token pointer' id='tok-76-55'>will</span><span class='token pointer' id='tok-76-56'>explain</span><span class='token pointer' id='tok-76-57'>the</span><span class='token pointer' id='tok-76-58'>specimen</span><span class='token pointer' id='tok-76-59'>process.</span><span class='token pointer' id='tok-76-60'>The</span><span class='token pointer' id='tok-76-61'>analysis</span><span class='token pointer' id='tok-76-62'>objective</span><span class='token pointer' id='tok-76-63'>is</span><span class='token pointer' id='tok-76-64'>to</span><span class='token pointer' id='tok-76-65'>do</span><span class='token pointer' id='tok-76-66'>some</span><span class='token pointer' id='tok-76-67'>code</span><span class='token pointer' id='tok-76-68'>analysis</span><span class='token pointer' id='tok-76-69'>in</span><span class='token pointer' id='tok-76-70'>a</span><span class='token pointer' id='tok-76-71'>dissembler</span><span class='token pointer' id='tok-76-72'>and</span><span class='token pointer' id='tok-76-73'>then</span><span class='token pointer' id='tok-76-74'>perform</span><span class='token pointer' id='tok-76-75'>a</span><span class='token pointer' id='tok-76-76'>dynamic</span><span class='token pointer' id='tok-76-77'>analysis</span><span class='token pointer' id='tok-76-78'>as</span><span class='token pointer' id='tok-76-79'>well</span><span class='token pointer' id='tok-76-80'>to</span><span class='token pointer' id='tok-76-81'>see</span><span class='token pointer' id='tok-76-82'>artifacts</span><span class='token pointer' id='tok-76-83'>while</span><span class='token pointer' id='tok-76-84'>the</span><span class='token pointer' id='tok-76-85'>malware</span><span class='token pointer' id='tok-76-86'>is</span><span class='token pointer' id='tok-76-87'>in</span><span class='token pointer' id='tok-76-88'>action.</span></p>
<p id=p89><span class='token pointer' id='tok-76-89'>Certificate</span><span class='token pointer' id='tok-76-90'>InformationThe</span><span class='token pointer' id='tok-76-91'>Petya</span><span class='token pointer' id='tok-76-92'>variant</span><span class='token pointer' id='tok-76-93'>is</span><span class='token pointer' id='tok-76-94'>using</span><span class='token pointer' id='tok-76-95'>an</span><span class='token pointer' id='tok-76-96'>expired</span><span class='token pointer' id='tok-76-97'>Microsoft</span><span class='token pointer' id='tok-76-98'>Certificate.</span></p>
<p id=p99><span class='token pointer' id='tok-76-99'>Since</span><span class='token pointer' id='tok-76-100'>the</span><span class='token pointer' id='tok-76-101'>objective</span><span class='token pointer' id='tok-76-102'>of</span><span class='token pointer' id='tok-76-103'>this</span><span class='token pointer' id='tok-76-104'>ransomware</span><span class='token pointer' id='tok-76-105'>is</span><span class='token pointer' id='tok-76-106'>to</span><span class='token pointer' id='tok-76-107'>encrypt</span><span class='token pointer' id='tok-76-108'>the</span><span class='token pointer' id='tok-76-109'>target</span><span class='token pointer' id='tok-76-110'>machine,</span><span class='token pointer' id='tok-76-111'>I</span><span class='token pointer' id='tok-76-112'>prefer</span><span class='token pointer' id='tok-76-113'>to</span><span class='token pointer' id='tok-76-114'>do</span><span class='token pointer' id='tok-76-115'>some</span><span class='token pointer' id='tok-76-116'>static</span><span class='token pointer' id='tok-76-117'>analysis</span><span class='token pointer' id='tok-76-118'>(i.e.</span><span class='token pointer' id='tok-76-119'>to</span><span class='token pointer' id='tok-76-120'>analyze</span><span class='token pointer' id='tok-76-121'>malware</span><span class='token pointer' id='tok-76-122'>without</span><span class='token pointer' id='tok-76-123'>running</span><span class='token pointer' id='tok-76-124'>it)</span><span class='token pointer' id='tok-76-125'>in</span><span class='token pointer' id='tok-76-126'>IDA</span><span class='token pointer' id='tok-76-127'>Pro</span><span class='token pointer' id='tok-76-128'>and</span><span class='token pointer' id='tok-76-129'>check</span><span class='token pointer' id='tok-76-130'>whether</span><span class='token pointer' id='tok-76-131'>we</span><span class='token pointer' id='tok-76-132'>can</span><span class='token pointer' id='tok-76-133'>see</span><span class='token pointer' id='tok-76-134'>any</span><span class='token pointer' id='tok-76-135'>interesting</span><span class='token pointer' id='tok-76-136'>functions.</span></p>
<p id=p137><span class='token pointer' id='tok-76-137'>Static</span><span class='token pointer' id='tok-76-138'>AnalysisDll</span><span class='token pointer' id='tok-76-139'>is</span><span class='token pointer' id='tok-76-140'>loaded</span><span class='token pointer' id='tok-76-141'>into</span><span class='token pointer' id='tok-76-142'>IDA</span><span class='token pointer' id='tok-76-143'>pro,</span><span class='token pointer' id='tok-76-144'>and</span><span class='token pointer' id='tok-76-145'>as</span><span class='token pointer' id='tok-76-146'>expected</span><span class='token pointer' id='tok-76-147'>it</span><span class='token pointer' id='tok-76-148'>stops</span><span class='token pointer' id='tok-76-149'>at</span><span class='token pointer' id='tok-76-150'>dll</span><span class='token pointer' id='tok-76-151'>Entry</span><span class='token pointer' id='tok-76-152'>Point(main()</span><span class='token pointer' id='tok-76-153'>for</span><span class='token pointer' id='tok-76-154'>dll).</span></p>
<p id=p155><span class='token pointer' id='tok-76-155'>The</span><span class='token pointer' id='tok-76-156'>specimen</span><span class='token pointer' id='tok-76-157'>is</span><span class='token pointer' id='tok-76-158'>using</span><span class='token pointer' id='tok-76-159'>the</span><span class='token pointer' id='tok-76-160'>function</span><span class='token pointer' id='tok-76-161'>below,</span><span class='token pointer' id='tok-76-162'>calling</span><span class='token pointer' id='tok-76-163'>CreateToolhelp32snapshot</span><span class='token pointer' id='tok-76-164'>followed</span><span class='token pointer' id='tok-76-165'>by</span><span class='token pointer' id='tok-76-166'>Process32First</span><span class='token pointer' id='tok-76-167'>and</span><span class='token pointer' id='tok-76-168'>Process</span><span class='token pointer' id='tok-76-169'>32</span><span class='token pointer' id='tok-76-170'>Next.</span><span class='token pointer' id='tok-76-171'>This</span><span class='token pointer' id='tok-76-172'>means</span><span class='token pointer' id='tok-76-173'>the</span><span class='token pointer' id='tok-76-174'>specimen</span><span class='token pointer' id='tok-76-175'>is</span><span class='token pointer' id='tok-76-176'>enumerating</span><span class='token pointer' id='tok-76-177'>the</span><span class='token pointer' id='tok-76-178'>victim</span><span class='token pointer' id='tok-76-179'>machine</span><span class='token pointer' id='tok-76-180'>for</span><span class='token pointer' id='tok-76-181'>running</span><span class='token pointer' id='tok-76-182'>processes.</span></p>
<p id=p183><span class='token pointer' id='tok-76-183'>The</span><span class='token pointer' id='tok-76-184'>authors</span><span class='token pointer' id='tok-76-185'>have</span><span class='token pointer' id='tok-76-186'>XOR'ed</span><span class='token pointer' id='tok-76-187'>the</span><span class='token pointer' id='tok-76-188'>Process</span><span class='token pointer' id='tok-76-189'>Names</span><span class='token pointer' id='tok-76-190'>they</span><span class='token pointer' id='tok-76-191'>are</span><span class='token pointer' id='tok-76-192'>reviewing.</span><span class='token pointer' id='tok-76-193'>After</span><span class='token pointer' id='tok-76-194'>a</span><span class='token pointer' id='tok-76-195'>bit</span><span class='token pointer' id='tok-76-196'>of</span><span class='token pointer' id='tok-76-197'>deobfuscation,</span><span class='token pointer' id='tok-76-198'>it</span><span class='token pointer' id='tok-76-199'>turned</span><span class='token pointer' id='tok-76-200'>out</span><span class='token pointer' id='tok-76-201'>that</span><span class='token pointer' id='tok-76-202'>they</span><span class='token pointer' id='tok-76-203'>are</span><span class='token pointer' id='tok-76-204'>checking</span><span class='token pointer' id='tok-76-205'>for</span><span class='token pointer' id='tok-76-206'>the</span><span class='token pointer' id='tok-76-207'>following</span><span class='token pointer' id='tok-76-208'>AVKaspersky,</span><span class='token pointer' id='tok-76-209'>Norton</span><span class='token pointer' id='tok-76-210'>Security,</span><span class='token pointer' id='tok-76-211'>Symantec.</span><span class='token pointer' id='tok-76-212'>Based</span><span class='token pointer' id='tok-76-213'>on</span><span class='token pointer' id='tok-76-214'>SeDebugPrivilege</span><span class='token pointer' id='tok-76-215'>permissions,</span><span class='token pointer' id='tok-76-216'>the</span><span class='token pointer' id='tok-76-217'>malware</span><span class='token pointer' id='tok-76-218'>will</span><span class='token pointer' id='tok-76-219'>call</span><span class='token pointer' id='tok-76-220'>three</span><span class='token pointer' id='tok-76-221'>APIs</span><span class='token pointer' id='tok-76-222'>to</span><span class='token pointer' id='tok-76-223'>encrypt</span><span class='token pointer' id='tok-76-224'>the</span><span class='token pointer' id='tok-76-225'>files</span><span class='token pointer' id='tok-76-226'>using</span><span class='token pointer' id='tok-76-227'>AES</span><span class='token pointer' id='tok-76-228'>encryption</span><span class='token pointer' id='tok-76-229'>in</span><span class='token pointer' id='tok-76-230'>memory.</span><span class='token pointer' id='tok-76-231'>FindFileMapViewOfFileFLushViewOfFileAfter</span><span class='token pointer' id='tok-76-232'>that</span><span class='token pointer' id='tok-76-233'>specimen,</span><span class='token pointer' id='tok-76-234'>it</span><span class='token pointer' id='tok-76-235'>deletes</span><span class='token pointer' id='tok-76-236'>its</span><span class='token pointer' id='tok-76-237'>activities</span><span class='token pointer' id='tok-76-238'>by</span><span class='token pointer' id='tok-76-239'>deleting</span><span class='token pointer' id='tok-76-240'>Setup,</span><span class='token pointer' id='tok-76-241'>System,</span><span class='token pointer' id='tok-76-242'>Security</span><span class='token pointer' id='tok-76-243'>and</span><span class='token pointer' id='tok-76-244'>Application</span><span class='token pointer' id='tok-76-245'>Event</span><span class='token pointer' id='tok-76-246'>Logs</span><span class='token pointer' id='tok-76-247'>using</span><span class='token pointer' id='tok-76-248'>weutil.</span><span class='token pointer' id='tok-76-249'>It</span><span class='token pointer' id='tok-76-250'>also</span><span class='token pointer' id='tok-76-251'>used</span><span class='token pointer' id='tok-76-252'>fsutil</span><span class='token pointer' id='tok-76-253'>to</span><span class='token pointer' id='tok-76-254'>delete</span><span class='token pointer' id='tok-76-255'>the</span><span class='token pointer' id='tok-76-256'>USN</span><span class='token pointer' id='tok-76-257'>change</span><span class='token pointer' id='tok-76-258'>journal(to</span><span class='token pointer' id='tok-76-259'>remove</span><span class='token pointer' id='tok-76-260'>traces</span><span class='token pointer' id='tok-76-261'>of</span><span class='token pointer' id='tok-76-262'>any</span><span class='token pointer' id='tok-76-263'>update</span><span class='token pointer' id='tok-76-264'>to</span><span class='token pointer' id='tok-76-265'>volume.)Notice</span><span class='token pointer' id='tok-76-266'>wevutil</span><span class='token pointer' id='tok-76-267'>cl</span><span class='token pointer' id='tok-76-268'>and</span><span class='token pointer' id='tok-76-269'>fsutil</span><span class='token pointer' id='tok-76-270'>/D</span><span class='token pointer' id='tok-76-271'>command</span><span class='token pointer' id='tok-76-272'>below</span></p>
<p id=p273><span class='token pointer' id='tok-76-273'>For</span><span class='token pointer' id='tok-76-274'>lateral</span><span class='token pointer' id='tok-76-275'>movement,</span><span class='token pointer' id='tok-76-276'>Petya</span><span class='token pointer' id='tok-76-277'>does</span><span class='token pointer' id='tok-76-278'>the</span><span class='token pointer' id='tok-76-279'>following:It</span><span class='token pointer' id='tok-76-280'>tries</span><span class='token pointer' id='tok-76-281'>to</span><span class='token pointer' id='tok-76-282'>make</span><span class='token pointer' id='tok-76-283'>a</span><span class='token pointer' id='tok-76-284'>connection</span><span class='token pointer' id='tok-76-285'>to</span><span class='token pointer' id='tok-76-286'>admin$</span><span class='token pointer' id='tok-76-287'>with</span><span class='token pointer' id='tok-76-288'>a</span><span class='token pointer' id='tok-76-289'>call</span><span class='token pointer' id='tok-76-290'>to</span><span class='token pointer' id='tok-76-291'>WNetAddConnection</span><span class='token pointer' id='tok-76-292'>with</span><span class='token pointer' id='tok-76-293'>a</span><span class='token pointer' id='tok-76-294'>null</span><span class='token pointer' id='tok-76-295'>username</span><span class='token pointer' id='tok-76-296'>and</span><span class='token pointer' id='tok-76-297'>password,</span><span class='token pointer' id='tok-76-298'>which</span><span class='token pointer' id='tok-76-299'>means</span><span class='token pointer' id='tok-76-300'>that</span><span class='token pointer' id='tok-76-301'>specimen</span><span class='token pointer' id='tok-76-302'>is</span><span class='token pointer' id='tok-76-303'>using</span><span class='token pointer' id='tok-76-304'>current</span><span class='token pointer' id='tok-76-305'>user</span><span class='token pointer' id='tok-76-306'>credentials</span><span class='token pointer' id='tok-76-307'>which</span><span class='token pointer' id='tok-76-308'>will</span><span class='token pointer' id='tok-76-309'>exploit</span><span class='token pointer' id='tok-76-310'>shared</span><span class='token pointer' id='tok-76-311'>local</span><span class='token pointer' id='tok-76-312'>administrator</span><span class='token pointer' id='tok-76-313'>accounts.</span></p>
<p id=p314><span class='token pointer' id='tok-76-314'>After</span><span class='token pointer' id='tok-76-315'>the</span><span class='token pointer' id='tok-76-316'>connection</span><span class='token pointer' id='tok-76-317'>is</span><span class='token pointer' id='tok-76-318'>made,</span><span class='token pointer' id='tok-76-319'>the</span><span class='token pointer' id='tok-76-320'>malware</span><span class='token pointer' id='tok-76-321'>will</span><span class='token pointer' id='tok-76-322'>create</span><span class='token pointer' id='tok-76-323'>a</span><span class='token pointer' id='tok-76-324'>copy</span><span class='token pointer' id='tok-76-325'>of</span><span class='token pointer' id='tok-76-326'>itself</span><span class='token pointer' id='tok-76-327'>using</span><span class='token pointer' id='tok-76-328'>CreateFile()</span><span class='token pointer' id='tok-76-329'>and</span><span class='token pointer' id='tok-76-330'>WriteFile()Then</span><span class='token pointer' id='tok-76-331'>the</span><span class='token pointer' id='tok-76-332'>newly</span><span class='token pointer' id='tok-76-333'>created</span><span class='token pointer' id='tok-76-334'>file</span><span class='token pointer' id='tok-76-335'>is</span><span class='token pointer' id='tok-76-336'>executed</span><span class='token pointer' id='tok-76-337'>using</span><span class='token pointer' id='tok-76-338'>an</span><span class='token pointer' id='tok-76-339'>embedded</span><span class='token pointer' id='tok-76-340'>utility</span><span class='token pointer' id='tok-76-341'>which</span><span class='token pointer' id='tok-76-342'>the</span><span class='token pointer' id='tok-76-343'>specimen</span><span class='token pointer' id='tok-76-344'>extracts</span><span class='token pointer' id='tok-76-345'>as</span><span class='token pointer' id='tok-76-346'>dllhost.dat</span><span class='token pointer' id='tok-76-347'>(C:\Windows)</span><span class='token pointer' id='tok-76-348'>on</span><span class='token pointer' id='tok-76-349'>the</span><span class='token pointer' id='tok-76-350'>target</span><span class='token pointer' id='tok-76-351'>system.</span><span class='token pointer' id='tok-76-352'>This</span><span class='token pointer' id='tok-76-353'>dllhost.dat</span><span class='token pointer' id='tok-76-354'>file</span><span class='token pointer' id='tok-76-355'>uses</span><span class='token pointer' id='tok-76-356'>%s</span><span class='token pointer' id='tok-76-357'>-acceptula</span><span class='token pointer' id='tok-76-358'>-s,</span><span class='token pointer' id='tok-76-359'>which</span><span class='token pointer' id='tok-76-360'>is</span><span class='token pointer' id='tok-76-361'>a</span><span class='token pointer' id='tok-76-362'>silent</span><span class='token pointer' id='tok-76-363'>option</span><span class='token pointer' id='tok-76-364'>for</span><span class='token pointer' id='tok-76-365'>PSEXEC.</span><span class='token pointer' id='tok-76-366'>Submitting</span><span class='token pointer' id='tok-76-367'>dllhost.dat</span><span class='token pointer' id='tok-76-368'>files</span><span class='token pointer' id='tok-76-369'>to</span><span class='token pointer' id='tok-76-370'>VirtuTotal</span><span class='token pointer' id='tok-76-371'>reveals</span><span class='token pointer' id='tok-76-372'>it</span><span class='token pointer' id='tok-76-373'>as</span><span class='token pointer' id='tok-76-374'>PSEXEC.If</span><span class='token pointer' id='tok-76-375'>above</span><span class='token pointer' id='tok-76-376'>approach</span><span class='token pointer' id='tok-76-377'>fails,</span><span class='token pointer' id='tok-76-378'>then</span><span class='token pointer' id='tok-76-379'>the</span><span class='token pointer' id='tok-76-380'>malware</span><span class='token pointer' id='tok-76-381'>will</span><span class='token pointer' id='tok-76-382'>try</span><span class='token pointer' id='tok-76-383'>to</span><span class='token pointer' id='tok-76-384'>execute</span><span class='token pointer' id='tok-76-385'>the</span><span class='token pointer' id='tok-76-386'>dllhost.dat</span><span class='token pointer' id='tok-76-387'>file</span><span class='token pointer' id='tok-76-388'>using</span><span class='token pointer' id='tok-76-389'>WMIC.exe.</span></p>
<p id=p390><span class='token pointer' id='tok-76-390'>The</span><span class='token pointer' id='tok-76-391'>specimen</span><span class='token pointer' id='tok-76-392'>also</span><span class='token pointer' id='tok-76-393'>uses</span><span class='token pointer' id='tok-76-394'>DHcpEnumSubnets,</span><span class='token pointer' id='tok-76-395'>DHCPSubnetINfo,</span><span class='token pointer' id='tok-76-396'>DHCPSubnetCLients</span><span class='token pointer' id='tok-76-397'>to</span><span class='token pointer' id='tok-76-398'>enumerate</span><span class='token pointer' id='tok-76-399'>all</span><span class='token pointer' id='tok-76-400'>the</span><span class='token pointer' id='tok-76-401'>clients</span><span class='token pointer' id='tok-76-402'>in</span><span class='token pointer' id='tok-76-403'>the</span><span class='token pointer' id='tok-76-404'>domain.</span></p>
<p id=p405><span class='token pointer' id='tok-76-405'>If</span><span class='token pointer' id='tok-76-406'>the</span><span class='token pointer' id='tok-76-407'>specimen</span><span class='token pointer' id='tok-76-408'>gets</span><span class='token pointer' id='tok-76-409'>SEDebugPrivilege,</span><span class='token pointer' id='tok-76-410'>then</span><span class='token pointer' id='tok-76-411'>the</span><span class='token pointer' id='tok-76-412'>specimen</span><span class='token pointer' id='tok-76-413'>will</span><span class='token pointer' id='tok-76-414'>also</span><span class='token pointer' id='tok-76-415'>access</span><span class='token pointer' id='tok-76-416'>the</span><span class='token pointer' id='tok-76-417'>physical</span><span class='token pointer' id='tok-76-418'>device.</span><span class='token pointer' id='tok-76-419'>The</span><span class='token pointer' id='tok-76-420'>specimen</span><span class='token pointer' id='tok-76-421'>collects</span><span class='token pointer' id='tok-76-422'>all</span><span class='token pointer' id='tok-76-423'>the</span><span class='token pointer' id='tok-76-424'>files</span><span class='token pointer' id='tok-76-425'>as</span><span class='token pointer' id='tok-76-426'>listed</span><span class='token pointer' id='tok-76-427'>below.</span></p>
<p id=p428><span class='token pointer' id='tok-76-428'>Below</span><span class='token pointer' id='tok-76-429'>is</span><span class='token pointer' id='tok-76-430'>some</span><span class='token pointer' id='tok-76-431'>of</span><span class='token pointer' id='tok-76-432'>the</span><span class='token pointer' id='tok-76-433'>text</span><span class='token pointer' id='tok-76-434'>of</span><span class='token pointer' id='tok-76-435'>Petya</span><span class='token pointer' id='tok-76-436'>banner</span><span class='token pointer' id='tok-76-437'>that</span><span class='token pointer' id='tok-76-438'>we</span><span class='token pointer' id='tok-76-439'>will</span><span class='token pointer' id='tok-76-440'>see</span><span class='token pointer' id='tok-76-441'>once</span><span class='token pointer' id='tok-76-442'>the</span><span class='token pointer' id='tok-76-443'>target</span><span class='token pointer' id='tok-76-444'>system</span><span class='token pointer' id='tok-76-445'>is</span><span class='token pointer' id='tok-76-446'>encrypted</span></p>
<p id=p447><span class='token pointer' id='tok-76-447'>Below</span><span class='token pointer' id='tok-76-448'>is</span><span class='token pointer' id='tok-76-449'>the</span><span class='token pointer' id='tok-76-450'>Fake</span><span class='token pointer' id='tok-76-451'>CHKDSK</span><span class='token pointer' id='tok-76-452'>message.</span></p>
<p id=p453><span class='token pointer' id='tok-76-453'>Ethical</span><span class='token pointer' id='tok-76-454'>Hacking</span><span class='token pointer' id='tok-76-455'>Training</span><span class='token pointer' id='tok-76-456'>â€“</span><span class='token pointer' id='tok-76-457'>Resources</span><span class='token pointer' id='tok-76-458'>(InfoSec)</span></p>
<p id=p459><span class='token pointer' id='tok-76-459'>Dynamic</span><span class='token pointer' id='tok-76-460'>AnalysisSince</span><span class='token pointer' id='tok-76-461'>this</span><span class='token pointer' id='tok-76-462'>is</span><span class='token pointer' id='tok-76-463'>a</span><span class='token pointer' id='tok-76-464'>dll,</span><span class='token pointer' id='tok-76-465'>it</span><span class='token pointer' id='tok-76-466'>needs</span><span class='token pointer' id='tok-76-467'>to</span><span class='token pointer' id='tok-76-468'>be</span><span class='token pointer' id='tok-76-469'>run</span><span class='token pointer' id='tok-76-470'>with</span><span class='token pointer' id='tok-76-471'>rundll32</span><span class='token pointer' id='tok-76-472'>like</span><span class='token pointer' id='tok-76-473'>below</span></p>
<p id=p474><span class='token pointer' id='tok-76-474'>As</span><span class='token pointer' id='tok-76-475'>soon</span><span class='token pointer' id='tok-76-476'>as</span><span class='token pointer' id='tok-76-477'>the</span><span class='token pointer' id='tok-76-478'>task</span><span class='token pointer' id='tok-76-479'>is</span><span class='token pointer' id='tok-76-480'>created,</span><span class='token pointer' id='tok-76-481'>it</span><span class='token pointer' id='tok-76-482'>creates</span><span class='token pointer' id='tok-76-483'>a</span><span class='token pointer' id='tok-76-484'>Scheduled</span><span class='token pointer' id='tok-76-485'>task</span><span class='token pointer' id='tok-76-486'>to</span><span class='token pointer' id='tok-76-487'>shut</span><span class='token pointer' id='tok-76-488'>down</span><span class='token pointer' id='tok-76-489'>the</span><span class='token pointer' id='tok-76-490'>system.</span><span class='token pointer' id='tok-76-491'>I</span><span class='token pointer' id='tok-76-492'>have</span><span class='token pointer' id='tok-76-493'>observed</span><span class='token pointer' id='tok-76-494'>that</span><span class='token pointer' id='tok-76-495'>it</span><span class='token pointer' id='tok-76-496'>gives</span><span class='token pointer' id='tok-76-497'>a</span><span class='token pointer' id='tok-76-498'>buffer</span><span class='token pointer' id='tok-76-499'>of</span><span class='token pointer' id='tok-76-500'>around</span><span class='token pointer' id='tok-76-501'>one</span><span class='token pointer' id='tok-76-502'>hour</span><span class='token pointer' id='tok-76-503'>before</span><span class='token pointer' id='tok-76-504'>the</span><span class='token pointer' id='tok-76-505'>scheduled</span><span class='token pointer' id='tok-76-506'>tasks</span><span class='token pointer' id='tok-76-507'>kick</span><span class='token pointer' id='tok-76-508'>in.</span><span class='token pointer' id='tok-76-509'>In</span><span class='token pointer' id='tok-76-510'>this</span><span class='token pointer' id='tok-76-511'>buffer</span><span class='token pointer' id='tok-76-512'>period,</span><span class='token pointer' id='tok-76-513'>malware</span><span class='token pointer' id='tok-76-514'>will</span><span class='token pointer' id='tok-76-515'>get</span><span class='token pointer' id='tok-76-516'>a</span><span class='token pointer' id='tok-76-517'>hold</span><span class='token pointer' id='tok-76-518'>of</span><span class='token pointer' id='tok-76-519'>the</span><span class='token pointer' id='tok-76-520'>whole</span><span class='token pointer' id='tok-76-521'>system</span><span class='token pointer' id='tok-76-522'>and</span><span class='token pointer' id='tok-76-523'>also</span><span class='token pointer' id='tok-76-524'>try</span><span class='token pointer' id='tok-76-525'>to</span><span class='token pointer' id='tok-76-526'>enumerate</span><span class='token pointer' id='tok-76-527'>the</span><span class='token pointer' id='tok-76-528'>network,</span><span class='token pointer' id='tok-76-529'>since</span><span class='token pointer' id='tok-76-530'>just</span><span class='token pointer' id='tok-76-531'>before</span><span class='token pointer' id='tok-76-532'>the</span><span class='token pointer' id='tok-76-533'>shutdown,</span><span class='token pointer' id='tok-76-534'>malware</span><span class='token pointer' id='tok-76-535'>will</span><span class='token pointer' id='tok-76-536'>delete</span><span class='token pointer' id='tok-76-537'>itself</span><span class='token pointer' id='tok-76-538'>and</span><span class='token pointer' id='tok-76-539'>if</span><span class='token pointer' id='tok-76-540'>it</span><span class='token pointer' id='tok-76-541'>immediately</span><span class='token pointer' id='tok-76-542'>shuts</span><span class='token pointer' id='tok-76-543'>itself</span><span class='token pointer' id='tok-76-544'>down,</span><span class='token pointer' id='tok-76-545'>then</span><span class='token pointer' id='tok-76-546'>it</span><span class='token pointer' id='tok-76-547'>misses</span><span class='token pointer' id='tok-76-548'>the</span><span class='token pointer' id='tok-76-549'>chance</span><span class='token pointer' id='tok-76-550'>to</span><span class='token pointer' id='tok-76-551'>spread</span><span class='token pointer' id='tok-76-552'>in</span><span class='token pointer' id='tok-76-553'>the</span><span class='token pointer' id='tok-76-554'>network.</span></p>
<p id=p555><span class='token pointer' id='tok-76-555'>As</span><span class='token pointer' id='tok-76-556'>stated</span><span class='token pointer' id='tok-76-557'>above,</span><span class='token pointer' id='tok-76-558'>the</span><span class='token pointer' id='tok-76-559'>specimen</span><span class='token pointer' id='tok-76-560'>tries</span><span class='token pointer' id='tok-76-561'>to</span><span class='token pointer' id='tok-76-562'>map</span><span class='token pointer' id='tok-76-563'>admin</span><span class='token pointer' id='tok-76-564'>share</span><span class='token pointer' id='tok-76-565'>to</span><span class='token pointer' id='tok-76-566'>other</span><span class='token pointer' id='tok-76-567'>machines</span><span class='token pointer' id='tok-76-568'>on</span><span class='token pointer' id='tok-76-569'>the</span><span class='token pointer' id='tok-76-570'>network.</span></p>
<p id=p571><span class='token pointer' id='tok-76-571'>Following</span><span class='token pointer' id='tok-76-572'>are</span><span class='token pointer' id='tok-76-573'>the</span><span class='token pointer' id='tok-76-574'>processes</span><span class='token pointer' id='tok-76-575'>created</span><span class='token pointer' id='tok-76-576'>by</span><span class='token pointer' id='tok-76-577'>the</span><span class='token pointer' id='tok-76-578'>specimen.As</span><span class='token pointer' id='tok-76-579'>mentioned</span><span class='token pointer' id='tok-76-580'>above</span><span class='token pointer' id='tok-76-581'>in</span><span class='token pointer' id='tok-76-582'>static</span><span class='token pointer' id='tok-76-583'>analysisIt</span><span class='token pointer' id='tok-76-584'>creates</span><span class='token pointer' id='tok-76-585'>a</span><span class='token pointer' id='tok-76-586'>scheduled</span><span class='token pointer' id='tok-76-587'>taskCreates</span><span class='token pointer' id='tok-76-588'>a</span><span class='token pointer' id='tok-76-589'>tmp</span><span class='token pointer' id='tok-76-590'>file</span><span class='token pointer' id='tok-76-591'>in</span><span class='token pointer' id='tok-76-592'>AppData</span><span class='token pointer' id='tok-76-593'>local</span><span class='token pointer' id='tok-76-594'>folderCreates</span><span class='token pointer' id='tok-76-595'>dllhost.dat</span><span class='token pointer' id='tok-76-596'>file</span><span class='token pointer' id='tok-76-597'>in</span><span class='token pointer' id='tok-76-598'>C:\WindowsI</span><span class='token pointer' id='tok-76-599'>also</span><span class='token pointer' id='tok-76-600'>noticed</span><span class='token pointer' id='tok-76-601'>that</span><span class='token pointer' id='tok-76-602'>the</span><span class='token pointer' id='tok-76-603'>specimen</span><span class='token pointer' id='tok-76-604'>will</span><span class='token pointer' id='tok-76-605'>delete</span><span class='token pointer' id='tok-76-606'>the</span><span class='token pointer' id='tok-76-607'>malicious</span><span class='token pointer' id='tok-76-608'>file</span><span class='token pointer' id='tok-76-609'>(petya.dll)</span><span class='token pointer' id='tok-76-610'>in</span><span class='token pointer' id='tok-76-611'>this</span><span class='token pointer' id='tok-76-612'>case</span><span class='token pointer' id='tok-76-613'>and</span><span class='token pointer' id='tok-76-614'>will</span><span class='token pointer' id='tok-76-615'>copy</span><span class='token pointer' id='tok-76-616'>to</span><span class='token pointer' id='tok-76-617'>C:\Windows.</span><span class='token pointer' id='tok-76-618'>Those</span><span class='token pointer' id='tok-76-619'>who</span><span class='token pointer' id='tok-76-620'>are</span><span class='token pointer' id='tok-76-621'>still</span><span class='token pointer' id='tok-76-622'>following</span><span class='token pointer' id='tok-76-623'>the</span><span class='token pointer' id='tok-76-624'>document</span><span class='token pointer' id='tok-76-625'>will</span><span class='token pointer' id='tok-76-626'>know</span><span class='token pointer' id='tok-76-627'>why</span><span class='token pointer' id='tok-76-628'>I</span><span class='token pointer' id='tok-76-629'>mentioned</span><span class='token pointer' id='tok-76-630'>this</span><span class='token pointer' id='tok-76-631'>point.</span><span class='token pointer' id='tok-76-632'>(Later</span><span class='token pointer' id='tok-76-633'>in</span><span class='token pointer' id='tok-76-634'>Kill</span><span class='token pointer' id='tok-76-635'>Switch)</span></p>
<p id=p636><span class='token pointer' id='tok-76-636'>There</span><span class='token pointer' id='tok-76-637'>are</span><span class='token pointer' id='tok-76-638'>a</span><span class='token pointer' id='tok-76-639'>whole</span><span class='token pointer' id='tok-76-640'>lot</span><span class='token pointer' id='tok-76-641'>of</span><span class='token pointer' id='tok-76-642'>CreateFile</span><span class='token pointer' id='tok-76-643'>events</span><span class='token pointer' id='tok-76-644'>by</span><span class='token pointer' id='tok-76-645'>this</span><span class='token pointer' id='tok-76-646'>specimen</span><span class='token pointer' id='tok-76-647'>since</span><span class='token pointer' id='tok-76-648'>it</span><span class='token pointer' id='tok-76-649'>needs</span><span class='token pointer' id='tok-76-650'>to</span><span class='token pointer' id='tok-76-651'>get</span><span class='token pointer' id='tok-76-652'>hold</span><span class='token pointer' id='tok-76-653'>of</span><span class='token pointer' id='tok-76-654'>the</span><span class='token pointer' id='tok-76-655'>files</span><span class='token pointer' id='tok-76-656'>in</span><span class='token pointer' id='tok-76-657'>the</span><span class='token pointer' id='tok-76-658'>system</span><span class='token pointer' id='tok-76-659'>to</span><span class='token pointer' id='tok-76-660'>encrypt.After</span><span class='token pointer' id='tok-76-661'>the</span><span class='token pointer' id='tok-76-662'>scheduled</span><span class='token pointer' id='tok-76-663'>tasks</span><span class='token pointer' id='tok-76-664'>kick</span><span class='token pointer' id='tok-76-665'>in,</span><span class='token pointer' id='tok-76-666'>then</span><span class='token pointer' id='tok-76-667'>as</span><span class='token pointer' id='tok-76-668'>expected</span><span class='token pointer' id='tok-76-669'>the</span><span class='token pointer' id='tok-76-670'>FAKECHKDSK</span><span class='token pointer' id='tok-76-671'>message</span><span class='token pointer' id='tok-76-672'>will</span><span class='token pointer' id='tok-76-673'>appear.</span></p>
<p id=p674><span class='token pointer' id='tok-76-674'>Defeating</span><span class='token pointer' id='tok-76-675'>Petya</span><span class='token pointer' id='tok-76-676'>process</span><span class='token pointer' id='tok-76-677'>(trial)</span><span class='token pointer' id='tok-76-678'>I</span><span class='token pointer' id='tok-76-679'>thought</span><span class='token pointer' id='tok-76-680'>to</span><span class='token pointer' id='tok-76-681'>try</span><span class='token pointer' id='tok-76-682'>a</span><span class='token pointer' id='tok-76-683'>couple</span><span class='token pointer' id='tok-76-684'>of</span><span class='token pointer' id='tok-76-685'>techniques</span><span class='token pointer' id='tok-76-686'>to</span><span class='token pointer' id='tok-76-687'>avoid</span><span class='token pointer' id='tok-76-688'>either</span><span class='token pointer' id='tok-76-689'>the</span><span class='token pointer' id='tok-76-690'>encryption</span><span class='token pointer' id='tok-76-691'>process</span><span class='token pointer' id='tok-76-692'>or</span><span class='token pointer' id='tok-76-693'>to</span><span class='token pointer' id='tok-76-694'>stop</span><span class='token pointer' id='tok-76-695'>the</span><span class='token pointer' id='tok-76-696'>malware</span><span class='token pointer' id='tok-76-697'>from</span><span class='token pointer' id='tok-76-698'>running</span><span class='token pointer' id='tok-76-699'>altogether.</span></p>
<p id=p700><span class='token pointer' id='tok-76-700'>I</span><span class='token pointer' id='tok-76-701'>tried</span><span class='token pointer' id='tok-76-702'>using</span><span class='token pointer' id='tok-76-703'>the</span><span class='token pointer' id='tok-76-704'>Cisco</span><span class='token pointer' id='tok-76-705'>MBRFilter</span><span class='token pointer' id='tok-76-706'>driver</span><span class='token pointer' id='tok-76-707'>utility</span><span class='token pointer' id='tok-76-708'>which</span><span class='token pointer' id='tok-76-709'>per</span><span class='token pointer' id='tok-76-710'>Cisco</span><span class='token pointer' id='tok-76-711'>will</span><span class='token pointer' id='tok-76-712'>prevent</span><span class='token pointer' id='tok-76-713'>any</span><span class='token pointer' id='tok-76-714'>attempts</span><span class='token pointer' id='tok-76-715'>to</span><span class='token pointer' id='tok-76-716'>overwrite</span><span class='token pointer' id='tok-76-717'>MBR</span><span class='token pointer' id='tok-76-718'>record.</span></p>
<p id=p719><span class='token pointer' id='tok-76-719'>This</span><span class='token pointer' id='tok-76-720'>did</span><span class='token pointer' id='tok-76-721'>not</span><span class='token pointer' id='tok-76-722'>work</span><span class='token pointer' id='tok-76-723'>for</span><span class='token pointer' id='tok-76-724'>me,</span><span class='token pointer' id='tok-76-725'>and</span><span class='token pointer' id='tok-76-726'>Petya</span><span class='token pointer' id='tok-76-727'>successfully</span><span class='token pointer' id='tok-76-728'>encrypted</span><span class='token pointer' id='tok-76-729'>my</span><span class='token pointer' id='tok-76-730'>system</span><span class='token pointer' id='tok-76-731'>even</span><span class='token pointer' id='tok-76-732'>with</span><span class='token pointer' id='tok-76-733'>this</span><span class='token pointer' id='tok-76-734'>driver</span><span class='token pointer' id='tok-76-735'>running</span><span class='token pointer' id='tok-76-736'>L.</span></p>
<p id=p737><span class='token pointer' id='tok-76-737'>There</span><span class='token pointer' id='tok-76-738'>is</span><span class='token pointer' id='tok-76-739'>some</span><span class='token pointer' id='tok-76-740'>news</span><span class='token pointer' id='tok-76-741'>of</span><span class='token pointer' id='tok-76-742'>a</span><span class='token pointer' id='tok-76-743'>Kill</span><span class='token pointer' id='tok-76-744'>Switch</span><span class='token pointer' id='tok-76-745'>of</span><span class='token pointer' id='tok-76-746'>Petya</span><span class='token pointer' id='tok-76-747'>of</span><span class='token pointer' id='tok-76-748'>including</span><span class='token pointer' id='tok-76-749'>perfc</span><span class='token pointer' id='tok-76-750'>file</span><span class='token pointer' id='tok-76-751'>in</span><span class='token pointer' id='tok-76-752'>C:\Windows\</span><span class='token pointer' id='tok-76-753'>directory.</span><span class='token pointer' id='tok-76-754'>I</span><span class='token pointer' id='tok-76-755'>blindly</span><span class='token pointer' id='tok-76-756'>followed</span><span class='token pointer' id='tok-76-757'>the</span><span class='token pointer' id='tok-76-758'>news</span><span class='token pointer' id='tok-76-759'>and</span><span class='token pointer' id='tok-76-760'>created</span><span class='token pointer' id='tok-76-761'>following</span><span class='token pointer' id='tok-76-762'>perfc*</span><span class='token pointer' id='tok-76-763'>app</span><span class='token pointer' id='tok-76-764'>files</span><span class='token pointer' id='tok-76-765'>in</span><span class='token pointer' id='tok-76-766'>read</span><span class='token pointer' id='tok-76-767'>only</span><span class='token pointer' id='tok-76-768'>mode.But</span><span class='token pointer' id='tok-76-769'>it</span><span class='token pointer' id='tok-76-770'>did</span><span class='token pointer' id='tok-76-771'>not</span><span class='token pointer' id='tok-76-772'>work,</span><span class='token pointer' id='tok-76-773'>and</span><span class='token pointer' id='tok-76-774'>Petya</span><span class='token pointer' id='tok-76-775'>again</span><span class='token pointer' id='tok-76-776'>encrypted</span><span class='token pointer' id='tok-76-777'>my</span><span class='token pointer' id='tok-76-778'>device.</span><span class='token pointer' id='tok-76-779'>Reading</span><span class='token pointer' id='tok-76-780'>the</span><span class='token pointer' id='tok-76-781'>code</span><span class='token pointer' id='tok-76-782'>reveals</span><span class='token pointer' id='tok-76-783'>that</span><span class='token pointer' id='tok-76-784'>the</span><span class='token pointer' id='tok-76-785'>specimen</span><span class='token pointer' id='tok-76-786'>is</span><span class='token pointer' id='tok-76-787'>looking</span><span class='token pointer' id='tok-76-788'>for</span><span class='token pointer' id='tok-76-789'>the</span><span class='token pointer' id='tok-76-790'>exact</span><span class='token pointer' id='tok-76-791'>same</span><span class='token pointer' id='tok-76-792'>file</span><span class='token pointer' id='tok-76-793'>which</span><span class='token pointer' id='tok-76-794'>is</span><span class='token pointer' id='tok-76-795'>run</span><span class='token pointer' id='tok-76-796'>as</span><span class='token pointer' id='tok-76-797'>a</span><span class='token pointer' id='tok-76-798'>specimen.</span><span class='token pointer' id='tok-76-799'>In</span><span class='token pointer' id='tok-76-800'>our</span><span class='token pointer' id='tok-76-801'>case</span><span class='token pointer' id='tok-76-802'>it</span><span class='token pointer' id='tok-76-803'>is</span><span class='token pointer' id='tok-76-804'>petya.dll.</span><span class='token pointer' id='tok-76-805'>So</span><span class='token pointer' id='tok-76-806'>I</span><span class='token pointer' id='tok-76-807'>created</span><span class='token pointer' id='tok-76-808'>a</span><span class='token pointer' id='tok-76-809'>new</span><span class='token pointer' id='tok-76-810'>Petya.dll</span><span class='token pointer' id='tok-76-811'>app</span><span class='token pointer' id='tok-76-812'>file</span><span class='token pointer' id='tok-76-813'>and</span><span class='token pointer' id='tok-76-814'>make</span><span class='token pointer' id='tok-76-815'>it</span><span class='token pointer' id='tok-76-816'>read</span><span class='token pointer' id='tok-76-817'>only.</span></p>
<p id=p818><span class='token pointer' id='tok-76-818'>And</span><span class='token pointer' id='tok-76-819'>this</span><span class='token pointer' id='tok-76-820'>time</span><span class='token pointer' id='tok-76-821'>it</span><span class='token pointer' id='tok-76-822'>worked.</span><span class='token pointer' id='tok-76-823'>I</span><span class='token pointer' id='tok-76-824'>could</span><span class='token pointer' id='tok-76-825'>see</span><span class='token pointer' id='tok-76-826'>the</span><span class='token pointer' id='tok-76-827'>malware</span><span class='token pointer' id='tok-76-828'>process</span><span class='token pointer' id='tok-76-829'>created</span><span class='token pointer' id='tok-76-830'>but</span><span class='token pointer' id='tok-76-831'>then</span><span class='token pointer' id='tok-76-832'>deleted</span><span class='token pointer' id='tok-76-833'>itself</span><span class='token pointer' id='tok-76-834'>after</span><span class='token pointer' id='tok-76-835'>it</span><span class='token pointer' id='tok-76-836'>saw</span><span class='token pointer' id='tok-76-837'>the</span><span class='token pointer' id='tok-76-838'>existence</span><span class='token pointer' id='tok-76-839'>of</span><span class='token pointer' id='tok-76-840'>petya.dll.</span><span class='token pointer' id='tok-76-841'>There</span><span class='token pointer' id='tok-76-842'>was</span><span class='token pointer' id='tok-76-843'>no</span><span class='token pointer' id='tok-76-844'>creation</span><span class='token pointer' id='tok-76-845'>of</span><span class='token pointer' id='tok-76-846'>a</span><span class='token pointer' id='tok-76-847'>scheduled</span><span class='token pointer' id='tok-76-848'>task</span><span class='token pointer' id='tok-76-849'>as</span><span class='token pointer' id='tok-76-850'>is</span><span class='token pointer' id='tok-76-851'>mentioned</span><span class='token pointer' id='tok-76-852'>above.</span></p>
<p id=p853><span class='token pointer' id='tok-76-853'>To</span><span class='token pointer' id='tok-76-854'>be</span><span class='token pointer' id='tok-76-855'>on</span><span class='token pointer' id='tok-76-856'>the</span><span class='token pointer' id='tok-76-857'>safe</span><span class='token pointer' id='tok-76-858'>side,</span><span class='token pointer' id='tok-76-859'>I</span><span class='token pointer' id='tok-76-860'>restarted</span><span class='token pointer' id='tok-76-861'>my</span><span class='token pointer' id='tok-76-862'>system,</span><span class='token pointer' id='tok-76-863'>and</span><span class='token pointer' id='tok-76-864'>it</span><span class='token pointer' id='tok-76-865'>came</span><span class='token pointer' id='tok-76-866'>back</span><span class='token pointer' id='tok-76-867'>in</span><span class='token pointer' id='tok-76-868'>good</span><span class='token pointer' id='tok-76-869'>shape.</span></p>
<p id=p870><span class='token pointer' id='tok-76-870'>So,</span><span class='token pointer' id='tok-76-871'>this</span><span class='token pointer' id='tok-76-872'>is</span><span class='token pointer' id='tok-76-873'>the</span><span class='token pointer' id='tok-76-874'>initial</span><span class='token pointer' id='tok-76-875'>Analysis.</span><span class='token pointer' id='tok-76-876'>I</span><span class='token pointer' id='tok-76-877'>will</span><span class='token pointer' id='tok-76-878'>work</span><span class='token pointer' id='tok-76-879'>on</span><span class='token pointer' id='tok-76-880'>the</span><span class='token pointer' id='tok-76-881'>credential</span><span class='token pointer' id='tok-76-882'>extraction</span><span class='token pointer' id='tok-76-883'>process</span><span class='token pointer' id='tok-76-884'>in</span><span class='token pointer' id='tok-76-885'>this</span><span class='token pointer' id='tok-76-886'>malware</span><span class='token pointer' id='tok-76-887'>and</span><span class='token pointer' id='tok-76-888'>will</span><span class='token pointer' id='tok-76-889'>also</span><span class='token pointer' id='tok-76-890'>review</span><span class='token pointer' id='tok-76-891'>what</span><span class='token pointer' id='tok-76-892'>stack</span><span class='token pointer' id='tok-76-893'>parameters</span><span class='token pointer' id='tok-76-894'>can</span><span class='token pointer' id='tok-76-895'>be</span><span class='token pointer' id='tok-76-896'>seen</span><span class='token pointer' id='tok-76-897'>in</span><span class='token pointer' id='tok-76-898'>the</span><span class='token pointer' id='tok-76-899'>debugger.</span></p>
<p id=p900><span class='token pointer' id='tok-76-900'></span><span class='token pointer' id='tok-76-901'></span><span class='token pointer' id='tok-76-902'></span><span class='token pointer' id='tok-76-903'></span><span class='token pointer' id='tok-76-904'></span><span class='token pointer' id='tok-76-905'>