<p id=p0><span class='token pointer' id='tok-70-0'>Often</span><span class='token pointer' id='tok-70-1'>during</span><span class='token pointer' id='tok-70-2'>our</span><span class='token pointer' id='tok-70-3'>penetration</span><span class='token pointer' id='tok-70-4'>testing</span><span class='token pointer' id='tok-70-5'>engagements,</span><span class='token pointer' id='tok-70-6'>we</span><span class='token pointer' id='tok-70-7'>may</span><span class='token pointer' id='tok-70-8'>have</span><span class='token pointer' id='tok-70-9'>to</span><span class='token pointer' id='tok-70-10'>bypass</span><span class='token pointer' id='tok-70-11'>antivirus</span><span class='token pointer' id='tok-70-12'>applications</span><span class='token pointer' id='tok-70-13'>â€“</span><span class='token pointer' id='tok-70-14'>especially</span><span class='token pointer' id='tok-70-15'>during</span><span class='token pointer' id='tok-70-16'>the</span><span class='token pointer' id='tok-70-17'>post</span><span class='token pointer' id='tok-70-18'>exploitation</span><span class='token pointer' id='tok-70-19'>phase</span><span class='token pointer' id='tok-70-20'>to</span><span class='token pointer' id='tok-70-21'>execute</span><span class='token pointer' id='tok-70-22'>certain</span><span class='token pointer' id='tok-70-23'>files</span><span class='token pointer' id='tok-70-24'>on</span><span class='token pointer' id='tok-70-25'>the</span><span class='token pointer' id='tok-70-26'>target</span><span class='token pointer' id='tok-70-27'>machines.</span><span class='token pointer' id='tok-70-28'>Sometimes</span><span class='token pointer' id='tok-70-29'>it</span><span class='token pointer' id='tok-70-30'>is</span><span class='token pointer' id='tok-70-31'>challenging</span><span class='token pointer' id='tok-70-32'>to</span><span class='token pointer' id='tok-70-33'>bypass</span><span class='token pointer' id='tok-70-34'>certain</span><span class='token pointer' id='tok-70-35'>antivirus</span><span class='token pointer' id='tok-70-36'>applications,</span><span class='token pointer' id='tok-70-37'>as</span><span class='token pointer' id='tok-70-38'>there</span><span class='token pointer' id='tok-70-39'>is</span><span class='token pointer' id='tok-70-40'>no</span><span class='token pointer' id='tok-70-41'>standard</span><span class='token pointer' id='tok-70-42'>method/technique</span><span class='token pointer' id='tok-70-43'>available</span><span class='token pointer' id='tok-70-44'>to</span><span class='token pointer' id='tok-70-45'>bypass</span><span class='token pointer' id='tok-70-46'>all</span><span class='token pointer' id='tok-70-47'>the</span><span class='token pointer' id='tok-70-48'>antivirus</span><span class='token pointer' id='tok-70-49'>software.</span><span class='token pointer' id='tok-70-50'>Thus,</span><span class='token pointer' id='tok-70-51'>we</span><span class='token pointer' id='tok-70-52'>need</span><span class='token pointer' id='tok-70-53'>to</span><span class='token pointer' id='tok-70-54'>try</span><span class='token pointer' id='tok-70-55'>out</span><span class='token pointer' id='tok-70-56'>different</span><span class='token pointer' id='tok-70-57'>methods</span><span class='token pointer' id='tok-70-58'>to</span><span class='token pointer' id='tok-70-59'>bypass</span><span class='token pointer' id='tok-70-60'>them.</span><span class='token pointer' id='tok-70-61'>This</span><span class='token pointer' id='tok-70-62'>article</span><span class='token pointer' id='tok-70-63'>walks</span><span class='token pointer' id='tok-70-64'>the</span><span class='token pointer' id='tok-70-65'>reader</span><span class='token pointer' id='tok-70-66'>through</span><span class='token pointer' id='tok-70-67'>some</span><span class='token pointer' id='tok-70-68'>of</span><span class='token pointer' id='tok-70-69'>the</span><span class='token pointer' id='tok-70-70'>popular</span><span class='token pointer' id='tok-70-71'>tools</span><span class='token pointer' id='tok-70-72'>available</span><span class='token pointer' id='tok-70-73'>to</span><span class='token pointer' id='tok-70-74'>play</span><span class='token pointer' id='tok-70-75'>with</span><span class='token pointer' id='tok-70-76'>Antivirus</span><span class='token pointer' id='tok-70-77'>evasion.</span></p>
<p id=p78><span class='token pointer' id='tok-70-78'>File</span><span class='token pointer' id='tok-70-79'>Splitters</span><span class='token pointer' id='tok-70-80'>and</span><span class='token pointer' id='tok-70-81'>Hex</span><span class='token pointer' id='tok-70-82'>editors</span><span class='token pointer' id='tok-70-83'>The</span><span class='token pointer' id='tok-70-84'>first</span><span class='token pointer' id='tok-70-85'>technique</span><span class='token pointer' id='tok-70-86'>that</span><span class='token pointer' id='tok-70-87'>we</span><span class='token pointer' id='tok-70-88'>are</span><span class='token pointer' id='tok-70-89'>going</span><span class='token pointer' id='tok-70-90'>to</span><span class='token pointer' id='tok-70-91'>discuss</span><span class='token pointer' id='tok-70-92'>is</span><span class='token pointer' id='tok-70-93'>using</span><span class='token pointer' id='tok-70-94'>file</span><span class='token pointer' id='tok-70-95'>splitting</span><span class='token pointer' id='tok-70-96'>tools</span><span class='token pointer' id='tok-70-97'>to</span><span class='token pointer' id='tok-70-98'>identify</span><span class='token pointer' id='tok-70-99'>the</span><span class='token pointer' id='tok-70-100'>exact</span><span class='token pointer' id='tok-70-101'>signature</span><span class='token pointer' id='tok-70-102'>that</span><span class='token pointer' id='tok-70-103'>is</span><span class='token pointer' id='tok-70-104'>being</span><span class='token pointer' id='tok-70-105'>detected</span><span class='token pointer' id='tok-70-106'>by</span><span class='token pointer' id='tok-70-107'>the</span><span class='token pointer' id='tok-70-108'>antivirus</span><span class='token pointer' id='tok-70-109'>application</span><span class='token pointer' id='tok-70-110'>and</span><span class='token pointer' id='tok-70-111'>modify</span><span class='token pointer' id='tok-70-112'>it.</span><span class='token pointer' id='tok-70-113'>This</span><span class='token pointer' id='tok-70-114'>is</span><span class='token pointer' id='tok-70-115'>one</span><span class='token pointer' id='tok-70-116'>of</span><span class='token pointer' id='tok-70-117'>the</span><span class='token pointer' id='tok-70-118'>oldest</span><span class='token pointer' id='tok-70-119'>ways</span><span class='token pointer' id='tok-70-120'>to</span><span class='token pointer' id='tok-70-121'>bypass</span><span class='token pointer' id='tok-70-122'>AV</span><span class='token pointer' id='tok-70-123'>tools.</span><span class='token pointer' id='tok-70-124'>This</span><span class='token pointer' id='tok-70-125'>technique</span><span class='token pointer' id='tok-70-126'>is</span><span class='token pointer' id='tok-70-127'>efficient</span><span class='token pointer' id='tok-70-128'>if</span><span class='token pointer' id='tok-70-129'>we</span><span class='token pointer' id='tok-70-130'>can</span><span class='token pointer' id='tok-70-131'>locate</span><span class='token pointer' id='tok-70-132'>the</span><span class='token pointer' id='tok-70-133'>exact</span><span class='token pointer' id='tok-70-134'>signature</span><span class='token pointer' id='tok-70-135'>that</span><span class='token pointer' id='tok-70-136'>is</span><span class='token pointer' id='tok-70-137'>being</span><span class='token pointer' id='tok-70-138'>detected.</span><span class='token pointer' id='tok-70-139'>However,</span><span class='token pointer' id='tok-70-140'>there</span><span class='token pointer' id='tok-70-141'>is</span><span class='token pointer' id='tok-70-142'>a</span><span class='token pointer' id='tok-70-143'>limitation</span><span class='token pointer' id='tok-70-144'>with</span><span class='token pointer' id='tok-70-145'>this</span><span class='token pointer' id='tok-70-146'>technique.</span><span class='token pointer' id='tok-70-147'>If</span><span class='token pointer' id='tok-70-148'>we</span><span class='token pointer' id='tok-70-149'>mess</span><span class='token pointer' id='tok-70-150'>the</span><span class='token pointer' id='tok-70-151'>functionality</span><span class='token pointer' id='tok-70-152'>of</span><span class='token pointer' id='tok-70-153'>the</span><span class='token pointer' id='tok-70-154'>application,</span><span class='token pointer' id='tok-70-155'>it</span><span class='token pointer' id='tok-70-156'>becomes</span><span class='token pointer' id='tok-70-157'>useless</span><span class='token pointer' id='tok-70-158'>even</span><span class='token pointer' id='tok-70-159'>if</span><span class='token pointer' id='tok-70-160'>we</span><span class='token pointer' id='tok-70-161'>bypass</span><span class='token pointer' id='tok-70-162'>antivirus.</span><span class='token pointer' id='tok-70-163'>So,</span><span class='token pointer' id='tok-70-164'>as</span><span class='token pointer' id='tok-70-165'>long</span><span class='token pointer' id='tok-70-166'>as</span><span class='token pointer' id='tok-70-167'>the</span><span class='token pointer' id='tok-70-168'>functionality</span><span class='token pointer' id='tok-70-169'>is</span><span class='token pointer' id='tok-70-170'>not</span><span class='token pointer' id='tok-70-171'>modified</span><span class='token pointer' id='tok-70-172'>while</span><span class='token pointer' id='tok-70-173'>we</span><span class='token pointer' id='tok-70-174'>are</span><span class='token pointer' id='tok-70-175'>changing</span><span class='token pointer' id='tok-70-176'>the</span><span class='token pointer' id='tok-70-177'>signatures,</span><span class='token pointer' id='tok-70-178'>we</span><span class='token pointer' id='tok-70-179'>are</span><span class='token pointer' id='tok-70-180'>good</span><span class='token pointer' id='tok-70-181'>to</span><span class='token pointer' id='tok-70-182'>go.</span></p>
<p id=p183><span class='token pointer' id='tok-70-183'>This</span><span class='token pointer' id='tok-70-184'>can</span><span class='token pointer' id='tok-70-185'>be</span><span class='token pointer' id='tok-70-186'>achieved</span><span class='token pointer' id='tok-70-187'>by</span><span class='token pointer' id='tok-70-188'>using</span><span class='token pointer' id='tok-70-189'>a</span><span class='token pointer' id='tok-70-190'>file-splitting</span><span class='token pointer' id='tok-70-191'>tool</span><span class='token pointer' id='tok-70-192'>to</span><span class='token pointer' id='tok-70-193'>split</span><span class='token pointer' id='tok-70-194'>the</span><span class='token pointer' id='tok-70-195'>binary</span><span class='token pointer' id='tok-70-196'>into</span><span class='token pointer' id='tok-70-197'>many</span><span class='token pointer' id='tok-70-198'>parts.</span><span class='token pointer' id='tok-70-199'>This</span><span class='token pointer' id='tok-70-200'>splitting</span><span class='token pointer' id='tok-70-201'>should</span><span class='token pointer' id='tok-70-202'>be</span><span class='token pointer' id='tok-70-203'>done</span><span class='token pointer' id='tok-70-204'>in</span><span class='token pointer' id='tok-70-205'>such</span><span class='token pointer' id='tok-70-206'>a</span><span class='token pointer' id='tok-70-207'>way</span><span class='token pointer' id='tok-70-208'>that</span><span class='token pointer' id='tok-70-209'>each</span><span class='token pointer' id='tok-70-210'>part</span><span class='token pointer' id='tok-70-211'>is</span><span class='token pointer' id='tok-70-212'>larger</span><span class='token pointer' id='tok-70-213'>than</span><span class='token pointer' id='tok-70-214'>the</span><span class='token pointer' id='tok-70-215'>previous</span><span class='token pointer' id='tok-70-216'>one</span><span class='token pointer' id='tok-70-217'>by</span><span class='token pointer' id='tok-70-218'>a</span><span class='token pointer' id='tok-70-219'>fixed</span><span class='token pointer' id='tok-70-220'>amount.</span><span class='token pointer' id='tok-70-221'>Then</span><span class='token pointer' id='tok-70-222'>we</span><span class='token pointer' id='tok-70-223'>need</span><span class='token pointer' id='tok-70-224'>to</span><span class='token pointer' id='tok-70-225'>run</span><span class='token pointer' id='tok-70-226'>the</span><span class='token pointer' id='tok-70-227'>Antivirus</span><span class='token pointer' id='tok-70-228'>scan</span><span class='token pointer' id='tok-70-229'>on</span><span class='token pointer' id='tok-70-230'>these</span><span class='token pointer' id='tok-70-231'>parts</span><span class='token pointer' id='tok-70-232'>to</span><span class='token pointer' id='tok-70-233'>identify</span><span class='token pointer' id='tok-70-234'>which</span><span class='token pointer' id='tok-70-235'>part</span><span class='token pointer' id='tok-70-236'>is</span><span class='token pointer' id='tok-70-237'>flagged</span><span class='token pointer' id='tok-70-238'>first</span><span class='token pointer' id='tok-70-239'>as</span><span class='token pointer' id='tok-70-240'>malicious.</span><span class='token pointer' id='tok-70-241'>We</span><span class='token pointer' id='tok-70-242'>need</span><span class='token pointer' id='tok-70-243'>to</span><span class='token pointer' id='tok-70-244'>do</span><span class='token pointer' id='tok-70-245'>this</span><span class='token pointer' id='tok-70-246'>process</span><span class='token pointer' id='tok-70-247'>repeatedly</span><span class='token pointer' id='tok-70-248'>until</span><span class='token pointer' id='tok-70-249'>the</span><span class='token pointer' id='tok-70-250'>actual</span><span class='token pointer' id='tok-70-251'>signature</span><span class='token pointer' id='tok-70-252'>is</span><span class='token pointer' id='tok-70-253'>located.</span><span class='token pointer' id='tok-70-254'>Tools</span><span class='token pointer' id='tok-70-255'>such</span><span class='token pointer' id='tok-70-256'>as</span><span class='token pointer' id='tok-70-257'>"Dsplit"</span><span class='token pointer' id='tok-70-258'>and</span><span class='token pointer' id='tok-70-259'>"Evade"</span><span class='token pointer' id='tok-70-260'>can</span><span class='token pointer' id='tok-70-261'>be</span><span class='token pointer' id='tok-70-262'>used</span><span class='token pointer' id='tok-70-263'>for</span><span class='token pointer' id='tok-70-264'>file</span><span class='token pointer' id='tok-70-265'>splitting.</span><span class='token pointer' id='tok-70-266'>Once</span><span class='token pointer' id='tok-70-267'>the</span><span class='token pointer' id='tok-70-268'>signature</span><span class='token pointer' id='tok-70-269'>is</span><span class='token pointer' id='tok-70-270'>located,</span><span class='token pointer' id='tok-70-271'>we</span><span class='token pointer' id='tok-70-272'>need</span><span class='token pointer' id='tok-70-273'>to</span><span class='token pointer' id='tok-70-274'>modify</span><span class='token pointer' id='tok-70-275'>it</span><span class='token pointer' id='tok-70-276'>and</span><span class='token pointer' id='tok-70-277'>save</span><span class='token pointer' id='tok-70-278'>the</span><span class='token pointer' id='tok-70-279'>modified</span><span class='token pointer' id='tok-70-280'>binary.</span></p>
<p id=p281><span class='token pointer' id='tok-70-281'>Let's</span><span class='token pointer' id='tok-70-282'>have</span><span class='token pointer' id='tok-70-283'>a</span><span class='token pointer' id='tok-70-284'>look</span><span class='token pointer' id='tok-70-285'>at</span><span class='token pointer' id='tok-70-286'>an</span><span class='token pointer' id='tok-70-287'>example</span><span class='token pointer' id='tok-70-288'>of</span><span class='token pointer' id='tok-70-289'>how</span><span class='token pointer' id='tok-70-290'>this</span><span class='token pointer' id='tok-70-291'>really</span><span class='token pointer' id='tok-70-292'>works</span><span class='token pointer' id='tok-70-293'>against</span><span class='token pointer' id='tok-70-294'>Antivirus</span><span class='token pointer' id='tok-70-295'>tools.</span></p>
<p id=p296><span class='token pointer' id='tok-70-296'>I</span><span class='token pointer' id='tok-70-297'>have</span><span class='token pointer' id='tok-70-298'>downloaded</span><span class='token pointer' id='tok-70-299'>wce.exe</span><span class='token pointer' id='tok-70-300'>from</span><span class='token pointer' id='tok-70-301'>the</span><span class='token pointer' id='tok-70-302'>link</span><span class='token pointer' id='tok-70-303'>given</span><span class='token pointer' id='tok-70-304'>below.</span><span class='token pointer' id='tok-70-305'>This</span><span class='token pointer' id='tok-70-306'>is</span><span class='token pointer' id='tok-70-307'>one</span><span class='token pointer' id='tok-70-308'>of</span><span class='token pointer' id='tok-70-309'>the</span><span class='token pointer' id='tok-70-310'>commonly</span><span class='token pointer' id='tok-70-311'>used</span><span class='token pointer' id='tok-70-312'>tool</span><span class='token pointer' id='tok-70-313'>during</span><span class='token pointer' id='tok-70-314'>post</span><span class='token pointer' id='tok-70-315'>exploitation</span><span class='token pointer' id='tok-70-316'>for</span><span class='token pointer' id='tok-70-317'>dumping</span><span class='token pointer' id='tok-70-318'>passwords</span><span class='token pointer' id='tok-70-319'>in</span><span class='token pointer' id='tok-70-320'>clear</span><span class='token pointer' id='tok-70-321'>text.</span></p>
<p id=p322><span class='token pointer' id='tok-70-322'>When</span><span class='token pointer' id='tok-70-323'>we</span><span class='token pointer' id='tok-70-324'>scan</span><span class='token pointer' id='tok-70-325'>this</span><span class='token pointer' id='tok-70-326'>tool</span><span class='token pointer' id='tok-70-327'>through</span><span class='token pointer' id='tok-70-328'>virustotal.com,</span><span class='token pointer' id='tok-70-329'>it</span><span class='token pointer' id='tok-70-330'>is</span><span class='token pointer' id='tok-70-331'>flagged</span><span class='token pointer' id='tok-70-332'>as</span><span class='token pointer' id='tok-70-333'>malicious</span><span class='token pointer' id='tok-70-334'>by</span><span class='token pointer' id='tok-70-335'>47</span><span class='token pointer' id='tok-70-336'>Antivirus</span><span class='token pointer' id='tok-70-337'>softwares</span><span class='token pointer' id='tok-70-338'>out</span><span class='token pointer' id='tok-70-339'>of</span><span class='token pointer' id='tok-70-340'>56.</span></p>
<p id=p341><span class='token pointer' id='tok-70-341'>By</span><span class='token pointer' id='tok-70-342'>using</span><span class='token pointer' id='tok-70-343'>Dsplit,</span><span class='token pointer' id='tok-70-344'>I</span><span class='token pointer' id='tok-70-345'>have</span><span class='token pointer' id='tok-70-346'>noticed</span><span class='token pointer' id='tok-70-347'>that</span><span class='token pointer' id='tok-70-348'>some</span><span class='token pointer' id='tok-70-349'>antivirus</span><span class='token pointer' id='tok-70-350'>software</span><span class='token pointer' id='tok-70-351'>is</span><span class='token pointer' id='tok-70-352'>detecting</span><span class='token pointer' id='tok-70-353'>it</span><span class='token pointer' id='tok-70-354'>as</span><span class='token pointer' id='tok-70-355'>malicious</span><span class='token pointer' id='tok-70-356'>using</span><span class='token pointer' id='tok-70-357'>its</span><span class='token pointer' id='tok-70-358'>welcome</span><span class='token pointer' id='tok-70-359'>text,</span><span class='token pointer' id='tok-70-360'>which</span><span class='token pointer' id='tok-70-361'>is</span><span class='token pointer' id='tok-70-362'>displayed</span><span class='token pointer' id='tok-70-363'>when</span><span class='token pointer' id='tok-70-364'>we</span><span class='token pointer' id='tok-70-365'>run</span><span class='token pointer' id='tok-70-366'>this</span><span class='token pointer' id='tok-70-367'>tool.</span><span class='token pointer' id='tok-70-368'>Therefore,</span><span class='token pointer' id='tok-70-369'>I</span><span class='token pointer' id='tok-70-370'>opened</span><span class='token pointer' id='tok-70-371'>wce.exe</span><span class='token pointer' id='tok-70-372'>in</span><span class='token pointer' id='tok-70-373'>a</span><span class='token pointer' id='tok-70-374'>hex</span><span class='token pointer' id='tok-70-375'>editor</span><span class='token pointer' id='tok-70-376'>and</span><span class='token pointer' id='tok-70-377'>changed</span><span class='token pointer' id='tok-70-378'>this</span><span class='token pointer' id='tok-70-379'>signature</span><span class='token pointer' id='tok-70-380'>from</span><span class='token pointer' id='tok-70-381'>uppercase</span><span class='token pointer' id='tok-70-382'>to</span><span class='token pointer' id='tok-70-383'>lowercase</span><span class='token pointer' id='tok-70-384'>and</span><span class='token pointer' id='tok-70-385'>vice</span><span class='token pointer' id='tok-70-386'>versa.</span><span class='token pointer' id='tok-70-387'>This</span><span class='token pointer' id='tok-70-388'>is</span><span class='token pointer' id='tok-70-389'>shown</span><span class='token pointer' id='tok-70-390'>below.</span></p>
<p id=p391><span class='token pointer' id='tok-70-391'>After</span><span class='token pointer' id='tok-70-392'>making</span><span class='token pointer' id='tok-70-393'>the</span><span class='token pointer' id='tok-70-394'>above</span><span class='token pointer' id='tok-70-395'>shown</span><span class='token pointer' id='tok-70-396'>modifications</span><span class='token pointer' id='tok-70-397'>to</span><span class='token pointer' id='tok-70-398'>the</span><span class='token pointer' id='tok-70-399'>binary,</span><span class='token pointer' id='tok-70-400'>I</span><span class='token pointer' id='tok-70-401'>have</span><span class='token pointer' id='tok-70-402'>scanned</span><span class='token pointer' id='tok-70-403'>through</span><span class='token pointer' id='tok-70-404'>virustotal.com</span><span class='token pointer' id='tok-70-405'>once</span><span class='token pointer' id='tok-70-406'>again</span><span class='token pointer' id='tok-70-407'>and</span><span class='token pointer' id='tok-70-408'>noticed</span><span class='token pointer' id='tok-70-409'>that</span><span class='token pointer' id='tok-70-410'>42</span><span class='token pointer' id='tok-70-411'>antivirus</span><span class='token pointer' id='tok-70-412'>engines</span><span class='token pointer' id='tok-70-413'>out</span><span class='token pointer' id='tok-70-414'>of</span><span class='token pointer' id='tok-70-415'>56</span><span class='token pointer' id='tok-70-416'>have</span><span class='token pointer' id='tok-70-417'>flagged</span><span class='token pointer' id='tok-70-418'>it</span><span class='token pointer' id='tok-70-419'>as</span><span class='token pointer' id='tok-70-420'>malicious</span><span class='token pointer' id='tok-70-421'>this</span><span class='token pointer' id='tok-70-422'>time.</span></p>
<p id=p423><span class='token pointer' id='tok-70-423'>However,</span><span class='token pointer' id='tok-70-424'>this</span><span class='token pointer' id='tok-70-425'>didn't</span><span class='token pointer' id='tok-70-426'>bypass</span><span class='token pointer' id='tok-70-427'>most</span><span class='token pointer' id='tok-70-428'>of</span><span class='token pointer' id='tok-70-429'>the</span><span class='token pointer' id='tok-70-430'>antivirus</span><span class='token pointer' id='tok-70-431'>applications;</span><span class='token pointer' id='tok-70-432'>it</span><span class='token pointer' id='tok-70-433'>is</span><span class='token pointer' id='tok-70-434'>possible</span><span class='token pointer' id='tok-70-435'>to</span><span class='token pointer' id='tok-70-436'>do</span><span class='token pointer' id='tok-70-437'>that</span><span class='token pointer' id='tok-70-438'>if</span><span class='token pointer' id='tok-70-439'>we</span><span class='token pointer' id='tok-70-440'>can</span><span class='token pointer' id='tok-70-441'>locate</span><span class='token pointer' id='tok-70-442'>the</span><span class='token pointer' id='tok-70-443'>exact</span><span class='token pointer' id='tok-70-444'>signature</span><span class='token pointer' id='tok-70-445'>that</span><span class='token pointer' id='tok-70-446'>is</span><span class='token pointer' id='tok-70-447'>being</span><span class='token pointer' id='tok-70-448'>detected</span><span class='token pointer' id='tok-70-449'>by</span><span class='token pointer' id='tok-70-450'>those</span><span class='token pointer' id='tok-70-451'>AVs.</span></p>
<p id=p452><span class='token pointer' id='tok-70-452'>When</span><span class='token pointer' id='tok-70-453'>we</span><span class='token pointer' id='tok-70-454'>use</span><span class='token pointer' id='tok-70-455'>the</span><span class='token pointer' id='tok-70-456'>above-mentioned</span><span class='token pointer' id='tok-70-457'>technique,</span><span class='token pointer' id='tok-70-458'>we</span><span class='token pointer' id='tok-70-459'>should</span><span class='token pointer' id='tok-70-460'>not</span><span class='token pointer' id='tok-70-461'>forget</span><span class='token pointer' id='tok-70-462'>about</span><span class='token pointer' id='tok-70-463'>the</span><span class='token pointer' id='tok-70-464'>functionality</span><span class='token pointer' id='tok-70-465'>of</span><span class='token pointer' id='tok-70-466'>the</span><span class='token pointer' id='tok-70-467'>binary</span><span class='token pointer' id='tok-70-468'>while</span><span class='token pointer' id='tok-70-469'>making</span><span class='token pointer' id='tok-70-470'>changes.</span></p>
<p id=p471><span class='token pointer' id='tok-70-471'>As</span><span class='token pointer' id='tok-70-472'>an</span><span class='token pointer' id='tok-70-473'>example,</span><span class='token pointer' id='tok-70-474'>here</span><span class='token pointer' id='tok-70-475'>is</span><span class='token pointer' id='tok-70-476'>the</span><span class='token pointer' id='tok-70-477'>output</span><span class='token pointer' id='tok-70-478'>of</span><span class='token pointer' id='tok-70-479'>original</span><span class='token pointer' id='tok-70-480'>wce.exe</span><span class='token pointer' id='tok-70-481'>dumping</span><span class='token pointer' id='tok-70-482'>the</span><span class='token pointer' id='tok-70-483'>password</span><span class='token pointer' id='tok-70-484'>from</span><span class='token pointer' id='tok-70-485'>memory.</span></p>
<p id=p486><span class='token pointer' id='tok-70-486'>The</span><span class='token pointer' id='tok-70-487'>functionality</span><span class='token pointer' id='tok-70-488'>remained</span><span class='token pointer' id='tok-70-489'>the</span><span class='token pointer' id='tok-70-490'>same</span><span class='token pointer' id='tok-70-491'>even</span><span class='token pointer' id='tok-70-492'>after</span><span class='token pointer' id='tok-70-493'>making</span><span class='token pointer' id='tok-70-494'>changes</span><span class='token pointer' id='tok-70-495'>to</span><span class='token pointer' id='tok-70-496'>the</span><span class='token pointer' id='tok-70-497'>binary.</span><span class='token pointer' id='tok-70-498'>It</span><span class='token pointer' id='tok-70-499'>is</span><span class='token pointer' id='tok-70-500'>still</span><span class='token pointer' id='tok-70-501'>able</span><span class='token pointer' id='tok-70-502'>to</span><span class='token pointer' id='tok-70-503'>get</span><span class='token pointer' id='tok-70-504'>the</span><span class='token pointer' id='tok-70-505'>password</span><span class='token pointer' id='tok-70-506'>from</span><span class='token pointer' id='tok-70-507'>the</span><span class='token pointer' id='tok-70-508'>memory</span><span class='token pointer' id='tok-70-509'>as</span><span class='token pointer' id='tok-70-510'>shown</span><span class='token pointer' id='tok-70-511'>below.</span></p>
<p id=p512><span class='token pointer' id='tok-70-512'>HyperionEncrypting</span><span class='token pointer' id='tok-70-513'>the</span><span class='token pointer' id='tok-70-514'>binary</span><span class='token pointer' id='tok-70-515'>is</span><span class='token pointer' id='tok-70-516'>one</span><span class='token pointer' id='tok-70-517'>of</span><span class='token pointer' id='tok-70-518'>the</span><span class='token pointer' id='tok-70-519'>common</span><span class='token pointer' id='tok-70-520'>ways</span><span class='token pointer' id='tok-70-521'>to</span><span class='token pointer' id='tok-70-522'>bypass</span><span class='token pointer' id='tok-70-523'>antivirus</span><span class='token pointer' id='tok-70-524'>detection.</span><span class='token pointer' id='tok-70-525'>The</span><span class='token pointer' id='tok-70-526'>logic</span><span class='token pointer' id='tok-70-527'>behind</span><span class='token pointer' id='tok-70-528'>using</span><span class='token pointer' id='tok-70-529'>encrypters</span><span class='token pointer' id='tok-70-530'>is</span><span class='token pointer' id='tok-70-531'>to</span><span class='token pointer' id='tok-70-532'>obfuscate</span><span class='token pointer' id='tok-70-533'>the</span><span class='token pointer' id='tok-70-534'>binary</span><span class='token pointer' id='tok-70-535'>from</span><span class='token pointer' id='tok-70-536'>antivirus</span><span class='token pointer' id='tok-70-537'>tools</span><span class='token pointer' id='tok-70-538'>by</span><span class='token pointer' id='tok-70-539'>encrypting</span><span class='token pointer' id='tok-70-540'>it.</span><span class='token pointer' id='tok-70-541'>This</span><span class='token pointer' id='tok-70-542'>will</span><span class='token pointer' id='tok-70-543'>be</span><span class='token pointer' id='tok-70-544'>decrypted</span><span class='token pointer' id='tok-70-545'>back</span><span class='token pointer' id='tok-70-546'>when</span><span class='token pointer' id='tok-70-547'>the</span><span class='token pointer' id='tok-70-548'>binary</span><span class='token pointer' id='tok-70-549'>is</span><span class='token pointer' id='tok-70-550'>run.</span><span class='token pointer' id='tok-70-551'>Kali</span><span class='token pointer' id='tok-70-552'>Linux</span><span class='token pointer' id='tok-70-553'>has</span><span class='token pointer' id='tok-70-554'>got</span><span class='token pointer' id='tok-70-555'>an</span><span class='token pointer' id='tok-70-556'>open</span><span class='token pointer' id='tok-70-557'>source</span><span class='token pointer' id='tok-70-558'>encrypter</span><span class='token pointer' id='tok-70-559'>named</span><span class='token pointer' id='tok-70-560'>Hyperion</span><span class='token pointer' id='tok-70-561'>available</span><span class='token pointer' id='tok-70-562'>in</span><span class='token pointer' id='tok-70-563'>it.</span><span class='token pointer' id='tok-70-564'></span></p>
<p id=p565><span class='token pointer' id='tok-70-565'>I</span><span class='token pointer' id='tok-70-566'>am</span><span class='token pointer' id='tok-70-567'>using</span><span class='token pointer' id='tok-70-568'>the</span><span class='token pointer' id='tok-70-569'>one</span><span class='token pointer' id='tok-70-570'>I</span><span class='token pointer' id='tok-70-571'>have</span><span class='token pointer' id='tok-70-572'>downloaded</span><span class='token pointer' id='tok-70-573'>from</span><span class='token pointer' id='tok-70-574'>the</span><span class='token pointer' id='tok-70-575'>above</span><span class='token pointer' id='tok-70-576'>link.</span><span class='token pointer' id='tok-70-577'>Let</span><span class='token pointer' id='tok-70-578'>us</span><span class='token pointer' id='tok-70-579'>see</span><span class='token pointer' id='tok-70-580'>how</span><span class='token pointer' id='tok-70-581'>we</span><span class='token pointer' id='tok-70-582'>can</span><span class='token pointer' id='tok-70-583'>use</span><span class='token pointer' id='tok-70-584'>this</span><span class='token pointer' id='tok-70-585'>tool.</span></p>
<p id=p586><span class='token pointer' id='tok-70-586'>Before</span><span class='token pointer' id='tok-70-587'>we</span><span class='token pointer' id='tok-70-588'>use</span><span class='token pointer' id='tok-70-589'>Hyperion,</span><span class='token pointer' id='tok-70-590'>let's</span><span class='token pointer' id='tok-70-591'>scan</span><span class='token pointer' id='tok-70-592'>the</span><span class='token pointer' id='tok-70-593'>32</span><span class='token pointer' id='tok-70-594'>bit</span><span class='token pointer' id='tok-70-595'>version</span><span class='token pointer' id='tok-70-596'>of</span><span class='token pointer' id='tok-70-597'>wce.exe</span><span class='token pointer' id='tok-70-598'>file</span><span class='token pointer' id='tok-70-599'>through</span><span class='token pointer' id='tok-70-600'>virustotal.com</span><span class='token pointer' id='tok-70-601'>first.</span></p>
<p id=p602><span class='token pointer' id='tok-70-602'>As</span><span class='token pointer' id='tok-70-603'>we</span><span class='token pointer' id='tok-70-604'>can</span><span class='token pointer' id='tok-70-605'>notice,</span><span class='token pointer' id='tok-70-606'>44</span><span class='token pointer' id='tok-70-607'>antivirus</span><span class='token pointer' id='tok-70-608'>applications</span><span class='token pointer' id='tok-70-609'>have</span><span class='token pointer' id='tok-70-610'>flagged</span><span class='token pointer' id='tok-70-611'>this</span><span class='token pointer' id='tok-70-612'>as</span><span class='token pointer' id='tok-70-613'>malicious.</span></p>
<p id=p614><span class='token pointer' id='tok-70-614'>Let's</span><span class='token pointer' id='tok-70-615'>encrypt</span><span class='token pointer' id='tok-70-616'>this</span><span class='token pointer' id='tok-70-617'>file</span><span class='token pointer' id='tok-70-618'>with</span><span class='token pointer' id='tok-70-619'>Hyperion</span><span class='token pointer' id='tok-70-620'>as</span><span class='token pointer' id='tok-70-621'>shown</span><span class='token pointer' id='tok-70-622'>below.</span></p>
<p id=p623><span class='token pointer' id='tok-70-623'>Let's</span><span class='token pointer' id='tok-70-624'>scan</span><span class='token pointer' id='tok-70-625'>this</span><span class='token pointer' id='tok-70-626'>newly</span><span class='token pointer' id='tok-70-627'>generated</span><span class='token pointer' id='tok-70-628'>file</span><span class='token pointer' id='tok-70-629'>once</span><span class='token pointer' id='tok-70-630'>again</span><span class='token pointer' id='tok-70-631'>and</span><span class='token pointer' id='tok-70-632'>see</span><span class='token pointer' id='tok-70-633'>the</span><span class='token pointer' id='tok-70-634'>detection</span><span class='token pointer' id='tok-70-635'>ratio.</span></p>
<p id=p636><span class='token pointer' id='tok-70-636'>As</span><span class='token pointer' id='tok-70-637'>we</span><span class='token pointer' id='tok-70-638'>can</span><span class='token pointer' id='tok-70-639'>see</span><span class='token pointer' id='tok-70-640'>in</span><span class='token pointer' id='tok-70-641'>the</span><span class='token pointer' id='tok-70-642'>figure</span><span class='token pointer' id='tok-70-643'>above,</span><span class='token pointer' id='tok-70-644'>this</span><span class='token pointer' id='tok-70-645'>has</span><span class='token pointer' id='tok-70-646'>got</span><span class='token pointer' id='tok-70-647'>lesser</span><span class='token pointer' id='tok-70-648'>detection</span><span class='token pointer' id='tok-70-649'>compared</span><span class='token pointer' id='tok-70-650'>to</span><span class='token pointer' id='tok-70-651'>the</span><span class='token pointer' id='tok-70-652'>unencrypted</span><span class='token pointer' id='tok-70-653'>binary.</span></p>
<p id=p654><span class='token pointer' id='tok-70-654'>Veil-EvasionVeil-Evasion</span><span class='token pointer' id='tok-70-655'>is</span><span class='token pointer' id='tok-70-656'>another</span><span class='token pointer' id='tok-70-657'>popular</span><span class='token pointer' id='tok-70-658'>framework</span><span class='token pointer' id='tok-70-659'>written</span><span class='token pointer' id='tok-70-660'>in</span><span class='token pointer' id='tok-70-661'>python.</span><span class='token pointer' id='tok-70-662'>We</span><span class='token pointer' id='tok-70-663'>can</span><span class='token pointer' id='tok-70-664'>use</span><span class='token pointer' id='tok-70-665'>this</span><span class='token pointer' id='tok-70-666'>framework</span><span class='token pointer' id='tok-70-667'>to</span><span class='token pointer' id='tok-70-668'>generate</span><span class='token pointer' id='tok-70-669'>payloads</span><span class='token pointer' id='tok-70-670'>that</span><span class='token pointer' id='tok-70-671'>can</span><span class='token pointer' id='tok-70-672'>evade</span><span class='token pointer' id='tok-70-673'>majority</span><span class='token pointer' id='tok-70-674'>of</span><span class='token pointer' id='tok-70-675'>AVs.</span></p>
<p id=p676><span class='token pointer' id='tok-70-676'>First</span><span class='token pointer' id='tok-70-677'>download</span><span class='token pointer' id='tok-70-678'>and</span><span class='token pointer' id='tok-70-679'>install</span><span class='token pointer' id='tok-70-680'>Veil-Evasion</span><span class='token pointer' id='tok-70-681'>and</span><span class='token pointer' id='tok-70-682'>run</span><span class='token pointer' id='tok-70-683'>it</span><span class='token pointer' id='tok-70-684'>using</span><span class='token pointer' id='tok-70-685'>the</span><span class='token pointer' id='tok-70-686'>following</span><span class='token pointer' id='tok-70-687'>command</span></p>
<p id=p688><span class='token pointer' id='tok-70-688'>"veil-evasion"</span></p>
<p id=p689><span class='token pointer' id='tok-70-689'>As</span><span class='token pointer' id='tok-70-690'>we</span><span class='token pointer' id='tok-70-691'>can</span><span class='token pointer' id='tok-70-692'>see,</span><span class='token pointer' id='tok-70-693'>46</span><span class='token pointer' id='tok-70-694'>payloads</span><span class='token pointer' id='tok-70-695'>have</span><span class='token pointer' id='tok-70-696'>been</span><span class='token pointer' id='tok-70-697'>loaded.</span><span class='token pointer' id='tok-70-698'>To</span><span class='token pointer' id='tok-70-699'>use</span><span class='token pointer' id='tok-70-700'>a</span><span class='token pointer' id='tok-70-701'>specific</span><span class='token pointer' id='tok-70-702'>payload,</span><span class='token pointer' id='tok-70-703'>we</span><span class='token pointer' id='tok-70-704'>can</span><span class='token pointer' id='tok-70-705'>type</span><span class='token pointer' id='tok-70-706'>"use"</span><span class='token pointer' id='tok-70-707'>command.</span></p>
<p id=p708><span class='token pointer' id='tok-70-708'>I</span><span class='token pointer' id='tok-70-709'>am</span><span class='token pointer' id='tok-70-710'>going</span><span class='token pointer' id='tok-70-711'>to</span><span class='token pointer' id='tok-70-712'>choose</span><span class='token pointer' id='tok-70-713'>option</span><span class='token pointer' id='tok-70-714'>31</span><span class='token pointer' id='tok-70-715'>to</span><span class='token pointer' id='tok-70-716'>create</span><span class='token pointer' id='tok-70-717'>the</span><span class='token pointer' id='tok-70-718'>executable</span><span class='token pointer' id='tok-70-719'>payload</span><span class='token pointer' id='tok-70-720'>python/meterpreter/rev_tcp.</span><span class='token pointer' id='tok-70-721'>Infact,</span><span class='token pointer' id='tok-70-722'>it</span><span class='token pointer' id='tok-70-723'>creates</span><span class='token pointer' id='tok-70-724'>a</span><span class='token pointer' id='tok-70-725'>python</span><span class='token pointer' id='tok-70-726'>script,</span><span class='token pointer' id='tok-70-727'>which</span><span class='token pointer' id='tok-70-728'>in</span><span class='token pointer' id='tok-70-729'>turn</span><span class='token pointer' id='tok-70-730'>will</span><span class='token pointer' id='tok-70-731'>be</span><span class='token pointer' id='tok-70-732'>converted</span><span class='token pointer' id='tok-70-733'>into</span><span class='token pointer' id='tok-70-734'>an</span><span class='token pointer' id='tok-70-735'>executable</span><span class='token pointer' id='tok-70-736'>using</span><span class='token pointer' id='tok-70-737'>tools</span><span class='token pointer' id='tok-70-738'>like</span><span class='token pointer' id='tok-70-739'>pyinstaller.</span></p>
<p id=p740><span class='token pointer' id='tok-70-740'>In</span><span class='token pointer' id='tok-70-741'>the</span><span class='token pointer' id='tok-70-742'>above</span><span class='token pointer' id='tok-70-743'>figure,</span><span class='token pointer' id='tok-70-744'>we</span><span class='token pointer' id='tok-70-745'>have</span><span class='token pointer' id='tok-70-746'>set</span><span class='token pointer' id='tok-70-747'>the</span><span class='token pointer' id='tok-70-748'>LHOST</span><span class='token pointer' id='tok-70-749'>to</span><span class='token pointer' id='tok-70-750'>192.168.56.101</span><span class='token pointer' id='tok-70-751'>and</span><span class='token pointer' id='tok-70-752'>typed</span><span class='token pointer' id='tok-70-753'>"generate"</span><span class='token pointer' id='tok-70-754'>command</span><span class='token pointer' id='tok-70-755'>to</span><span class='token pointer' id='tok-70-756'>generate</span><span class='token pointer' id='tok-70-757'>the</span><span class='token pointer' id='tok-70-758'>payload.</span></p>
<p id=p759><span class='token pointer' id='tok-70-759'>Next,</span><span class='token pointer' id='tok-70-760'>it</span><span class='token pointer' id='tok-70-761'>will</span><span class='token pointer' id='tok-70-762'>ask</span><span class='token pointer' id='tok-70-763'>us</span><span class='token pointer' id='tok-70-764'>to</span><span class='token pointer' id='tok-70-765'>enter</span><span class='token pointer' id='tok-70-766'>a</span><span class='token pointer' id='tok-70-767'>name</span><span class='token pointer' id='tok-70-768'>for</span><span class='token pointer' id='tok-70-769'>the</span><span class='token pointer' id='tok-70-770'>payload.</span><span class='token pointer' id='tok-70-771'>I</span><span class='token pointer' id='tok-70-772'>named</span><span class='token pointer' id='tok-70-773'>it</span><span class='token pointer' id='tok-70-774'>"backdoor".</span><span class='token pointer' id='tok-70-775'>As</span><span class='token pointer' id='tok-70-776'>mentioned</span><span class='token pointer' id='tok-70-777'>earlier,</span><span class='token pointer' id='tok-70-778'>Veil</span><span class='token pointer' id='tok-70-779'>converts</span><span class='token pointer' id='tok-70-780'>python</span><span class='token pointer' id='tok-70-781'>files</span><span class='token pointer' id='tok-70-782'>to</span><span class='token pointer' id='tok-70-783'>exe.</span><span class='token pointer' id='tok-70-784'>It</span><span class='token pointer' id='tok-70-785'>asks</span><span class='token pointer' id='tok-70-786'>us</span><span class='token pointer' id='tok-70-787'>to</span><span class='token pointer' id='tok-70-788'>choose</span><span class='token pointer' id='tok-70-789'>which</span><span class='token pointer' id='tok-70-790'>tool</span><span class='token pointer' id='tok-70-791'>we</span><span class='token pointer' id='tok-70-792'>want</span><span class='token pointer' id='tok-70-793'>to</span><span class='token pointer' id='tok-70-794'>use</span><span class='token pointer' id='tok-70-795'>for</span><span class='token pointer' id='tok-70-796'>this</span><span class='token pointer' id='tok-70-797'>process.</span><span class='token pointer' id='tok-70-798'>Personally,</span><span class='token pointer' id='tok-70-799'>I</span><span class='token pointer' id='tok-70-800'>like</span><span class='token pointer' id='tok-70-801'>Pyinstaller</span><span class='token pointer' id='tok-70-802'>and</span><span class='token pointer' id='tok-70-803'>I</span><span class='token pointer' id='tok-70-804'>am</span><span class='token pointer' id='tok-70-805'>going</span><span class='token pointer' id='tok-70-806'>for</span><span class='token pointer' id='tok-70-807'>it</span><span class='token pointer' id='tok-70-808'>with</span><span class='token pointer' id='tok-70-809'>option</span><span class='token pointer' id='tok-70-810'>1.</span><span class='token pointer' id='tok-70-811'>These</span><span class='token pointer' id='tok-70-812'>two</span><span class='token pointer' id='tok-70-813'>steps</span><span class='token pointer' id='tok-70-814'>are</span><span class='token pointer' id='tok-70-815'>shown</span><span class='token pointer' id='tok-70-816'>below.</span></p>
<p id=p817><span class='token pointer' id='tok-70-817'>Once</span><span class='token pointer' id='tok-70-818'>done,</span><span class='token pointer' id='tok-70-819'>it</span><span class='token pointer' id='tok-70-820'>will</span><span class='token pointer' id='tok-70-821'>create</span><span class='token pointer' id='tok-70-822'>our</span><span class='token pointer' id='tok-70-823'>final</span><span class='token pointer' id='tok-70-824'>payload</span><span class='token pointer' id='tok-70-825'>and</span><span class='token pointer' id='tok-70-826'>gives</span><span class='token pointer' id='tok-70-827'>us</span><span class='token pointer' id='tok-70-828'>the</span><span class='token pointer' id='tok-70-829'>location</span><span class='token pointer' id='tok-70-830'>of</span><span class='token pointer' id='tok-70-831'>it</span><span class='token pointer' id='tok-70-832'>as</span><span class='token pointer' id='tok-70-833'>shown</span><span class='token pointer' id='tok-70-834'>below.</span></p>
<p id=p835><span class='token pointer' id='tok-70-835'>As</span><span class='token pointer' id='tok-70-836'>we</span><span class='token pointer' id='tok-70-837'>can</span><span class='token pointer' id='tok-70-838'>see</span><span class='token pointer' id='tok-70-839'>in</span><span class='token pointer' id='tok-70-840'>the</span><span class='token pointer' id='tok-70-841'>figure</span><span class='token pointer' id='tok-70-842'>above,</span><span class='token pointer' id='tok-70-843'>the</span><span class='token pointer' id='tok-70-844'>authors</span><span class='token pointer' id='tok-70-845'>of</span><span class='token pointer' id='tok-70-846'>this</span><span class='token pointer' id='tok-70-847'>framework</span><span class='token pointer' id='tok-70-848'>are</span><span class='token pointer' id='tok-70-849'>suggesting</span><span class='token pointer' id='tok-70-850'>not</span><span class='token pointer' id='tok-70-851'>to</span><span class='token pointer' id='tok-70-852'>submit</span><span class='token pointer' id='tok-70-853'>these</span><span class='token pointer' id='tok-70-854'>samples</span><span class='token pointer' id='tok-70-855'>online.</span><span class='token pointer' id='tok-70-856'>Therefore,</span><span class='token pointer' id='tok-70-857'>I</span><span class='token pointer' id='tok-70-858'>have</span><span class='token pointer' id='tok-70-859'>checked</span><span class='token pointer' id='tok-70-860'>this</span><span class='token pointer' id='tok-70-861'>payload</span><span class='token pointer' id='tok-70-862'>in</span><span class='token pointer' id='tok-70-863'>sandboxed</span><span class='token pointer' id='tok-70-864'>environment</span><span class='token pointer' id='tok-70-865'>with</span><span class='token pointer' id='tok-70-866'>Avast</span><span class='token pointer' id='tok-70-867'>Antivirus</span><span class='token pointer' id='tok-70-868'>and</span><span class='token pointer' id='tok-70-869'>it</span><span class='token pointer' id='tok-70-870'>is</span><span class='token pointer' id='tok-70-871'>not</span><span class='token pointer' id='tok-70-872'>detected.</span></p>
<p id=p873><span class='token pointer' id='tok-70-873'>Ethical</span><span class='token pointer' id='tok-70-874'>Hacking</span><span class='token pointer' id='tok-70-875'>Training</span><span class='token pointer' id='tok-70-876'>â€“</span><span class='token pointer' id='tok-70-877'>Resources</span><span class='token pointer' id='tok-70-878'>(InfoSec)</span></p>
<p id=p879><span class='token pointer' id='tok-70-879'>These</span><span class='token pointer' id='tok-70-880'>payloads</span><span class='token pointer' id='tok-70-881'>also</span><span class='token pointer' id='tok-70-882'>work</span><span class='token pointer' id='tok-70-883'>fine</span><span class='token pointer' id='tok-70-884'>when</span><span class='token pointer' id='tok-70-885'>they</span><span class='token pointer' id='tok-70-886'>are</span><span class='token pointer' id='tok-70-887'>executed</span><span class='token pointer' id='tok-70-888'>on</span><span class='token pointer' id='tok-70-889'>Victim's</span><span class='token pointer' id='tok-70-890'>machines.</span></p>
<p id=p891><span class='token pointer' id='tok-70-891'>Following</span><span class='token pointer' id='tok-70-892'>figure</span><span class='token pointer' id='tok-70-893'>shows</span><span class='token pointer' id='tok-70-894'>a</span><span class='token pointer' id='tok-70-895'>meterpreter</span><span class='token pointer' id='tok-70-896'>shell</span><span class='token pointer' id='tok-70-897'>obtained</span><span class='token pointer' id='tok-70-898'>using</span><span class='token pointer' id='tok-70-899'>the</span><span class='token pointer' id='tok-70-900'>payload</span><span class='token pointer' id='tok-70-901'>created</span><span class='token pointer' id='tok-70-902'>above.</span></p>
<p id=p903><span class='token pointer' id='tok-70-903'>Try</span><span class='token pointer' id='tok-70-904'>with</span><span class='token pointer' id='tok-70-905'>other</span><span class='token pointer' id='tok-70-906'>payloads</span><span class='token pointer' id='tok-70-907'>that</span><span class='token pointer' id='tok-70-908'>use</span><span class='token pointer' id='tok-70-909'>encryption</span><span class='token pointer' id='tok-70-910'>to</span><span class='token pointer' id='tok-70-911'>get</span><span class='token pointer' id='tok-70-912'>better</span><span class='token pointer' id='tok-70-913'>output.</span></p>
<p id=p914><span class='token pointer' id='tok-70-914'>This</span><span class='token pointer' id='tok-70-915'>script</span><span class='token pointer' id='tok-70-916'>automates</span><span class='token pointer' id='tok-70-917'>multiple</span><span class='token pointer' id='tok-70-918'>tricks</span><span class='token pointer' id='tok-70-919'>to</span><span class='token pointer' id='tok-70-920'>evade</span><span class='token pointer' id='tok-70-921'>AVs.</span><span class='token pointer' id='tok-70-922'>The</span><span class='token pointer' id='tok-70-923'>author</span><span class='token pointer' id='tok-70-924'>has</span><span class='token pointer' id='tok-70-925'>written</span><span class='token pointer' id='tok-70-926'>this</span><span class='token pointer' id='tok-70-927'>for</span><span class='token pointer' id='tok-70-928'>his</span><span class='token pointer' id='tok-70-929'>own</span><span class='token pointer' id='tok-70-930'>purposes</span><span class='token pointer' id='tok-70-931'>and</span><span class='token pointer' id='tok-70-932'>he</span><span class='token pointer' id='tok-70-933'>released</span><span class='token pointer' id='tok-70-934'>it</span><span class='token pointer' id='tok-70-935'>publicly</span><span class='token pointer' id='tok-70-936'>as</span><span class='token pointer' id='tok-70-937'>a</span><span class='token pointer' id='tok-70-938'>beta</span><span class='token pointer' id='tok-70-939'>version.</span><span class='token pointer' id='tok-70-940'>This</span><span class='token pointer' id='tok-70-941'>script</span><span class='token pointer' id='tok-70-942'>gives</span><span class='token pointer' id='tok-70-943'>us</span><span class='token pointer' id='tok-70-944'>an</span><span class='token pointer' id='tok-70-945'>idea</span><span class='token pointer' id='tok-70-946'>of</span><span class='token pointer' id='tok-70-947'>how</span><span class='token pointer' id='tok-70-948'>we</span><span class='token pointer' id='tok-70-949'>can</span><span class='token pointer' id='tok-70-950'>write</span><span class='token pointer' id='tok-70-951'>our</span><span class='token pointer' id='tok-70-952'>own</span><span class='token pointer' id='tok-70-953'>scripts</span><span class='token pointer' id='tok-70-954'>to</span><span class='token pointer' id='tok-70-955'>evade</span><span class='token pointer' id='tok-70-956'>Antiviruses.</span></p>
<p id=p957><span class='token pointer' id='tok-70-957'>Let's</span><span class='token pointer' id='tok-70-958'>see</span><span class='token pointer' id='tok-70-959'>this</span><span class='token pointer' id='tok-70-960'>in</span><span class='token pointer' id='tok-70-961'>action.</span></p>
<p id=p962><span class='token pointer' id='tok-70-962'>I</span><span class='token pointer' id='tok-70-963'>am</span><span class='token pointer' id='tok-70-964'>going</span><span class='token pointer' id='tok-70-965'>to</span><span class='token pointer' id='tok-70-966'>create</span><span class='token pointer' id='tok-70-967'>a</span><span class='token pointer' id='tok-70-968'>meterpreter</span><span class='token pointer' id='tok-70-969'>payload</span><span class='token pointer' id='tok-70-970'>using</span><span class='token pointer' id='tok-70-971'>msfvenom</span><span class='token pointer' id='tok-70-972'>for</span><span class='token pointer' id='tok-70-973'>this</span><span class='token pointer' id='tok-70-974'>purpose.</span><span class='token pointer' id='tok-70-975'>This</span><span class='token pointer' id='tok-70-976'>is</span><span class='token pointer' id='tok-70-977'>shown</span><span class='token pointer' id='tok-70-978'>below.</span></p>
<p id=p979><span class='token pointer' id='tok-70-979'>Let</span><span class='token pointer' id='tok-70-980'>us</span><span class='token pointer' id='tok-70-981'>scan</span><span class='token pointer' id='tok-70-982'>the</span><span class='token pointer' id='tok-70-983'>payload</span><span class='token pointer' id='tok-70-984'>"test.exe"</span><span class='token pointer' id='tok-70-985'>through</span><span class='token pointer' id='tok-70-986'>virustotal.com</span><span class='token pointer' id='tok-70-987'>as</span><span class='token pointer' id='tok-70-988'>shown</span><span class='token pointer' id='tok-70-989'>below.</span></p>
<p id=p990><span class='token pointer' id='tok-70-990'>36</span><span class='token pointer' id='tok-70-991'>out</span><span class='token pointer' id='tok-70-992'>of</span><span class='token pointer' id='tok-70-993'>56</span><span class='token pointer' id='tok-70-994'>antivirus</span><span class='token pointer' id='tok-70-995'>engines</span><span class='token pointer' id='tok-70-996'>have</span><span class='token pointer' id='tok-70-997'>flagged</span><span class='token pointer' id='tok-70-998'>this</span><span class='token pointer' id='tok-70-999'>as</span><span class='token pointer' id='tok-70-1000'>malicious.</span></p>
<p id=p1001><span class='token pointer' id='tok-70-1001'>Now,</span><span class='token pointer' id='tok-70-1002'>lets</span><span class='token pointer' id='tok-70-1003'>run</span><span class='token pointer' id='tok-70-1004'>this</span><span class='token pointer' id='tok-70-1005'>using</span><span class='token pointer' id='tok-70-1006'>peCloak.py</span><span class='token pointer' id='tok-70-1007'>script.</span></p>
<p id=p1008><span class='token pointer' id='tok-70-1008'>I</span><span class='token pointer' id='tok-70-1009'>am</span><span class='token pointer' id='tok-70-1010'>using</span><span class='token pointer' id='tok-70-1011'>the</span><span class='token pointer' id='tok-70-1012'>script</span><span class='token pointer' id='tok-70-1013'>with</span><span class='token pointer' id='tok-70-1014'>the</span><span class='token pointer' id='tok-70-1015'>default</span><span class='token pointer' id='tok-70-1016'>options.</span></p>
<p id=p1017><span class='token pointer' id='tok-70-1017'>It</span><span class='token pointer' id='tok-70-1018'>creates</span><span class='token pointer' id='tok-70-1019'>a</span><span class='token pointer' id='tok-70-1020'>file</span><span class='token pointer' id='tok-70-1021'>called</span><span class='token pointer' id='tok-70-1022'>"cloaked.exe".</span></p>
<p id=p1023><span class='token pointer' id='tok-70-1023'>Let's</span><span class='token pointer' id='tok-70-1024'>scan</span><span class='token pointer' id='tok-70-1025'>this</span><span class='token pointer' id='tok-70-1026'>new</span><span class='token pointer' id='tok-70-1027'>payload</span><span class='token pointer' id='tok-70-1028'>and</span><span class='token pointer' id='tok-70-1029'>see</span><span class='token pointer' id='tok-70-1030'>how</span><span class='token pointer' id='tok-70-1031'>many</span><span class='token pointer' id='tok-70-1032'>antivirus</span><span class='token pointer' id='tok-70-1033'>engines</span><span class='token pointer' id='tok-70-1034'>detect</span><span class='token pointer' id='tok-70-1035'>is</span><span class='token pointer' id='tok-70-1036'>as</span><span class='token pointer' id='tok-70-1037'>malicious.</span></p>
<p id=p1038><span class='token pointer' id='tok-70-1038'>Only</span><span class='token pointer' id='tok-70-1039'>26</span><span class='token pointer' id='tok-70-1040'>out</span><span class='token pointer' id='tok-70-1041'>of</span><span class='token pointer' id='tok-70-1042'>56</span><span class='token pointer' id='tok-70-1043'>have</span><span class='token pointer' id='tok-70-1044'>flagged</span><span class='token pointer' id='tok-70-1045'>it</span><span class='token pointer' id='tok-70-1046'>as</span><span class='token pointer' id='tok-70-1047'>malicious.</span></p>
<p id=p1048><span class='token pointer' id='tok-70-1048'>Conclusion:</span><span class='token pointer' id='tok-70-1049'>Apart</span><span class='token pointer' id='tok-70-1050'>from</span><span class='token pointer' id='tok-70-1051'>the</span><span class='token pointer' id='tok-70-1052'>tools</span><span class='token pointer' id='tok-70-1053'>mentioned</span><span class='token pointer' id='tok-70-1054'>in</span><span class='token pointer' id='tok-70-1055'>this</span><span class='token pointer' id='tok-70-1056'>article,</span><span class='token pointer' id='tok-70-1057'>there</span><span class='token pointer' id='tok-70-1058'>are</span><span class='token pointer' id='tok-70-1059'>a</span><span class='token pointer' id='tok-70-1060'>couple</span><span class='token pointer' id='tok-70-1061'>of</span><span class='token pointer' id='tok-70-1062'>other</span><span class='token pointer' id='tok-70-1063'>tools</span><span class='token pointer' id='tok-70-1064'>out</span><span class='token pointer' id='tok-70-1065'>there</span><span class='token pointer' id='tok-70-1066'>such</span><span class='token pointer' id='tok-70-1067'>as</span><span class='token pointer' id='tok-70-1068'>Metasploit's</span><span class='token pointer' id='tok-70-1069'>encoders.</span><span class='token pointer' id='tok-70-1070'>It</span><span class='token pointer' id='tok-70-1071'>is</span><span class='token pointer' id='tok-70-1072'>better</span><span class='token pointer' id='tok-70-1073'>to</span><span class='token pointer' id='tok-70-1074'>write</span><span class='token pointer' id='tok-70-1075'>custom</span><span class='token pointer' id='tok-70-1076'>payloads</span><span class='token pointer' id='tok-70-1077'>and</span><span class='token pointer' id='tok-70-1078'>keep</span><span class='token pointer' id='tok-70-1079'>them</span><span class='token pointer' id='tok-70-1080'>simple</span><span class='token pointer' id='tok-70-1081'>to</span><span class='token pointer' id='tok-70-1082'>be</span><span class='token pointer' id='tok-70-1083'>away</span><span class='token pointer' id='tok-70-1084'>from</span><span class='token pointer' id='tok-70-1085'>Antivirus</span><span class='token pointer' id='tok-70-1086'>detection</span><span class='token pointer' id='tok-70-1087'>rather</span><span class='token pointer' id='tok-70-1088'>than</span><span class='token pointer' id='tok-70-1089'>creating</span><span class='token pointer' id='tok-70-1090'>payloads</span><span class='token pointer' id='tok-70-1091'>using</span><span class='token pointer' id='tok-70-1092'>popular</span><span class='token pointer' id='tok-70-1093'>frameworks.</span><span class='token pointer' id='tok-70-1094'>A</span><span class='token pointer' id='tok-70-1095'>side</span><span class='token pointer' id='tok-70-1096'>note:</span><span class='token pointer' id='tok-70-1097'>The</span><span class='token pointer' id='tok-70-1098'>results</span><span class='token pointer' id='tok-70-1099'>shown</span><span class='token pointer' id='tok-70-1100'>in</span><span class='token pointer' id='tok-70-1101'>this</span><span class='token pointer' id='tok-70-1102'>article</span><span class='token pointer' id='tok-70-1103'>may</span><span class='token pointer' id='tok-70-1104'>change</span><span class='token pointer' id='tok-70-1105'>when</span><span class='token pointer' id='tok-70-1106'>you</span><span class='token pointer' id='tok-70-1107'>read</span><span class='token pointer' id='tok-70-1108'>this</span><span class='token pointer' id='tok-70-1109'>article</span><span class='token pointer' id='tok-70-1110'>as</span><span class='token pointer' id='tok-70-1111'>Antivirus</span><span class='token pointer' id='tok-70-1112'></span><span class='token pointer' id='tok-70-1113'></span><span class='token pointer' id='tok-70-1114'></span><span class='token pointer' id='tok-70-1115'>